{"ast":null,"code":"import _asyncToGenerator from \"/Users/gregdunn/src/test/ai_debug_context/vscode_2/webview-ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { __decorate } from \"tslib\";\nimport { Component, Input, Output, EventEmitter, signal, ChangeDetectionStrategy } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nlet AIDebugComponent = class AIDebugComponent {\n  constructor() {\n    this.fileSelection = null;\n    this.testConfiguration = null;\n    this.workflowComplete = new EventEmitter();\n    this.workflowState = signal({\n      phase: 'idle',\n      progress: 0,\n      message: 'Ready to start AI debug workflow'\n    });\n    this.copilotAvailable = signal(false);\n    this.workflowPhases = [{\n      key: 'collecting-context',\n      label: 'Context',\n      icon: 'üìÅ'\n    }, {\n      key: 'running-tests',\n      label: 'Tests',\n      icon: 'üß™'\n    }, {\n      key: 'analyzing-results',\n      label: 'Analysis',\n      icon: 'ü§ñ'\n    }, {\n      key: 'generating-report',\n      label: 'Report',\n      icon: 'üìÑ'\n    }];\n  }\n  ngOnInit() {\n    this.checkCopilotAvailability();\n  }\n  canStartWorkflow() {\n    return !!(this.fileSelection && this.testConfiguration);\n  }\n  getStatusSummary() {\n    const state = this.workflowState();\n    switch (state.phase) {\n      case 'idle':\n        return 'Ready to start';\n      case 'complete':\n        return 'Analysis complete';\n      case 'error':\n        return 'Error occurred';\n      default:\n        return `${state.progress}% complete`;\n    }\n  }\n  getFileSelectionSummary() {\n    if (!this.fileSelection) return '';\n    switch (this.fileSelection.mode) {\n      case 'uncommitted':\n        return `${this.fileSelection.files.length} files`;\n      case 'commit':\n        return this.fileSelection.commit?.hash.substring(0, 7) || 'No commit';\n      case 'branch-diff':\n        return 'Branch to main';\n      default:\n        return '';\n    }\n  }\n  getTestConfigSummary() {\n    if (!this.testConfiguration) return '';\n    if (this.testConfiguration.mode === 'affected') {\n      return 'Affected tests';\n    } else {\n      return this.testConfiguration.project || 'No project';\n    }\n  }\n  getPhaseDisplayName() {\n    const state = this.workflowState();\n    switch (state.phase) {\n      case 'collecting-context':\n        return 'Collecting Context';\n      case 'running-tests':\n        return 'Running Tests';\n      case 'analyzing-results':\n        return 'Analyzing with AI';\n      case 'generating-report':\n        return 'Generating Report';\n      default:\n        return 'Processing';\n    }\n  }\n  getPhaseIndicatorClass(phaseKey) {\n    const currentPhase = this.workflowState().phase;\n    const phases = ['collecting-context', 'running-tests', 'analyzing-results', 'generating-report'];\n    const currentIndex = phases.indexOf(currentPhase);\n    const phaseIndex = phases.indexOf(phaseKey);\n    if (phaseIndex < currentIndex) {\n      return 'bg-green-100 text-green-800 border border-green-200';\n    } else if (phaseIndex === currentIndex) {\n      return 'bg-blue-100 text-blue-800 border border-blue-200';\n    } else {\n      return 'bg-gray-100 text-gray-600 border border-gray-200';\n    }\n  }\n  getPassedTestsCount() {\n    return this.workflowState().testResults?.filter(t => t.status === 'passed').length || 0;\n  }\n  getFailedTestsCount() {\n    return this.workflowState().testResults?.filter(t => t.status === 'failed').length || 0;\n  }\n  getSkippedTestsCount() {\n    return this.workflowState().testResults?.filter(t => t.status === 'skipped').length || 0;\n  }\n  getFailedTests() {\n    return this.workflowState().testResults?.filter(t => t.status === 'failed') || [];\n  }\n  startAIDebugWorkflow() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      if (!_this.canStartWorkflow()) return;\n      try {\n        // Phase 1: Collecting Context\n        _this.updateWorkflowState({\n          phase: 'collecting-context',\n          progress: 10,\n          message: 'Collecting file changes and test configuration...'\n        });\n        yield _this.simulateDelay(1000);\n        // Phase 2: Running Tests\n        _this.updateWorkflowState({\n          phase: 'running-tests',\n          progress: 30,\n          message: 'Executing test suite...'\n        });\n        const testResults = yield _this.runTests();\n        // Phase 3: Analyzing Results\n        _this.updateWorkflowState({\n          phase: 'analyzing-results',\n          progress: 70,\n          message: 'Analyzing test results with AI...',\n          testResults\n        });\n        const aiAnalysis = yield _this.performAIAnalysis(testResults);\n        // Phase 4: Generating Report\n        _this.updateWorkflowState({\n          phase: 'generating-report',\n          progress: 90,\n          message: 'Generating final report...',\n          testResults,\n          aiAnalysis\n        });\n        yield _this.simulateDelay(1000);\n        // Complete\n        _this.updateWorkflowState({\n          phase: 'complete',\n          progress: 100,\n          message: 'AI debug workflow completed successfully',\n          testResults,\n          aiAnalysis\n        });\n        _this.workflowComplete.emit({\n          testResults,\n          aiAnalysis\n        });\n      } catch (error) {\n        _this.updateWorkflowState({\n          phase: 'error',\n          progress: 0,\n          message: 'Error occurred during workflow',\n          error: error instanceof Error ? error.message : 'Unknown error'\n        });\n      }\n    })();\n  }\n  resetWorkflow() {\n    this.workflowState.set({\n      phase: 'idle',\n      progress: 0,\n      message: 'Ready to start AI debug workflow'\n    });\n  }\n  exportResults() {\n    const state = this.workflowState();\n    if (state.testResults && state.aiAnalysis) {\n      // This would trigger a download or save the results\n      console.log('Exporting results:', {\n        testResults: state.testResults,\n        aiAnalysis: state.aiAnalysis\n      });\n    }\n  }\n  updateWorkflowState(updates) {\n    this.workflowState.update(current => ({\n      ...current,\n      ...updates\n    }));\n  }\n  checkCopilotAvailability() {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      // Mock check - will be replaced with actual Copilot API check\n      yield _this2.simulateDelay(500);\n      _this2.copilotAvailable.set(Math.random() > 0.3); // 70% chance of being available for demo\n    })();\n  }\n  runTests() {\n    var _this3 = this;\n    return _asyncToGenerator(function* () {\n      // Mock test execution - will be replaced with actual test runner integration\n      yield _this3.simulateDelay(3000);\n      // Generate mock test results based on configuration\n      const mockResults = [{\n        name: 'should render component correctly',\n        status: 'passed',\n        duration: 245,\n        file: 'src/app/component.spec.ts'\n      }, {\n        name: 'should handle user input',\n        status: 'failed',\n        duration: 189,\n        file: 'src/app/component.spec.ts',\n        error: 'Expected true to be false',\n        stackTrace: 'at Object.toBe (src/app/component.spec.ts:25:23)'\n      }, {\n        name: 'should call service method',\n        status: 'passed',\n        duration: 156,\n        file: 'src/app/service.spec.ts'\n      }, {\n        name: 'should validate form input',\n        status: 'skipped',\n        duration: 0,\n        file: 'src/app/form.spec.ts'\n      }];\n      return mockResults;\n    })();\n  }\n  performAIAnalysis(testResults) {\n    var _this4 = this;\n    return _asyncToGenerator(function* () {\n      // Mock AI analysis - will be replaced with actual Copilot integration\n      yield _this4.simulateDelay(2000);\n      const failedTests = testResults.filter(t => t.status === 'failed');\n      if (failedTests.length > 0) {\n        // Failure analysis\n        return {\n          type: 'failure-analysis',\n          rootCause: 'The test failure appears to be caused by incorrect expectations in the component test. The test is expecting a boolean value to be false, but the component is returning true.',\n          suggestedFixes: ['Update the test expectation to match the actual component behavior', 'Check if the component logic needs to be modified to return false', 'Verify that the test setup is correctly initializing the component state'],\n          newTestSuggestions: ['Add test for edge cases in user input handling', 'Add integration test for component-service interaction', 'Add test for error handling scenarios']\n        };\n      } else {\n        // Success analysis\n        return {\n          type: 'success-analysis',\n          falsePositiveWarnings: ['The skipped test for form validation should be implemented', 'Consider adding more edge case tests for user input scenarios'],\n          codeImprovements: ['Consider adding more descriptive test names', 'Add setup and teardown methods for better test isolation', 'Consider using test data builders for complex object creation'],\n          newTestSuggestions: ['Add performance tests for component rendering', 'Add accessibility tests using testing-library', 'Add tests for component lifecycle methods']\n        };\n      }\n    })();\n  }\n  simulateDelay(ms) {\n    return new Promise(resolve => setTimeout(resolve, ms));\n  }\n};\n__decorate([Input()], AIDebugComponent.prototype, \"fileSelection\", void 0);\n__decorate([Input()], AIDebugComponent.prototype, \"testConfiguration\", void 0);\n__decorate([Output()], AIDebugComponent.prototype, \"workflowComplete\", void 0);\nAIDebugComponent = __decorate([Component({\n  selector: 'app-ai-debug',\n  imports: [CommonModule, FormsModule],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  template: `\n    <div class=\"bg-vscode-editor-background p-4 rounded-lg border border-vscode-panel-border\">\n      <div class=\"flex items-center justify-between mb-6\">\n        <h3 class=\"text-vscode-foreground text-lg font-semibold flex items-center gap-2\">\n          <span class=\"text-2xl\">ü§ñ</span>\n          AI Test Debug\n        </h3>\n        <div class=\"text-vscode-descriptionForeground text-sm\">\n          {{ getStatusSummary() }}\n        </div>\n      </div>\n\n      <!-- Prerequisites Check -->\n      <div class=\"mb-6 space-y-3\">\n        <h4 class=\"text-vscode-foreground font-medium\">Prerequisites</h4>\n        <div class=\"grid gap-2\">\n          <div class=\"flex items-center gap-2 text-sm\">\n            <span [class]=\"fileSelection ? 'text-green-500' : 'text-red-500'\">\n              {{ fileSelection ? '‚úÖ' : '‚ùå' }}\n            </span>\n            <span class=\"text-vscode-foreground\">File selection configured</span>\n            @if (fileSelection) {\n              <span class=\"text-vscode-descriptionForeground text-xs\">\n                ({{ fileSelection.mode }}: {{ getFileSelectionSummary() }})\n              </span>\n            }\n          </div>\n          \n          <div class=\"flex items-center gap-2 text-sm\">\n            <span [class]=\"testConfiguration ? 'text-green-500' : 'text-red-500'\">\n              {{ testConfiguration ? '‚úÖ' : '‚ùå' }}\n            </span>\n            <span class=\"text-vscode-foreground\">Test configuration set</span>\n            @if (testConfiguration) {\n              <span class=\"text-vscode-descriptionForeground text-xs\">\n                ({{ testConfiguration.mode }}: {{ getTestConfigSummary() }})\n              </span>\n            }\n          </div>\n          \n          <div class=\"flex items-center gap-2 text-sm\">\n            <span [class]=\"copilotAvailable() ? 'text-green-500' : 'text-yellow-500'\">\n              {{ copilotAvailable() ? '‚úÖ' : '‚ö†Ô∏è' }}\n            </span>\n            <span class=\"text-vscode-foreground\">GitHub Copilot</span>\n            <span class=\"text-vscode-descriptionForeground text-xs\">\n              {{ copilotAvailable() ? 'Available' : 'Not available - will use fallback analysis' }}\n            </span>\n          </div>\n        </div>\n      </div>\n\n      <!-- Main Action Button -->\n      @if (workflowState().phase === 'idle') {\n        <div class=\"mb-6 text-center\">\n          <button \n            (click)=\"startAIDebugWorkflow()\"\n            [disabled]=\"!canStartWorkflow()\"\n            class=\"px-8 py-4 bg-vscode-button-background text-vscode-button-foreground rounded-lg font-medium text-lg hover:bg-vscode-button-hoverBackground disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200\">\n            <span class=\"flex items-center gap-3\">\n              <span class=\"text-2xl\">üöÄ</span>\n              <span>Run AI Test Debug</span>\n            </span>\n          </button>\n          \n          @if (!canStartWorkflow()) {\n            <p class=\"text-vscode-descriptionForeground text-sm mt-2\">\n              Complete file selection and test configuration to continue\n            </p>\n          }\n        </div>\n      }\n\n      <!-- Workflow Progress -->\n      @if (workflowState().phase !== 'idle') {\n        <div class=\"mb-6\">\n          <!-- Progress Bar -->\n          <div class=\"mb-4\">\n            <div class=\"flex justify-between items-center mb-2\">\n              <span class=\"text-vscode-foreground text-sm font-medium\">\n                {{ getPhaseDisplayName() }}\n              </span>\n              <span class=\"text-vscode-descriptionForeground text-xs\">\n                {{ workflowState().progress }}%\n              </span>\n            </div>\n            <div class=\"w-full bg-vscode-progressBar-background rounded-full h-2\">\n              <div \n                class=\"bg-vscode-progressBar-foreground h-2 rounded-full transition-all duration-300\"\n                [style.width.%]=\"workflowState().progress\">\n              </div>\n            </div>\n            <p class=\"text-vscode-descriptionForeground text-xs mt-2\">\n              {{ workflowState().message }}\n            </p>\n          </div>\n\n          <!-- Phase Indicators -->\n          <div class=\"grid grid-cols-2 md:grid-cols-4 gap-2 text-xs\">\n            @for (phase of workflowPhases; track phase.key) {\n              <div class=\"flex items-center gap-2 p-2 rounded\" [class]=\"getPhaseIndicatorClass(phase.key)\">\n                <span>{{ phase.icon }}</span>\n                <span>{{ phase.label }}</span>\n              </div>\n            }\n          </div>\n        </div>\n      }\n\n      <!-- Test Results -->\n      @if (workflowState().testResults && workflowState().testResults.length > 0) {\n        <div class=\"mb-6\">\n          <h4 class=\"text-vscode-foreground font-medium mb-3\">Test Results</h4>\n          \n          <!-- Test Summary -->\n          <div class=\"grid grid-cols-3 gap-4 mb-4\">\n            <div class=\"bg-green-50 border border-green-200 rounded p-3 text-center\">\n              <div class=\"text-green-600 text-xl font-bold\">{{ getPassedTestsCount() }}</div>\n              <div class=\"text-green-700 text-sm\">Passed</div>\n            </div>\n            <div class=\"bg-red-50 border border-red-200 rounded p-3 text-center\">\n              <div class=\"text-red-600 text-xl font-bold\">{{ getFailedTestsCount() }}</div>\n              <div class=\"text-red-700 text-sm\">Failed</div>\n            </div>\n            <div class=\"bg-yellow-50 border border-yellow-200 rounded p-3 text-center\">\n              <div class=\"text-yellow-600 text-xl font-bold\">{{ getSkippedTestsCount() }}</div>\n              <div class=\"text-yellow-700 text-sm\">Skipped</div>\n            </div>\n          </div>\n\n          <!-- Failed Tests Details -->\n          @if (getFailedTests().length > 0) {\n            <div class=\"space-y-2 max-h-64 overflow-y-auto border border-vscode-panel-border rounded p-2\">\n              @for (test of getFailedTests(); track test.name) {\n                <div class=\"bg-red-50 border border-red-200 rounded p-3\">\n                  <div class=\"flex items-start justify-between\">\n                    <div class=\"flex-1\">\n                      <div class=\"font-medium text-red-800\">{{ test.name }}</div>\n                      <div class=\"text-red-600 text-sm font-mono\">{{ test.file }}</div>\n                      @if (test.error) {\n                        <div class=\"text-red-700 text-sm mt-2\">{{ test.error }}</div>\n                      }\n                    </div>\n                    <div class=\"text-red-500 text-xs\">{{ test.duration }}ms</div>\n                  </div>\n                </div>\n              }\n            </div>\n          }\n        </div>\n      }\n\n      <!-- AI Analysis Results -->\n      @if (workflowState().aiAnalysis) {\n        <div class=\"mb-6\">\n          <h4 class=\"text-vscode-foreground font-medium mb-3\">AI Analysis</h4>\n          \n          @if (workflowState().aiAnalysis!.type === 'failure-analysis') {\n            <!-- Failure Analysis -->\n            <div class=\"space-y-4\">\n              @if (workflowState().aiAnalysis!.rootCause) {\n                <div class=\"bg-vscode-textBlockQuote-background border-l-4 border-red-400 p-4 rounded\">\n                  <h5 class=\"text-vscode-foreground font-medium mb-2\">üîç Root Cause Analysis</h5>\n                  <p class=\"text-vscode-textBlockQuote-foreground text-sm\">\n                    {{ workflowState().aiAnalysis!.rootCause }}\n                  </p>\n                </div>\n              }\n\n              @if (workflowState().aiAnalysis!.suggestedFixes && workflowState().aiAnalysis!.suggestedFixes!.length > 0) {\n                <div class=\"bg-vscode-textBlockQuote-background border-l-4 border-blue-400 p-4 rounded\">\n                  <h5 class=\"text-vscode-foreground font-medium mb-2\">üîß Suggested Fixes</h5>\n                  <ul class=\"space-y-2\">\n                    @for (fix of workflowState().aiAnalysis!.suggestedFixes!; track fix) {\n                      <li class=\"text-vscode-textBlockQuote-foreground text-sm flex items-start gap-2\">\n                        <span class=\"text-blue-500 mt-1\">‚Ä¢</span>\n                        <span>{{ fix }}</span>\n                      </li>\n                    }\n                  </ul>\n                </div>\n              }\n            </div>\n          } @else {\n            <!-- Success Analysis -->\n            <div class=\"space-y-4\">\n              @if (workflowState().aiAnalysis!.falsePositiveWarnings && workflowState().aiAnalysis!.falsePositiveWarnings!.length > 0) {\n                <div class=\"bg-vscode-textBlockQuote-background border-l-4 border-yellow-400 p-4 rounded\">\n                  <h5 class=\"text-vscode-foreground font-medium mb-2\">‚ö†Ô∏è Potential False Positives</h5>\n                  <ul class=\"space-y-2\">\n                    @for (warning of workflowState().aiAnalysis!.falsePositiveWarnings!; track warning) {\n                      <li class=\"text-vscode-textBlockQuote-foreground text-sm flex items-start gap-2\">\n                        <span class=\"text-yellow-500 mt-1\">‚Ä¢</span>\n                        <span>{{ warning }}</span>\n                      </li>\n                    }\n                  </ul>\n                </div>\n              }\n\n              @if (workflowState().aiAnalysis!.codeImprovements && workflowState().aiAnalysis!.codeImprovements!.length > 0) {\n                <div class=\"bg-vscode-textBlockQuote-background border-l-4 border-green-400 p-4 rounded\">\n                  <h5 class=\"text-vscode-foreground font-medium mb-2\">üí° Code Improvements</h5>\n                  <ul class=\"space-y-2\">\n                    @for (improvement of workflowState().aiAnalysis!.codeImprovements!; track improvement) {\n                      <li class=\"text-vscode-textBlockQuote-foreground text-sm flex items-start gap-2\">\n                        <span class=\"text-green-500 mt-1\">‚Ä¢</span>\n                        <span>{{ improvement }}</span>\n                      </li>\n                    }\n                  </ul>\n                </div>\n              }\n            </div>\n          }\n\n          <!-- Test Suggestions (always shown) -->\n          @if (workflowState().aiAnalysis!.newTestSuggestions && workflowState().aiAnalysis!.newTestSuggestions!.length > 0) {\n            <div class=\"bg-vscode-textBlockQuote-background border-l-4 border-purple-400 p-4 rounded\">\n              <h5 class=\"text-vscode-foreground font-medium mb-2\">üß™ New Test Suggestions</h5>\n              <ul class=\"space-y-2\">\n                @for (suggestion of workflowState().aiAnalysis!.newTestSuggestions!; track suggestion) {\n                  <li class=\"text-vscode-textBlockQuote-foreground text-sm flex items-start gap-2\">\n                    <span class=\"text-purple-500 mt-1\">‚Ä¢</span>\n                    <span>{{ suggestion }}</span>\n                  </li>\n                }\n              </ul>\n            </div>\n          }\n        </div>\n      }\n\n      <!-- Error State -->\n      @if (workflowState().phase === 'error') {\n        <div class=\"mb-6\">\n          <div class=\"bg-red-50 border border-red-200 rounded p-4\">\n            <h4 class=\"text-red-800 font-medium mb-2\">‚ùå Error Occurred</h4>\n            <p class=\"text-red-700 text-sm\">\n              {{ workflowState().error || 'An unexpected error occurred during the AI debug workflow.' }}\n            </p>\n            <button \n              (click)=\"resetWorkflow()\"\n              class=\"mt-3 px-4 py-2 bg-red-600 text-white rounded text-sm hover:bg-red-700\">\n              Try Again\n            </button>\n          </div>\n        </div>\n      }\n\n      <!-- Complete State -->\n      @if (workflowState().phase === 'complete') {\n        <div class=\"mb-6\">\n          <div class=\"bg-green-50 border border-green-200 rounded p-4 text-center\">\n            <h4 class=\"text-green-800 font-medium mb-2\">‚úÖ Analysis Complete</h4>\n            <p class=\"text-green-700 text-sm mb-4\">\n              AI debug workflow completed successfully. Review the analysis above.\n            </p>\n            <div class=\"flex gap-3 justify-center\">\n              <button \n                (click)=\"exportResults()\"\n                class=\"px-4 py-2 bg-green-600 text-white rounded text-sm hover:bg-green-700\">\n                üìÑ Export Results\n              </button>\n              <button \n                (click)=\"resetWorkflow()\"\n                class=\"px-4 py-2 bg-vscode-button-secondaryBackground text-vscode-button-secondaryForeground rounded text-sm hover:bg-vscode-button-secondaryHoverBackground\">\n                üîÑ New Analysis\n              </button>\n            </div>\n          </div>\n        </div>\n      }\n    </div>\n  `,\n  styles: []\n})], AIDebugComponent);\nexport { AIDebugComponent };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}