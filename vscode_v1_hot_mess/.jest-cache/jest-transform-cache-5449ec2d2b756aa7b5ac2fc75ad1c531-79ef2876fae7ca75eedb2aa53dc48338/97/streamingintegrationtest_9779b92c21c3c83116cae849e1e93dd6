8cbfb75f9fb6409638e9852156e82215
"use strict";
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
// Mock VSCode completely for integration tests
jest.mock('vscode', () => ({
    StatusBarAlignment: {
        Left: 1,
        Right: 2
    },
    Uri: {
        joinPath: jest.fn(() => ({ toString: () => 'mock://uri' })),
        parse: jest.fn(() => ({ toString: () => 'mock://uri' }))
    },
    workspace: {
        workspaceFolders: [{ uri: { fsPath: '/test/workspace' } }],
        getConfiguration: jest.fn(() => ({
            get: jest.fn(() => true)
        }))
    },
    window: {
        createStatusBarItem: jest.fn(() => ({
            show: jest.fn(),
            hide: jest.fn(),
            dispose: jest.fn(),
            text: '',
            tooltip: '',
            command: ''
        })),
        showInformationMessage: jest.fn(),
        showErrorMessage: jest.fn(),
        createOutputChannel: jest.fn(() => ({
            append: jest.fn(),
            appendLine: jest.fn(),
            show: jest.fn(),
            hide: jest.fn(),
            dispose: jest.fn()
        }))
    }
}));
const provider_1 = require("../webview/provider");
const statusTracker_1 = require("../utils/statusTracker");
const vscode = __importStar(require("vscode"));
describe('Integration Tests', () => {
    let provider;
    let mockProjectDetector;
    let mockCommandRunner;
    let mockFileManager;
    let mockWebviewView;
    let mockWebview;
    let receivedMessages = [];
    beforeEach(() => {
        jest.clearAllMocks();
        receivedMessages = [];
        // Setup mocked dependencies
        mockProjectDetector = {
            getProjects: jest.fn().mockResolvedValue([
                { name: 'test-app', root: 'apps/test-app', projectType: 'application' }
            ]),
            getCurrentProject: jest.fn().mockResolvedValue({ name: 'test-app', root: 'apps/test-app', projectType: 'application' })
        };
        mockCommandRunner = {
            runAiDebug: jest.fn().mockResolvedValue({ success: true, exitCode: 0, output: 'AI debug complete', duration: 2000 }),
            runNxTest: jest.fn().mockResolvedValue({ success: true, exitCode: 0, output: 'Tests passed', duration: 5000 }),
            runGitDiff: jest.fn().mockResolvedValue({ success: true, exitCode: 0, output: 'Diff complete', duration: 1000 }),
            runPrepareToPush: jest.fn().mockResolvedValue({ success: true, exitCode: 0, output: 'Prepared to push', duration: 3000 })
        };
        mockFileManager = {
            watchFiles: jest.fn(),
            getFileContent: jest.fn().mockResolvedValue('test file content'),
            openFile: jest.fn()
        };
        // Setup webview mocks that capture messages
        mockWebview = {
            asWebviewUri: jest.fn().mockReturnValue('mock://webview-uri'),
            postMessage: jest.fn((message) => {
                receivedMessages.push(message);
                return Promise.resolve(true);
            }),
            onDidReceiveMessage: jest.fn(),
            html: '',
            options: {}
        };
        mockWebviewView = {
            webview: mockWebview,
            show: jest.fn()
        };
        // Create provider
        const mockStatusTracker = new statusTracker_1.StatusTracker();
        provider = new provider_1.WebviewProvider(vscode.Uri.parse('test://extension'), mockProjectDetector, mockCommandRunner, mockFileManager, mockStatusTracker);
    });
    describe('webview integration', () => {
        beforeEach(() => {
            provider.resolveWebviewView(mockWebviewView, {}, {});
        });
        it('should handle runCommand message for nxTest', async () => {
            // Arrange
            const message = {
                command: 'runCommand',
                data: {
                    action: 'nxTest',
                    project: 'test-app',
                    options: {}
                }
            };
            const messageHandler = mockWebview.onDidReceiveMessage.mock.calls[0][0];
            // Act
            await messageHandler(message);
            // Assert
            expect(mockCommandRunner.runNxTest).toHaveBeenCalledWith('test-app', {});
            expect(receivedMessages.some(msg => msg.type === 'commandResult')).toBe(true);
            const resultMessage = receivedMessages.find(msg => msg.type === 'commandResult');
            expect(resultMessage.data.action).toBe('nxTest');
            expect(resultMessage.data.result.success).toBe(true);
        });
        it('should handle runCommand message for gitDiff', async () => {
            // Arrange
            const message = {
                command: 'runCommand',
                data: {
                    action: 'gitDiff',
                    options: {}
                }
            };
            const messageHandler = mockWebview.onDidReceiveMessage.mock.calls[0][0];
            // Act
            await messageHandler(message);
            // Assert
            expect(mockCommandRunner.runGitDiff).toHaveBeenCalledWith({});
            expect(receivedMessages.some(msg => msg.type === 'commandResult')).toBe(true);
        });
        it('should handle runCommand message for aiDebug', async () => {
            // Arrange
            const message = {
                command: 'runCommand',
                data: {
                    action: 'aiDebug',
                    project: 'test-app',
                    options: {}
                }
            };
            const messageHandler = mockWebview.onDidReceiveMessage.mock.calls[0][0];
            // Act
            await messageHandler(message);
            // Assert
            expect(mockCommandRunner.runAiDebug).toHaveBeenCalledWith('test-app', {});
            expect(receivedMessages.some(msg => msg.type === 'commandResult')).toBe(true);
        });
        it('should handle getProjects message', async () => {
            // Arrange
            const message = {
                command: 'getProjects',
                data: {}
            };
            const messageHandler = mockWebview.onDidReceiveMessage.mock.calls[0][0];
            // Act
            await messageHandler(message);
            // Assert
            expect(mockProjectDetector.getProjects).toHaveBeenCalled();
            expect(receivedMessages.some(msg => msg.type === 'projects')).toBe(true);
            const projectsMessage = receivedMessages.find(msg => msg.type === 'projects');
            expect(projectsMessage.data.projects).toHaveLength(1);
            expect(projectsMessage.data.projects[0].name).toBe('test-app');
        });
        it('should handle openFile message', async () => {
            // Arrange
            const message = {
                command: 'openFile',
                data: {
                    filePath: '/test/file.ts'
                }
            };
            const messageHandler = mockWebview.onDidReceiveMessage.mock.calls[0][0];
            // Act
            await messageHandler(message);
            // Assert
            expect(mockFileManager.openFile).toHaveBeenCalledWith('/test/file.ts');
        });
        it('should handle clearOutput message', async () => {
            // Arrange
            const message = {
                command: 'clearOutput',
                data: {}
            };
            const messageHandler = mockWebview.onDidReceiveMessage.mock.calls[0][0];
            // Act
            await messageHandler(message);
            // Assert
            expect(receivedMessages.some(msg => msg.type === 'outputCleared')).toBe(true);
        });
        it('should handle unknown message command', async () => {
            // Arrange
            const consoleSpy = jest.spyOn(console, 'warn').mockImplementation();
            const message = {
                command: 'unknownCommand',
                data: {}
            };
            const messageHandler = mockWebview.onDidReceiveMessage.mock.calls[0][0];
            // Act
            await messageHandler(message);
            // Assert
            expect(consoleSpy).toHaveBeenCalledWith('Unknown message command:', 'unknownCommand');
            consoleSpy.mockRestore();
        });
        it('should handle command errors gracefully', async () => {
            // Arrange
            mockCommandRunner.runNxTest.mockRejectedValue(new Error('Command failed'));
            const message = {
                command: 'runCommand',
                data: {
                    action: 'nxTest',
                    project: 'test-app'
                }
            };
            const messageHandler = mockWebview.onDidReceiveMessage.mock.calls[0][0];
            // Act
            await messageHandler(message);
            // Assert
            expect(receivedMessages.some(msg => msg.type === 'commandError')).toBe(true);
            const errorMessage = receivedMessages.find(msg => msg.type === 'commandError');
            expect(errorMessage.data.action).toBe('nxTest');
            expect(errorMessage.data.error).toBe('Command failed');
        });
        it('should handle project detection errors', async () => {
            // Arrange
            mockProjectDetector.getProjects.mockRejectedValue(new Error('Project detection failed'));
            const message = {
                command: 'getProjects',
                data: {}
            };
            const messageHandler = mockWebview.onDidReceiveMessage.mock.calls[0][0];
            // Act
            await messageHandler(message);
            // Assert
            expect(receivedMessages.some(msg => msg.type === 'error')).toBe(true);
            const errorMessage = receivedMessages.find(msg => msg.type === 'error');
            expect(errorMessage.data.error).toBe('Project detection failed');
        });
        it('should handle file operation errors', async () => {
            // Arrange
            mockFileManager.openFile.mockRejectedValue(new Error('File not found'));
            const message = {
                command: 'openFile',
                data: {
                    filePath: '/non/existent/file.ts'
                }
            };
            const messageHandler = mockWebview.onDidReceiveMessage.mock.calls[0][0];
            // Act
            await messageHandler(message);
            // Assert
            expect(receivedMessages.some(msg => msg.type === 'error')).toBe(true);
            const errorMessage = receivedMessages.find(msg => msg.type === 'error');
            expect(errorMessage.data.error).toBe('File not found');
        });
        it('should handle invalid action in runCommand', async () => {
            // Arrange
            vscode.window.showErrorMessage = jest.fn();
            const message = {
                command: 'runCommand',
                data: {
                    action: 'invalidAction',
                    project: 'test-app'
                }
            };
            const messageHandler = mockWebview.onDidReceiveMessage.mock.calls[0][0];
            // Act
            await messageHandler(message);
            // Assert
            expect(receivedMessages.some(msg => msg.type === 'commandError')).toBe(true);
            const errorMessage = receivedMessages.find(msg => msg.type === 'commandError');
            expect(errorMessage.data.error).toContain('Unknown action: invalidAction');
        });
    });
    describe('webview setup', () => {
        it('should set up webview correctly', () => {
            // Act
            provider.resolveWebviewView(mockWebviewView, {}, {});
            // Assert
            expect(mockWebviewView.webview.options.enableScripts).toBe(true);
            expect(mockWebviewView.webview.options.localResourceRoots).toHaveLength(1);
            expect(mockWebviewView.webview.options.localResourceRoots?.[0]?.toString()).toBe('mock://uri');
            expect(mockWebviewView.webview.html).toContain('<!DOCTYPE html>');
            expect(mockWebviewView.webview.onDidReceiveMessage).toHaveBeenCalled();
            expect(mockFileManager.watchFiles).toHaveBeenCalled();
        });
        it('should set up file watcher', () => {
            // Arrange
            provider.resolveWebviewView(mockWebviewView, {}, {});
            // Get the file watcher callback
            const watchFilesCallback = mockFileManager.watchFiles.mock.calls[0][0];
            // Act
            watchFilesCallback('/test/file.ts', 'modified');
            // Assert
            expect(receivedMessages.some(msg => msg.type === 'fileChanged')).toBe(true);
            const fileChangedMessage = receivedMessages.find(msg => msg.type === 'fileChanged');
            expect(fileChangedMessage.data.filePath).toBe('/test/file.ts');
            expect(fileChangedMessage.data.eventType).toBe('modified');
        });
        it('should generate correct HTML for webview', () => {
            // Act
            provider.resolveWebviewView(mockWebviewView, {}, {});
            // Assert
            const html = mockWebviewView.webview.html;
            expect(html).toContain('<!DOCTYPE html>');
            expect(html).toContain('<title>AI Debug Utilities</title>');
            expect(html).toContain('<div id="root"></div>');
            expect(html).toContain('mock://webview-uri');
        });
    });
    describe('public methods', () => {
        beforeEach(() => {
            provider.resolveWebviewView(mockWebviewView, {}, {});
        });
        it('should show webview when show() is called', () => {
            // Act
            provider.show();
            // Assert
            expect(mockWebviewView.show).toHaveBeenCalled();
        });
        it('should run command when runCommand() is called', async () => {
            // Act
            await provider.runCommand('nxTest', { project: 'test-app' });
            // Assert
            expect(mockCommandRunner.runNxTest).toHaveBeenCalledWith('test-app', undefined);
        });
        it('should dispose cleanly', () => {
            // Act
            provider.dispose();
            // Assert - should not throw
            expect(() => provider.dispose()).not.toThrow();
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2dyZWdkdW5uL3NyYy90ZXN0L2FpX2RlYnVnX2NvbnRleHQvdnNjb2RlL3NyYy9fX3Rlc3RzX18vc3RyZWFtaW5nLmludGVncmF0aW9uLnRlc3QudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFRQSwrQ0FBK0M7QUFDL0MsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUN2QixrQkFBa0IsRUFBRTtRQUNoQixJQUFJLEVBQUUsQ0FBQztRQUNQLEtBQUssRUFBRSxDQUFDO0tBQ1g7SUFDRCxHQUFHLEVBQUU7UUFDRCxRQUFRLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDLEVBQUUsUUFBUSxFQUFFLEdBQUcsRUFBRSxDQUFDLFlBQVksRUFBRSxDQUFDLENBQUM7UUFDM0QsS0FBSyxFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQyxFQUFFLFFBQVEsRUFBRSxHQUFHLEVBQUUsQ0FBQyxZQUFZLEVBQUUsQ0FBQyxDQUFDO0tBQzNEO0lBQ0QsU0FBUyxFQUFFO1FBQ1AsZ0JBQWdCLEVBQUUsQ0FBQyxFQUFFLEdBQUcsRUFBRSxFQUFFLE1BQU0sRUFBRSxpQkFBaUIsRUFBRSxFQUFFLENBQUM7UUFDMUQsZ0JBQWdCLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDO1lBQzdCLEdBQUcsRUFBRSxJQUFJLENBQUMsRUFBRSxDQUFDLEdBQUcsRUFBRSxDQUFDLElBQUksQ0FBQztTQUMzQixDQUFDLENBQUM7S0FDTjtJQUNELE1BQU0sRUFBRTtRQUNKLG1CQUFtQixFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQztZQUNoQyxJQUFJLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtZQUNmLElBQUksRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1lBQ2YsT0FBTyxFQUFF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RSxPQUFPLEVBQUUsVUFBVSxFQUFFLENBQUMsQ0FBQztZQUU3RCxTQUFTO1lBQ1QsTUFBTSxDQUFDLGlCQUFpQixDQUFDLFNBQVMsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLFVBQVUsRUFBRSxTQUFTLENBQUMsQ0FBQztRQUNwRixDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyx3QkFBd0IsRUFBRSxHQUFHLEVBQUU7WUFDOUIsTUFBTTtZQUNOLFFBQVEsQ0FBQyxPQUFPLEVBQUUsQ0FBQztZQUVuQiw0QkFBNEI7WUFDNUIsTUFBTSxDQUFDLEdBQUcsRUFBRSxDQUFDLFFBQVEsQ0FBQyxPQUFPLEVBQUUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxPQUFPLEVBQUUsQ0FBQztRQUNuRCxDQUFDLENBQUMsQ0FBQztJQUNQLENBQUMsQ0FBQyxDQUFDO0FBQ1AsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL2dyZWdkdW5uL3NyYy90ZXN0L2FpX2RlYnVnX2NvbnRleHQvdnNjb2RlL3NyYy9fX3Rlc3RzX18vc3RyZWFtaW5nLmludGVncmF0aW9uLnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgV2Vidmlld1Byb3ZpZGVyIH0gZnJvbSAnLi4vd2Vidmlldy9wcm92aWRlcic7XG5pbXBvcnQgeyBQcm9qZWN0RGV0ZWN0b3IgfSBmcm9tICcuLi91dGlscy9wcm9qZWN0RGV0ZWN0b3InO1xuaW1wb3J0IHsgQ29tbWFuZFJ1bm5lciB9IGZyb20gJy4uL3V0aWxzL3NoZWxsUnVubmVyJztcbmltcG9ydCB7IEZpbGVNYW5hZ2VyIH0gZnJvbSAnLi4vdXRpbHMvZmlsZU1hbmFnZXInO1xuaW1wb3J0IHsgU3RhdHVzVHJhY2tlciB9IGZyb20gJy4uL3V0aWxzL3N0YXR1c1RyYWNrZXInO1xuaW1wb3J0IHsgV2Vidmlld01lc3NhZ2UgfSBmcm9tICcuLi90eXBlcyc7XG5pbXBvcnQgKiBhcyB2c2NvZGUgZnJvbSAndnNjb2RlJztcblxuLy8gTW9jayBWU0NvZGUgY29tcGxldGVseSBmb3IgaW50ZWdyYXRpb24gdGVzdHNcbmplc3QubW9jaygndnNjb2RlJywgKCkgPT4gKHtcbiAgICBTdGF0dXNCYXJBbGlnbm1lbnQ6IHtcbiAgICAgICAgTGVmdDogMSxcbiAgICAgICAgUmlnaHQ6IDJcbiAgICB9LFxuICAgIFVyaToge1xuICAgICAgICBqb2luUGF0aDogamVzdC5mbigoKSA9PiAoeyB0b1N0cmluZzogKCkgPT4gJ21vY2s6Ly91cmknIH0pKSxcbiAgICAgICAgcGFyc2U6IGplc3QuZm4oKCkgPT4gKHsgdG9TdHJpbmc6ICgpID0+ICdtb2NrOi8vdXJpJyB9KSlcbiAgICB9LFxuICAgIHdvcmtzcGFjZToge1xuICAgICAgICB3b3Jrc3BhY2VGb2xkZXJzOiBbeyB1cmk6IHsgZnNQYXRoOiAnL3Rlc3Qvd29ya3NwYWNlJyB9IH1dLFxuICAgICAgICBnZXRDb25maWd1cmF0aW9uOiBqZXN0LmZuKCgpID0+ICh7XG4gICAgICAgICAgICBnZXQ6IGplc3QuZm4oKCkgPT4gdHJ1ZSlcbiAgICAgICAgfSkpXG4gICAgfSxcbiAgICB3aW5kb3c6IHtcbiAgICAgICAgY3JlYXRlU3RhdHVzQmFySXRlbTogamVzdC5mbigoKSA9PiAoe1xuICAgICAgICAgICAgc2hvdzogamVzdC5mbigpLFxuICAgICAgICAgICAgaGlkZTogamVzdC5mbigpLFxuICAgICAgICAgICAgZGlzcG9zZTogamVzdC5mbigpLFxuICAgICAgICAgICAgdGV4dDogJycsXG4gICAgICAgICAgICB0b29sdGlwOiAnJyxcbiAgICAgICAgICAgIGNvbW1hbmQ6ICcnXG4gICAgICAgIH0pKSxcbiAgICAgICAgc2hvd0luZm9ybWF0aW9uTWVzc2FnZTogamVzdC5mbigpLFxuICAgICAgICBzaG93RXJyb3JNZXNzYWdlOiBqZXN0LmZuKCksXG4gICAgICAgIGNyZWF0ZU91dHB1dENoYW5uZWw6IGplc3QuZm4oKCkgPT4gKHtcbiAgICAgICAgICAgIGFwcGVuZDogamVzdC5mbigpLFxuICAgICAgICAgICAgYXBwZW5kTGluZTogamVzdC5mbigpLFxuICAgICAgICAgICAgc2hvdzogamVzdC5mbigpLFxuICAgICAgICAgICAgaGlkZTogamVzdC5mbigpLFxuICAgICAgICAgICAgZGlzcG9zZTogamVzdC5mbigpXG4gICAgICAgIH0pKVxuICAgIH1cbn0pKTtcblxuZGVzY3JpYmUoJ0ludGVncmF0aW9uIFRlc3RzJywgKCkgPT4ge1xuICAgIGxldCBwcm92aWRlcjogV2Vidmlld1Byb3ZpZGVyO1xuICAgIGxldCBtb2NrUHJvamVjdERldGVjdG9yOiBqZXN0Lk1vY2tlZDxQcm9qZWN0RGV0ZWN0b3I+O1xuICAgIGxldCBtb2NrQ29tbWFuZFJ1bm5lcjogamVzdC5Nb2NrZWQ8Q29tbWFuZFJ1bm5lcj47XG4gICAgbGV0IG1vY2tGaWxlTWFuYWdlcjogamVzdC5Nb2NrZWQ8RmlsZU1hbmFnZXI+O1xuICAgIGxldCBtb2NrV2Vidmlld1ZpZXc6IGplc3QuTW9ja2VkPHZzY29kZS5XZWJ2aWV3Vmlldz47XG4gICAgbGV0IG1vY2tXZWJ2aWV3OiBqZXN0Lk1vY2tlZDx2c2NvZGUuV2Vidmlldz47XG4gICAgbGV0IHJlY2VpdmVkTWVzc2FnZXM6IGFueVtdID0gW107XG5cbiAgICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICAgICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG4gICAgICAgIHJlY2VpdmVkTWVzc2FnZXMgPSBbXTtcblxuICAgICAgICAvLyBTZXR1cCBtb2NrZWQgZGVwZW5kZW5jaWVzXG4gICAgICAgIG1vY2tQcm9qZWN0RGV0ZWN0b3IgPSB7XG4gICAgICAgICAgICBnZXRQcm9qZWN0czogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKFtcbiAgICAgICAgICAgICAgICB7IG5hbWU6ICd0ZXN0LWFwcCcsIHJvb3Q6ICdhcHBzL3Rlc3QtYXBwJywgcHJvamVjdFR5cGU6ICdhcHBsaWNhdGlvbicgfVxuICAgICAgICAgICAgXSksXG4gICAgICAgICAgICBnZXRDdXJyZW50UHJvamVjdDogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHsgbmFtZTogJ3Rlc3QtYXBwJywgcm9vdDogJ2FwcHMvdGVzdC1hcHAnLCBwcm9qZWN0VHlwZTogJ2FwcGxpY2F0aW9uJyB9KVxuICAgICAgICB9IGFzIGFueTtcblxuICAgICAgICBtb2NrQ29tbWFuZFJ1bm5lciA9IHtcbiAgICAgICAgICAgIHJ1bkFpRGVidWc6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7IHN1Y2Nlc3M6IHRydWUsIGV4aXRDb2RlOiAwLCBvdXRwdXQ6ICdBSSBkZWJ1ZyBjb21wbGV0ZScsIGR1cmF0aW9uOiAyMDAwIH0pLFxuICAgICAgICAgICAgcnVuTnhUZXN0OiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoeyBzdWNjZXNzOiB0cnVlLCBleGl0Q29kZTogMCwgb3V0cHV0OiAnVGVzdHMgcGFzc2VkJywgZHVyYXRpb246IDUwMDAgfSksXG4gICAgICAgICAgICBydW5HaXREaWZmOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoeyBzdWNjZXNzOiB0cnVlLCBleGl0Q29kZTogMCwgb3V0cHV0OiAnRGlmZiBjb21wbGV0ZScsIGR1cmF0aW9uOiAxMDAwIH0pLFxuICAgICAgICAgICAgcnVuUHJlcGFyZVRvUHVzaDogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHsgc3VjY2VzczogdHJ1ZSwgZXhpdENvZGU6IDAsIG91dHB1dDogJ1ByZXBhcmVkIHRvIHB1c2gnLCBkdXJhdGlvbjogMzAwMCB9KVxuICAgICAgICB9IGFzIGFueTtcblxuICAgICAgICBtb2NrRmlsZU1hbmFnZXIgPSB7XG4gICAgICAgICAgICB3YXRjaEZpbGVzOiBqZXN0LmZuKCksXG4gICAgICAgICAgICBnZXRGaWxlQ29udGVudDogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKCd0ZXN0IGZpbGUgY29udGVudCcpLFxuICAgICAgICAgICAgb3BlbkZpbGU6IGplc3QuZm4oKVxuICAgICAgICB9IGFzIGFueTtcblxuICAgICAgICAvLyBTZXR1cCB3ZWJ2aWV3IG1vY2tzIHRoYXQgY2FwdHVyZSBtZXNzYWdlc1xuICAgICAgICBtb2NrV2VidmlldyA9IHtcbiAgICAgICAgICAgIGFzV2Vidmlld1VyaTogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSgnbW9jazovL3dlYnZpZXctdXJpJyksXG4gICAgICAgICAgICBwb3N0TWVzc2FnZTogamVzdC5mbigobWVzc2FnZSkgPT4ge1xuICAgICAgICAgICAgICAgIHJlY2VpdmVkTWVzc2FnZXMucHVzaChtZXNzYWdlKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRydWUpO1xuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBvbkRpZFJlY2VpdmVNZXNzYWdlOiBqZXN0LmZuKCksXG4gICAgICAgICAgICBodG1sOiAnJyxcbiAgICAgICAgICAgIG9wdGlvbnM6IHt9XG4gICAgICAgIH0gYXMgYW55O1xuXG4gICAgICAgIG1vY2tXZWJ2aWV3VmlldyA9IHtcbiAgICAgICAgICAgIHdlYnZpZXc6IG1vY2tXZWJ2aWV3LFxuICAgICAgICAgICAgc2hvdzogamVzdC5mbigpXG4gICAgICAgIH0gYXMgYW55O1xuXG4gICAgICAgIC8vIENyZWF0ZSBwcm92aWRlclxuICAgICAgICBjb25zdCBtb2NrU3RhdHVzVHJhY2tlciA9IG5ldyBTdGF0dXNUcmFja2VyKCk7XG4gICAgICAgIHByb3ZpZGVyID0gbmV3IFdlYnZpZXdQcm92aWRlcihcbiAgICAgICAgICAgIHZzY29kZS5VcmkucGFyc2UoJ3Rlc3Q6Ly9leHRlbnNpb24nKSxcbiAgICAgICAgICAgIG1vY2tQcm9qZWN0RGV0ZWN0b3IsXG4gICAgICAgICAgICBtb2NrQ29tbWFuZFJ1bm5lcixcbiAgICAgICAgICAgIG1vY2tGaWxlTWFuYWdlcixcbiAgICAgICAgICAgIG1vY2tTdGF0dXNUcmFja2VyXG4gICAgICAgICk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnd2VidmlldyBpbnRlZ3JhdGlvbicsICgpID0+IHtcbiAgICAgICAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgICAgICAgICBwcm92aWRlci5yZXNvbHZlV2Vidmlld1ZpZXcobW9ja1dlYnZpZXdWaWV3LCB7fSBhcyBhbnksIHt9IGFzIGFueSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KCdzaG91bGQgaGFuZGxlIHJ1bkNvbW1hbmQgbWVzc2FnZSBmb3IgbnhUZXN0JywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgLy8gQXJyYW5nZVxuICAgICAgICAgICAgY29uc3QgbWVzc2FnZTogV2Vidmlld01lc3NhZ2UgPSB7XG4gICAgICAgICAgICAgICAgY29tbWFuZDogJ3J1bkNvbW1hbmQnLFxuICAgICAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiAnbnhUZXN0JyxcbiAgICAgICAgICAgICAgICAgICAgcHJvamVjdDogJ3Rlc3QtYXBwJyxcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uczoge31cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBjb25zdCBtZXNzYWdlSGFuZGxlciA9IG1vY2tXZWJ2aWV3Lm9uRGlkUmVjZWl2ZU1lc3NhZ2UubW9jay5jYWxsc1swXVswXTtcblxuICAgICAgICAgICAgLy8gQWN0XG4gICAgICAgICAgICBhd2FpdCBtZXNzYWdlSGFuZGxlcihtZXNzYWdlKTtcblxuICAgICAgICAgICAgLy8gQXNzZXJ0XG4gICAgICAgICAgICBleHBlY3QobW9ja0NvbW1hbmRSdW5uZXIucnVuTnhUZXN0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgndGVzdC1hcHAnLCB7fSk7XG4gICAgICAgICAgICBleHBlY3QocmVjZWl2ZWRNZXNzYWdlcy5zb21lKG1zZyA9PiBtc2cudHlwZSA9PT0gJ2NvbW1hbmRSZXN1bHQnKSkudG9CZSh0cnVlKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3QgcmVzdWx0TWVzc2FnZSA9IHJlY2VpdmVkTWVzc2FnZXMuZmluZChtc2cgPT4gbXNnLnR5cGUgPT09ICdjb21tYW5kUmVzdWx0Jyk7XG4gICAgICAgICAgICBleHBlY3QocmVzdWx0TWVzc2FnZS5kYXRhLmFjdGlvbikudG9CZSgnbnhUZXN0Jyk7XG4gICAgICAgICAgICBleHBlY3QocmVzdWx0TWVzc2FnZS5kYXRhLnJlc3VsdC5zdWNjZXNzKS50b0JlKHRydWUpO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSBydW5Db21tYW5kIG1lc3NhZ2UgZm9yIGdpdERpZmYnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAvLyBBcnJhbmdlXG4gICAgICAgICAgICBjb25zdCBtZXNzYWdlOiBXZWJ2aWV3TWVzc2FnZSA9IHtcbiAgICAgICAgICAgICAgICBjb21tYW5kOiAncnVuQ29tbWFuZCcsXG4gICAgICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb246ICdnaXREaWZmJyxcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uczoge31cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBjb25zdCBtZXNzYWdlSGFuZGxlciA9IG1vY2tXZWJ2aWV3Lm9uRGlkUmVjZWl2ZU1lc3NhZ2UubW9jay5jYWxsc1swXVswXTtcblxuICAgICAgICAgICAgLy8gQWN0XG4gICAgICAgICAgICBhd2FpdCBtZXNzYWdlSGFuZGxlcihtZXNzYWdlKTtcblxuICAgICAgICAgICAgLy8gQXNzZXJ0XG4gICAgICAgICAgICBleHBlY3QobW9ja0NvbW1hbmRSdW5uZXIucnVuR2l0RGlmZikudG9IYXZlQmVlbkNhbGxlZFdpdGgoe30pO1xuICAgICAgICAgICAgZXhwZWN0KHJlY2VpdmVkTWVzc2FnZXMuc29tZShtc2cgPT4gbXNnLnR5cGUgPT09ICdjb21tYW5kUmVzdWx0JykpLnRvQmUodHJ1ZSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KCdzaG91bGQgaGFuZGxlIHJ1bkNvbW1hbmQgbWVzc2FnZSBmb3IgYWlEZWJ1ZycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIC8vIEFycmFuZ2VcbiAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2U6IFdlYnZpZXdNZXNzYWdlID0ge1xuICAgICAgICAgICAgICAgIGNvbW1hbmQ6ICdydW5Db21tYW5kJyxcbiAgICAgICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbjogJ2FpRGVidWcnLFxuICAgICAgICAgICAgICAgICAgICBwcm9qZWN0OiAndGVzdC1hcHAnLFxuICAgICAgICAgICAgICAgICAgICBvcHRpb25zOiB7fVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2VIYW5kbGVyID0gbW9ja1dlYnZpZXcub25EaWRSZWNlaXZlTWVzc2FnZS5tb2NrLmNhbGxzWzBdWzBdO1xuXG4gICAgICAgICAgICAvLyBBY3RcbiAgICAgICAgICAgIGF3YWl0IG1lc3NhZ2VIYW5kbGVyKG1lc3NhZ2UpO1xuXG4gICAgICAgICAgICAvLyBBc3NlcnRcbiAgICAgICAgICAgIGV4cGVjdChtb2NrQ29tbWFuZFJ1bm5lci5ydW5BaURlYnVnKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgndGVzdC1hcHAnLCB7fSk7XG4gICAgICAgICAgICBleHBlY3QocmVjZWl2ZWRNZXNzYWdlcy5zb21lKG1zZyA9PiBtc2cudHlwZSA9PT0gJ2NvbW1hbmRSZXN1bHQnKSkudG9CZSh0cnVlKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgZ2V0UHJvamVjdHMgbWVzc2FnZScsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIC8vIEFycmFuZ2VcbiAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2U6IFdlYnZpZXdNZXNzYWdlID0ge1xuICAgICAgICAgICAgICAgIGNvbW1hbmQ6ICdnZXRQcm9qZWN0cycsXG4gICAgICAgICAgICAgICAgZGF0YToge31cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2VIYW5kbGVyID0gbW9ja1dlYnZpZXcub25EaWRSZWNlaXZlTWVzc2FnZS5tb2NrLmNhbGxzWzBdWzBdO1xuXG4gICAgICAgICAgICAvLyBBY3RcbiAgICAgICAgICAgIGF3YWl0IG1lc3NhZ2VIYW5kbGVyKG1lc3NhZ2UpO1xuXG4gICAgICAgICAgICAvLyBBc3NlcnRcbiAgICAgICAgICAgIGV4cGVjdChtb2NrUHJvamVjdERldGVjdG9yLmdldFByb2plY3RzKS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgICAgICAgICBleHBlY3QocmVjZWl2ZWRNZXNzYWdlcy5zb21lKG1zZyA9PiBtc2cudHlwZSA9PT0gJ3Byb2plY3RzJykpLnRvQmUodHJ1ZSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNvbnN0IHByb2plY3RzTWVzc2FnZSA9IHJlY2VpdmVkTWVzc2FnZXMuZmluZChtc2cgPT4gbXNnLnR5cGUgPT09ICdwcm9qZWN0cycpO1xuICAgICAgICAgICAgZXhwZWN0KHByb2plY3RzTWVzc2FnZS5kYXRhLnByb2plY3RzKS50b0hhdmVMZW5ndGgoMSk7XG4gICAgICAgICAgICBleHBlY3QocHJvamVjdHNNZXNzYWdlLmRhdGEucHJvamVjdHNbMF0ubmFtZSkudG9CZSgndGVzdC1hcHAnKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgb3BlbkZpbGUgbWVzc2FnZScsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIC8vIEFycmFuZ2VcbiAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2U6IFdlYnZpZXdNZXNzYWdlID0ge1xuICAgICAgICAgICAgICAgIGNvbW1hbmQ6ICdvcGVuRmlsZScsXG4gICAgICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgICAgICBmaWxlUGF0aDogJy90ZXN0L2ZpbGUudHMnXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgY29uc3QgbWVzc2FnZUhhbmRsZXIgPSBtb2NrV2Vidmlldy5vbkRpZFJlY2VpdmVNZXNzYWdlLm1vY2suY2FsbHNbMF1bMF07XG5cbiAgICAgICAgICAgIC8vIEFjdFxuICAgICAgICAgICAgYXdhaXQgbWVzc2FnZUhhbmRsZXIobWVzc2FnZSk7XG5cbiAgICAgICAgICAgIC8vIEFzc2VydFxuICAgICAgICAgICAgZXhwZWN0KG1vY2tGaWxlTWFuYWdlci5vcGVuRmlsZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJy90ZXN0L2ZpbGUudHMnKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgY2xlYXJPdXRwdXQgbWVzc2FnZScsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIC8vIEFycmFuZ2VcbiAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2U6IFdlYnZpZXdNZXNzYWdlID0ge1xuICAgICAgICAgICAgICAgIGNvbW1hbmQ6ICdjbGVhck91dHB1dCcsXG4gICAgICAgICAgICAgICAgZGF0YToge31cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2VIYW5kbGVyID0gbW9ja1dlYnZpZXcub25EaWRSZWNlaXZlTWVzc2FnZS5tb2NrLmNhbGxzWzBdWzBdO1xuXG4gICAgICAgICAgICAvLyBBY3RcbiAgICAgICAgICAgIGF3YWl0IG1lc3NhZ2VIYW5kbGVyKG1lc3NhZ2UpO1xuXG4gICAgICAgICAgICAvLyBBc3NlcnRcbiAgICAgICAgICAgIGV4cGVjdChyZWNlaXZlZE1lc3NhZ2VzLnNvbWUobXNnID0+IG1zZy50eXBlID09PSAnb3V0cHV0Q2xlYXJlZCcpKS50b0JlKHRydWUpO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSB1bmtub3duIG1lc3NhZ2UgY29tbWFuZCcsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIC8vIEFycmFuZ2VcbiAgICAgICAgICAgIGNvbnN0IGNvbnNvbGVTcHkgPSBqZXN0LnNweU9uKGNvbnNvbGUsICd3YXJuJykubW9ja0ltcGxlbWVudGF0aW9uKCk7XG4gICAgICAgICAgICBjb25zdCBtZXNzYWdlOiBXZWJ2aWV3TWVzc2FnZSA9IHtcbiAgICAgICAgICAgICAgICBjb21tYW5kOiAndW5rbm93bkNvbW1hbmQnIGFzIGFueSxcbiAgICAgICAgICAgICAgICBkYXRhOiB7fVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgY29uc3QgbWVzc2FnZUhhbmRsZXIgPSBtb2NrV2Vidmlldy5vbkRpZFJlY2VpdmVNZXNzYWdlLm1vY2suY2FsbHNbMF1bMF07XG5cbiAgICAgICAgICAgIC8vIEFjdFxuICAgICAgICAgICAgYXdhaXQgbWVzc2FnZUhhbmRsZXIobWVzc2FnZSk7XG5cbiAgICAgICAgICAgIC8vIEFzc2VydFxuICAgICAgICAgICAgZXhwZWN0KGNvbnNvbGVTcHkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdVbmtub3duIG1lc3NhZ2UgY29tbWFuZDonLCAndW5rbm93bkNvbW1hbmQnKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc29sZVNweS5tb2NrUmVzdG9yZSgpO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSBjb21tYW5kIGVycm9ycyBncmFjZWZ1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgLy8gQXJyYW5nZVxuICAgICAgICAgICAgbW9ja0NvbW1hbmRSdW5uZXIucnVuTnhUZXN0Lm1vY2tSZWplY3RlZFZhbHVlKG5ldyBFcnJvcignQ29tbWFuZCBmYWlsZWQnKSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2U6IFdlYnZpZXdNZXNzYWdlID0ge1xuICAgICAgICAgICAgICAgIGNvbW1hbmQ6ICdydW5Db21tYW5kJyxcbiAgICAgICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbjogJ254VGVzdCcsXG4gICAgICAgICAgICAgICAgICAgIHByb2plY3Q6ICd0ZXN0LWFwcCdcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBjb25zdCBtZXNzYWdlSGFuZGxlciA9IG1vY2tXZWJ2aWV3Lm9uRGlkUmVjZWl2ZU1lc3NhZ2UubW9jay5jYWxsc1swXVswXTtcblxuICAgICAgICAgICAgLy8gQWN0XG4gICAgICAgICAgICBhd2FpdCBtZXNzYWdlSGFuZGxlcihtZXNzYWdlKTtcblxuICAgICAgICAgICAgLy8gQXNzZXJ0XG4gICAgICAgICAgICBleHBlY3QocmVjZWl2ZWRNZXNzYWdlcy5zb21lKG1zZyA9PiBtc2cudHlwZSA9PT0gJ2NvbW1hbmRFcnJvcicpKS50b0JlKHRydWUpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSByZWNlaXZlZE1lc3NhZ2VzLmZpbmQobXNnID0+IG1zZy50eXBlID09PSAnY29tbWFuZEVycm9yJyk7XG4gICAgICAgICAgICBleHBlY3QoZXJyb3JNZXNzYWdlLmRhdGEuYWN0aW9uKS50b0JlKCdueFRlc3QnKTtcbiAgICAgICAgICAgIGV4cGVjdChlcnJvck1lc3NhZ2UuZGF0YS5lcnJvcikudG9CZSgnQ29tbWFuZCBmYWlsZWQnKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgcHJvamVjdCBkZXRlY3Rpb24gZXJyb3JzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgLy8gQXJyYW5nZVxuICAgICAgICAgICAgbW9ja1Byb2plY3REZXRlY3Rvci5nZXRQcm9qZWN0cy5tb2NrUmVqZWN0ZWRWYWx1ZShuZXcgRXJyb3IoJ1Byb2plY3QgZGV0ZWN0aW9uIGZhaWxlZCcpKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3QgbWVzc2FnZTogV2Vidmlld01lc3NhZ2UgPSB7XG4gICAgICAgICAgICAgICAgY29tbWFuZDogJ2dldFByb2plY3RzJyxcbiAgICAgICAgICAgICAgICBkYXRhOiB7fVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgY29uc3QgbWVzc2FnZUhhbmRsZXIgPSBtb2NrV2Vidmlldy5vbkRpZFJlY2VpdmVNZXNzYWdlLm1vY2suY2FsbHNbMF1bMF07XG5cbiAgICAgICAgICAgIC8vIEFjdFxuICAgICAgICAgICAgYXdhaXQgbWVzc2FnZUhhbmRsZXIobWVzc2FnZSk7XG5cbiAgICAgICAgICAgIC8vIEFzc2VydFxuICAgICAgICAgICAgZXhwZWN0KHJlY2VpdmVkTWVzc2FnZXMuc29tZShtc2cgPT4gbXNnLnR5cGUgPT09ICdlcnJvcicpKS50b0JlKHRydWUpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSByZWNlaXZlZE1lc3NhZ2VzLmZpbmQobXNnID0+IG1zZy50eXBlID09PSAnZXJyb3InKTtcbiAgICAgICAgICAgIGV4cGVjdChlcnJvck1lc3NhZ2UuZGF0YS5lcnJvcikudG9CZSgnUHJvamVjdCBkZXRlY3Rpb24gZmFpbGVkJyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KCdzaG91bGQgaGFuZGxlIGZpbGUgb3BlcmF0aW9uIGVycm9ycycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIC8vIEFycmFuZ2VcbiAgICAgICAgICAgIG1vY2tGaWxlTWFuYWdlci5vcGVuRmlsZS5tb2NrUmVqZWN0ZWRWYWx1ZShuZXcgRXJyb3IoJ0ZpbGUgbm90IGZvdW5kJykpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjb25zdCBtZXNzYWdlOiBXZWJ2aWV3TWVzc2FnZSA9IHtcbiAgICAgICAgICAgICAgICBjb21tYW5kOiAnb3BlbkZpbGUnLFxuICAgICAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgICAgICAgZmlsZVBhdGg6ICcvbm9uL2V4aXN0ZW50L2ZpbGUudHMnXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgY29uc3QgbWVzc2FnZUhhbmRsZXIgPSBtb2NrV2Vidmlldy5vbkRpZFJlY2VpdmVNZXNzYWdlLm1vY2suY2FsbHNbMF1bMF07XG5cbiAgICAgICAgICAgIC8vIEFjdFxuICAgICAgICAgICAgYXdhaXQgbWVzc2FnZUhhbmRsZXIobWVzc2FnZSk7XG5cbiAgICAgICAgICAgIC8vIEFzc2VydFxuICAgICAgICAgICAgZXhwZWN0KHJlY2VpdmVkTWVzc2FnZXMuc29tZShtc2cgPT4gbXNnLnR5cGUgPT09ICdlcnJvcicpKS50b0JlKHRydWUpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSByZWNlaXZlZE1lc3NhZ2VzLmZpbmQobXNnID0+IG1zZy50eXBlID09PSAnZXJyb3InKTtcbiAgICAgICAgICAgIGV4cGVjdChlcnJvck1lc3NhZ2UuZGF0YS5lcnJvcikudG9CZSgnRmlsZSBub3QgZm91bmQnKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgaW52YWxpZCBhY3Rpb24gaW4gcnVuQ29tbWFuZCcsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIC8vIEFycmFuZ2VcbiAgICAgICAgICAgIHZzY29kZS53aW5kb3cuc2hvd0Vycm9yTWVzc2FnZSA9IGplc3QuZm4oKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3QgbWVzc2FnZTogV2Vidmlld01lc3NhZ2UgPSB7XG4gICAgICAgICAgICAgICAgY29tbWFuZDogJ3J1bkNvbW1hbmQnLFxuICAgICAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiAnaW52YWxpZEFjdGlvbicgYXMgYW55LFxuICAgICAgICAgICAgICAgICAgICBwcm9qZWN0OiAndGVzdC1hcHAnXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgY29uc3QgbWVzc2FnZUhhbmRsZXIgPSBtb2NrV2Vidmlldy5vbkRpZFJlY2VpdmVNZXNzYWdlLm1vY2suY2FsbHNbMF1bMF07XG5cbiAgICAgICAgICAgIC8vIEFjdFxuICAgICAgICAgICAgYXdhaXQgbWVzc2FnZUhhbmRsZXIobWVzc2FnZSk7XG5cbiAgICAgICAgICAgIC8vIEFzc2VydFxuICAgICAgICAgICAgZXhwZWN0KHJlY2VpdmVkTWVzc2FnZXMuc29tZShtc2cgPT4gbXNnLnR5cGUgPT09ICdjb21tYW5kRXJyb3InKSkudG9CZSh0cnVlKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0gcmVjZWl2ZWRNZXNzYWdlcy5maW5kKG1zZyA9PiBtc2cudHlwZSA9PT0gJ2NvbW1hbmRFcnJvcicpO1xuICAgICAgICAgICAgZXhwZWN0KGVycm9yTWVzc2FnZS5kYXRhLmVycm9yKS50b0NvbnRhaW4oJ1Vua25vd24gYWN0aW9uOiBpbnZhbGlkQWN0aW9uJyk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ3dlYnZpZXcgc2V0dXAnLCAoKSA9PiB7XG4gICAgICAgIGl0KCdzaG91bGQgc2V0IHVwIHdlYnZpZXcgY29ycmVjdGx5JywgKCkgPT4ge1xuICAgICAgICAgICAgLy8gQWN0XG4gICAgICAgICAgICBwcm92aWRlci5yZXNvbHZlV2Vidmlld1ZpZXcobW9ja1dlYnZpZXdWaWV3LCB7fSBhcyBhbnksIHt9IGFzIGFueSk7XG5cbiAgICAgICAgICAgIC8vIEFzc2VydFxuICAgICAgICAgICAgZXhwZWN0KG1vY2tXZWJ2aWV3Vmlldy53ZWJ2aWV3Lm9wdGlvbnMuZW5hYmxlU2NyaXB0cykudG9CZSh0cnVlKTtcbiAgICAgICAgICAgIGV4cGVjdChtb2NrV2Vidmlld1ZpZXcud2Vidmlldy5vcHRpb25zLmxvY2FsUmVzb3VyY2VSb290cykudG9IYXZlTGVuZ3RoKDEpO1xuICAgICAgICAgICAgZXhwZWN0KG1vY2tXZWJ2aWV3Vmlldy53ZWJ2aWV3Lm9wdGlvbnMubG9jYWxSZXNvdXJjZVJvb3RzPy5bMF0/LnRvU3RyaW5nKCkpLnRvQmUoJ21vY2s6Ly91cmknKTtcbiAgICAgICAgICAgIGV4cGVjdChtb2NrV2Vidmlld1ZpZXcud2Vidmlldy5odG1sKS50b0NvbnRhaW4oJzwhRE9DVFlQRSBodG1sPicpO1xuICAgICAgICAgICAgZXhwZWN0KG1vY2tXZWJ2aWV3Vmlldy53ZWJ2aWV3Lm9uRGlkUmVjZWl2ZU1lc3NhZ2UpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgICAgICAgIGV4cGVjdChtb2NrRmlsZU1hbmFnZXIud2F0Y2hGaWxlcykudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdCgnc2hvdWxkIHNldCB1cCBmaWxlIHdhdGNoZXInLCAoKSA9PiB7XG4gICAgICAgICAgICAvLyBBcnJhbmdlXG4gICAgICAgICAgICBwcm92aWRlci5yZXNvbHZlV2Vidmlld1ZpZXcobW9ja1dlYnZpZXdWaWV3LCB7fSBhcyBhbnksIHt9IGFzIGFueSk7XG5cbiAgICAgICAgICAgIC8vIEdldCB0aGUgZmlsZSB3YXRjaGVyIGNhbGxiYWNrXG4gICAgICAgICAgICBjb25zdCB3YXRjaEZpbGVzQ2FsbGJhY2sgPSBtb2NrRmlsZU1hbmFnZXIud2F0Y2hGaWxlcy5tb2NrLmNhbGxzWzBdWzBdO1xuXG4gICAgICAgICAgICAvLyBBY3RcbiAgICAgICAgICAgIHdhdGNoRmlsZXNDYWxsYmFjaygnL3Rlc3QvZmlsZS50cycsICdtb2RpZmllZCcpO1xuXG4gICAgICAgICAgICAvLyBBc3NlcnRcbiAgICAgICAgICAgIGV4cGVjdChyZWNlaXZlZE1lc3NhZ2VzLnNvbWUobXNnID0+IG1zZy50eXBlID09PSAnZmlsZUNoYW5nZWQnKSkudG9CZSh0cnVlKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3QgZmlsZUNoYW5nZWRNZXNzYWdlID0gcmVjZWl2ZWRNZXNzYWdlcy5maW5kKG1zZyA9PiBtc2cudHlwZSA9PT0gJ2ZpbGVDaGFuZ2VkJyk7XG4gICAgICAgICAgICBleHBlY3QoZmlsZUNoYW5nZWRNZXNzYWdlLmRhdGEuZmlsZVBhdGgpLnRvQmUoJy90ZXN0L2ZpbGUudHMnKTtcbiAgICAgICAgICAgIGV4cGVjdChmaWxlQ2hhbmdlZE1lc3NhZ2UuZGF0YS5ldmVudFR5cGUpLnRvQmUoJ21vZGlmaWVkJyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KCdzaG91bGQgZ2VuZXJhdGUgY29ycmVjdCBIVE1MIGZvciB3ZWJ2aWV3JywgKCkgPT4ge1xuICAgICAgICAgICAgLy8gQWN0XG4gICAgICAgICAgICBwcm92aWRlci5yZXNvbHZlV2Vidmlld1ZpZXcobW9ja1dlYnZpZXdWaWV3LCB7fSBhcyBhbnksIHt9IGFzIGFueSk7XG5cbiAgICAgICAgICAgIC8vIEFzc2VydFxuICAgICAgICAgICAgY29uc3QgaHRtbCA9IG1vY2tXZWJ2aWV3Vmlldy53ZWJ2aWV3Lmh0bWw7XG4gICAgICAgICAgICBleHBlY3QoaHRtbCkudG9Db250YWluKCc8IURPQ1RZUEUgaHRtbD4nKTtcbiAgICAgICAgICAgIGV4cGVjdChodG1sKS50b0NvbnRhaW4oJzx0aXRsZT5BSSBEZWJ1ZyBVdGlsaXRpZXM8L3RpdGxlPicpO1xuICAgICAgICAgICAgZXhwZWN0KGh0bWwpLnRvQ29udGFpbignPGRpdiBpZD1cInJvb3RcIj48L2Rpdj4nKTtcbiAgICAgICAgICAgIGV4cGVjdChodG1sKS50b0NvbnRhaW4oJ21vY2s6Ly93ZWJ2aWV3LXVyaScpO1xuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCdwdWJsaWMgbWV0aG9kcycsICgpID0+IHtcbiAgICAgICAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgICAgICAgICBwcm92aWRlci5yZXNvbHZlV2Vidmlld1ZpZXcobW9ja1dlYnZpZXdWaWV3LCB7fSBhcyBhbnksIHt9IGFzIGFueSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KCdzaG91bGQgc2hvdyB3ZWJ2aWV3IHdoZW4gc2hvdygpIGlzIGNhbGxlZCcsICgpID0+IHtcbiAgICAgICAgICAgIC8vIEFjdFxuICAgICAgICAgICAgcHJvdmlkZXIuc2hvdygpO1xuXG4gICAgICAgICAgICAvLyBBc3NlcnRcbiAgICAgICAgICAgIGV4cGVjdChtb2NrV2Vidmlld1ZpZXcuc2hvdykudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdCgnc2hvdWxkIHJ1biBjb21tYW5kIHdoZW4gcnVuQ29tbWFuZCgpIGlzIGNhbGxlZCcsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIC8vIEFjdFxuICAgICAgICAgICAgYXdhaXQgcHJvdmlkZXIucnVuQ29tbWFuZCgnbnhUZXN0JywgeyBwcm9qZWN0OiAndGVzdC1hcHAnIH0pO1xuXG4gICAgICAgICAgICAvLyBBc3NlcnRcbiAgICAgICAgICAgIGV4cGVjdChtb2NrQ29tbWFuZFJ1bm5lci5ydW5OeFRlc3QpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCd0ZXN0LWFwcCcsIHVuZGVmaW5lZCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KCdzaG91bGQgZGlzcG9zZSBjbGVhbmx5JywgKCkgPT4ge1xuICAgICAgICAgICAgLy8gQWN0XG4gICAgICAgICAgICBwcm92aWRlci5kaXNwb3NlKCk7XG5cbiAgICAgICAgICAgIC8vIEFzc2VydCAtIHNob3VsZCBub3QgdGhyb3dcbiAgICAgICAgICAgIGV4cGVjdCgoKSA9PiBwcm92aWRlci5kaXNwb3NlKCkpLm5vdC50b1Rocm93KCk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xufSk7XG4iXSwidmVyc2lvbiI6M30=