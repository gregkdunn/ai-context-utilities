cb644169f26b72ce311103852de39cca
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.NaturalLanguageQueryEngine = void 0;
/**
 * Enhanced Natural Language Query Interface for Phase 4.2
 * Provides sophisticated natural language processing for debugging queries
 */
class NaturalLanguageQueryEngine {
    context;
    queryHistory = [];
    entityExtractor;
    intentClassifier;
    responseGenerator;
    maxHistorySize = 500;
    constructor(context) {
        this.context = context;
        this.entityExtractor = new EntityExtractor();
        this.intentClassifier = new IntentClassifier();
        this.responseGenerator = new ResponseGenerator();
        this.loadQueryHistory();
    }
    /**
     * Process natural language query with enhanced understanding
     */
    async processQuery(query, context) {
        try {
            console.log(`Processing natural language query: "${query}"`);
            // Preprocess query
            const preprocessedQuery = this.preprocessQuery(query);
            // Extract entities and intent in parallel
            const [entities, intent] = await Promise.all([
                this.entityExtractor.extractEntities(preprocessedQuery),
                this.intentClassifier.classifyIntent(preprocessedQuery)
            ]);
            // Calculate confidence based on entity and intent quality
            const confidence = this.calculateQueryConfidence(intent, entities, preprocessedQuery);
            // Generate response based on intent and entities
            const response = await this.responseGenerator.generateResponse(intent, entities, preprocessedQuery, context);
            // Generate contextual action suggestions
            const suggestedActions = await this.generateActionSuggestions(intent, entities, context);
            // Fetch relevant data if available
            const data = await this.fetchQueryData(intent, entities, context);
            // Create and store query result
            const result = {
                intent,
                entities,
                confidence,
                response,
                suggestedActions,
                data
            };
            // Record query for learning
            this.recordQuery(query, result);
            console.log(`Query processed with ${confidence.toFixed(2)} confidence`);
            return result;
        }
        catch (error) {
            console.error('Error processing natural language query:', error);
            return this.createErrorResponse(query);
        }
    }
    /**
     * Get query suggestions based on current context
     */
    async getQuerySuggestions(context) {
        const suggestions = [];
        try {
            // Base suggestions
            suggestions.push("Show me failing tests from this week", "What's causing the performance issues?", "Find errors in the checkout module", "How can I improve test coverage?", "Show recent build failures");
            // Context-aware suggestions
            if (context) {
                const contextSuggestions = await this.generateContextualSuggestions(context);
                suggestions.push(...contextSuggestions);
            }
            // Historical suggestions based on common queries
            const popularSuggestions = this.getPopularQuerySuggestions();
            suggestions.push(...popularSuggestions);
            return suggestions.slice(0, 8); // Return top 8 suggestions
        }
        catch (error) {
            console.error('Error generating query suggestions:', error);
            return suggestions.slice(0, 5);
        }
    }
    /**
     * Analyze query patterns to improve understanding
     */
    async analyzeQueryPatterns() {
        const patterns = [];
        try {
            // Group queries by intent
            const intentGroups = this.groupQueriesByIntent();
            for (const [intent, queries] of intentGroups.entries()) {
                const pattern = this.extractQueryPattern(intent, queries);
                if (pattern.confidence > 0.6) {
                    patterns.push(pattern);
                }
            }
            // Update classifiers based on patterns
            await this.updateClassifiersFromPatterns(patterns);
            console.log(`Analyzed ${this.queryHistory.length} queries, found ${patterns.length} patterns`);
            return patterns;
        }
        catch (error) {
            console.error('Error analyzing query patterns:', error);
            return [];
        }
    }
    // Private implementation methods
    preprocessQuery(query) {
        return query
            .toLowerCase()
            .trim()
            .replace(/[^\w\s\?\!]/g, ' ')
            .replace(/\s+/g, ' ');
    }
    calculateQueryConfidence(intent, entities, query) {
        let confidence = 0.5; // Base confidence
        // Intent confidence
        if (intent !== 'unknown' && intent !== 'unclear') {
            confidence += 0.3;
        }
        // Entity confidence
        const entityCount = Object.keys(entities).length;
        if (entityCount > 0) {
            confidence += Math.min(entityCount * 0.1, 0.2);
        }
        // Query length and structure
        const words = query.split(' ').length;
        if (words >= 3 && words <= 15) {
            confidence += 0.1;
        }
        // Question structure
        if (query.includes('?') || query.startsWith('what') ||
            query.startsWith('how') || query.startsWith('show')) {
            confidence += 0.1;
        }
        return Math.min(confidence, 0.95);
    }
    async generateActionSuggestions(intent, entities, context) {
        const suggestions = [];
        switch (intent) {
            case 'test-query':
                suggestions.push({
                    id: this.generateSuggestionId(),
                    title: 'Run Test Analysis',
                    description: 'Execute comprehensive test analysis',
                    action: {
                        type: 'command',
                        data: { command: 'nxTest', options: { focus: 'tests' } }
                    },
                    estimatedImpact: 'high',
                    estimatedEffort: 'minutes'
                });
                break;
            case 'performance-query':
                suggestions.push({
                    id: this.generateSuggestionId(),
                    title: 'Performance Analysis',
                    description: 'Run detailed performance analysis',
                    action: {
                        type: 'command',
                        data: { command: 'aiDebug', options: { focus: 'performance' } }
                    },
                    estimatedImpact: 'high',
                    estimatedEffort: 'minutes'
                });
                break;
            case 'error-query':
                suggestions.push({
                    id: this.generateSuggestionId(),
                    title: 'Error Investigation',
                    description: 'Investigate and analyze error patterns',
                    action: {
                        type: 'command',
                        data: { command: 'aiDebug', options: { focus: 'errors' } }
                    },
                    estimatedImpact: 'high',
                    estimatedEffort: 'minutes'
                });
                break;
            case 'git-query':
                suggestions.push({
                    id: this.generateSuggestionId(),
                    title: 'Git Analysis',
                    description: 'Analyze git history and changes',
                    action: {
                        type: 'command',
                        data: { command: 'gitDiff' }
                    },
                    estimatedImpact: 'medium',
                    estimatedEffort: 'minutes'
                });
                break;
            case 'build-query':
                suggestions.push({
                    id: this.generateSuggestionId(),
                    title: 'Build Analysis',
                    description: 'Analyze build process and issues',
                    action: {
                        type: 'command',
                        data: { command: 'prepareToPush' }
                    },
                    estimatedImpact: 'high',
                    estimatedEffort: 'minutes'
                });
                break;
        }
        // Add context-specific suggestions
        if (context) {
            const contextSuggestions = await this.generateContextualActionSuggestions(intent, entities, context);
            suggestions.push(...contextSuggestions);
        }
        return suggestions;
    }
    async generateContextualActionSuggestions(intent, entities, context) {
        const suggestions = [];
        // If asking about tests and there are failing tests
        if (intent === 'test-query' && context.testResults.some(t => t.status === 'failed')) {
            suggestions.push({
                id: this.generateSuggestionId(),
                title: 'Focus on Failing Tests',
                description: 'Run only the currently failing tests',
                action: {
                    type: 'command',
                    data: { command: 'nxTest', options: { focus: 'failing' } }
                },
                estimatedImpact: 'high',
                estimatedEffort: 'minutes'
            });
        }
        // If asking about errors and there are recurring patterns
        if (intent === 'error-query' && context.errorPatterns.some(e => e.frequency > 3)) {
            suggestions.push({
                id: this.generateSuggestionId(),
                title: 'Address Recurring Errors',
                description: 'Focus on the most frequent error patterns',
                action: {
                    type: 'command',
                    data: { command: 'aiDebug', options: { focus: 'recurring-errors' } }
                },
                estimatedImpact: 'high',
                estimatedEffort: 'minutes'
            });
        }
        return suggestions;
    }
    async fetchQueryData(intent, entities, context) {
        if (!context) {
            return null;
        }
        const data = {};
        switch (intent) {
            case 'test-query':
                data.testResults = context.testResults;
                data.testSummary = this.summarizeTestResults(context.testResults);
                break;
            case 'error-query':
                data.errorPatterns = context.errorPatterns;
                data.errorSummary = this.summarizeErrorPatterns(context.errorPatterns);
                break;
            case 'performance-query':
                data.performanceMetrics = context.performanceMetrics;
                data.performanceSummary = this.summarizePerformanceMetrics(context.performanceMetrics);
                break;
            case 'git-query':
                data.gitHistory = context.gitHistory;
                data.gitSummary = this.summarizeGitHistory(context.gitHistory);
                break;
        }
        return data;
    }
    async generateContextualSuggestions(context) {
        const suggestions = [];
        // Test-related suggestions
        const failingTests = context.testResults.filter(t => t.status === 'failed');
        if (failingTests.length > 0) {
            suggestions.push(`Show me the ${failingTests.length} failing tests`);
            suggestions.push("Why are tests failing?");
        }
        // Error-related suggestions
        const frequentErrors = context.errorPatterns.filter(e => e.frequency > 3);
        if (frequentErrors.length > 0) {
            suggestions.push("What are the most common errors?");
            suggestions.push("How to fix recurring errors?");
        }
        // Performance suggestions
        if (context.performanceMetrics.length > 0) {
            suggestions.push("Show performance trends");
            suggestions.push("What's slowing down the build?");
        }
        // Git suggestions
        if (context.gitHistory.length > 0) {
            suggestions.push("Show recent commits");
            suggestions.push("What files changed recently?");
        }
        return suggestions;
    }
    getPopularQuerySuggestions() {
        const queryFrequency = new Map();
        // Count query patterns
        for (const entry of this.queryHistory) {
            const normalizedQuery = this.normalizeQueryForPattern(entry.query);
            queryFrequency.set(normalizedQuery, (queryFrequency.get(normalizedQuery) || 0) + 1);
        }
        // Return most popular patterns
        return Array.from(queryFrequency.entries())
            .sort((a, b) => b[1] - a[1])
            .slice(0, 3)
            .map(([query]) => query);
    }
    normalizeQueryForPattern(query) {
        return query
            .toLowerCase()
            .replace(/\b(show|find|get|what|how|why)\b/g, 'show')
            .replace(/\b(test|tests|testing)\b/g, 'tests')
            .replace(/\b(error|errors|bug|bugs)\b/g, 'errors')
            .replace(/\b(performance|speed|slow)\b/g, 'performance');
    }
    groupQueriesByIntent() {
        const groups = new Map();
        for (const query of this.queryHistory) {
            const intent = query.result.intent;
            if (!groups.has(intent)) {
                groups.set(intent, []);
            }
            groups.get(intent).push(query);
        }
        return groups;
    }
    extractQueryPattern(intent, queries) {
        const commonWords = this.findCommonWords(queries.map(q => q.query));
        const avgConfidence = queries.reduce((sum, q) => sum + q.result.confidence, 0) / queries.length;
        return {
            intent,
            commonWords,
            frequency: queries.length,
            avgConfidence,
            confidence: avgConfidence > 0.7 ? 0.8 : 0.6,
            examples: queries.slice(0, 3).map(q => q.query)
        };
    }
    findCommonWords(queries) {
        const wordFreq = new Map();
        for (const query of queries) {
            const words = query.toLowerCase().split(/\s+/);
            for (const word of words) {
                if (word.length > 2) { // Ignore short words
                    wordFreq.set(word, (wordFreq.get(word) || 0) + 1);
                }
            }
        }
        const threshold = Math.max(2, Math.floor(queries.length * 0.3));
        return Array.from(wordFreq.entries())
            .filter(([, freq]) => freq >= threshold)
            .sort((a, b) => b[1] - a[1])
            .slice(0, 5)
            .map(([word]) => word);
    }
    async updateClassifiersFromPatterns(patterns) {
        // Update intent classifier with new patterns
        for (const pattern of patterns) {
            this.intentClassifier.addPattern(pattern);
        }
        // Update entity extractor with new examples
        this.entityExtractor.updateFromPatterns(patterns);
        console.log(`Updated classifiers with ${patterns.length} patterns`);
    }
    // Summary methods for different data types
    summarizeTestResults(results) {
        const total = results.length;
        const passed = results.filter(r => r.status === 'passed').length;
        const failed = results.filter(r => r.status === 'failed').length;
        const skipped = results.filter(r => r.status === 'skipped').length;
        return {
            total,
            passed,
            failed,
            skipped,
            passRate: passed / total,
            failureRate: failed / total
        };
    }
    summarizeErrorPatterns(patterns) {
        const total = patterns.length;
        const totalFrequency = patterns.reduce((sum, p) => sum + p.frequency, 0);
        const mostFrequent = patterns.sort((a, b) => b.frequency - a.frequency)[0];
        return {
            total,
            totalFrequency,
            mostFrequent: mostFrequent?.pattern,
            avgFrequency: totalFrequency / total
        };
    }
    summarizePerformanceMetrics(metrics) {
        return {
            total: metrics.length,
            types: [...new Set(metrics.map(m => m.metric))],
            timeRange: metrics.length > 0 ? {
                start: Math.min(...metrics.map(m => m.timestamp.getTime())),
                end: Math.max(...metrics.map(m => m.timestamp.getTime()))
            } : null
        };
    }
    summarizeGitHistory(history) {
        return {
            totalCommits: history.length,
            authors: [...new Set(history.map(c => c.author))],
            timeRange: history.length > 0 ? {
                start: Math.min(...history.map(c => c.date.getTime())),
                end: Math.max(...history.map(c => c.date.getTime()))
            } : null
        };
    }
    createErrorResponse(query) {
        return {
            intent: 'error',
            entities: {},
            confidence: 0,
            response: `I apologize, but I couldn't understand your query: "${query}". Please try rephrasing your question or use one of the suggested queries.`,
            suggestedActions: [{
                    id: this.generateSuggestionId(),
                    title: 'Try Example Query',
                    description: 'Use one of the example queries to get started',
                    action: {
                        type: 'external',
                        data: { action: 'show-examples' }
                    },
                    estimatedImpact: 'low',
                    estimatedEffort: 'minutes'
                }]
        };
    }
    recordQuery(query, result) {
        const entry = {
            query,
            result,
            timestamp: new Date()
        };
        this.queryHistory.push(entry);
        // Limit history size
        if (this.queryHistory.length > this.maxHistorySize) {
            this.queryHistory = this.queryHistory.slice(-this.maxHistorySize);
        }
    }
    loadQueryHistory() {
        try {
            const historyData = this.context.globalState.get('query-history');
            if (historyData) {
                const history = JSON.parse(historyData);
                this.queryHistory = history.map((entry) => ({
                    ...entry,
                    timestamp: new Date(entry.timestamp)
                }));
                console.log(`Loaded ${this.queryHistory.length} query history entries`);
            }
        }
        catch (error) {
            console.error('Error loading query history:', error);
        }
    }
    generateSuggestionId() {
        return `suggestion_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
    }
    async saveQueryHistory() {
        try {
            await this.context.globalState.update('query-history', JSON.stringify(this.queryHistory));
            console.log(`Saved ${this.queryHistory.length} query history entries`);
        }
        catch (error) {
            console.error('Error saving query history:', error);
        }
    }
    dispose() {
        this.saveQueryHistory();
        this.queryHistory = [];
        this.entityExtractor.dispose();
        this.intentClassifier.dispose();
        this.responseGenerator.dispose();
    }
}
exports.NaturalLanguageQueryEngine = NaturalLanguageQueryEngine;
// Supporting classes for NLP functionality
class EntityExtractor {
    entityPatterns = new Map();
    constructor() {
        this.initializePatterns();
    }
    initializePatterns() {
        // Time entities
        this.entityPatterns.set('timeRange', [
            /(?:last|past)\s+(\d+)\s+(day|week|month|year)s?/i,
            /(today|yesterday|this\s+week|last\s+week)/i
        ]);
        // Project entities
        this.entityPatterns.set('project', [
            /project[s]?\s+(\w+)/i,
            /in\s+(\w+)\s+project/i
        ]);
        // File entities
        this.entityPatterns.set('files', [
            /file[s]?\s+(\S+\.\w+)/i,
            /(\w+\/\w+\.\w+)/i
        ]);
        // Test entities
        this.entityPatterns.set('tests', [
            /(failing|failed|broken)\s+tests?/i,
            /test[s]?\s+(\w+)/i
        ]);
        // Error entities
        this.entityPatterns.set('errors', [
            /error[s]?\s+in\s+(\w+)/i,
            /(error|bug|issue)[s]?\s+(\w+)/i
        ]);
    }
    async extractEntities(query) {
        const entities = {};
        for (const [entityType, patterns] of this.entityPatterns.entries()) {
            for (const pattern of patterns) {
                const match = query.match(pattern);
                if (match) {
                    entities[entityType] = match[1] || match[0];
                    break;
                }
            }
        }
        return entities;
    }
    updateFromPatterns(patterns) {
        // Update entity patterns based on successful query patterns
        for (const pattern of patterns) {
            // Simplified pattern learning
            if (pattern.commonWords.length > 0) {
                const newPatterns = pattern.commonWords.map(word => new RegExp(`\\b${word}\\b`, 'i'));
                if (this.entityPatterns.has(pattern.intent)) {
                    this.entityPatterns.get(pattern.intent).push(...newPatterns);
                }
                else {
                    this.entityPatterns.set(pattern.intent, newPatterns);
                }
            }
        }
    }
    dispose() {
        this.entityPatterns.clear();
    }
}
class IntentClassifier {
    intentPatterns = new Map();
    constructor() {
        this.initializeIntentPatterns();
    }
    initializeIntentPatterns() {
        this.intentPatterns.set('test-query', [
            /\b(test|tests|testing|spec|specs)\b/i,
            /\b(failing|failed|broken|pass|passed)\b.*\b(test|tests)\b/i,
            /\brun\s+tests?\b/i
        ]);
        this.intentPatterns.set('error-query', [
            /\b(error|errors|bug|bugs|issue|issues)\b/i,
            /\b(fix|debug|solve|resolve)\b/i,
            /\b(exception|crash|fail)\b/i
        ]);
        this.intentPatterns.set('performance-query', [
            /\b(performance|speed|slow|fast|optimize)\b/i,
            /\b(time|duration|latency|bottleneck)\b/i,
            /\bhow\s+(fast|slow|long)\b/i
        ]);
        this.intentPatterns.set('git-query', [
            /\b(git|commit|commits|branch|merge)\b/i,
            /\b(changed|changes|diff|history)\b/i,
            /\bwhat.*changed\b/i
        ]);
        this.intentPatterns.set('build-query', [
            /\b(build|builds|compile|compilation)\b/i,
            /\b(deploy|deployment|ci|cd)\b/i,
            /\bpush|pull\b/i
        ]);
        this.intentPatterns.set('coverage-query', [
            /\b(coverage|covered|uncovered)\b/i,
            /\bhow\s+much.*covered\b/i
        ]);
    }
    async classifyIntent(query) {
        for (const [intent, patterns] of this.intentPatterns.entries()) {
            for (const pattern of patterns) {
                if (pattern.test(query)) {
                    return intent;
                }
            }
        }
        // Fallback classification based on question words
        if (/^(what|how|why|when|where)\b/i.test(query)) {
            return 'general-query';
        }
        if (/^(show|find|get|list)\b/i.test(query)) {
            return 'data-query';
        }
        return 'unknown';
    }
    addPattern(pattern) {
        if (!this.intentPatterns.has(pattern.intent)) {
            this.intentPatterns.set(pattern.intent, []);
        }
        // Add new patterns based on common words
        const newPatterns = pattern.commonWords.map(word => new RegExp(`\\b${word}\\b`, 'i'));
        this.intentPatterns.get(pattern.intent).push(...newPatterns);
    }
    dispose() {
        this.intentPatterns.clear();
    }
}
class ResponseGenerator {
    responseTemplates = new Map();
    constructor() {
        this.initializeTemplates();
    }
    initializeTemplates() {
        this.responseTemplates.set('test-query', [
            "I can help you analyze your test results and identify patterns in test failures.",
            "Let me examine your test data to provide insights about test performance and failures.",
            "I'll analyze your test patterns to help improve test reliability and coverage."
        ]);
        this.responseTemplates.set('error-query', [
            "I can help identify and analyze error patterns in your codebase.",
            "Let me examine the error data to find recurring issues and suggest fixes.",
            "I'll analyze the error patterns to help you resolve the most impactful issues first."
        ]);
        this.responseTemplates.set('performance-query', [
            "I can analyze performance metrics and identify optimization opportunities.",
            "Let me examine your performance data to find bottlenecks and suggest improvements.",
            "I'll analyze performance trends to help you optimize your development workflow."
        ]);
        this.responseTemplates.set('git-query', [
            "I can analyze your git history and provide insights about code changes.",
            "Let me examine your commit patterns and file changes for insights.",
            "I'll analyze your git data to help you understand development patterns."
        ]);
        this.responseTemplates.set('build-query', [
            "I can help analyze your build process and identify improvement opportunities.",
            "Let me examine your build patterns to suggest optimizations.",
            "I'll analyze your build data to help streamline your deployment process."
        ]);
    }
    async generateResponse(intent, entities, query, context) {
        const templates = this.responseTemplates.get(intent) || [
            "I can help you analyze your debugging patterns and suggest improvements."
        ];
        let baseResponse = templates[Math.floor(Math.random() * templates.length)];
        // Customize response based on entities and context
        if (context) {
            baseResponse += this.addContextualDetails(intent, entities, context);
        }
        return baseResponse;
    }
    addContextualDetails(intent, entities, context) {
        let details = "";
        switch (intent) {
            case 'test-query':
                const failedTests = context.testResults.filter(t => t.status === 'failed').length;
                if (failedTests > 0) {
                    details += ` I found ${failedTests} failing tests that need attention.`;
                }
                break;
            case 'error-query':
                const errorCount = context.errorPatterns.length;
                if (errorCount > 0) {
                    details += ` I identified ${errorCount} error patterns in your codebase.`;
                }
                break;
            case 'performance-query':
                const metricCount = context.performanceMetrics.length;
                if (metricCount > 0) {
                    details += ` I have ${metricCount} performance metrics to analyze.`;
                }
                break;
        }
        return details;
    }
    dispose() {
        this.responseTemplates.clear();
    }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2dyZWdkdW5uL3NyYy90ZXN0L2FpX2RlYnVnX2NvbnRleHQvdnNjb2RlL3NyYy9zZXJ2aWNlcy9haS1pbnNpZ2h0cy9lbmdpbmVzL25hdHVyYWxMYW5ndWFnZVF1ZXJ5RW5naW5lLnRzIiwibWFwcGluZ3MiOiI7OztBQVVBOzs7R0FHRztBQUNILE1BQWEsMEJBQTBCO0lBT2Y7SUFOWixZQUFZLEdBQW1CLEVBQUUsQ0FBQztJQUNsQyxlQUFlLENBQWtCO0lBQ2pDLGdCQUFnQixDQUFtQjtJQUNuQyxpQkFBaUIsQ0FBb0I7SUFDNUIsY0FBYyxHQUFHLEdBQUcsQ0FBQztJQUV0QyxZQUFvQixPQUFnQztRQUFoQyxZQUFPLEdBQVAsT0FBTyxDQUF5QjtRQUNoRCxJQUFJLENBQUMsZUFBZSxHQUFHLElBQUksZUFBZSxFQUFFLENBQUM7UUFDN0MsSUFBSSxDQUFDLGdCQUFnQixHQUFHLElBQUksZ0JBQWdCLEVBQUUsQ0FBQztRQUMvQyxJQUFJLENBQUMsaUJBQWlCLEdBQUcsSUFBSSxpQkFBaUIsRUFBRSxDQUFDO1FBQ2pELElBQUksQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO0lBQzVCLENBQUM7SUFFRDs7T0FFRztJQUNILEtBQUssQ0FBQyxZQUFZLENBQUMsS0FBYSxFQUFFLE9BQXNCO1FBQ3BELElBQUksQ0FBQztZQUNELE9BQU8sQ0FBQyxHQUFHLENBQUMsdUNBQXVDLEtBQUssR0FBRyxDQUFDLENBQUM7WUFFN0QsbUJBQW1CO1lBQ25CLE1BQU0saUJBQWlCLEdBQUcsSUFBSSxDQUFDLGVBQWUsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUV0RCwwQ0FBMEM7WUFDMUMsTUFBTSxDQUFDLFFBQVEsRUFBRSxNQUFNLENBQUMsR0FBRyxNQUFNLE9BQU8sQ0FBQyxHQUFHLENBQUM7Z0JBQ3pDLElBQUksQ0FBQyxlQUFlLENBQUMsZUFBZSxDQUFDLGlCQUFpQixDQUFDO2dCQUN2RCxJQUFJLENBQUMsZ0JBQWdCLENBQUMsY0FBYyxDQUFDLGlCQUFpQixDQUFDO2FBQzFELENBQUMsQ0FBQztZ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VyxHQUFHLE9BQU8sQ0FBQyxrQkFBa0IsQ0FBQyxNQUFNLENBQUM7Z0JBQ3RELElBQUksV0FBVyxHQUFHLENBQUMsRUFBRSxDQUFDO29CQUNsQixPQUFPLElBQUksV0FBVyxXQUFXLGtDQUFrQyxDQUFDO2dCQUN4RSxDQUFDO2dCQUNELE1BQU07UUFDZCxDQUFDO1FBRUQsT0FBTyxPQUFPLENBQUM7SUFDbkIsQ0FBQztJQUVELE9BQU87UUFDSCxJQUFJLENBQUMsaUJBQWlCLENBQUMsS0FBSyxFQUFFLENBQUM7SUFDbkMsQ0FBQztDQUNKIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9ncmVnZHVubi9zcmMvdGVzdC9haV9kZWJ1Z19jb250ZXh0L3ZzY29kZS9zcmMvc2VydmljZXMvYWktaW5zaWdodHMvZW5naW5lcy9uYXR1cmFsTGFuZ3VhZ2VRdWVyeUVuZ2luZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyB2c2NvZGUgZnJvbSAndnNjb2RlJztcbmltcG9ydCB7IFxuICAgIFF1ZXJ5UmVzdWx0LCBcbiAgICBBY3Rpb25TdWdnZXN0aW9uLFxuICAgIENvbW1hbmRFeGVjdXRpb24sXG4gICAgVGVzdFJlc3VsdCxcbiAgICBFcnJvclBhdHRlcm4sXG4gICAgQW5hbHlzaXNEYXRhXG59IGZyb20gJy4uLy4uLy4uL3R5cGVzJztcblxuLyoqXG4gKiBFbmhhbmNlZCBOYXR1cmFsIExhbmd1YWdlIFF1ZXJ5IEludGVyZmFjZSBmb3IgUGhhc2UgNC4yXG4gKiBQcm92aWRlcyBzb3BoaXN0aWNhdGVkIG5hdHVyYWwgbGFuZ3VhZ2UgcHJvY2Vzc2luZyBmb3IgZGVidWdnaW5nIHF1ZXJpZXNcbiAqL1xuZXhwb3J0IGNsYXNzIE5hdHVyYWxMYW5ndWFnZVF1ZXJ5RW5naW5lIHtcbiAgICBwcml2YXRlIHF1ZXJ5SGlzdG9yeTogUXVlcnlIaXN0b3J5W10gPSBbXTtcbiAgICBwcml2YXRlIGVudGl0eUV4dHJhY3RvcjogRW50aXR5RXh0cmFjdG9yO1xuICAgIHByaXZhdGUgaW50ZW50Q2xhc3NpZmllcjogSW50ZW50Q2xhc3NpZmllcjtcbiAgICBwcml2YXRlIHJlc3BvbnNlR2VuZXJhdG9yOiBSZXNwb25zZUdlbmVyYXRvcjtcbiAgICBwcml2YXRlIHJlYWRvbmx5IG1heEhpc3RvcnlTaXplID0gNTAwO1xuXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBjb250ZXh0OiB2c2NvZGUuRXh0ZW5zaW9uQ29udGV4dCkge1xuICAgICAgICB0aGlzLmVudGl0eUV4dHJhY3RvciA9IG5ldyBFbnRpdHlFeHRyYWN0b3IoKTtcbiAgICAgICAgdGhpcy5pbnRlbnRDbGFzc2lmaWVyID0gbmV3IEludGVudENsYXNzaWZpZXIoKTtcbiAgICAgICAgdGhpcy5yZXNwb25zZUdlbmVyYXRvciA9IG5ldyBSZXNwb25zZUdlbmVyYXRvcigpO1xuICAgICAgICB0aGlzLmxvYWRRdWVyeUhpc3RvcnkoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQcm9jZXNzIG5hdHVyYWwgbGFuZ3VhZ2UgcXVlcnkgd2l0aCBlbmhhbmNlZCB1bmRlcnN0YW5kaW5nXG4gICAgICovXG4gICAgYXN5bmMgcHJvY2Vzc1F1ZXJ5KHF1ZXJ5OiBzdHJpbmcsIGNvbnRleHQ/OiBBbmFseXNpc0RhdGEpOiBQcm9taXNlPFF1ZXJ5UmVzdWx0PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgUHJvY2Vzc2luZyBuYXR1cmFsIGxhbmd1YWdlIHF1ZXJ5OiBcIiR7cXVlcnl9XCJgKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gUHJlcHJvY2VzcyBxdWVyeVxuICAgICAgICAgICAgY29uc3QgcHJlcHJvY2Vzc2VkUXVlcnkgPSB0aGlzLnByZXByb2Nlc3NRdWVyeShxdWVyeSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEV4dHJhY3QgZW50aXRpZXMgYW5kIGludGVudCBpbiBwYXJhbGxlbFxuICAgICAgICAgICAgY29uc3QgW2VudGl0aWVzLCBpbnRlbnRdID0gYXdhaXQgUHJvbWlzZS5hbGwoW1xuICAgICAgICAgICAgICAgIHRoaXMuZW50aXR5RXh0cmFjdG9yLmV4dHJhY3RFbnRpdGllcyhwcmVwcm9jZXNzZWRRdWVyeSksXG4gICAgICAgICAgICAgICAgdGhpcy5pbnRlbnRDbGFzc2lmaWVyLmNsYXNzaWZ5SW50ZW50KHByZXByb2Nlc3NlZFF1ZXJ5KVxuICAgICAgICAgICAgXSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIENhbGN1bGF0ZSBjb25maWRlbmNlIGJhc2VkIG9uIGVudGl0eSBhbmQgaW50ZW50IHF1YWxpdHlcbiAgICAgICAgICAgIGNvbnN0IGNvbmZpZGVuY2UgPSB0aGlzLmNhbGN1bGF0ZVF1ZXJ5Q29uZmlkZW5jZShpbnRlbnQsIGVudGl0aWVzLCBwcmVwcm9jZXNzZWRRdWVyeSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEdlbmVyYXRlIHJlc3BvbnNlIGJhc2VkIG9uIGludGVudCBhbmQgZW50aXRpZXNcbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5yZXNwb25zZUdlbmVyYXRvci5nZW5lcmF0ZVJlc3BvbnNlKFxuICAgICAgICAgICAgICAgIGludGVudCwgXG4gICAgICAgICAgICAgICAgZW50aXRpZXMsIFxuICAgICAgICAgICAgICAgIHByZXByb2Nlc3NlZFF1ZXJ5LCBcbiAgICAgICAgICAgICAgICBjb250ZXh0XG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBHZW5lcmF0ZSBjb250ZXh0dWFsIGFjdGlvbiBzdWdnZXN0aW9uc1xuICAgICAgICAgICAgY29uc3Qgc3VnZ2VzdGVkQWN0aW9ucyA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVBY3Rpb25TdWdnZXN0aW9ucyhcbiAgICAgICAgICAgICAgICBpbnRlbnQsIFxuICAgICAgICAgICAgICAgIGVudGl0aWVzLCBcbiAgICAgICAgICAgICAgICBjb250ZXh0XG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBGZXRjaCByZWxldmFudCBkYXRhIGlmIGF2YWlsYWJsZVxuICAgICAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHRoaXMuZmV0Y2hRdWVyeURhdGEoaW50ZW50LCBlbnRpdGllcywgY29udGV4dCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIENyZWF0ZSBhbmQgc3RvcmUgcXVlcnkgcmVzdWx0XG4gICAgICAgICAgICBjb25zdCByZXN1bHQ6IFF1ZXJ5UmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgIGludGVudCxcbiAgICAgICAgICAgICAgICBlbnRpdGllcyxcbiAgICAgICAgICAgICAgICBjb25maWRlbmNlLFxuICAgICAgICAgICAgICAgIHJlc3BvbnNlLFxuICAgICAgICAgICAgICAgIHN1Z2dlc3RlZEFjdGlvbnMsXG4gICAgICAgICAgICAgICAgZGF0YVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gUmVjb3JkIHF1ZXJ5IGZvciBsZWFybmluZ1xuICAgICAgICAgICAgdGhpcy5yZWNvcmRRdWVyeShxdWVyeSwgcmVzdWx0KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc29sZS5sb2coYFF1ZXJ5IHByb2Nlc3NlZCB3aXRoICR7Y29uZmlkZW5jZS50b0ZpeGVkKDIpfSBjb25maWRlbmNlYCk7XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBwcm9jZXNzaW5nIG5hdHVyYWwgbGFuZ3VhZ2UgcXVlcnk6JywgZXJyb3IpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY3JlYXRlRXJyb3JSZXNwb25zZShxdWVyeSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgcXVlcnkgc3VnZ2VzdGlvbnMgYmFzZWQgb24gY3VycmVudCBjb250ZXh0XG4gICAgICovXG4gICAgYXN5bmMgZ2V0UXVlcnlTdWdnZXN0aW9ucyhjb250ZXh0PzogQW5hbHlzaXNEYXRhKTogUHJvbWlzZTxzdHJpbmdbXT4ge1xuICAgICAgICBjb25zdCBzdWdnZXN0aW9uczogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBCYXNlIHN1Z2dlc3Rpb25zXG4gICAgICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKFxuICAgICAgICAgICAgICAgIFwiU2hvdyBtZSBmYWlsaW5nIHRlc3RzIGZyb20gdGhpcyB3ZWVrXCIsXG4gICAgICAgICAgICAgICAgXCJXaGF0J3MgY2F1c2luZyB0aGUgcGVyZm9ybWFuY2UgaXNzdWVzP1wiLFxuICAgICAgICAgICAgICAgIFwiRmluZCBlcnJvcnMgaW4gdGhlIGNoZWNrb3V0IG1vZHVsZVwiLFxuICAgICAgICAgICAgICAgIFwiSG93IGNhbiBJIGltcHJvdmUgdGVzdCBjb3ZlcmFnZT9cIixcbiAgICAgICAgICAgICAgICBcIlNob3cgcmVjZW50IGJ1aWxkIGZhaWx1cmVzXCJcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIENvbnRleHQtYXdhcmUgc3VnZ2VzdGlvbnNcbiAgICAgICAgICAgIGlmIChjb250ZXh0KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY29udGV4dFN1Z2dlc3Rpb25zID0gYXdhaXQgdGhpcy5nZW5lcmF0ZUNvbnRleHR1YWxTdWdnZXN0aW9ucyhjb250ZXh0KTtcbiAgICAgICAgICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKC4uLmNvbnRleHRTdWdnZXN0aW9ucyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEhpc3RvcmljYWwgc3VnZ2VzdGlvbnMgYmFzZWQgb24gY29tbW9uIHF1ZXJpZXNcbiAgICAgICAgICAgIGNvbnN0IHBvcHVsYXJTdWdnZXN0aW9ucyA9IHRoaXMuZ2V0UG9wdWxhclF1ZXJ5U3VnZ2VzdGlvbnMoKTtcbiAgICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goLi4ucG9wdWxhclN1Z2dlc3Rpb25zKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmV0dXJuIHN1Z2dlc3Rpb25zLnNsaWNlKDAsIDgpOyAvLyBSZXR1cm4gdG9wIDggc3VnZ2VzdGlvbnNcbiAgICAgICAgICAgIFxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZ2VuZXJhdGluZyBxdWVyeSBzdWdnZXN0aW9uczonLCBlcnJvcik7XG4gICAgICAgICAgICByZXR1cm4gc3VnZ2VzdGlvbnMuc2xpY2UoMCwgNSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBbmFseXplIHF1ZXJ5IHBhdHRlcm5zIHRvIGltcHJvdmUgdW5kZXJzdGFuZGluZ1xuICAgICAqL1xuICAgIGFzeW5jIGFuYWx5emVRdWVyeVBhdHRlcm5zKCk6IFByb21pc2U8UXVlcnlQYXR0ZXJuW10+IHtcbiAgICAgICAgY29uc3QgcGF0dGVybnM6IFF1ZXJ5UGF0dGVybltdID0gW107XG4gICAgICAgIFxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gR3JvdXAgcXVlcmllcyBieSBpbnRlbnRcbiAgICAgICAgICAgIGNvbnN0IGludGVudEdyb3VwcyA9IHRoaXMuZ3JvdXBRdWVyaWVzQnlJbnRlbnQoKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgZm9yIChjb25zdCBbaW50ZW50LCBxdWVyaWVzXSBvZiBpbnRlbnRHcm91cHMuZW50cmllcygpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcGF0dGVybiA9IHRoaXMuZXh0cmFjdFF1ZXJ5UGF0dGVybihpbnRlbnQsIHF1ZXJpZXMpO1xuICAgICAgICAgICAgICAgIGlmIChwYXR0ZXJuLmNvbmZpZGVuY2UgPiAwLjYpIHtcbiAgICAgICAgICAgICAgICAgICAgcGF0dGVybnMucHVzaChwYXR0ZXJuKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFVwZGF0ZSBjbGFzc2lmaWVycyBiYXNlZCBvbiBwYXR0ZXJuc1xuICAgICAgICAgICAgYXdhaXQgdGhpcy51cGRhdGVDbGFzc2lmaWVyc0Zyb21QYXR0ZXJucyhwYXR0ZXJucyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBBbmFseXplZCAke3RoaXMucXVlcnlIaXN0b3J5Lmxlbmd0aH0gcXVlcmllcywgZm91bmQgJHtwYXR0ZXJucy5sZW5ndGh9IHBhdHRlcm5zYCk7XG4gICAgICAgICAgICByZXR1cm4gcGF0dGVybnM7XG4gICAgICAgICAgICBcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGFuYWx5emluZyBxdWVyeSBwYXR0ZXJuczonLCBlcnJvcik7XG4gICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBQcml2YXRlIGltcGxlbWVudGF0aW9uIG1ldGhvZHNcblxuICAgIHByaXZhdGUgcHJlcHJvY2Vzc1F1ZXJ5KHF1ZXJ5OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gcXVlcnlcbiAgICAgICAgICAgIC50b0xvd2VyQ2FzZSgpXG4gICAgICAgICAgICAudHJpbSgpXG4gICAgICAgICAgICAucmVwbGFjZSgvW15cXHdcXHNcXD9cXCFdL2csICcgJylcbiAgICAgICAgICAgIC5yZXBsYWNlKC9cXHMrL2csICcgJyk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjYWxjdWxhdGVRdWVyeUNvbmZpZGVuY2UoXG4gICAgICAgIGludGVudDogc3RyaW5nLCBcbiAgICAgICAgZW50aXRpZXM6IFJlY29yZDxzdHJpbmcsIGFueT4sIFxuICAgICAgICBxdWVyeTogc3RyaW5nXG4gICAgKTogbnVtYmVyIHtcbiAgICAgICAgbGV0IGNvbmZpZGVuY2UgPSAwLjU7IC8vIEJhc2UgY29uZmlkZW5jZVxuICAgICAgICBcbiAgICAgICAgLy8gSW50ZW50IGNvbmZpZGVuY2VcbiAgICAgICAgaWYgKGludGVudCAhPT0gJ3Vua25vd24nICYmIGludGVudCAhPT0gJ3VuY2xlYXInKSB7XG4gICAgICAgICAgICBjb25maWRlbmNlICs9IDAuMztcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gRW50aXR5IGNvbmZpZGVuY2VcbiAgICAgICAgY29uc3QgZW50aXR5Q291bnQgPSBPYmplY3Qua2V5cyhlbnRpdGllcykubGVuZ3RoO1xuICAgICAgICBpZiAoZW50aXR5Q291bnQgPiAwKSB7XG4gICAgICAgICAgICBjb25maWRlbmNlICs9IE1hdGgubWluKGVudGl0eUNvdW50ICogMC4xLCAwLjIpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBRdWVyeSBsZW5ndGggYW5kIHN0cnVjdHVyZVxuICAgICAgICBjb25zdCB3b3JkcyA9IHF1ZXJ5LnNwbGl0KCcgJykubGVuZ3RoO1xuICAgICAgICBpZiAod29yZHMgPj0gMyAmJiB3b3JkcyA8PSAxNSkge1xuICAgICAgICAgICAgY29uZmlkZW5jZSArPSAwLjE7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIFF1ZXN0aW9uIHN0cnVjdHVyZVxuICAgICAgICBpZiAocXVlcnkuaW5jbHVkZXMoJz8nKSB8fCBxdWVyeS5zdGFydHNXaXRoKCd3aGF0JykgfHwgXG4gICAgICAgICAgICBxdWVyeS5zdGFydHNXaXRoKCdob3cnKSB8fCBxdWVyeS5zdGFydHNXaXRoKCdzaG93JykpIHtcbiAgICAgICAgICAgIGNvbmZpZGVuY2UgKz0gMC4xO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gTWF0aC5taW4oY29uZmlkZW5jZSwgMC45NSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhc3luYyBnZW5lcmF0ZUFjdGlvblN1Z2dlc3Rpb25zKFxuICAgICAgICBpbnRlbnQ6IHN0cmluZywgXG4gICAgICAgIGVudGl0aWVzOiBSZWNvcmQ8c3RyaW5nLCBhbnk+LCBcbiAgICAgICAgY29udGV4dD86IEFuYWx5c2lzRGF0YVxuICAgICk6IFByb21pc2U8QWN0aW9uU3VnZ2VzdGlvbltdPiB7XG4gICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25zOiBBY3Rpb25TdWdnZXN0aW9uW10gPSBbXTtcbiAgICAgICAgXG4gICAgICAgIHN3aXRjaCAoaW50ZW50KSB7XG4gICAgICAgICAgICBjYXNlICd0ZXN0LXF1ZXJ5JzpcbiAgICAgICAgICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6IHRoaXMuZ2VuZXJhdGVTdWdnZXN0aW9uSWQoKSxcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICdSdW4gVGVzdCBBbmFseXNpcycsXG4gICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiAnRXhlY3V0ZSBjb21wcmVoZW5zaXZlIHRlc3QgYW5hbHlzaXMnLFxuICAgICAgICAgICAgICAgICAgICBhY3Rpb246IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdjb21tYW5kJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY29tbWFuZDogJ254VGVzdCcsIG9wdGlvbnM6IHsgZm9jdXM6ICd0ZXN0cycgfSB9XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGVzdGltYXRlZEltcGFjdDogJ2hpZ2gnLFxuICAgICAgICAgICAgICAgICAgICBlc3RpbWF0ZWRFZmZvcnQ6ICdtaW51dGVzJ1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgY2FzZSAncGVyZm9ybWFuY2UtcXVlcnknOlxuICAgICAgICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICBpZDogdGhpcy5nZW5lcmF0ZVN1Z2dlc3Rpb25JZCgpLFxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ1BlcmZvcm1hbmNlIEFuYWx5c2lzJyxcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246ICdSdW4gZGV0YWlsZWQgcGVyZm9ybWFuY2UgYW5hbHlzaXMnLFxuICAgICAgICAgICAgICAgICAgICBhY3Rpb246IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdjb21tYW5kJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY29tbWFuZDogJ2FpRGVidWcnLCBvcHRpb25zOiB7IGZvY3VzOiAncGVyZm9ybWFuY2UnIH0gfVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBlc3RpbWF0ZWRJbXBhY3Q6ICdoaWdoJyxcbiAgICAgICAgICAgICAgICAgICAgZXN0aW1hdGVkRWZmb3J0OiAnbWludXRlcydcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIGNhc2UgJ2Vycm9yLXF1ZXJ5JzpcbiAgICAgICAgICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6IHRoaXMuZ2VuZXJhdGVTdWdnZXN0aW9uSWQoKSxcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICdFcnJvciBJbnZlc3RpZ2F0aW9uJyxcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246ICdJbnZlc3RpZ2F0ZSBhbmQgYW5hbHl6ZSBlcnJvciBwYXR0ZXJucycsXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2NvbW1hbmQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogeyBjb21tYW5kOiAnYWlEZWJ1ZycsIG9wdGlvbnM6IHsgZm9jdXM6ICdlcnJvcnMnIH0gfVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBlc3RpbWF0ZWRJbXBhY3Q6ICdoaWdoJyxcbiAgICAgICAgICAgICAgICAgICAgZXN0aW1hdGVkRWZmb3J0OiAnbWludXRlcydcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIGNhc2UgJ2dpdC1xdWVyeSc6XG4gICAgICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIGlkOiB0aGlzLmdlbmVyYXRlU3VnZ2VzdGlvbklkKCksXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiAnR2l0IEFuYWx5c2lzJyxcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246ICdBbmFseXplIGdpdCBoaXN0b3J5IGFuZCBjaGFuZ2VzJyxcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnY29tbWFuZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IGNvbW1hbmQ6ICdnaXREaWZmJyB9XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGVzdGltYXRlZEltcGFjdDogJ21lZGl1bScsXG4gICAgICAgICAgICAgICAgICAgIGVzdGltYXRlZEVmZm9ydDogJ21pbnV0ZXMnXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICBjYXNlICdidWlsZC1xdWVyeSc6XG4gICAgICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIGlkOiB0aGlzLmdlbmVyYXRlU3VnZ2VzdGlvbklkKCksXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiAnQnVpbGQgQW5hbHlzaXMnLFxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogJ0FuYWx5emUgYnVpbGQgcHJvY2VzcyBhbmQgaXNzdWVzJyxcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnY29tbWFuZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IGNvbW1hbmQ6ICdwcmVwYXJlVG9QdXNoJyB9XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGVzdGltYXRlZEltcGFjdDogJ2hpZ2gnLFxuICAgICAgICAgICAgICAgICAgICBlc3RpbWF0ZWRFZmZvcnQ6ICdtaW51dGVzJ1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgY29udGV4dC1zcGVjaWZpYyBzdWdnZXN0aW9uc1xuICAgICAgICBpZiAoY29udGV4dCkge1xuICAgICAgICAgICAgY29uc3QgY29udGV4dFN1Z2dlc3Rpb25zID0gYXdhaXQgdGhpcy5nZW5lcmF0ZUNvbnRleHR1YWxBY3Rpb25TdWdnZXN0aW9ucyhpbnRlbnQsIGVudGl0aWVzLCBjb250ZXh0KTtcbiAgICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goLi4uY29udGV4dFN1Z2dlc3Rpb25zKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHN1Z2dlc3Rpb25zO1xuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVDb250ZXh0dWFsQWN0aW9uU3VnZ2VzdGlvbnMoXG4gICAgICAgIGludGVudDogc3RyaW5nLCBcbiAgICAgICAgZW50aXRpZXM6IFJlY29yZDxzdHJpbmcsIGFueT4sIFxuICAgICAgICBjb250ZXh0OiBBbmFseXNpc0RhdGFcbiAgICApOiBQcm9taXNlPEFjdGlvblN1Z2dlc3Rpb25bXT4ge1xuICAgICAgICBjb25zdCBzdWdnZXN0aW9uczogQWN0aW9uU3VnZ2VzdGlvbltdID0gW107XG4gICAgICAgIFxuICAgICAgICAvLyBJZiBhc2tpbmcgYWJvdXQgdGVzdHMgYW5kIHRoZXJlIGFyZSBmYWlsaW5nIHRlc3RzXG4gICAgICAgIGlmIChpbnRlbnQgPT09ICd0ZXN0LXF1ZXJ5JyAmJiBjb250ZXh0LnRlc3RSZXN1bHRzLnNvbWUodCA9PiB0LnN0YXR1cyA9PT0gJ2ZhaWxlZCcpKSB7XG4gICAgICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKHtcbiAgICAgICAgICAgICAgICBpZDogdGhpcy5nZW5lcmF0ZVN1Z2dlc3Rpb25JZCgpLFxuICAgICAgICAgICAgICAgIHRpdGxlOiAnRm9jdXMgb24gRmFpbGluZyBUZXN0cycsXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246ICdSdW4gb25seSB0aGUgY3VycmVudGx5IGZhaWxpbmcgdGVzdHMnLFxuICAgICAgICAgICAgICAgIGFjdGlvbjoge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnY29tbWFuZCcsXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgY29tbWFuZDogJ254VGVzdCcsIG9wdGlvbnM6IHsgZm9jdXM6ICdmYWlsaW5nJyB9IH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGVzdGltYXRlZEltcGFjdDogJ2hpZ2gnLFxuICAgICAgICAgICAgICAgIGVzdGltYXRlZEVmZm9ydDogJ21pbnV0ZXMnXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gSWYgYXNraW5nIGFib3V0IGVycm9ycyBhbmQgdGhlcmUgYXJlIHJlY3VycmluZyBwYXR0ZXJuc1xuICAgICAgICBpZiAoaW50ZW50ID09PSAnZXJyb3ItcXVlcnknICYmIGNvbnRleHQuZXJyb3JQYXR0ZXJucy5zb21lKGUgPT4gZS5mcmVxdWVuY3kgPiAzKSkge1xuICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgaWQ6IHRoaXMuZ2VuZXJhdGVTdWdnZXN0aW9uSWQoKSxcbiAgICAgICAgICAgICAgICB0aXRsZTogJ0FkZHJlc3MgUmVjdXJyaW5nIEVycm9ycycsXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246ICdGb2N1cyBvbiB0aGUgbW9zdCBmcmVxdWVudCBlcnJvciBwYXR0ZXJucycsXG4gICAgICAgICAgICAgICAgYWN0aW9uOiB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdjb21tYW5kJyxcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogeyBjb21tYW5kOiAnYWlEZWJ1ZycsIG9wdGlvbnM6IHsgZm9jdXM6ICdyZWN1cnJpbmctZXJyb3JzJyB9IH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGVzdGltYXRlZEltcGFjdDogJ2hpZ2gnLFxuICAgICAgICAgICAgICAgIGVzdGltYXRlZEVmZm9ydDogJ21pbnV0ZXMnXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHN1Z2dlc3Rpb25zO1xuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgZmV0Y2hRdWVyeURhdGEoXG4gICAgICAgIGludGVudDogc3RyaW5nLCBcbiAgICAgICAgZW50aXRpZXM6IFJlY29yZDxzdHJpbmcsIGFueT4sIFxuICAgICAgICBjb250ZXh0PzogQW5hbHlzaXNEYXRhXG4gICAgKTogUHJvbWlzZTxhbnk+IHtcbiAgICAgICAgaWYgKCFjb250ZXh0KSB7cmV0dXJuIG51bGw7fVxuICAgICAgICBcbiAgICAgICAgY29uc3QgZGF0YTogYW55ID0ge307XG4gICAgICAgIFxuICAgICAgICBzd2l0Y2ggKGludGVudCkge1xuICAgICAgICAgICAgY2FzZSAndGVzdC1xdWVyeSc6XG4gICAgICAgICAgICAgICAgZGF0YS50ZXN0UmVzdWx0cyA9IGNvbnRleHQudGVzdFJlc3VsdHM7XG4gICAgICAgICAgICAgICAgZGF0YS50ZXN0U3VtbWFyeSA9IHRoaXMuc3VtbWFyaXplVGVzdFJlc3VsdHMoY29udGV4dC50ZXN0UmVzdWx0cyk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICBjYXNlICdlcnJvci1xdWVyeSc6XG4gICAgICAgICAgICAgICAgZGF0YS5lcnJvclBhdHRlcm5zID0gY29udGV4dC5lcnJvclBhdHRlcm5zO1xuICAgICAgICAgICAgICAgIGRhdGEuZXJyb3JTdW1tYXJ5ID0gdGhpcy5zdW1tYXJpemVFcnJvclBhdHRlcm5zKGNvbnRleHQuZXJyb3JQYXR0ZXJucyk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICBjYXNlICdwZXJmb3JtYW5jZS1xdWVyeSc6XG4gICAgICAgICAgICAgICAgZGF0YS5wZXJmb3JtYW5jZU1ldHJpY3MgPSBjb250ZXh0LnBlcmZvcm1hbmNlTWV0cmljcztcbiAgICAgICAgICAgICAgICBkYXRhLnBlcmZvcm1hbmNlU3VtbWFyeSA9IHRoaXMuc3VtbWFyaXplUGVyZm9ybWFuY2VNZXRyaWNzKGNvbnRleHQucGVyZm9ybWFuY2VNZXRyaWNzKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIGNhc2UgJ2dpdC1xdWVyeSc6XG4gICAgICAgICAgICAgICAgZGF0YS5naXRIaXN0b3J5ID0gY29udGV4dC5naXRIaXN0b3J5O1xuICAgICAgICAgICAgICAgIGRhdGEuZ2l0U3VtbWFyeSA9IHRoaXMuc3VtbWFyaXplR2l0SGlzdG9yeShjb250ZXh0LmdpdEhpc3RvcnkpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gZGF0YTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIGdlbmVyYXRlQ29udGV4dHVhbFN1Z2dlc3Rpb25zKGNvbnRleHQ6IEFuYWx5c2lzRGF0YSk6IFByb21pc2U8c3RyaW5nW10+IHtcbiAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbnM6IHN0cmluZ1tdID0gW107XG4gICAgICAgIFxuICAgICAgICAvLyBUZXN0LXJlbGF0ZWQgc3VnZ2VzdGlvbnNcbiAgICAgICAgY29uc3QgZmFpbGluZ1Rlc3RzID0gY29udGV4dC50ZXN0UmVzdWx0cy5maWx0ZXIodCA9PiB0LnN0YXR1cyA9PT0gJ2ZhaWxlZCcpO1xuICAgICAgICBpZiAoZmFpbGluZ1Rlc3RzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goYFNob3cgbWUgdGhlICR7ZmFpbGluZ1Rlc3RzLmxlbmd0aH0gZmFpbGluZyB0ZXN0c2ApO1xuICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaChcIldoeSBhcmUgdGVzdHMgZmFpbGluZz9cIik7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIEVycm9yLXJlbGF0ZWQgc3VnZ2VzdGlvbnNcbiAgICAgICAgY29uc3QgZnJlcXVlbnRFcnJvcnMgPSBjb250ZXh0LmVycm9yUGF0dGVybnMuZmlsdGVyKGUgPT4gZS5mcmVxdWVuY3kgPiAzKTtcbiAgICAgICAgaWYgKGZyZXF1ZW50RXJyb3JzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goXCJXaGF0IGFyZSB0aGUgbW9zdCBjb21tb24gZXJyb3JzP1wiKTtcbiAgICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goXCJIb3cgdG8gZml4IHJlY3VycmluZyBlcnJvcnM/XCIpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBQZXJmb3JtYW5jZSBzdWdnZXN0aW9uc1xuICAgICAgICBpZiAoY29udGV4dC5wZXJmb3JtYW5jZU1ldHJpY3MubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaChcIlNob3cgcGVyZm9ybWFuY2UgdHJlbmRzXCIpO1xuICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaChcIldoYXQncyBzbG93aW5nIGRvd24gdGhlIGJ1aWxkP1wiKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gR2l0IHN1Z2dlc3Rpb25zXG4gICAgICAgIGlmIChjb250ZXh0LmdpdEhpc3RvcnkubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaChcIlNob3cgcmVjZW50IGNvbW1pdHNcIik7XG4gICAgICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKFwiV2hhdCBmaWxlcyBjaGFuZ2VkIHJlY2VudGx5P1wiKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHN1Z2dlc3Rpb25zO1xuICAgIH1cblxuICAgIHByaXZhdGUgZ2V0UG9wdWxhclF1ZXJ5U3VnZ2VzdGlvbnMoKTogc3RyaW5nW10ge1xuICAgICAgICBjb25zdCBxdWVyeUZyZXF1ZW5jeSA9IG5ldyBNYXA8c3RyaW5nLCBudW1iZXI+KCk7XG4gICAgICAgIFxuICAgICAgICAvLyBDb3VudCBxdWVyeSBwYXR0ZXJuc1xuICAgICAgICBmb3IgKGNvbnN0IGVudHJ5IG9mIHRoaXMucXVlcnlIaXN0b3J5KSB7XG4gICAgICAgICAgICBjb25zdCBub3JtYWxpemVkUXVlcnkgPSB0aGlzLm5vcm1hbGl6ZVF1ZXJ5Rm9yUGF0dGVybihlbnRyeS5xdWVyeSk7XG4gICAgICAgICAgICBxdWVyeUZyZXF1ZW5jeS5zZXQobm9ybWFsaXplZFF1ZXJ5LCAocXVlcnlGcmVxdWVuY3kuZ2V0KG5vcm1hbGl6ZWRRdWVyeSkgfHwgMCkgKyAxKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gUmV0dXJuIG1vc3QgcG9wdWxhciBwYXR0ZXJuc1xuICAgICAgICByZXR1cm4gQXJyYXkuZnJvbShxdWVyeUZyZXF1ZW5jeS5lbnRyaWVzKCkpXG4gICAgICAgICAgICAuc29ydCgoYSwgYikgPT4gYlsxXSAtIGFbMV0pXG4gICAgICAgICAgICAuc2xpY2UoMCwgMylcbiAgICAgICAgICAgIC5tYXAoKFtxdWVyeV0pID0+IHF1ZXJ5KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIG5vcm1hbGl6ZVF1ZXJ5Rm9yUGF0dGVybihxdWVyeTogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHF1ZXJ5XG4gICAgICAgICAgICAudG9Mb3dlckNhc2UoKVxuICAgICAgICAgICAgLnJlcGxhY2UoL1xcYihzaG93fGZpbmR8Z2V0fHdoYXR8aG93fHdoeSlcXGIvZywgJ3Nob3cnKVxuICAgICAgICAgICAgLnJlcGxhY2UoL1xcYih0ZXN0fHRlc3RzfHRlc3RpbmcpXFxiL2csICd0ZXN0cycpXG4gICAgICAgICAgICAucmVwbGFjZSgvXFxiKGVycm9yfGVycm9yc3xidWd8YnVncylcXGIvZywgJ2Vycm9ycycpXG4gICAgICAgICAgICAucmVwbGFjZSgvXFxiKHBlcmZvcm1hbmNlfHNwZWVkfHNsb3cpXFxiL2csICdwZXJmb3JtYW5jZScpO1xuICAgIH1cblxuICAgIHByaXZhdGUgZ3JvdXBRdWVyaWVzQnlJbnRlbnQoKTogTWFwPHN0cmluZywgUXVlcnlIaXN0b3J5W10+IHtcbiAgICAgICAgY29uc3QgZ3JvdXBzID0gbmV3IE1hcDxzdHJpbmcsIFF1ZXJ5SGlzdG9yeVtdPigpO1xuICAgICAgICBcbiAgICAgICAgZm9yIChjb25zdCBxdWVyeSBvZiB0aGlzLnF1ZXJ5SGlzdG9yeSkge1xuICAgICAgICAgICAgY29uc3QgaW50ZW50ID0gcXVlcnkucmVzdWx0LmludGVudDtcbiAgICAgICAgICAgIGlmICghZ3JvdXBzLmhhcyhpbnRlbnQpKSB7XG4gICAgICAgICAgICAgICAgZ3JvdXBzLnNldChpbnRlbnQsIFtdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGdyb3Vwcy5nZXQoaW50ZW50KSEucHVzaChxdWVyeSk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBncm91cHM7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBleHRyYWN0UXVlcnlQYXR0ZXJuKGludGVudDogc3RyaW5nLCBxdWVyaWVzOiBRdWVyeUhpc3RvcnlbXSk6IFF1ZXJ5UGF0dGVybiB7XG4gICAgICAgIGNvbnN0IGNvbW1vbldvcmRzID0gdGhpcy5maW5kQ29tbW9uV29yZHMocXVlcmllcy5tYXAocSA9PiBxLnF1ZXJ5KSk7XG4gICAgICAgIGNvbnN0IGF2Z0NvbmZpZGVuY2UgPSBxdWVyaWVzLnJlZHVjZSgoc3VtLCBxKSA9PiBzdW0gKyBxLnJlc3VsdC5jb25maWRlbmNlLCAwKSAvIHF1ZXJpZXMubGVuZ3RoO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGludGVudCxcbiAgICAgICAgICAgIGNvbW1vbldvcmRzLFxuICAgICAgICAgICAgZnJlcXVlbmN5OiBxdWVyaWVzLmxlbmd0aCxcbiAgICAgICAgICAgIGF2Z0NvbmZpZGVuY2UsXG4gICAgICAgICAgICBjb25maWRlbmNlOiBhdmdDb25maWRlbmNlID4gMC43ID8gMC44IDogMC42LFxuICAgICAgICAgICAgZXhhbXBsZXM6IHF1ZXJpZXMuc2xpY2UoMCwgMykubWFwKHEgPT4gcS5xdWVyeSlcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGZpbmRDb21tb25Xb3JkcyhxdWVyaWVzOiBzdHJpbmdbXSk6IHN0cmluZ1tdIHtcbiAgICAgICAgY29uc3Qgd29yZEZyZXEgPSBuZXcgTWFwPHN0cmluZywgbnVtYmVyPigpO1xuICAgICAgICBcbiAgICAgICAgZm9yIChjb25zdCBxdWVyeSBvZiBxdWVyaWVzKSB7XG4gICAgICAgICAgICBjb25zdCB3b3JkcyA9IHF1ZXJ5LnRvTG93ZXJDYXNlKCkuc3BsaXQoL1xccysvKTtcbiAgICAgICAgICAgIGZvciAoY29uc3Qgd29yZCBvZiB3b3Jkcykge1xuICAgICAgICAgICAgICAgIGlmICh3b3JkLmxlbmd0aCA+IDIpIHsgLy8gSWdub3JlIHNob3J0IHdvcmRzXG4gICAgICAgICAgICAgICAgICAgIHdvcmRGcmVxLnNldCh3b3JkLCAod29yZEZyZXEuZ2V0KHdvcmQpIHx8IDApICsgMSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBjb25zdCB0aHJlc2hvbGQgPSBNYXRoLm1heCgyLCBNYXRoLmZsb29yKHF1ZXJpZXMubGVuZ3RoICogMC4zKSk7XG4gICAgICAgIHJldHVybiBBcnJheS5mcm9tKHdvcmRGcmVxLmVudHJpZXMoKSlcbiAgICAgICAgICAgIC5maWx0ZXIoKFssIGZyZXFdKSA9PiBmcmVxID49IHRocmVzaG9sZClcbiAgICAgICAgICAgIC5zb3J0KChhLCBiKSA9PiBiWzFdIC0gYVsxXSlcbiAgICAgICAgICAgIC5zbGljZSgwLCA1KVxuICAgICAgICAgICAgLm1hcCgoW3dvcmRdKSA9PiB3b3JkKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIHVwZGF0ZUNsYXNzaWZpZXJzRnJvbVBhdHRlcm5zKHBhdHRlcm5zOiBRdWVyeVBhdHRlcm5bXSk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICAvLyBVcGRhdGUgaW50ZW50IGNsYXNzaWZpZXIgd2l0aCBuZXcgcGF0dGVybnNcbiAgICAgICAgZm9yIChjb25zdCBwYXR0ZXJuIG9mIHBhdHRlcm5zKSB7XG4gICAgICAgICAgICB0aGlzLmludGVudENsYXNzaWZpZXIuYWRkUGF0dGVybihwYXR0ZXJuKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gVXBkYXRlIGVudGl0eSBleHRyYWN0b3Igd2l0aCBuZXcgZXhhbXBsZXNcbiAgICAgICAgdGhpcy5lbnRpdHlFeHRyYWN0b3IudXBkYXRlRnJvbVBhdHRlcm5zKHBhdHRlcm5zKTtcbiAgICAgICAgXG4gICAgICAgIGNvbnNvbGUubG9nKGBVcGRhdGVkIGNsYXNzaWZpZXJzIHdpdGggJHtwYXR0ZXJucy5sZW5ndGh9IHBhdHRlcm5zYCk7XG4gICAgfVxuXG4gICAgLy8gU3VtbWFyeSBtZXRob2RzIGZvciBkaWZmZXJlbnQgZGF0YSB0eXBlc1xuICAgIHByaXZhdGUgc3VtbWFyaXplVGVzdFJlc3VsdHMocmVzdWx0czogVGVzdFJlc3VsdFtdKTogYW55IHtcbiAgICAgICAgY29uc3QgdG90YWwgPSByZXN1bHRzLmxlbmd0aDtcbiAgICAgICAgY29uc3QgcGFzc2VkID0gcmVzdWx0cy5maWx0ZXIociA9PiByLnN0YXR1cyA9PT0gJ3Bhc3NlZCcpLmxlbmd0aDtcbiAgICAgICAgY29uc3QgZmFpbGVkID0gcmVzdWx0cy5maWx0ZXIociA9PiByLnN0YXR1cyA9PT0gJ2ZhaWxlZCcpLmxlbmd0aDtcbiAgICAgICAgY29uc3Qgc2tpcHBlZCA9IHJlc3VsdHMuZmlsdGVyKHIgPT4gci5zdGF0dXMgPT09ICdza2lwcGVkJykubGVuZ3RoO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHRvdGFsLFxuICAgICAgICAgICAgcGFzc2VkLFxuICAgICAgICAgICAgZmFpbGVkLFxuICAgICAgICAgICAgc2tpcHBlZCxcbiAgICAgICAgICAgIHBhc3NSYXRlOiBwYXNzZWQgLyB0b3RhbCxcbiAgICAgICAgICAgIGZhaWx1cmVSYXRlOiBmYWlsZWQgLyB0b3RhbFxuICAgICAgICB9O1xuICAgIH1cblxuICAgIHByaXZhdGUgc3VtbWFyaXplRXJyb3JQYXR0ZXJucyhwYXR0ZXJuczogRXJyb3JQYXR0ZXJuW10pOiBhbnkge1xuICAgICAgICBjb25zdCB0b3RhbCA9IHBhdHRlcm5zLmxlbmd0aDtcbiAgICAgICAgY29uc3QgdG90YWxGcmVxdWVuY3kgPSBwYXR0ZXJucy5yZWR1Y2UoKHN1bSwgcCkgPT4gc3VtICsgcC5mcmVxdWVuY3ksIDApO1xuICAgICAgICBjb25zdCBtb3N0RnJlcXVlbnQgPSBwYXR0ZXJucy5zb3J0KChhLCBiKSA9PiBiLmZyZXF1ZW5jeSAtIGEuZnJlcXVlbmN5KVswXTtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB0b3RhbCxcbiAgICAgICAgICAgIHRvdGFsRnJlcXVlbmN5LFxuICAgICAgICAgICAgbW9zdEZyZXF1ZW50OiBtb3N0RnJlcXVlbnQ/LnBhdHRlcm4sXG4gICAgICAgICAgICBhdmdGcmVxdWVuY3k6IHRvdGFsRnJlcXVlbmN5IC8gdG90YWxcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHN1bW1hcml6ZVBlcmZvcm1hbmNlTWV0cmljcyhtZXRyaWNzOiBhbnlbXSk6IGFueSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB0b3RhbDogbWV0cmljcy5sZW5ndGgsXG4gICAgICAgICAgICB0eXBlczogWy4uLm5ldyBTZXQobWV0cmljcy5tYXAobSA9PiBtLm1ldHJpYykpXSxcbiAgICAgICAgICAgIHRpbWVSYW5nZTogbWV0cmljcy5sZW5ndGggPiAwID8ge1xuICAgICAgICAgICAgICAgIHN0YXJ0OiBNYXRoLm1pbiguLi5tZXRyaWNzLm1hcChtID0+IG0udGltZXN0YW1wLmdldFRpbWUoKSkpLFxuICAgICAgICAgICAgICAgIGVuZDogTWF0aC5tYXgoLi4ubWV0cmljcy5tYXAobSA9PiBtLnRpbWVzdGFtcC5nZXRUaW1lKCkpKVxuICAgICAgICAgICAgfSA6IG51bGxcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHN1bW1hcml6ZUdpdEhpc3RvcnkoaGlzdG9yeTogYW55W10pOiBhbnkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdG90YWxDb21taXRzOiBoaXN0b3J5Lmxlbmd0aCxcbiAgICAgICAgICAgIGF1dGhvcnM6IFsuLi5uZXcgU2V0KGhpc3RvcnkubWFwKGMgPT4gYy5hdXRob3IpKV0sXG4gICAgICAgICAgICB0aW1lUmFuZ2U6IGhpc3RvcnkubGVuZ3RoID4gMCA/IHtcbiAgICAgICAgICAgICAgICBzdGFydDogTWF0aC5taW4oLi4uaGlzdG9yeS5tYXAoYyA9PiBjLmRhdGUuZ2V0VGltZSgpKSksXG4gICAgICAgICAgICAgICAgZW5kOiBNYXRoLm1heCguLi5oaXN0b3J5Lm1hcChjID0+IGMuZGF0ZS5nZXRUaW1lKCkpKVxuICAgICAgICAgICAgfSA6IG51bGxcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGNyZWF0ZUVycm9yUmVzcG9uc2UocXVlcnk6IHN0cmluZyk6IFF1ZXJ5UmVzdWx0IHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGludGVudDogJ2Vycm9yJyxcbiAgICAgICAgICAgIGVudGl0aWVzOiB7fSxcbiAgICAgICAgICAgIGNvbmZpZGVuY2U6IDAsXG4gICAgICAgICAgICByZXNwb25zZTogYEkgYXBvbG9naXplLCBidXQgSSBjb3VsZG4ndCB1bmRlcnN0YW5kIHlvdXIgcXVlcnk6IFwiJHtxdWVyeX1cIi4gUGxlYXNlIHRyeSByZXBocmFzaW5nIHlvdXIgcXVlc3Rpb24gb3IgdXNlIG9uZSBvZiB0aGUgc3VnZ2VzdGVkIHF1ZXJpZXMuYCxcbiAgICAgICAgICAgIHN1Z2dlc3RlZEFjdGlvbnM6IFt7XG4gICAgICAgICAgICAgICAgaWQ6IHRoaXMuZ2VuZXJhdGVTdWdnZXN0aW9uSWQoKSxcbiAgICAgICAgICAgICAgICB0aXRsZTogJ1RyeSBFeGFtcGxlIFF1ZXJ5JyxcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogJ1VzZSBvbmUgb2YgdGhlIGV4YW1wbGUgcXVlcmllcyB0byBnZXQgc3RhcnRlZCcsXG4gICAgICAgICAgICAgICAgYWN0aW9uOiB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdleHRlcm5hbCcsXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgYWN0aW9uOiAnc2hvdy1leGFtcGxlcycgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZXN0aW1hdGVkSW1wYWN0OiAnbG93JyxcbiAgICAgICAgICAgICAgICBlc3RpbWF0ZWRFZmZvcnQ6ICdtaW51dGVzJ1xuICAgICAgICAgICAgfV1cbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHJlY29yZFF1ZXJ5KHF1ZXJ5OiBzdHJpbmcsIHJlc3VsdDogUXVlcnlSZXN1bHQpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZW50cnk6IFF1ZXJ5SGlzdG9yeSA9IHtcbiAgICAgICAgICAgIHF1ZXJ5LFxuICAgICAgICAgICAgcmVzdWx0LFxuICAgICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpXG4gICAgICAgIH07XG4gICAgICAgIFxuICAgICAgICB0aGlzLnF1ZXJ5SGlzdG9yeS5wdXNoKGVudHJ5KTtcbiAgICAgICAgXG4gICAgICAgIC8vIExpbWl0IGhpc3Rvcnkgc2l6ZVxuICAgICAgICBpZiAodGhpcy5xdWVyeUhpc3RvcnkubGVuZ3RoID4gdGhpcy5tYXhIaXN0b3J5U2l6ZSkge1xuICAgICAgICAgICAgdGhpcy5xdWVyeUhpc3RvcnkgPSB0aGlzLnF1ZXJ5SGlzdG9yeS5zbGljZSgtdGhpcy5tYXhIaXN0b3J5U2l6ZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIGxvYWRRdWVyeUhpc3RvcnkoKTogdm9pZCB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBoaXN0b3J5RGF0YSA9IHRoaXMuY29udGV4dC5nbG9iYWxTdGF0ZS5nZXQ8c3RyaW5nPigncXVlcnktaGlzdG9yeScpO1xuICAgICAgICAgICAgaWYgKGhpc3RvcnlEYXRhKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgaGlzdG9yeSA9IEpTT04ucGFyc2UoaGlzdG9yeURhdGEpO1xuICAgICAgICAgICAgICAgIHRoaXMucXVlcnlIaXN0b3J5ID0gaGlzdG9yeS5tYXAoKGVudHJ5OiBhbnkpID0+ICh7XG4gICAgICAgICAgICAgICAgICAgIC4uLmVudHJ5LFxuICAgICAgICAgICAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKGVudHJ5LnRpbWVzdGFtcClcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coYExvYWRlZCAke3RoaXMucXVlcnlIaXN0b3J5Lmxlbmd0aH0gcXVlcnkgaGlzdG9yeSBlbnRyaWVzYCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBsb2FkaW5nIHF1ZXJ5IGhpc3Rvcnk6JywgZXJyb3IpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBnZW5lcmF0ZVN1Z2dlc3Rpb25JZCgpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gYHN1Z2dlc3Rpb25fJHtEYXRlLm5vdygpfV8ke01hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cigyLCA5KX1gO1xuICAgIH1cblxuICAgIGFzeW5jIHNhdmVRdWVyeUhpc3RvcnkoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmNvbnRleHQuZ2xvYmFsU3RhdGUudXBkYXRlKFxuICAgICAgICAgICAgICAgICdxdWVyeS1oaXN0b3J5JywgXG4gICAgICAgICAgICAgICAgSlNPTi5zdHJpbmdpZnkodGhpcy5xdWVyeUhpc3RvcnkpXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgY29uc29sZS5sb2coYFNhdmVkICR7dGhpcy5xdWVyeUhpc3RvcnkubGVuZ3RofSBxdWVyeSBoaXN0b3J5IGVudHJpZXNgKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHNhdmluZyBxdWVyeSBoaXN0b3J5OicsIGVycm9yKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGRpc3Bvc2UoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuc2F2ZVF1ZXJ5SGlzdG9yeSgpO1xuICAgICAgICB0aGlzLnF1ZXJ5SGlzdG9yeSA9IFtdO1xuICAgICAgICB0aGlzLmVudGl0eUV4dHJhY3Rvci5kaXNwb3NlKCk7XG4gICAgICAgIHRoaXMuaW50ZW50Q2xhc3NpZmllci5kaXNwb3NlKCk7XG4gICAgICAgIHRoaXMucmVzcG9uc2VHZW5lcmF0b3IuZGlzcG9zZSgpO1xuICAgIH1cbn1cblxuLy8gU3VwcG9ydGluZyBjbGFzc2VzIGZvciBOTFAgZnVuY3Rpb25hbGl0eVxuXG5jbGFzcyBFbnRpdHlFeHRyYWN0b3Ige1xuICAgIHByaXZhdGUgZW50aXR5UGF0dGVybnM6IE1hcDxzdHJpbmcsIFJlZ0V4cFtdPiA9IG5ldyBNYXAoKTtcblxuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLmluaXRpYWxpemVQYXR0ZXJucygpO1xuICAgIH1cblxuICAgIHByaXZhdGUgaW5pdGlhbGl6ZVBhdHRlcm5zKCk6IHZvaWQge1xuICAgICAgICAvLyBUaW1lIGVudGl0aWVzXG4gICAgICAgIHRoaXMuZW50aXR5UGF0dGVybnMuc2V0KCd0aW1lUmFuZ2UnLCBbXG4gICAgICAgICAgICAvKD86bGFzdHxwYXN0KVxccysoXFxkKylcXHMrKGRheXx3ZWVrfG1vbnRofHllYXIpcz8vaSxcbiAgICAgICAgICAgIC8odG9kYXl8eWVzdGVyZGF5fHRoaXNcXHMrd2Vla3xsYXN0XFxzK3dlZWspL2lcbiAgICAgICAgXSk7XG4gICAgICAgIFxuICAgICAgICAvLyBQcm9qZWN0IGVudGl0aWVzXG4gICAgICAgIHRoaXMuZW50aXR5UGF0dGVybnMuc2V0KCdwcm9qZWN0JywgW1xuICAgICAgICAgICAgL3Byb2plY3Rbc10/XFxzKyhcXHcrKS9pLFxuICAgICAgICAgICAgL2luXFxzKyhcXHcrKVxccytwcm9qZWN0L2lcbiAgICAgICAgXSk7XG4gICAgICAgIFxuICAgICAgICAvLyBGaWxlIGVudGl0aWVzXG4gICAgICAgIHRoaXMuZW50aXR5UGF0dGVybnMuc2V0KCdmaWxlcycsIFtcbiAgICAgICAgICAgIC9maWxlW3NdP1xccysoXFxTK1xcLlxcdyspL2ksXG4gICAgICAgICAgICAvKFxcdytcXC9cXHcrXFwuXFx3KykvaVxuICAgICAgICBdKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFRlc3QgZW50aXRpZXNcbiAgICAgICAgdGhpcy5lbnRpdHlQYXR0ZXJucy5zZXQoJ3Rlc3RzJywgW1xuICAgICAgICAgICAgLyhmYWlsaW5nfGZhaWxlZHxicm9rZW4pXFxzK3Rlc3RzPy9pLFxuICAgICAgICAgICAgL3Rlc3Rbc10/XFxzKyhcXHcrKS9pXG4gICAgICAgIF0pO1xuICAgICAgICBcbiAgICAgICAgLy8gRXJyb3IgZW50aXRpZXNcbiAgICAgICAgdGhpcy5lbnRpdHlQYXR0ZXJucy5zZXQoJ2Vycm9ycycsIFtcbiAgICAgICAgICAgIC9lcnJvcltzXT9cXHMraW5cXHMrKFxcdyspL2ksXG4gICAgICAgICAgICAvKGVycm9yfGJ1Z3xpc3N1ZSlbc10/XFxzKyhcXHcrKS9pXG4gICAgICAgIF0pO1xuICAgIH1cblxuICAgIGFzeW5jIGV4dHJhY3RFbnRpdGllcyhxdWVyeTogc3RyaW5nKTogUHJvbWlzZTxSZWNvcmQ8c3RyaW5nLCBhbnk+PiB7XG4gICAgICAgIGNvbnN0IGVudGl0aWVzOiBSZWNvcmQ8c3RyaW5nLCBhbnk+ID0ge307XG4gICAgICAgIFxuICAgICAgICBmb3IgKGNvbnN0IFtlbnRpdHlUeXBlLCBwYXR0ZXJuc10gb2YgdGhpcy5lbnRpdHlQYXR0ZXJucy5lbnRyaWVzKCkpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgcGF0dGVybiBvZiBwYXR0ZXJucykge1xuICAgICAgICAgICAgICAgIGNvbnN0IG1hdGNoID0gcXVlcnkubWF0Y2gocGF0dGVybik7XG4gICAgICAgICAgICAgICAgaWYgKG1hdGNoKSB7XG4gICAgICAgICAgICAgICAgICAgIGVudGl0aWVzW2VudGl0eVR5cGVdID0gbWF0Y2hbMV0gfHwgbWF0Y2hbMF07XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGVudGl0aWVzO1xuICAgIH1cblxuICAgIHVwZGF0ZUZyb21QYXR0ZXJucyhwYXR0ZXJuczogUXVlcnlQYXR0ZXJuW10pOiB2b2lkIHtcbiAgICAgICAgLy8gVXBkYXRlIGVudGl0eSBwYXR0ZXJucyBiYXNlZCBvbiBzdWNjZXNzZnVsIHF1ZXJ5IHBhdHRlcm5zXG4gICAgICAgIGZvciAoY29uc3QgcGF0dGVybiBvZiBwYXR0ZXJucykge1xuICAgICAgICAgICAgLy8gU2ltcGxpZmllZCBwYXR0ZXJuIGxlYXJuaW5nXG4gICAgICAgICAgICBpZiAocGF0dGVybi5jb21tb25Xb3Jkcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbmV3UGF0dGVybnMgPSBwYXR0ZXJuLmNvbW1vbldvcmRzLm1hcCh3b3JkID0+IFxuICAgICAgICAgICAgICAgICAgICBuZXcgUmVnRXhwKGBcXFxcYiR7d29yZH1cXFxcYmAsICdpJylcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmVudGl0eVBhdHRlcm5zLmhhcyhwYXR0ZXJuLmludGVudCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbnRpdHlQYXR0ZXJucy5nZXQocGF0dGVybi5pbnRlbnQpIS5wdXNoKC4uLm5ld1BhdHRlcm5zKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmVudGl0eVBhdHRlcm5zLnNldChwYXR0ZXJuLmludGVudCwgbmV3UGF0dGVybnMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGRpc3Bvc2UoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuZW50aXR5UGF0dGVybnMuY2xlYXIoKTtcbiAgICB9XG59XG5cbmNsYXNzIEludGVudENsYXNzaWZpZXIge1xuICAgIHByaXZhdGUgaW50ZW50UGF0dGVybnM6IE1hcDxzdHJpbmcsIFJlZ0V4cFtdPiA9IG5ldyBNYXAoKTtcblxuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLmluaXRpYWxpemVJbnRlbnRQYXR0ZXJucygpO1xuICAgIH1cblxuICAgIHByaXZhdGUgaW5pdGlhbGl6ZUludGVudFBhdHRlcm5zKCk6IHZvaWQge1xuICAgICAgICB0aGlzLmludGVudFBhdHRlcm5zLnNldCgndGVzdC1xdWVyeScsIFtcbiAgICAgICAgICAgIC9cXGIodGVzdHx0ZXN0c3x0ZXN0aW5nfHNwZWN8c3BlY3MpXFxiL2ksXG4gICAgICAgICAgICAvXFxiKGZhaWxpbmd8ZmFpbGVkfGJyb2tlbnxwYXNzfHBhc3NlZClcXGIuKlxcYih0ZXN0fHRlc3RzKVxcYi9pLFxuICAgICAgICAgICAgL1xcYnJ1blxccyt0ZXN0cz9cXGIvaVxuICAgICAgICBdKTtcbiAgICAgICAgXG4gICAgICAgIHRoaXMuaW50ZW50UGF0dGVybnMuc2V0KCdlcnJvci1xdWVyeScsIFtcbiAgICAgICAgICAgIC9cXGIoZXJyb3J8ZXJyb3JzfGJ1Z3xidWdzfGlzc3VlfGlzc3VlcylcXGIvaSxcbiAgICAgICAgICAgIC9cXGIoZml4fGRlYnVnfHNvbHZlfHJlc29sdmUpXFxiL2ksXG4gICAgICAgICAgICAvXFxiKGV4Y2VwdGlvbnxjcmFzaHxmYWlsKVxcYi9pXG4gICAgICAgIF0pO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5pbnRlbnRQYXR0ZXJucy5zZXQoJ3BlcmZvcm1hbmNlLXF1ZXJ5JywgW1xuICAgICAgICAgICAgL1xcYihwZXJmb3JtYW5jZXxzcGVlZHxzbG93fGZhc3R8b3B0aW1pemUpXFxiL2ksXG4gICAgICAgICAgICAvXFxiKHRpbWV8ZHVyYXRpb258bGF0ZW5jeXxib3R0bGVuZWNrKVxcYi9pLFxuICAgICAgICAgICAgL1xcYmhvd1xccysoZmFzdHxzbG93fGxvbmcpXFxiL2lcbiAgICAgICAgXSk7XG4gICAgICAgIFxuICAgICAgICB0aGlzLmludGVudFBhdHRlcm5zLnNldCgnZ2l0LXF1ZXJ5JywgW1xuICAgICAgICAgICAgL1xcYihnaXR8Y29tbWl0fGNvbW1pdHN8YnJhbmNofG1lcmdlKVxcYi9pLFxuICAgICAgICAgICAgL1xcYihjaGFuZ2VkfGNoYW5nZXN8ZGlmZnxoaXN0b3J5KVxcYi9pLFxuICAgICAgICAgICAgL1xcYndoYXQuKmNoYW5nZWRcXGIvaVxuICAgICAgICBdKTtcbiAgICAgICAgXG4gICAgICAgIHRoaXMuaW50ZW50UGF0dGVybnMuc2V0KCdidWlsZC1xdWVyeScsIFtcbiAgICAgICAgICAgIC9cXGIoYnVpbGR8YnVpbGRzfGNvbXBpbGV8Y29tcGlsYXRpb24pXFxiL2ksXG4gICAgICAgICAgICAvXFxiKGRlcGxveXxkZXBsb3ltZW50fGNpfGNkKVxcYi9pLFxuICAgICAgICAgICAgL1xcYnB1c2h8cHVsbFxcYi9pXG4gICAgICAgIF0pO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5pbnRlbnRQYXR0ZXJucy5zZXQoJ2NvdmVyYWdlLXF1ZXJ5JywgW1xuICAgICAgICAgICAgL1xcYihjb3ZlcmFnZXxjb3ZlcmVkfHVuY292ZXJlZClcXGIvaSxcbiAgICAgICAgICAgIC9cXGJob3dcXHMrbXVjaC4qY292ZXJlZFxcYi9pXG4gICAgICAgIF0pO1xuICAgIH1cblxuICAgIGFzeW5jIGNsYXNzaWZ5SW50ZW50KHF1ZXJ5OiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgICAgICBmb3IgKGNvbnN0IFtpbnRlbnQsIHBhdHRlcm5zXSBvZiB0aGlzLmludGVudFBhdHRlcm5zLmVudHJpZXMoKSkge1xuICAgICAgICAgICAgZm9yIChjb25zdCBwYXR0ZXJuIG9mIHBhdHRlcm5zKSB7XG4gICAgICAgICAgICAgICAgaWYgKHBhdHRlcm4udGVzdChxdWVyeSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGludGVudDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIEZhbGxiYWNrIGNsYXNzaWZpY2F0aW9uIGJhc2VkIG9uIHF1ZXN0aW9uIHdvcmRzXG4gICAgICAgIGlmICgvXih3aGF0fGhvd3x3aHl8d2hlbnx3aGVyZSlcXGIvaS50ZXN0KHF1ZXJ5KSkge1xuICAgICAgICAgICAgcmV0dXJuICdnZW5lcmFsLXF1ZXJ5JztcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgaWYgKC9eKHNob3d8ZmluZHxnZXR8bGlzdClcXGIvaS50ZXN0KHF1ZXJ5KSkge1xuICAgICAgICAgICAgcmV0dXJuICdkYXRhLXF1ZXJ5JztcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuICd1bmtub3duJztcbiAgICB9XG5cbiAgICBhZGRQYXR0ZXJuKHBhdHRlcm46IFF1ZXJ5UGF0dGVybik6IHZvaWQge1xuICAgICAgICBpZiAoIXRoaXMuaW50ZW50UGF0dGVybnMuaGFzKHBhdHRlcm4uaW50ZW50KSkge1xuICAgICAgICAgICAgdGhpcy5pbnRlbnRQYXR0ZXJucy5zZXQocGF0dGVybi5pbnRlbnQsIFtdKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gQWRkIG5ldyBwYXR0ZXJucyBiYXNlZCBvbiBjb21tb24gd29yZHNcbiAgICAgICAgY29uc3QgbmV3UGF0dGVybnMgPSBwYXR0ZXJuLmNvbW1vbldvcmRzLm1hcCh3b3JkID0+IFxuICAgICAgICAgICAgbmV3IFJlZ0V4cChgXFxcXGIke3dvcmR9XFxcXGJgLCAnaScpXG4gICAgICAgICk7XG4gICAgICAgIFxuICAgICAgICB0aGlzLmludGVudFBhdHRlcm5zLmdldChwYXR0ZXJuLmludGVudCkhLnB1c2goLi4ubmV3UGF0dGVybnMpO1xuICAgIH1cblxuICAgIGRpc3Bvc2UoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuaW50ZW50UGF0dGVybnMuY2xlYXIoKTtcbiAgICB9XG59XG5cbmNsYXNzIFJlc3BvbnNlR2VuZXJhdG9yIHtcbiAgICBwcml2YXRlIHJlc3BvbnNlVGVtcGxhdGVzOiBNYXA8c3RyaW5nLCBzdHJpbmdbXT4gPSBuZXcgTWFwKCk7XG5cbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5pbml0aWFsaXplVGVtcGxhdGVzKCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBpbml0aWFsaXplVGVtcGxhdGVzKCk6IHZvaWQge1xuICAgICAgICB0aGlzLnJlc3BvbnNlVGVtcGxhdGVzLnNldCgndGVzdC1xdWVyeScsIFtcbiAgICAgICAgICAgIFwiSSBjYW4gaGVscCB5b3UgYW5hbHl6ZSB5b3VyIHRlc3QgcmVzdWx0cyBhbmQgaWRlbnRpZnkgcGF0dGVybnMgaW4gdGVzdCBmYWlsdXJlcy5cIixcbiAgICAgICAgICAgIFwiTGV0IG1lIGV4YW1pbmUgeW91ciB0ZXN0IGRhdGEgdG8gcHJvdmlkZSBpbnNpZ2h0cyBhYm91dCB0ZXN0IHBlcmZvcm1hbmNlIGFuZCBmYWlsdXJlcy5cIixcbiAgICAgICAgICAgIFwiSSdsbCBhbmFseXplIHlvdXIgdGVzdCBwYXR0ZXJucyB0byBoZWxwIGltcHJvdmUgdGVzdCByZWxpYWJpbGl0eSBhbmQgY292ZXJhZ2UuXCJcbiAgICAgICAgXSk7XG4gICAgICAgIFxuICAgICAgICB0aGlzLnJlc3BvbnNlVGVtcGxhdGVzLnNldCgnZXJyb3ItcXVlcnknLCBbXG4gICAgICAgICAgICBcIkkgY2FuIGhlbHAgaWRlbnRpZnkgYW5kIGFuYWx5emUgZXJyb3IgcGF0dGVybnMgaW4geW91ciBjb2RlYmFzZS5cIixcbiAgICAgICAgICAgIFwiTGV0IG1lIGV4YW1pbmUgdGhlIGVycm9yIGRhdGEgdG8gZmluZCByZWN1cnJpbmcgaXNzdWVzIGFuZCBzdWdnZXN0IGZpeGVzLlwiLFxuICAgICAgICAgICAgXCJJJ2xsIGFuYWx5emUgdGhlIGVycm9yIHBhdHRlcm5zIHRvIGhlbHAgeW91IHJlc29sdmUgdGhlIG1vc3QgaW1wYWN0ZnVsIGlzc3VlcyBmaXJzdC5cIlxuICAgICAgICBdKTtcbiAgICAgICAgXG4gICAgICAgIHRoaXMucmVzcG9uc2VUZW1wbGF0ZXMuc2V0KCdwZXJmb3JtYW5jZS1xdWVyeScsIFtcbiAgICAgICAgICAgIFwiSSBjYW4gYW5hbHl6ZSBwZXJmb3JtYW5jZSBtZXRyaWNzIGFuZCBpZGVudGlmeSBvcHRpbWl6YXRpb24gb3Bwb3J0dW5pdGllcy5cIixcbiAgICAgICAgICAgIFwiTGV0IG1lIGV4YW1pbmUgeW91ciBwZXJmb3JtYW5jZSBkYXRhIHRvIGZpbmQgYm90dGxlbmVja3MgYW5kIHN1Z2dlc3QgaW1wcm92ZW1lbnRzLlwiLFxuICAgICAgICAgICAgXCJJJ2xsIGFuYWx5emUgcGVyZm9ybWFuY2UgdHJlbmRzIHRvIGhlbHAgeW91IG9wdGltaXplIHlvdXIgZGV2ZWxvcG1lbnQgd29ya2Zsb3cuXCJcbiAgICAgICAgXSk7XG4gICAgICAgIFxuICAgICAgICB0aGlzLnJlc3BvbnNlVGVtcGxhdGVzLnNldCgnZ2l0LXF1ZXJ5JywgW1xuICAgICAgICAgICAgXCJJIGNhbiBhbmFseXplIHlvdXIgZ2l0IGhpc3RvcnkgYW5kIHByb3ZpZGUgaW5zaWdodHMgYWJvdXQgY29kZSBjaGFuZ2VzLlwiLFxuICAgICAgICAgICAgXCJMZXQgbWUgZXhhbWluZSB5b3VyIGNvbW1pdCBwYXR0ZXJucyBhbmQgZmlsZSBjaGFuZ2VzIGZvciBpbnNpZ2h0cy5cIixcbiAgICAgICAgICAgIFwiSSdsbCBhbmFseXplIHlvdXIgZ2l0IGRhdGEgdG8gaGVscCB5b3UgdW5kZXJzdGFuZCBkZXZlbG9wbWVudCBwYXR0ZXJucy5cIlxuICAgICAgICBdKTtcbiAgICAgICAgXG4gICAgICAgIHRoaXMucmVzcG9uc2VUZW1wbGF0ZXMuc2V0KCdidWlsZC1xdWVyeScsIFtcbiAgICAgICAgICAgIFwiSSBjYW4gaGVscCBhbmFseXplIHlvdXIgYnVpbGQgcHJvY2VzcyBhbmQgaWRlbnRpZnkgaW1wcm92ZW1lbnQgb3Bwb3J0dW5pdGllcy5cIixcbiAgICAgICAgICAgIFwiTGV0IG1lIGV4YW1pbmUgeW91ciBidWlsZCBwYXR0ZXJucyB0byBzdWdnZXN0IG9wdGltaXphdGlvbnMuXCIsXG4gICAgICAgICAgICBcIkknbGwgYW5hbHl6ZSB5b3VyIGJ1aWxkIGRhdGEgdG8gaGVscCBzdHJlYW1saW5lIHlvdXIgZGVwbG95bWVudCBwcm9jZXNzLlwiXG4gICAgICAgIF0pO1xuICAgIH1cblxuICAgIGFzeW5jIGdlbmVyYXRlUmVzcG9uc2UoXG4gICAgICAgIGludGVudDogc3RyaW5nLCBcbiAgICAgICAgZW50aXRpZXM6IFJlY29yZDxzdHJpbmcsIGFueT4sIFxuICAgICAgICBxdWVyeTogc3RyaW5nLCBcbiAgICAgICAgY29udGV4dD86IEFuYWx5c2lzRGF0YVxuICAgICk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgICAgIGNvbnN0IHRlbXBsYXRlcyA9IHRoaXMucmVzcG9uc2VUZW1wbGF0ZXMuZ2V0KGludGVudCkgfHwgW1xuICAgICAgICAgICAgXCJJIGNhbiBoZWxwIHlvdSBhbmFseXplIHlvdXIgZGVidWdnaW5nIHBhdHRlcm5zIGFuZCBzdWdnZXN0IGltcHJvdmVtZW50cy5cIlxuICAgICAgICBdO1xuICAgICAgICBcbiAgICAgICAgbGV0IGJhc2VSZXNwb25zZSA9IHRlbXBsYXRlc1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiB0ZW1wbGF0ZXMubGVuZ3RoKV07XG4gICAgICAgIFxuICAgICAgICAvLyBDdXN0b21pemUgcmVzcG9uc2UgYmFzZWQgb24gZW50aXRpZXMgYW5kIGNvbnRleHRcbiAgICAgICAgaWYgKGNvbnRleHQpIHtcbiAgICAgICAgICAgIGJhc2VSZXNwb25zZSArPSB0aGlzLmFkZENvbnRleHR1YWxEZXRhaWxzKGludGVudCwgZW50aXRpZXMsIGNvbnRleHQpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gYmFzZVJlc3BvbnNlO1xuICAgIH1cblxuICAgIHByaXZhdGUgYWRkQ29udGV4dHVhbERldGFpbHMoXG4gICAgICAgIGludGVudDogc3RyaW5nLCBcbiAgICAgICAgZW50aXRpZXM6IFJlY29yZDxzdHJpbmcsIGFueT4sIFxuICAgICAgICBjb250ZXh0OiBBbmFseXNpc0RhdGFcbiAgICApOiBzdHJpbmcge1xuICAgICAgICBsZXQgZGV0YWlscyA9IFwiXCI7XG4gICAgICAgIFxuICAgICAgICBzd2l0Y2ggKGludGVudCkge1xuICAgICAgICAgICAgY2FzZSAndGVzdC1xdWVyeSc6XG4gICAgICAgICAgICAgICAgY29uc3QgZmFpbGVkVGVzdHMgPSBjb250ZXh0LnRlc3RSZXN1bHRzLmZpbHRlcih0ID0+IHQuc3RhdHVzID09PSAnZmFpbGVkJykubGVuZ3RoO1xuICAgICAgICAgICAgICAgIGlmIChmYWlsZWRUZXN0cyA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgZGV0YWlscyArPSBgIEkgZm91bmQgJHtmYWlsZWRUZXN0c30gZmFpbGluZyB0ZXN0cyB0aGF0IG5lZWQgYXR0ZW50aW9uLmA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgY2FzZSAnZXJyb3ItcXVlcnknOlxuICAgICAgICAgICAgICAgIGNvbnN0IGVycm9yQ291bnQgPSBjb250ZXh0LmVycm9yUGF0dGVybnMubGVuZ3RoO1xuICAgICAgICAgICAgICAgIGlmIChlcnJvckNvdW50ID4gMCkge1xuICAgICAgICAgICAgICAgICAgICBkZXRhaWxzICs9IGAgSSBpZGVudGlmaWVkICR7ZXJyb3JDb3VudH0gZXJyb3IgcGF0dGVybnMgaW4geW91ciBjb2RlYmFzZS5gO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIGNhc2UgJ3BlcmZvcm1hbmNlLXF1ZXJ5JzpcbiAgICAgICAgICAgICAgICBjb25zdCBtZXRyaWNDb3VudCA9IGNvbnRleHQucGVyZm9ybWFuY2VNZXRyaWNzLmxlbmd0aDtcbiAgICAgICAgICAgICAgICBpZiAobWV0cmljQ291bnQgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGRldGFpbHMgKz0gYCBJIGhhdmUgJHttZXRyaWNDb3VudH0gcGVyZm9ybWFuY2UgbWV0cmljcyB0byBhbmFseXplLmA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gZGV0YWlscztcbiAgICB9XG5cbiAgICBkaXNwb3NlKCk6IHZvaWQge1xuICAgICAgICB0aGlzLnJlc3BvbnNlVGVtcGxhdGVzLmNsZWFyKCk7XG4gICAgfVxufVxuXG4vLyBTdXBwb3J0aW5nIGludGVyZmFjZXMgZm9yIE5hdHVyYWwgTGFuZ3VhZ2UgUXVlcnkgRW5naW5lXG5cbmludGVyZmFjZSBRdWVyeUhpc3Rvcnkge1xuICAgIHF1ZXJ5OiBzdHJpbmc7XG4gICAgcmVzdWx0OiBRdWVyeVJlc3VsdDtcbiAgICB0aW1lc3RhbXA6IERhdGU7XG59XG5cbmludGVyZmFjZSBRdWVyeVBhdHRlcm4ge1xuICAgIGludGVudDogc3RyaW5nO1xuICAgIGNvbW1vbldvcmRzOiBzdHJpbmdbXTtcbiAgICBmcmVxdWVuY3k6IG51bWJlcjtcbiAgICBhdmdDb25maWRlbmNlOiBudW1iZXI7XG4gICAgY29uZmlkZW5jZTogbnVtYmVyO1xuICAgIGV4YW1wbGVzOiBzdHJpbmdbXTtcbn1cbiJdLCJ2ZXJzaW9uIjozfQ==