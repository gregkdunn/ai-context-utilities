{"file":"/Users/gregdunn/src/test/ai_debug_context/vscode/src/webview/provider.ts","mappings":"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","names":[],"sources":["/Users/gregdunn/src/test/ai_debug_context/vscode/src/webview/provider.ts"],"sourcesContent":["import * as vscode from 'vscode';\nimport { ProjectDetector } from '../utils/projectDetector';\nimport { CommandRunner } from '../utils/shellRunner';\nimport { FileManager } from '../utils/fileManager';\nimport { StatusTracker } from '../utils/statusTracker';\nimport { WebviewMessage, StreamingMessage } from '../types';\n\nexport class WebviewProvider implements vscode.WebviewViewProvider {\n    public static readonly viewType = 'aiDebugUtilities';\n    \n    private _view?: vscode.WebviewView;\n    private _disposables: vscode.Disposable[] = [];\n\n    constructor(\n        private readonly _extensionUri: vscode.Uri,\n        private readonly _projectDetector: ProjectDetector,\n        private readonly _commandRunner: CommandRunner,\n        private readonly _fileManager: FileManager,\n        private readonly _statusTracker: StatusTracker\n    ) {}\n\n    public resolveWebviewView(\n        webviewView: vscode.WebviewView,\n        context: vscode.WebviewViewResolveContext,\n        _token: vscode.CancellationToken\n    ) {\n        this._view = webviewView;\n\n        webviewView.webview.options = {\n            enableScripts: true,\n            localResourceRoots: [this._extensionUri]\n        };\n\n        webviewView.webview.html = this._getHtmlForWebview(webviewView.webview);\n\n        webviewView.webview.onDidReceiveMessage(\n            (data: WebviewMessage) => {\n                this._handleMessage(data);\n            },\n            undefined,\n            this._disposables\n        );\n\n        // Set up file watcher\n        this._fileManager.watchFiles((filePath: string, eventType: string) => {\n            this._postMessage({ type: 'fileChanged', data: { filePath, eventType } });\n        });\n    }\n\n    private _handleMessage(data: WebviewMessage) {\n        switch (data.command) {\n            case 'runCommand':\n                this._handleRunCommand(data.data);\n                break;\n            case 'getProjects':\n                this._handleGetProjects();\n                break;\n            case 'openFile':\n                this._handleOpenFile(data.data);\n                break;\n            case 'clearOutput':\n                this._handleClearOutput();\n                break;\n            default:\n                console.warn('Unknown message command:', data.command);\n        }\n    }\n\n    private async _handleRunCommand(data: any) {\n        const { action, project, options } = data;\n        \n        try {\n            let result;\n            \n            switch (action) {\n                case 'aiDebug':\n                    result = await this._commandRunner.runAiDebug(project, options);\n                    break;\n                case 'nxTest':\n                    result = await this._commandRunner.runNxTest(project, options);\n                    break;\n                case 'gitDiff':\n                    result = await this._commandRunner.runGitDiff(options);\n                    break;\n                case 'prepareToPush':\n                    result = await this._commandRunner.runPrepareToPush(project, options);\n                    break;\n                default:\n                    throw new Error(`Unknown action: ${action}`);\n            }\n            \n            this._postMessage({ \n                type: 'commandResult', \n                data: { action, result } \n            });\n        } catch (error) {\n            this._postMessage({ \n                type: 'commandError', \n                data: { action, error: (error as Error).message } \n            });\n        }\n    }\n\n    private async _handleGetProjects() {\n        try {\n            const projects = await this._projectDetector.getProjects();\n            this._postMessage({ \n                type: 'projects', \n                data: { projects } \n            });\n        } catch (error) {\n            this._postMessage({ \n                type: 'error', \n                data: { error: (error as Error).message } \n            });\n        }\n    }\n\n    private async _handleOpenFile(data: any) {\n        const { filePath } = data;\n        \n        try {\n            await this._fileManager.openFile(filePath);\n        } catch (error) {\n            this._postMessage({ \n                type: 'error', \n                data: { error: (error as Error).message } \n            });\n        }\n    }\n\n    private _handleClearOutput() {\n        // Clear output in status tracker or file manager\n        this._statusTracker.clearHistory();\n        this._postMessage({ \n            type: 'outputCleared', \n            data: {} \n        });\n    }\n\n    // Public methods for external use\n    public show() {\n        if (this._view) {\n            this._view.show();\n        }\n    }\n\n    public async runCommand(action: string, data: any) {\n        return this._handleRunCommand({ action, ...data });\n    }\n\n    private _postMessage(message: any) {\n        if (this._view) {\n            this._view.webview.postMessage(message);\n        }\n    }\n\n    private _getHtmlForWebview(webview: vscode.Webview): string {\n        const scriptUri = webview.asWebviewUri(\n            vscode.Uri.joinPath(this._extensionUri, 'out', 'webview', 'main.js')\n        );\n\n        const styleUri = webview.asWebviewUri(\n            vscode.Uri.joinPath(this._extensionUri, 'out', 'webview', 'styles.css')\n        );\n\n        return `<!DOCTYPE html>\n        <html lang=\"en\">\n        <head>\n            <meta charset=\"UTF-8\">\n            <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n            <link href=\"${styleUri}\" rel=\"stylesheet\">\n            <title>AI Debug Utilities</title>\n        </head>\n        <body>\n            <div id=\"root\"></div>\n            <script src=\"${scriptUri}\"></script>\n        </body>\n        </html>`;\n    }\n\n    public setupStreamingListeners() {\n        // Method for streaming integration - placeholder implementation\n        // This method would set up listeners for streaming events\n    }\n\n    public dispose() {\n        this._disposables.forEach(d => d.dispose());\n    }\n}"],"version":3}