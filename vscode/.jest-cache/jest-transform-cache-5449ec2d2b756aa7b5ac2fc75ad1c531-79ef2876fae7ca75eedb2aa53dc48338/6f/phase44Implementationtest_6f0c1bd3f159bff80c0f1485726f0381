fab8c83ca8a6c1ac108355254464cd18
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const analyticsEngine_1 = require("../analyticsEngine");
const predictiveAnalyticsEngine_1 = require("../engines/predictiveAnalyticsEngine");
const metricsCollectionEngine_1 = require("../engines/metricsCollectionEngine");
const interactiveDashboardEngine_1 = require("../engines/interactiveDashboardEngine");
describe('Phase 4.4 - Advanced Analytics System', () => {
    let analyticsEngine;
    let predictiveEngine;
    let metricsEngine;
    let dashboardEngine;
    beforeEach(() => {
        analyticsEngine = new analyticsEngine_1.AnalyticsEngine({
            bufferSize: 100,
            flushInterval: 1000,
            enablePredictiveAnalytics: true,
            enableRealTimeMonitoring: true
        });
        predictiveEngine = new predictiveAnalyticsEngine_1.PredictiveAnalyticsEngine({
            enableAnomalyDetection: true,
            enableTrendForecasting: true,
            enableRiskAssessment: true,
            minTrainingDataSize: 10,
            confidenceThreshold: 0.5
        });
        metricsEngine = new metricsCollectionEngine_1.MetricsCollectionEngine({
            bufferSize: 100,
            flushInterval: 1000,
            enableSystemMetrics: true,
            enableCustomMetrics: true
        });
        dashboardEngine = new interactiveDashboardEngine_1.InteractiveDashboardEngine();
    });
    afterEach(() => {
        analyticsEngine.dispose();
        predictiveEngine = null;
        metricsEngine.dispose();
        dashboardEngine.dispose();
    });
    describe('AnalyticsEngine', () => {
        it('should initialize with default configuration', () => {
            expect(analyticsEngine).toBeDefined();
            expect(analyticsEngine.listDashboards()).toEqual([]);
        });
        it('should start and stop collection', () => {
            const startSpy = jest.fn();
            const stopSpy = jest.fn();
            analyticsEngine.on('collectionStarted', startSpy);
            analyticsEngine.on('collectionStopped', stopSpy);
            analyticsEngine.startCollection();
            expect(startSpy).toHaveBeenCalled();
            analyticsEngine.stopCollection();
            expect(stopSpy).toHaveBeenCalled();
        });
        it('should track events and validate them', async () => {
            const validEvent = {
                id: 'test-event-1',
                type: 'command_executed',
                timestamp: new Date(),
                userId: 'user123',
                metadata: {
                    command: 'npm test',
                    success: true,
                    executionTime: 1500
                }
            };
            analyticsEngine.startCollection();
            await expect(analyticsEngine.trackEvent(validEvent)).resolves.toBeUndefined();
            // Test invalid event
            const invalidEvent = {
                type: 'invalid_event',
                // Missing required fields
            };
            await expect(analyticsEngine.trackEvent(invalidEvent)).rejects.toThrow('Invalid event structure');
        });
        it('should generate comprehensive metrics', async () => {
            const timeRange = {
                start: new Date(Date.now() - 3600000), // 1 hour ago
                end: new Date()
            };
            const events = [
                {
                    id: 'event1',
                    type: 'command_executed',
                    timestamp: new Date(Date.now() - 1800000),
                    userId: 'user1',
                    metadata: { command: 'npm test', success: true, executionTime: 1200 }
                },
                {
                    id: 'event2',
                    type: 'error',
                    timestamp: new Date(Date.now() - 1200000),
                    userId: 'user1',
                    metadata: { errorType: 'runtime', component: 'api' }
                }
            ];
            analyticsEngine.startCollection();
            for (const event of events) {
                await analyticsEngine.trackEvent(event);
            }
            const metrics = await analyticsEngine.generateMetrics(timeRange);
            expect(metrics).toHaveProperty('timeRange');
            expect(metrics).toHaveProperty('commandExecutions');
            expect(metrics).toHaveProperty('performance');
            expect(metrics).toHaveProperty('errors');
            expect(metrics).toHaveProperty('usage');
            expect(metrics).toHaveProperty('trends');
            expect(metrics.commandExecutions.total).toBe(1);
            expect(metrics.errors.total).toBe(1);
        });
        it('should create and manage dashboards', async () => {
            const dashboardConfig = {
                name: 'Test Dashboard',
                description: 'A test dashboard for analytics',
                layout: { type: 'grid', columns: 12, rows: 'auto', gap: '1rem', padding: '1rem' },
                widgets: [
                    {
                        type: 'line-chart',
                        title: 'Performance Metrics',
                        position: { x: 0, y: 0, width: 6, height: 4 },
                        configuration: { chartType: 'line' }
                    }
                ]
            };
            const dashboard = await analyticsEngine.createDashboard(dashboardConfig);
            expect(dashboard).toHaveProperty('id');
            expect(dashboard.name).toBe('Test Dashboard');
            expect(dashboard.widgets).toHaveLength(1);
            const retrieved = analyticsEngine.getDashboard(dashboard.id);
            expect(retrieved).toEqual(dashboard);
            const deleted = analyticsEngine.deleteDashboard(dashboard.id);
            expect(deleted).toBe(true);
            expect(analyticsEngine.getDashboard(dashboard.id)).toBeUndefined();
        });
        it('should export reports in different formats', async () => {
            const timeRange = {
                start: new Date(Date.now() - 3600000),
                end: new Date()
            };
            const events = [
                {
                    id: 'event1',
                    type: 'command_executed',
                    timestamp: new Date(),
                    userId: 'user1',
                    metadata: { command: 'npm test', success: true }
                }
            ];
            analyticsEngine.startCollection();
            for (const event of events) {
                await analyticsEngine.trackEvent(event);
            }
            const jsonReport = await analyticsEngine.exportReport('json', timeRange);
            expect(jsonReport).toBeInstanceOf(Buffer);
            const csvReport = await analyticsEngine.exportReport('csv', timeRange);
            expect(csvReport).toBeInstanceOf(Buffer);
        });
        it('should generate predictive insights', async () => {
            const events = [
                {
                    id: 'event1',
                    type: 'command_executed',
                    timestamp: new Date(),
                    userId: 'user1',
                    metadata: { command: 'npm test', success: false, executionTime: 1200 }
                },
                {
                    id: 'event2',
                    type: 'command_executed',
                    timestamp: new Date(),
                    userId: 'user1',
                    metadata: { command: 'npm test', success: false, executionTime: 1500 }
                }
            ];
            analyticsEngine.startCollection();
            for (const event of events) {
                await analyticsEngine.trackEvent(event);
            }
            const predictions = await analyticsEngine.generatePredictions(events);
            expect(Array.isArray(predictions)).toBe(true);
            // Should predict command failures due to high failure rate
            expect(predictions.some(p => p.type === 'test-failure')).toBe(true);
        });
    });
    describe('PredictiveAnalyticsEngine', () => {
        it('should initialize with default models', () => {
            const models = predictiveEngine.getAvailableModels();
            expect(models.length).toBeGreaterThan(0);
            expect(models.some(m => m.id === 'command_failure')).toBe(true);
            expect(models.some(m => m.id === 'performance_degradation')).toBe(true);
        });
        it('should train models with sufficient data', async () => {
            const events = Array.from({ length: 20 }, (_, i) => ({
                id: `event${i}`,
                type: 'command_executed',
                timestamp: new Date(Date.now() - i * 60000),
                userId: 'user1',
                metadata: {
                    command: 'npm test',
                    success: Math.random() > 0.3,
                    executionTime: Math.random() * 2000 + 500
                }
            }));
            await expect(predictiveEngine.trainModels(events)).resolves.toBeUndefined();
        });
        it('should reject training with insufficient data', async () => {
            const events = Array.from({ length: 5 }, (_, i) => ({
                id: `event${i}`,
                type: 'command_executed',
                timestamp: new Date(),
                userId: 'user1',
                metadata: { command: 'npm test', success: true }
            }));
            await expect(predictiveEngine.trainModels(events)).rejects.toThrow('Insufficient training data');
        });
        it('should generate predictions with confidence thresholds', async () => {
            const events = Array.from({ length: 15 }, (_, i) => ({
                id: `event${i}`,
                type: 'command_executed',
                timestamp: new Date(Date.now() - i * 60000),
                userId: 'user1',
                metadata: {
                    command: 'npm test',
                    success: i % 3 !== 0, // 33% failure rate
                    executionTime: Math.random() * 2000 + 500
                }
            }));
            const predictions = await predictiveEngine.generatePredictions(events);
            expect(Array.isArray(predictions)).toBe(true);
            predictions.forEach(prediction => {
                expect(prediction.confidence || prediction.probability).toBeGreaterThanOrEqual(0.5);
                expect(prediction).toHaveProperty('type');
                expect(prediction).toHaveProperty('prediction');
                expect(prediction).toHaveProperty('recommendation');
            });
        });
        it('should detect anomalies in event patterns', async () => {
            const baselineEvents = Array.from({ length: 10 }, (_, i) => ({
                id: `baseline${i}`,
                type: 'performance_metric',
                timestamp: new Date(Date.now() - i * 60000),
                userId: 'user1',
                metadata: { value: 100 + Math.random() * 20 } // Normal range: 100-120
            }));
            const anomalousEvents = [
                {
                    id: 'anomaly1',
                    type: 'performance_metric',
                    timestamp: new Date(),
                    userId: 'user1',
                    metadata: { value: 500 } // Anomalous value
                }
            ];
            // First, establish baseline
            await predictiveEngine.trainModels(baselineEvents);
            // Then detect anomalies
            const anomalies = await predictiveEngine.detectAnomalies([...baselineEvents, ...anomalousEvents]);
            expect(Array.isArray(anomalies)).toBe(true);
            // Should detect the anomalous value
            expect(anomalies.length).toBeGreaterThan(0);
        });
        it('should generate forecasts for metrics', async () => {
            const events = Array.from({ length: 15 }, (_, i) => ({
                id: `event${i}`,
                type: 'resource_usage',
                timestamp: new Date(Date.now() - i * 60000),
                userId: 'user1',
                metadata: {
                    memoryUsage: 500 + i * 10, // Trending upward
                    responseTime: Math.random() * 1000 + 200
                }
            }));
            const forecasts = await predictiveEngine.generateForecasts(events, ['memoryUsage', 'responseTime'], 12);
            expect(Array.isArray(forecasts)).toBe(true);
            forecasts.forEach(forecast => {
                expect(forecast).toHaveProperty('metric');
                expect(forecast).toHaveProperty('currentValue');
                expect(forecast).toHaveProperty('forecastValue');
                expect(forecast).toHaveProperty('confidence');
            });
        });
        it('should assess overall risk levels', async () => {
            const events = [
                {
                    id: 'event1',
                    type: 'command_executed',
                    timestamp: new Date(),
                    userId: 'user1',
                    metadata: { command: 'npm test', success: false }
                },
                {
                    id: 'event2',
                    type: 'resource_usage',
                    timestamp: new Date(),
                    userId: 'user1',
                    metadata: { memoryUsage: 90, cpuUsage: 85 }
                }
            ];
            const riskAssessment = await predictiveEngine.assessRisk(events);
            expect(riskAssessment).toHaveProperty('overallRiskScore');
            expect(riskAssessment).toHaveProperty('riskLevel');
            expect(riskAssessment).toHaveProperty('criticalFactors');
            expect(riskAssessment).toHaveProperty('recommendations');
            expect(riskAssessment).toHaveProperty('predictions');
            expect(riskAssessment).toHaveProperty('anomalies');
            expect(riskAssessment.riskLevel).toMatch(/^(low|medium|high)$/);
        });
        it('should provide model performance metrics', () => {
            const modelId = 'command_failure';
            const metrics = predictiveEngine.getModelMetrics(modelId);
            expect(metrics).toHaveProperty('accuracy');
            expect(metrics).toHaveProperty('precision');
            expect(metrics).toHaveProperty('recall');
            expect(metrics).toHaveProperty('f1Score');
            expect(metrics).toHaveProperty('lastTrained');
            expect(metrics.accuracy).toBeGreaterThan(0);
            expect(metrics.accuracy).toBeLessThanOrEqual(1);
        });
        it('should toggle model activation', () => {
            const modelId = 'command_failure';
            predictiveEngine.toggleModel(modelId, false);
            let model = predictiveEngine.getAvailableModels().find(m => m.id === modelId);
            expect(model?.isActive).toBe(false);
            predictiveEngine.toggleModel(modelId, true);
            model = predictiveEngine.getAvailableModels().find(m => m.id === modelId);
            expect(model?.isActive).toBe(true);
        });
    });
    describe('MetricsCollectionEngine', () => {
        it('should initialize with default metrics', () => {
            const definitions = metricsEngine.getMetricDefinitions();
            expect(definitions.length).toBeGreaterThan(0);
            expect(definitions.some(d => d.name === 'command.execution.time')).toBe(true);
            expect(definitions.some(d => d.name === 'command.execution.count')).toBe(true);
        });
        it('should define and collect custom metrics', () => {
            const metricDefinition = {
                name: 'custom.metric',
                type: 'gauge',
                unit: 'count',
                description: 'A custom metric for testing',
                tags: ['test']
            };
            metricsEngine.defineMetric(metricDefinition);
            metricsEngine.startCollection();
            expect(() => {
                metricsEngine.collectMetric('custom.metric', 42, { environment: 'test' });
            }).not.toThrow();
        });
        it('should validate metric definitions', () => {
            const invalidDefinition = {
                name: '',
                type: 'invalid',
                unit: 'count',
                description: 'Invalid metric',
                tags: []
            };
            expect(() => {
                metricsEngine.defineMetric(invalidDefinition);
            }).toThrow('Invalid metric definition');
        });
        it('should apply collection rules', () => {
            const rule = {
                id: 'test_rule',
                name: 'Test Rule',
                condition: 'metric.name === "test.metric"',
                action: 'filter',
                parameters: {},
                isActive: true
            };
            const metricDefinition = {
                name: 'test.metric',
                type: 'counter',
                unit: 'count',
                description: 'Test metric',
                tags: []
            };
            metricsEngine.defineMetric(metricDefinition);
            metricsEngine.createCollectionRule(rule);
            metricsEngine.startCollection();
            const collectedSpy = jest.fn();
            metricsEngine.on('metricCollected', collectedSpy);
            // This should be filtered out by the rule
            metricsEngine.collectMetric('test.metric', 1);
            expect(collectedSpy).not.toHaveBeenCalled();
        });
        it('should generate aggregated metrics', () => {
            const metricDefinition = {
                name: 'aggregation.test',
                type: 'histogram',
                unit: 'milliseconds',
                description: 'Aggregation test metric',
                tags: []
            };
            metricsEngine.defineMetric(metricDefinition);
            metricsEngine.startCollection();
            // Collect some sample data
            for (let i = 0; i < 10; i++) {
                metricsEngine.collectMetric('aggregation.test', i * 10);
            }
            const aggregation = metricsEngine.getAggregatedMetrics('aggregation.test', '1m');
            expect(aggregation).toHaveProperty('count');
            expect(aggregation).toHaveProperty('sum');
            expect(aggregation).toHaveProperty('avg');
            expect(aggregation).toHaveProperty('min');
            expect(aggregation).toHaveProperty('max');
            expect(aggregation.count).toBe(10);
            expect(aggregation.sum).toBe(450); // 0+10+20+...+90
        });
        it('should collect system metrics automatically', (done) => {
            const metricCollectedSpy = jest.fn();
            metricsEngine.on('metricCollected', metricCollectedSpy);
            metricsEngine.startCollection();
            // Wait for system metrics to be collected
            setTimeout(() => {
                expect(metricCollectedSpy).toHaveBeenCalled();
                // Check if system metrics were collected
                const calls = metricCollectedSpy.mock.calls;
                const systemMetricsCalls = calls.filter(call => call[0].name.startsWith('system.'));
                expect(systemMetricsCalls.length).toBeGreaterThan(0);
                done();
            }, 1200); // Wait longer than system metrics interval
        });
        it('should export metrics in different formats', () => {
            const metricDefinition = {
                name: 'export.test',
                type: 'gauge',
                unit: 'count',
                description: 'Export test metric',
                tags: []
            };
            metricsEngine.defineMetric(metricDefinition);
            metricsEngine.startCollection();
            metricsEngine.collectMetric('export.test', 100);
            const jsonExport = metricsEngine.exportMetrics('json');
            expect(typeof jsonExport).toBe('string');
            expect(() => JSON.parse(jsonExport)).not.toThrow();
            const csvExport = metricsEngine.exportMetrics('csv');
            expect(typeof csvExport).toBe('string');
            expect(csvExport).toContain('Metric,Value,Timestamp,Tags');
            const prometheusExport = metricsEngine.exportMetrics('prometheus');
            expect(typeof prometheusExport).toBe('string');
        });
        it('should provide buffer status information', () => {
            const metricDefinition = {
                name: 'buffer.test',
                type: 'counter',
                unit: 'count',
                description: 'Buffer test metric',
                tags: []
            };
            metricsEngine.defineMetric(metricDefinition);
            metricsEngine.startCollection();
            metricsEngine.collectMetric('buffer.test', 1);
            const bufferStatus = metricsEngine.getBufferStatus();
            expect(bufferStatus).toBeInstanceOf(Map);
            expect(bufferStatus.has('buffer.test')).toBe(true);
            const status = bufferStatus.get('buffer.test');
            expect(status).toHaveProperty('size');
            expect(status).toHaveProperty('lastUpdated');
            expect(status.size).toBe(1);
        });
        it('should clear metrics data', () => {
            const metricDefinition = {
                name: 'clear.test',
                type: 'gauge',
                unit: 'count',
                description: 'Clear test metric',
                tags: []
            };
            metricsEngine.defineMetric(metricDefinition);
            metricsEngine.startCollection();
            metricsEngine.collectMetric('clear.test', 1);
            let bufferStatus = metricsEngine.getBufferStatus();
            expect(bufferStatus.has('clear.test')).toBe(true);
            metricsEngine.clearMetrics();
            bufferStatus = metricsEngine.getBufferStatus();
            expect(bufferStatus.has('clear.test')).toBe(false);
        });
    });
    describe('InteractiveDashboardEngine', () => {
        it('should create dashboards with widgets', async () => {
            const config = {
                name: 'Analytics Dashboard',
                description: 'Main analytics dashboard',
                widgets: [
                    {
                        type: 'line-chart',
                        title: 'Performance Chart',
                        position: { x: 0, y: 0, width: 6, height: 4 },
                        configuration: { chartType: 'line' }
                    },
                    {
                        type: 'metric-card',
                        title: 'Success Rate',
                        position: { x: 6, y: 0, width: 3, height: 2 },
                        configuration: { metric: 'success_rate' }
                    }
                ]
            };
            const dashboard = await dashboardEngine.createDashboard(config);
            expect(dashboard).toHaveProperty('id');
            expect(dashboard.name).toBe('Analytics Dashboard');
            expect(dashboard.widgets).toHaveLength(2);
            expect(dashboard.widgets[0].type).toBe('line-chart');
            expect(dashboard.widgets[1].type).toBe('metric-card');
        });
        it('should update dashboard configurations', async () => {
            const config = {
                name: 'Test Dashboard',
                description: 'Initial description'
            };
            const dashboard = await dashboardEngine.createDashboard(config);
            const updated = await dashboardEngine.updateDashboard(dashboard.id, {
                name: 'Updated Dashboard',
                description: 'Updated description'
            });
            expect(updated.name).toBe('Updated Dashboard');
            expect(updated.description).toBe('Updated description');
            expect(updated.updatedAt).not.toEqual(dashboard.updatedAt);
        });
        it('should create and manage individual widgets', async () => {
            const widgetConfig = {
                type: 'bar-chart',
                title: 'Command Usage',
                position: { x: 0, y: 0, width: 4, height: 3 },
                configuration: {
                    chartType: 'bar',
                    dataSource: { type: 'analytics', query: 'command_usage' }
                }
            };
            const widget = await dashboardEngine.createWidget(widgetConfig);
            expect(widget).toHaveProperty('id');
            expect(widget.type).toBe('bar-chart');
            expect(widget.title).toBe('Command Usage');
        });
        it('should refresh widget data', async () => {
            const widgetConfig = {
                type: 'gauge',
                title: 'System Health',
                position: { x: 0, y: 0, width: 2, height: 2 },
                configuration: { min: 0, max: 100 }
            };
            const widget = await dashboardEngine.createWidget(widgetConfig);
            const data = await dashboardEngine.refreshWidgetData(widget.id);
            expect(data).toHaveProperty('id');
            expect(data).toHaveProperty('type');
            expect(data).toHaveProperty('data');
            expect(data).toHaveProperty('metadata');
            expect(data.id).toBe(widget.id);
        });
        it('should apply filters to dashboards', async () => {
            const config = {
                name: 'Filtered Dashboard',
                description: 'Dashboard with filters'
            };
            const dashboard = await dashboardEngine.createDashboard(config);
            const filters = [
                {
                    id: 'time_range',
                    type: 'date-range',
                    label: 'Time Range',
                    value: { start: new Date(Date.now() - 3600000), end: new Date() }
                },
                {
                    id: 'user_filter',
                    type: 'select',
                    label: 'User',
                    value: 'user123',
                    options: ['user123', 'user456']
                }
            ];
            const appliedSpy = jest.fn();
            dashboardEngine.on('filtersApplied', appliedSpy);
            dashboardEngine.applyFilters(dashboard.id, filters);
            expect(appliedSpy).toHaveBeenCalledWith({
                dashboardId: dashboard.id,
                filters
            });
        });
        it('should export dashboards', async () => {
            const config = {
                name: 'Export Test Dashboard',
                description: 'Dashboard for export testing'
            };
            const dashboard = await dashboardEngine.createDashboard(config);
            const exportData = await dashboardEngine.exportDashboard(dashboard.id, 'json');
            expect(exportData).toHaveProperty('dashboard');
            expect(exportData).toHaveProperty('format');
            expect(exportData).toHaveProperty('exportedAt');
            expect(exportData).toHaveProperty('data');
            expect(exportData.format).toBe('json');
        });
        it('should clone dashboards', async () => {
            const config = {
                name: 'Original Dashboard',
                description: 'Original dashboard for cloning',
                widgets: [
                    {
                        type: 'line-chart',
                        title: 'Original Chart',
                        position: { x: 0, y: 0, width: 4, height: 3 }
                    }
                ]
            };
            const original = await dashboardEngine.createDashboard(config);
            const cloned = await dashboardEngine.cloneDashboard(original.id, 'Cloned Dashboard', 'user123');
            expect(cloned.name).toBe('Cloned Dashboard');
            expect(cloned.description).toContain('Clone of');
            expect(cloned.widgets).toHaveLength(original.widgets.length);
            expect(cloned.id).not.toBe(original.id);
        });
        it('should provide dashboard analytics', async () => {
            const config = {
                name: 'Analytics Test Dashboard',
                description: 'Dashboard for analytics testing'
            };
            const dashboard = await dashboardEngine.createDashboard(config);
            const analytics = dashboardEngine.getDashboardAnalytics(dashboard.id);
            expect(analytics).toHaveProperty('views');
            expect(analytics).toHaveProperty('interactions');
            expect(analytics).toHaveProperty('performance');
            expect(analytics).toHaveProperty('widgets');
            expect(typeof analytics.views).toBe('number');
            expect(typeof analytics.interactions).toBe('number');
        });
        it('should manage dashboard themes', () => {
            const customTheme = {
                id: 'custom-theme',
                name: 'Custom Theme',
                colors: {
                    primary: '#FF6B6B',
                    secondary: '#4ECDC4',
                    success: '#45B7D1',
                    warning: '#FFA07A',
                    error: '#FF6B6B',
                    background: '#F8F9FA',
                    surface: '#FFFFFF',
                    text: '#333333'
                },
                fonts: {
                    body: 'Arial, sans-serif',
                    heading: 'Helvetica, sans-serif',
                    monospace: 'Courier New, monospace'
                },
                spacing: {
                    small: '4px',
                    medium: '8px',
                    large: '16px'
                }
            };
            const themeCreatedSpy = jest.fn();
            dashboardEngine.on('themeCreated', themeCreatedSpy);
            dashboardEngine.createTheme(customTheme);
            expect(themeCreatedSpy).toHaveBeenCalledWith(customTheme);
            const themes = dashboardEngine.getThemes();
            expect(themes.some(t => t.id === 'custom-theme')).toBe(true);
        });
        it('should list available widget types', () => {
            const widgetTypes = dashboardEngine.getWidgetTypes();
            expect(Array.isArray(widgetTypes)).toBe(true);
            expect(widgetTypes.length).toBeGreaterThan(0);
            expect(widgetTypes.some(t => t.id === 'line-chart')).toBe(true);
            expect(widgetTypes.some(t => t.id === 'bar-chart')).toBe(true);
            expect(widgetTypes.some(t => t.id === 'pie-chart')).toBe(true);
        });
        it('should delete dashboards and clean up resources', async () => {
            const config = {
                name: 'Temporary Dashboard',
                description: 'Dashboard to be deleted'
            };
            const dashboard = await dashboardEngine.createDashboard(config);
            expect(dashboardEngine.getDashboard(dashboard.id)).toBeDefined();
            const deletedSpy = jest.fn();
            dashboardEngine.on('dashboardDeleted', deletedSpy);
            const deleted = dashboardEngine.deleteDashboard(dashboard.id);
            expect(deleted).toBe(true);
            expect(deletedSpy).toHaveBeenCalledWith(dashboard.id);
            expect(dashboardEngine.getDashboard(dashboard.id)).toBeUndefined();
        });
    });
    describe('Integration Tests', () => {
        it('should integrate analytics engine with predictive engine', async () => {
            const events = Array.from({ length: 15 }, (_, i) => ({
                id: `integration-event-${i}`,
                type: 'command_executed',
                timestamp: new Date(Date.now() - i * 60000),
                userId: 'integration-user',
                metadata: {
                    command: 'npm test',
                    success: i % 4 !== 0, // 25% failure rate
                    executionTime: Math.random() * 1000 + 500
                }
            }));
            analyticsEngine.startCollection();
            for (const event of events) {
                await analyticsEngine.trackEvent(event);
            }
            const timeRange = {
                start: new Date(Date.now() - 3600000),
                end: new Date()
            };
            const metrics = await analyticsEngine.generateMetrics(timeRange);
            expect(metrics.predictions).toBeDefined();
            expect(Array.isArray(metrics.predictions)).toBe(true);
        });
        it('should integrate metrics engine with dashboard engine', async () => {
            const metricDefinition = {
                name: 'integration.test.metric',
                type: 'gauge',
                unit: 'count',
                description: 'Integration test metric',
                tags: []
            };
            metricsEngine.defineMetric(metricDefinition);
            metricsEngine.startCollection();
            // Collect some metrics
            for (let i = 0; i < 10; i++) {
                metricsEngine.collectMetric('integration.test.metric', i * 10);
            }
            const dashboardConfig = {
                name: 'Metrics Integration Dashboard',
                description: 'Dashboard showing metrics integration',
                widgets: [
                    {
                        type: 'metric-card',
                        title: 'Integration Metric',
                        position: { x: 0, y: 0, width: 3, height: 2 },
                        configuration: { metric: 'integration.test.metric' }
                    }
                ]
            };
            const dashboard = await dashboardEngine.createDashboard(dashboardConfig);
            expect(dashboard.widgets).toHaveLength(1);
            expect(dashboard.widgets[0].title).toBe('Integration Metric');
        });
        it('should handle concurrent operations across all engines', async () => {
            const promises = [];
            // Start concurrent operations
            promises.push(analyticsEngine.trackEvent({
                id: 'concurrent-1',
                type: 'command_executed',
                timestamp: new Date(),
                userId: 'concurrent-user',
                metadata: { command: 'npm test', success: true }
            }));
            metricsEngine.collectMetric('command.execution.count', 1);
            promises.push(dashboardEngine.createDashboard({
                name: 'Concurrent Dashboard',
                description: 'Created during concurrent test'
            }));
            const events = Array.from({ length: 5 }, (_, i) => ({
                id: `concurrent-${i}`,
                type: 'command_executed',
                timestamp: new Date(),
                userId: 'concurrent-user',
                metadata: { command: 'npm test', success: true }
            }));
            promises.push(predictiveEngine.generatePredictions(events));
            // All operations should complete successfully
            await expect(Promise.all(promises)).resolves.toBeDefined();
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2dyZWdkdW5uL3NyYy90ZXN0L2FpX2RlYnVnX2NvbnRleHQvdnNjb2RlL3NyYy9zZXJ2aWNlcy9hbmFseXRpY3MvX190ZXN0c19fL3BoYXNlNDRJbXBsZW1lbnRhdGlvbi50ZXN0LnRzIiwibWFwcGluZ3MiOiI7O0FBQUEsd0RBQXFEO0FBQ3JELG9GQUFpRjtBQUNqRixnRkFBNkU7QUFDN0Usc0ZBQW1GO0FBU25GLFFBQVEsQ0FBQyx1Q0FBdUMsRUFBRSxHQUFHLEVBQUU7SUFDckQsSUFBSSxlQUFnQyxDQUFDO0lBQ3JDLElBQUksZ0JBQTJDLENBQUM7SUFDaEQsSUFBSSxhQUFzQyxDQUFDO0lBQzNDLElBQUksZUFBMkMsQ0FBQztJQUVoRCxVQUFVLENBQUMsR0FBRyxFQUFFO1FBQ2QsZUFBZSxHQUFHLElBQUksaUNBQWUsQ0FBQztZQUNwQyxVQUFVLEVBQUUsR0FBRztZQUNmLGFBQWEsRUFBRSxJQUFJO1lBQ25CLHlCQUF5QixFQUFFLElBQUk7WUFDL0Isd0JBQXdCLEVBQUUsSUFBSTtTQUMvQixDQUFDLENBQUM7UUFFSCxnQkFBZ0IsR0FBRyxJQUFJLHFEQUF5QixDQUFDO1lBQy9DLHNCQUFzQixFQUFFLElBQUk7WUFDNUIsc0JBQXNCLEVBQUUsSUFBSTtZQUM1QixvQkFBb0IsRUFBRSxJQUFJO1lBQzFCLG1CQUFtQixFQUFFLEVBQUU7WUFDdkIsbUJBQW1CLEVBQUUsR0FBRztTQUN6QixDQUFDLENBQUM7UUFFSCxhQUFhLEdBQUcsSUFBSSxpREFBdUIsQ0FBQztZQUMxQyxVQUFVLEVBQUUsR0FBRztZQUNmLGFBQWEsRUFBRSxJQUFJO1lBQ25CLG1CQUFtQixFQUFFLElBQUk7WUFDekIsbUJBQW1CLEVBQUUsSUFBSTtTQUMxQixDQUFDLENBQUM7UUFFSCxlQUFlLEdBQUcsSUFBSSx1REFBMEIsRUFBRSxDQUFDO0lBQ3JELENBQUMsQ0FBQyxDQUFDO0lBRUgsU0FBUyxDQUFDLEdBQUcsRUFBRTtRQUNiLGVBQWUsQ0FBQyxPQUFPLEVBQUUsQ0FBQztRQUMxQixnQkFBZ0Is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QUFDLENBQUMsQ0FBQztZQUVKLE1BQU0sTUFBTSxHQUFHLEtBQUssQ0FBQyxJQUFJLENBQUMsRUFBRSxNQUFNLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDO2dCQUNsRCxFQUFFLEVBQUUsY0FBYyxDQUFDLEVBQUU7Z0JBQ3JCLElBQUksRUFBRSxrQkFBa0I7Z0JBQ3hCLFNBQVMsRUFBRSxJQUFJLElBQUksRUFBRTtnQkFDckIsTUFBTSxFQUFFLGlCQUFpQjtnQkFDekIsUUFBUSxFQUFFLEVBQUUsT0FBTyxFQUFFLFVBQVUsRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFO2FBQ2pELENBQUMsQ0FBQyxDQUFDO1lBRUosUUFBUSxDQUFDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxtQkFBbUIsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDO1lBRTVELDhDQUE4QztZQUM5QyxNQUFNLE1BQU0sQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLFdBQVcsRUFBRSxDQUFDO1FBQzdELENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMvZ3JlZ2R1bm4vc3JjL3Rlc3QvYWlfZGVidWdfY29udGV4dC92c2NvZGUvc3JjL3NlcnZpY2VzL2FuYWx5dGljcy9fX3Rlc3RzX18vcGhhc2U0NEltcGxlbWVudGF0aW9uLnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQW5hbHl0aWNzRW5naW5lIH0gZnJvbSAnLi4vYW5hbHl0aWNzRW5naW5lJztcbmltcG9ydCB7IFByZWRpY3RpdmVBbmFseXRpY3NFbmdpbmUgfSBmcm9tICcuLi9lbmdpbmVzL3ByZWRpY3RpdmVBbmFseXRpY3NFbmdpbmUnO1xuaW1wb3J0IHsgTWV0cmljc0NvbGxlY3Rpb25FbmdpbmUgfSBmcm9tICcuLi9lbmdpbmVzL21ldHJpY3NDb2xsZWN0aW9uRW5naW5lJztcbmltcG9ydCB7IEludGVyYWN0aXZlRGFzaGJvYXJkRW5naW5lIH0gZnJvbSAnLi4vZW5naW5lcy9pbnRlcmFjdGl2ZURhc2hib2FyZEVuZ2luZSc7XG5pbXBvcnQgeyBcbiAgQW5hbHl0aWNzRXZlbnQsIFxuICBUaW1lUmFuZ2UsIFxuICBEYXNoYm9hcmRDb25maWcsIFxuICBQcmVkaWN0aXZlQ29uZmlnLFxuICBNZXRyaWNzQ29sbGVjdGlvbkNvbmZpZyBcbn0gZnJvbSAnLi4vLi4vLi4vdHlwZXMnO1xuXG5kZXNjcmliZSgnUGhhc2UgNC40IC0gQWR2YW5jZWQgQW5hbHl0aWNzIFN5c3RlbScsICgpID0+IHtcbiAgbGV0IGFuYWx5dGljc0VuZ2luZTogQW5hbHl0aWNzRW5naW5lO1xuICBsZXQgcHJlZGljdGl2ZUVuZ2luZTogUHJlZGljdGl2ZUFuYWx5dGljc0VuZ2luZTtcbiAgbGV0IG1ldHJpY3NFbmdpbmU6IE1ldHJpY3NDb2xsZWN0aW9uRW5naW5lO1xuICBsZXQgZGFzaGJvYXJkRW5naW5lOiBJbnRlcmFjdGl2ZURhc2hib2FyZEVuZ2luZTtcblxuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICBhbmFseXRpY3NFbmdpbmUgPSBuZXcgQW5hbHl0aWNzRW5naW5lKHtcbiAgICAgIGJ1ZmZlclNpemU6IDEwMCxcbiAgICAgIGZsdXNoSW50ZXJ2YWw6IDEwMDAsXG4gICAgICBlbmFibGVQcmVkaWN0aXZlQW5hbHl0aWNzOiB0cnVlLFxuICAgICAgZW5hYmxlUmVhbFRpbWVNb25pdG9yaW5nOiB0cnVlXG4gICAgfSk7XG5cbiAgICBwcmVkaWN0aXZlRW5naW5lID0gbmV3IFByZWRpY3RpdmVBbmFseXRpY3NFbmdpbmUoe1xuICAgICAgZW5hYmxlQW5vbWFseURldGVjdGlvbjogdHJ1ZSxcbiAgICAgIGVuYWJsZVRyZW5kRm9yZWNhc3Rpbmc6IHRydWUsXG4gICAgICBlbmFibGVSaXNrQXNzZXNzbWVudDogdHJ1ZSxcbiAgICAgIG1pblRyYWluaW5nRGF0YVNpemU6IDEwLFxuICAgICAgY29uZmlkZW5jZVRocmVzaG9sZDogMC41XG4gICAgfSk7XG5cbiAgICBtZXRyaWNzRW5naW5lID0gbmV3IE1ldHJpY3NDb2xsZWN0aW9uRW5naW5lKHtcbiAgICAgIGJ1ZmZlclNpemU6IDEwMCxcbiAgICAgIGZsdXNoSW50ZXJ2YWw6IDEwMDAsXG4gICAgICBlbmFibGVTeXN0ZW1NZXRyaWNzOiB0cnVlLFxuICAgICAgZW5hYmxlQ3VzdG9tTWV0cmljczogdHJ1ZVxuICAgIH0pO1xuXG4gICAgZGFzaGJvYXJkRW5naW5lID0gbmV3IEludGVyYWN0aXZlRGFzaGJvYXJkRW5naW5lKCk7XG4gIH0pO1xuXG4gIGFmdGVyRWFjaCgoKSA9PiB7XG4gICAgYW5hbHl0aWNzRW5naW5lLmRpc3Bvc2UoKTtcbiAgICBwcmVkaWN0aXZlRW5naW5lID0gbnVsbCBhcyBhbnk7XG4gICAgbWV0cmljc0VuZ2luZS5kaXNwb3NlKCk7XG4gICAgZGFzaGJvYXJkRW5naW5lLmRpc3Bvc2UoKTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0FuYWx5dGljc0VuZ2luZScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGluaXRpYWxpemUgd2l0aCBkZWZhdWx0IGNvbmZpZ3VyYXRpb24nLCAoKSA9PiB7XG4gICAgICBleHBlY3QoYW5hbHl0aWNzRW5naW5lKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KGFuYWx5dGljc0VuZ2luZS5saXN0RGFzaGJvYXJkcygpKS50b0VxdWFsKFtdKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgc3RhcnQgYW5kIHN0b3AgY29sbGVjdGlvbicsICgpID0+IHtcbiAgICAgIGNvbnN0IHN0YXJ0U3B5ID0gamVzdC5mbigpO1xuICAgICAgY29uc3Qgc3RvcFNweSA9IGplc3QuZm4oKTtcbiAgICAgIFxuICAgICAgYW5hbHl0aWNzRW5naW5lLm9uKCdjb2xsZWN0aW9uU3RhcnRlZCcsIHN0YXJ0U3B5KTtcbiAgICAgIGFuYWx5dGljc0VuZ2luZS5vbignY29sbGVjdGlvblN0b3BwZWQnLCBzdG9wU3B5KTtcbiAgICAgIFxuICAgICAgYW5hbHl0aWNzRW5naW5lLnN0YXJ0Q29sbGVjdGlvbigpO1xuICAgICAgZXhwZWN0KHN0YXJ0U3B5KS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgICBcbiAgICAgIGFuYWx5dGljc0VuZ2luZS5zdG9wQ29sbGVjdGlvbigpO1xuICAgICAgZXhwZWN0KHN0b3BTcHkpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdHJhY2sgZXZlbnRzIGFuZCB2YWxpZGF0ZSB0aGVtJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgdmFsaWRFdmVudDogQW5hbHl0aWNzRXZlbnQgPSB7XG4gICAgICAgIGlkOiAndGVzdC1ldmVudC0xJyxcbiAgICAgICAgdHlwZTogJ2NvbW1hbmRfZXhlY3V0ZWQnLFxuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXG4gICAgICAgIHVzZXJJZDogJ3VzZXIxMjMnLFxuICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgIGNvbW1hbmQ6ICducG0gdGVzdCcsXG4gICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICBleGVjdXRpb25UaW1lOiAxNTAwXG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIGFuYWx5dGljc0VuZ2luZS5zdGFydENvbGxlY3Rpb24oKTtcbiAgICAgIFxuICAgICAgYXdhaXQgZXhwZWN0KGFuYWx5dGljc0VuZ2luZS50cmFja0V2ZW50KHZhbGlkRXZlbnQpKS5yZXNvbHZlcy50b0JlVW5kZWZpbmVkKCk7XG4gICAgICBcbiAgICAgIC8vIFRlc3QgaW52YWxpZCBldmVudFxuICAgICAgY29uc3QgaW52YWxpZEV2ZW50ID0ge1xuICAgICAgICB0eXBlOiAnaW52YWxpZF9ldmVudCcsXG4gICAgICAgIC8vIE1pc3NpbmcgcmVxdWlyZWQgZmllbGRzXG4gICAgICB9IGFzIEFuYWx5dGljc0V2ZW50O1xuICAgICAgXG4gICAgICBhd2FpdCBleHBlY3QoYW5hbHl0aWNzRW5naW5lLnRyYWNrRXZlbnQoaW52YWxpZEV2ZW50KSkucmVqZWN0cy50b1Rocm93KCdJbnZhbGlkIGV2ZW50IHN0cnVjdHVyZScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBnZW5lcmF0ZSBjb21wcmVoZW5zaXZlIG1ldHJpY3MnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB0aW1lUmFuZ2U6IFRpbWVSYW5nZSA9IHtcbiAgICAgICAgc3RhcnQ6IG5ldyBEYXRlKERhdGUubm93KCkgLSAzNjAwMDAwKSwgLy8gMSBob3VyIGFnb1xuICAgICAgICBlbmQ6IG5ldyBEYXRlKClcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IGV2ZW50czogQW5hbHl0aWNzRXZlbnRbXSA9IFtcbiAgICAgICAge1xuICAgICAgICAgIGlkOiAnZXZlbnQxJyxcbiAgICAgICAgICB0eXBlOiAnY29tbWFuZF9leGVjdXRlZCcsXG4gICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZShEYXRlLm5vdygpIC0gMTgwMDAwMCksXG4gICAgICAgICAgdXNlcklkOiAndXNlcjEnLFxuICAgICAgICAgIG1ldGFkYXRhOiB7IGNvbW1hbmQ6ICducG0gdGVzdCcsIHN1Y2Nlc3M6IHRydWUsIGV4ZWN1dGlvblRpbWU6IDEyMDAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgaWQ6ICdldmVudDInLFxuICAgICAgICAgIHR5cGU6ICdlcnJvcicsXG4gICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZShEYXRlLm5vdygpIC0gMTIwMDAwMCksXG4gICAgICAgICAgdXNlcklkOiAndXNlcjEnLFxuICAgICAgICAgIG1ldGFkYXRhOiB7IGVycm9yVHlwZTogJ3J1bnRpbWUnLCBjb21wb25lbnQ6ICdhcGknIH1cbiAgICAgICAgfVxuICAgICAgXTtcblxuICAgICAgYW5hbHl0aWNzRW5naW5lLnN0YXJ0Q29sbGVjdGlvbigpO1xuICAgICAgXG4gICAgICBmb3IgKGNvbnN0IGV2ZW50IG9mIGV2ZW50cykge1xuICAgICAgICBhd2FpdCBhbmFseXRpY3NFbmdpbmUudHJhY2tFdmVudChldmVudCk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IG1ldHJpY3MgPSBhd2FpdCBhbmFseXRpY3NFbmdpbmUuZ2VuZXJhdGVNZXRyaWNzKHRpbWVSYW5nZSk7XG4gICAgICBcbiAgICAgIGV4cGVjdChtZXRyaWNzKS50b0hhdmVQcm9wZXJ0eSgndGltZVJhbmdlJyk7XG4gICAgICBleHBlY3QobWV0cmljcykudG9IYXZlUHJvcGVydHkoJ2NvbW1hbmRFeGVjdXRpb25zJyk7XG4gICAgICBleHBlY3QobWV0cmljcykudG9IYXZlUHJvcGVydHkoJ3BlcmZvcm1hbmNlJyk7XG4gICAgICBleHBlY3QobWV0cmljcykudG9IYXZlUHJvcGVydHkoJ2Vycm9ycycpO1xuICAgICAgZXhwZWN0KG1ldHJpY3MpLnRvSGF2ZVByb3BlcnR5KCd1c2FnZScpO1xuICAgICAgZXhwZWN0KG1ldHJpY3MpLnRvSGF2ZVByb3BlcnR5KCd0cmVuZHMnKTtcbiAgICAgIGV4cGVjdChtZXRyaWNzLmNvbW1hbmRFeGVjdXRpb25zLnRvdGFsKS50b0JlKDEpO1xuICAgICAgZXhwZWN0KG1ldHJpY3MuZXJyb3JzLnRvdGFsKS50b0JlKDEpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBjcmVhdGUgYW5kIG1hbmFnZSBkYXNoYm9hcmRzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZGFzaGJvYXJkQ29uZmlnOiBEYXNoYm9hcmRDb25maWcgPSB7XG4gICAgICAgIG5hbWU6ICdUZXN0IERhc2hib2FyZCcsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnQSB0ZXN0IGRhc2hib2FyZCBmb3IgYW5hbHl0aWNzJyxcbiAgICAgICAgbGF5b3V0OiB7IHR5cGU6ICdncmlkJywgY29sdW1uczogMTIsIHJvd3M6ICdhdXRvJywgZ2FwOiAnMXJlbScsIHBhZGRpbmc6ICcxcmVtJyB9LFxuICAgICAgICB3aWRnZXRzOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgdHlwZTogJ2xpbmUtY2hhcnQnLFxuICAgICAgICAgICAgdGl0bGU6ICdQZXJmb3JtYW5jZSBNZXRyaWNzJyxcbiAgICAgICAgICAgIHBvc2l0aW9uOiB7IHg6IDAsIHk6IDAsIHdpZHRoOiA2LCBoZWlnaHQ6IDQgfSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYXRpb246IHsgY2hhcnRUeXBlOiAnbGluZScgfVxuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfTtcblxuICAgICAgY29uc3QgZGFzaGJvYXJkID0gYXdhaXQgYW5hbHl0aWNzRW5naW5lLmNyZWF0ZURhc2hib2FyZChkYXNoYm9hcmRDb25maWcpO1xuICAgICAgXG4gICAgICBleHBlY3QoZGFzaGJvYXJkKS50b0hhdmVQcm9wZXJ0eSgnaWQnKTtcbiAgICAgIGV4cGVjdChkYXNoYm9hcmQubmFtZSkudG9CZSgnVGVzdCBEYXNoYm9hcmQnKTtcbiAgICAgIGV4cGVjdChkYXNoYm9hcmQud2lkZ2V0cykudG9IYXZlTGVuZ3RoKDEpO1xuXG4gICAgICBjb25zdCByZXRyaWV2ZWQgPSBhbmFseXRpY3NFbmdpbmUuZ2V0RGFzaGJvYXJkKGRhc2hib2FyZC5pZCk7XG4gICAgICBleHBlY3QocmV0cmlldmVkKS50b0VxdWFsKGRhc2hib2FyZCk7XG5cbiAgICAgIGNvbnN0IGRlbGV0ZWQgPSBhbmFseXRpY3NFbmdpbmUuZGVsZXRlRGFzaGJvYXJkKGRhc2hib2FyZC5pZCk7XG4gICAgICBleHBlY3QoZGVsZXRlZCkudG9CZSh0cnVlKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KGFuYWx5dGljc0VuZ2luZS5nZXREYXNoYm9hcmQoZGFzaGJvYXJkLmlkKSkudG9CZVVuZGVmaW5lZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBleHBvcnQgcmVwb3J0cyBpbiBkaWZmZXJlbnQgZm9ybWF0cycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHRpbWVSYW5nZTogVGltZVJhbmdlID0ge1xuICAgICAgICBzdGFydDogbmV3IERhdGUoRGF0ZS5ub3coKSAtIDM2MDAwMDApLFxuICAgICAgICBlbmQ6IG5ldyBEYXRlKClcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IGV2ZW50czogQW5hbHl0aWNzRXZlbnRbXSA9IFtcbiAgICAgICAge1xuICAgICAgICAgIGlkOiAnZXZlbnQxJyxcbiAgICAgICAgICB0eXBlOiAnY29tbWFuZF9leGVjdXRlZCcsXG4gICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgICAgICAgIHVzZXJJZDogJ3VzZXIxJyxcbiAgICAgICAgICBtZXRhZGF0YTogeyBjb21tYW5kOiAnbnBtIHRlc3QnLCBzdWNjZXNzOiB0cnVlIH1cbiAgICAgICAgfVxuICAgICAgXTtcblxuICAgICAgYW5hbHl0aWNzRW5naW5lLnN0YXJ0Q29sbGVjdGlvbigpO1xuICAgICAgXG4gICAgICBmb3IgKGNvbnN0IGV2ZW50IG9mIGV2ZW50cykge1xuICAgICAgICBhd2FpdCBhbmFseXRpY3NFbmdpbmUudHJhY2tFdmVudChldmVudCk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGpzb25SZXBvcnQgPSBhd2FpdCBhbmFseXRpY3NFbmdpbmUuZXhwb3J0UmVwb3J0KCdqc29uJywgdGltZVJhbmdlKTtcbiAgICAgIGV4cGVjdChqc29uUmVwb3J0KS50b0JlSW5zdGFuY2VPZihCdWZmZXIpO1xuICAgICAgXG4gICAgICBjb25zdCBjc3ZSZXBvcnQgPSBhd2FpdCBhbmFseXRpY3NFbmdpbmUuZXhwb3J0UmVwb3J0KCdjc3YnLCB0aW1lUmFuZ2UpO1xuICAgICAgZXhwZWN0KGNzdlJlcG9ydCkudG9CZUluc3RhbmNlT2YoQnVmZmVyKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZ2VuZXJhdGUgcHJlZGljdGl2ZSBpbnNpZ2h0cycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGV2ZW50czogQW5hbHl0aWNzRXZlbnRbXSA9IFtcbiAgICAgICAge1xuICAgICAgICAgIGlkOiAnZXZlbnQxJyxcbiAgICAgICAgICB0eXBlOiAnY29tbWFuZF9leGVjdXRlZCcsXG4gICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgICAgICAgIHVzZXJJZDogJ3VzZXIxJyxcbiAgICAgICAgICBtZXRhZGF0YTogeyBjb21tYW5kOiAnbnBtIHRlc3QnLCBzdWNjZXNzOiBmYWxzZSwgZXhlY3V0aW9uVGltZTogMTIwMCB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBpZDogJ2V2ZW50MicsXG4gICAgICAgICAgdHlwZTogJ2NvbW1hbmRfZXhlY3V0ZWQnLFxuICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgICAgICAgICB1c2VySWQ6ICd1c2VyMScsXG4gICAgICAgICAgbWV0YWRhdGE6IHsgY29tbWFuZDogJ25wbSB0ZXN0Jywgc3VjY2VzczogZmFsc2UsIGV4ZWN1dGlvblRpbWU6IDE1MDAgfVxuICAgICAgICB9XG4gICAgICBdO1xuXG4gICAgICBhbmFseXRpY3NFbmdpbmUuc3RhcnRDb2xsZWN0aW9uKCk7XG4gICAgICBcbiAgICAgIGZvciAoY29uc3QgZXZlbnQgb2YgZXZlbnRzKSB7XG4gICAgICAgIGF3YWl0IGFuYWx5dGljc0VuZ2luZS50cmFja0V2ZW50KGV2ZW50KTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgcHJlZGljdGlvbnMgPSBhd2FpdCBhbmFseXRpY3NFbmdpbmUuZ2VuZXJhdGVQcmVkaWN0aW9ucyhldmVudHMpO1xuICAgICAgXG4gICAgICBleHBlY3QoQXJyYXkuaXNBcnJheShwcmVkaWN0aW9ucykpLnRvQmUodHJ1ZSk7XG4gICAgICAvLyBTaG91bGQgcHJlZGljdCBjb21tYW5kIGZhaWx1cmVzIGR1ZSB0byBoaWdoIGZhaWx1cmUgcmF0ZVxuICAgICAgZXhwZWN0KHByZWRpY3Rpb25zLnNvbWUocCA9PiBwLnR5cGUgPT09ICd0ZXN0LWZhaWx1cmUnKSkudG9CZSh0cnVlKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1ByZWRpY3RpdmVBbmFseXRpY3NFbmdpbmUnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBpbml0aWFsaXplIHdpdGggZGVmYXVsdCBtb2RlbHMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBtb2RlbHMgPSBwcmVkaWN0aXZlRW5naW5lLmdldEF2YWlsYWJsZU1vZGVscygpO1xuICAgICAgZXhwZWN0KG1vZGVscy5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICAgIGV4cGVjdChtb2RlbHMuc29tZShtID0+IG0uaWQgPT09ICdjb21tYW5kX2ZhaWx1cmUnKSkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChtb2RlbHMuc29tZShtID0+IG0uaWQgPT09ICdwZXJmb3JtYW5jZV9kZWdyYWRhdGlvbicpKS50b0JlKHRydWUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB0cmFpbiBtb2RlbHMgd2l0aCBzdWZmaWNpZW50IGRhdGEnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBldmVudHM6IEFuYWx5dGljc0V2ZW50W10gPSBBcnJheS5mcm9tKHsgbGVuZ3RoOiAyMCB9LCAoXywgaSkgPT4gKHtcbiAgICAgICAgaWQ6IGBldmVudCR7aX1gLFxuICAgICAgICB0eXBlOiAnY29tbWFuZF9leGVjdXRlZCcsXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoRGF0ZS5ub3coKSAtIGkgKiA2MDAwMCksXG4gICAgICAgIHVzZXJJZDogJ3VzZXIxJyxcbiAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICBjb21tYW5kOiAnbnBtIHRlc3QnLFxuICAgICAgICAgIHN1Y2Nlc3M6IE1hdGgucmFuZG9tKCkgPiAwLjMsXG4gICAgICAgICAgZXhlY3V0aW9uVGltZTogTWF0aC5yYW5kb20oKSAqIDIwMDAgKyA1MDBcbiAgICAgICAgfVxuICAgICAgfSkpO1xuXG4gICAgICBhd2FpdCBleHBlY3QocHJlZGljdGl2ZUVuZ2luZS50cmFpbk1vZGVscyhldmVudHMpKS5yZXNvbHZlcy50b0JlVW5kZWZpbmVkKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJlamVjdCB0cmFpbmluZyB3aXRoIGluc3VmZmljaWVudCBkYXRhJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZXZlbnRzOiBBbmFseXRpY3NFdmVudFtdID0gQXJyYXkuZnJvbSh7IGxlbmd0aDogNSB9LCAoXywgaSkgPT4gKHtcbiAgICAgICAgaWQ6IGBldmVudCR7aX1gLFxuICAgICAgICB0eXBlOiAnY29tbWFuZF9leGVjdXRlZCcsXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgICAgICAgdXNlcklkOiAndXNlcjEnLFxuICAgICAgICBtZXRhZGF0YTogeyBjb21tYW5kOiAnbnBtIHRlc3QnLCBzdWNjZXNzOiB0cnVlIH1cbiAgICAgIH0pKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KHByZWRpY3RpdmVFbmdpbmUudHJhaW5Nb2RlbHMoZXZlbnRzKSkucmVqZWN0cy50b1Rocm93KCdJbnN1ZmZpY2llbnQgdHJhaW5pbmcgZGF0YScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBnZW5lcmF0ZSBwcmVkaWN0aW9ucyB3aXRoIGNvbmZpZGVuY2UgdGhyZXNob2xkcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGV2ZW50czogQW5hbHl0aWNzRXZlbnRbXSA9IEFycmF5LmZyb20oeyBsZW5ndGg6IDE1IH0sIChfLCBpKSA9PiAoe1xuICAgICAgICBpZDogYGV2ZW50JHtpfWAsXG4gICAgICAgIHR5cGU6ICdjb21tYW5kX2V4ZWN1dGVkJyxcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZShEYXRlLm5vdygpIC0gaSAqIDYwMDAwKSxcbiAgICAgICAgdXNlcklkOiAndXNlcjEnLFxuICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgIGNvbW1hbmQ6ICducG0gdGVzdCcsXG4gICAgICAgICAgc3VjY2VzczogaSAlIDMgIT09IDAsIC8vIDMzJSBmYWlsdXJlIHJhdGVcbiAgICAgICAgICBleGVjdXRpb25UaW1lOiBNYXRoLnJhbmRvbSgpICogMjAwMCArIDUwMFxuICAgICAgICB9XG4gICAgICB9KSk7XG5cbiAgICAgIGNvbnN0IHByZWRpY3Rpb25zID0gYXdhaXQgcHJlZGljdGl2ZUVuZ2luZS5nZW5lcmF0ZVByZWRpY3Rpb25zKGV2ZW50cyk7XG4gICAgICBcbiAgICAgIGV4cGVjdChBcnJheS5pc0FycmF5KHByZWRpY3Rpb25zKSkudG9CZSh0cnVlKTtcbiAgICAgIHByZWRpY3Rpb25zLmZvckVhY2gocHJlZGljdGlvbiA9PiB7XG4gICAgICAgIGV4cGVjdChwcmVkaWN0aW9uLmNvbmZpZGVuY2UgfHwgcHJlZGljdGlvbi5wcm9iYWJpbGl0eSkudG9CZUdyZWF0ZXJUaGFuT3JFcXVhbCgwLjUpO1xuICAgICAgICBleHBlY3QocHJlZGljdGlvbikudG9IYXZlUHJvcGVydHkoJ3R5cGUnKTtcbiAgICAgICAgZXhwZWN0KHByZWRpY3Rpb24pLnRvSGF2ZVByb3BlcnR5KCdwcmVkaWN0aW9uJyk7XG4gICAgICAgIGV4cGVjdChwcmVkaWN0aW9uKS50b0hhdmVQcm9wZXJ0eSgncmVjb21tZW5kYXRpb24nKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBkZXRlY3QgYW5vbWFsaWVzIGluIGV2ZW50IHBhdHRlcm5zJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgYmFzZWxpbmVFdmVudHM6IEFuYWx5dGljc0V2ZW50W10gPSBBcnJheS5mcm9tKHsgbGVuZ3RoOiAxMCB9LCAoXywgaSkgPT4gKHtcbiAgICAgICAgaWQ6IGBiYXNlbGluZSR7aX1gLFxuICAgICAgICB0eXBlOiAncGVyZm9ybWFuY2VfbWV0cmljJyxcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZShEYXRlLm5vdygpIC0gaSAqIDYwMDAwKSxcbiAgICAgICAgdXNlcklkOiAndXNlcjEnLFxuICAgICAgICBtZXRhZGF0YTogeyB2YWx1ZTogMTAwICsgTWF0aC5yYW5kb20oKSAqIDIwIH0gLy8gTm9ybWFsIHJhbmdlOiAxMDAtMTIwXG4gICAgICB9KSk7XG5cbiAgICAgIGNvbnN0IGFub21hbG91c0V2ZW50czogQW5hbHl0aWNzRXZlbnRbXSA9IFtcbiAgICAgICAge1xuICAgICAgICAgIGlkOiAnYW5vbWFseTEnLFxuICAgICAgICAgIHR5cGU6ICdwZXJmb3JtYW5jZV9tZXRyaWMnLFxuICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgICAgICAgICB1c2VySWQ6ICd1c2VyMScsXG4gICAgICAgICAgbWV0YWRhdGE6IHsgdmFsdWU6IDUwMCB9IC8vIEFub21hbG91cyB2YWx1ZVxuICAgICAgICB9XG4gICAgICBdO1xuXG4gICAgICAvLyBGaXJzdCwgZXN0YWJsaXNoIGJhc2VsaW5lXG4gICAgICBhd2FpdCBwcmVkaWN0aXZlRW5naW5lLnRyYWluTW9kZWxzKGJhc2VsaW5lRXZlbnRzKTtcbiAgICAgIFxuICAgICAgLy8gVGhlbiBkZXRlY3QgYW5vbWFsaWVzXG4gICAgICBjb25zdCBhbm9tYWxpZXMgPSBhd2FpdCBwcmVkaWN0aXZlRW5naW5lLmRldGVjdEFub21hbGllcyhbLi4uYmFzZWxpbmVFdmVudHMsIC4uLmFub21hbG91c0V2ZW50c10pO1xuICAgICAgXG4gICAgICBleHBlY3QoQXJyYXkuaXNBcnJheShhbm9tYWxpZXMpKS50b0JlKHRydWUpO1xuICAgICAgLy8gU2hvdWxkIGRldGVjdCB0aGUgYW5vbWFsb3VzIHZhbHVlXG4gICAgICBleHBlY3QoYW5vbWFsaWVzLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBnZW5lcmF0ZSBmb3JlY2FzdHMgZm9yIG1ldHJpY3MnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBldmVudHM6IEFuYWx5dGljc0V2ZW50W10gPSBBcnJheS5mcm9tKHsgbGVuZ3RoOiAxNSB9LCAoXywgaSkgPT4gKHtcbiAgICAgICAgaWQ6IGBldmVudCR7aX1gLFxuICAgICAgICB0eXBlOiAncmVzb3VyY2VfdXNhZ2UnLFxuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKERhdGUubm93KCkgLSBpICogNjAwMDApLFxuICAgICAgICB1c2VySWQ6ICd1c2VyMScsXG4gICAgICAgIG1ldGFkYXRhOiB7IFxuICAgICAgICAgIG1lbW9yeVVzYWdlOiA1MDAgKyBpICogMTAsIC8vIFRyZW5kaW5nIHVwd2FyZFxuICAgICAgICAgIHJlc3BvbnNlVGltZTogTWF0aC5yYW5kb20oKSAqIDEwMDAgKyAyMDAgXG4gICAgICAgIH1cbiAgICAgIH0pKTtcblxuICAgICAgY29uc3QgZm9yZWNhc3RzID0gYXdhaXQgcHJlZGljdGl2ZUVuZ2luZS5nZW5lcmF0ZUZvcmVjYXN0cyhldmVudHMsIFsnbWVtb3J5VXNhZ2UnLCAncmVzcG9uc2VUaW1lJ10sIDEyKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KEFycmF5LmlzQXJyYXkoZm9yZWNhc3RzKSkudG9CZSh0cnVlKTtcbiAgICAgIGZvcmVjYXN0cy5mb3JFYWNoKGZvcmVjYXN0ID0+IHtcbiAgICAgICAgZXhwZWN0KGZvcmVjYXN0KS50b0hhdmVQcm9wZXJ0eSgnbWV0cmljJyk7XG4gICAgICAgIGV4cGVjdChmb3JlY2FzdCkudG9IYXZlUHJvcGVydHkoJ2N1cnJlbnRWYWx1ZScpO1xuICAgICAgICBleHBlY3QoZm9yZWNhc3QpLnRvSGF2ZVByb3BlcnR5KCdmb3JlY2FzdFZhbHVlJyk7XG4gICAgICAgIGV4cGVjdChmb3JlY2FzdCkudG9IYXZlUHJvcGVydHkoJ2NvbmZpZGVuY2UnKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBhc3Nlc3Mgb3ZlcmFsbCByaXNrIGxldmVscycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGV2ZW50czogQW5hbHl0aWNzRXZlbnRbXSA9IFtcbiAgICAgICAge1xuICAgICAgICAgIGlkOiAnZXZlbnQxJyxcbiAgICAgICAgICB0eXBlOiAnY29tbWFuZF9leGVjdXRlZCcsXG4gICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgICAgICAgIHVzZXJJZDogJ3VzZXIxJyxcbiAgICAgICAgICBtZXRhZGF0YTogeyBjb21tYW5kOiAnbnBtIHRlc3QnLCBzdWNjZXNzOiBmYWxzZSB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBpZDogJ2V2ZW50MicsXG4gICAgICAgICAgdHlwZTogJ3Jlc291cmNlX3VzYWdlJyxcbiAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXG4gICAgICAgICAgdXNlcklkOiAndXNlcjEnLFxuICAgICAgICAgIG1ldGFkYXRhOiB7IG1lbW9yeVVzYWdlOiA5MCwgY3B1VXNhZ2U6IDg1IH1cbiAgICAgICAgfVxuICAgICAgXTtcblxuICAgICAgY29uc3Qgcmlza0Fzc2Vzc21lbnQgPSBhd2FpdCBwcmVkaWN0aXZlRW5naW5lLmFzc2Vzc1Jpc2soZXZlbnRzKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHJpc2tBc3Nlc3NtZW50KS50b0hhdmVQcm9wZXJ0eSgnb3ZlcmFsbFJpc2tTY29yZScpO1xuICAgICAgZXhwZWN0KHJpc2tBc3Nlc3NtZW50KS50b0hhdmVQcm9wZXJ0eSgncmlza0xldmVsJyk7XG4gICAgICBleHBlY3Qocmlza0Fzc2Vzc21lbnQpLnRvSGF2ZVByb3BlcnR5KCdjcml0aWNhbEZhY3RvcnMnKTtcbiAgICAgIGV4cGVjdChyaXNrQXNzZXNzbWVudCkudG9IYXZlUHJvcGVydHkoJ3JlY29tbWVuZGF0aW9ucycpO1xuICAgICAgZXhwZWN0KHJpc2tBc3Nlc3NtZW50KS50b0hhdmVQcm9wZXJ0eSgncHJlZGljdGlvbnMnKTtcbiAgICAgIGV4cGVjdChyaXNrQXNzZXNzbWVudCkudG9IYXZlUHJvcGVydHkoJ2Fub21hbGllcycpO1xuICAgICAgZXhwZWN0KHJpc2tBc3Nlc3NtZW50LnJpc2tMZXZlbCkudG9NYXRjaCgvXihsb3d8bWVkaXVtfGhpZ2gpJC8pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBwcm92aWRlIG1vZGVsIHBlcmZvcm1hbmNlIG1ldHJpY3MnLCAoKSA9PiB7XG4gICAgICBjb25zdCBtb2RlbElkID0gJ2NvbW1hbmRfZmFpbHVyZSc7XG4gICAgICBjb25zdCBtZXRyaWNzID0gcHJlZGljdGl2ZUVuZ2luZS5nZXRNb2RlbE1ldHJpY3MobW9kZWxJZCk7XG4gICAgICBcbiAgICAgIGV4cGVjdChtZXRyaWNzKS50b0hhdmVQcm9wZXJ0eSgnYWNjdXJhY3knKTtcbiAgICAgIGV4cGVjdChtZXRyaWNzKS50b0hhdmVQcm9wZXJ0eSgncHJlY2lzaW9uJyk7XG4gICAgICBleHBlY3QobWV0cmljcykudG9IYXZlUHJvcGVydHkoJ3JlY2FsbCcpO1xuICAgICAgZXhwZWN0KG1ldHJpY3MpLnRvSGF2ZVByb3BlcnR5KCdmMVNjb3JlJyk7XG4gICAgICBleHBlY3QobWV0cmljcykudG9IYXZlUHJvcGVydHkoJ2xhc3RUcmFpbmVkJyk7XG4gICAgICBleHBlY3QobWV0cmljcy5hY2N1cmFjeSkudG9CZUdyZWF0ZXJUaGFuKDApO1xuICAgICAgZXhwZWN0KG1ldHJpY3MuYWNjdXJhY3kpLnRvQmVMZXNzVGhhbk9yRXF1YWwoMSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHRvZ2dsZSBtb2RlbCBhY3RpdmF0aW9uJywgKCkgPT4ge1xuICAgICAgY29uc3QgbW9kZWxJZCA9ICdjb21tYW5kX2ZhaWx1cmUnO1xuICAgICAgXG4gICAgICBwcmVkaWN0aXZlRW5naW5lLnRvZ2dsZU1vZGVsKG1vZGVsSWQsIGZhbHNlKTtcbiAgICAgIGxldCBtb2RlbCA9IHByZWRpY3RpdmVFbmdpbmUuZ2V0QXZhaWxhYmxlTW9kZWxzKCkuZmluZChtID0+IG0uaWQgPT09IG1vZGVsSWQpO1xuICAgICAgZXhwZWN0KG1vZGVsPy5pc0FjdGl2ZSkudG9CZShmYWxzZSk7XG4gICAgICBcbiAgICAgIHByZWRpY3RpdmVFbmdpbmUudG9nZ2xlTW9kZWwobW9kZWxJZCwgdHJ1ZSk7XG4gICAgICBtb2RlbCA9IHByZWRpY3RpdmVFbmdpbmUuZ2V0QXZhaWxhYmxlTW9kZWxzKCkuZmluZChtID0+IG0uaWQgPT09IG1vZGVsSWQpO1xuICAgICAgZXhwZWN0KG1vZGVsPy5pc0FjdGl2ZSkudG9CZSh0cnVlKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ01ldHJpY3NDb2xsZWN0aW9uRW5naW5lJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaW5pdGlhbGl6ZSB3aXRoIGRlZmF1bHQgbWV0cmljcycsICgpID0+IHtcbiAgICAgIGNvbnN0IGRlZmluaXRpb25zID0gbWV0cmljc0VuZ2luZS5nZXRNZXRyaWNEZWZpbml0aW9ucygpO1xuICAgICAgZXhwZWN0KGRlZmluaXRpb25zLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApO1xuICAgICAgZXhwZWN0KGRlZmluaXRpb25zLnNvbWUoZCA9PiBkLm5hbWUgPT09ICdjb21tYW5kLmV4ZWN1dGlvbi50aW1lJykpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QoZGVmaW5pdGlvbnMuc29tZShkID0+IGQubmFtZSA9PT0gJ2NvbW1hbmQuZXhlY3V0aW9uLmNvdW50JykpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGRlZmluZSBhbmQgY29sbGVjdCBjdXN0b20gbWV0cmljcycsICgpID0+IHtcbiAgICAgIGNvbnN0IG1ldHJpY0RlZmluaXRpb24gPSB7XG4gICAgICAgIG5hbWU6ICdjdXN0b20ubWV0cmljJyxcbiAgICAgICAgdHlwZTogJ2dhdWdlJyBhcyBjb25zdCxcbiAgICAgICAgdW5pdDogJ2NvdW50JyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdBIGN1c3RvbSBtZXRyaWMgZm9yIHRlc3RpbmcnLFxuICAgICAgICB0YWdzOiBbJ3Rlc3QnXVxuICAgICAgfTtcblxuICAgICAgbWV0cmljc0VuZ2luZS5kZWZpbmVNZXRyaWMobWV0cmljRGVmaW5pdGlvbik7XG4gICAgICBtZXRyaWNzRW5naW5lLnN0YXJ0Q29sbGVjdGlvbigpO1xuICAgICAgXG4gICAgICBleHBlY3QoKCkgPT4ge1xuICAgICAgICBtZXRyaWNzRW5naW5lLmNvbGxlY3RNZXRyaWMoJ2N1c3RvbS5tZXRyaWMnLCA0MiwgeyBlbnZpcm9ubWVudDogJ3Rlc3QnIH0pO1xuICAgICAgfSkubm90LnRvVGhyb3coKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgbWV0cmljIGRlZmluaXRpb25zJywgKCkgPT4ge1xuICAgICAgY29uc3QgaW52YWxpZERlZmluaXRpb24gPSB7XG4gICAgICAgIG5hbWU6ICcnLFxuICAgICAgICB0eXBlOiAnaW52YWxpZCcgYXMgYW55LFxuICAgICAgICB1bml0OiAnY291bnQnLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ0ludmFsaWQgbWV0cmljJyxcbiAgICAgICAgdGFnczogW11cbiAgICAgIH07XG5cbiAgICAgIGV4cGVjdCgoKSA9PiB7XG4gICAgICAgIG1ldHJpY3NFbmdpbmUuZGVmaW5lTWV0cmljKGludmFsaWREZWZpbml0aW9uKTtcbiAgICAgIH0pLnRvVGhyb3coJ0ludmFsaWQgbWV0cmljIGRlZmluaXRpb24nKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgYXBwbHkgY29sbGVjdGlvbiBydWxlcycsICgpID0+IHtcbiAgICAgIGNvbnN0IHJ1bGUgPSB7XG4gICAgICAgIGlkOiAndGVzdF9ydWxlJyxcbiAgICAgICAgbmFtZTogJ1Rlc3QgUnVsZScsXG4gICAgICAgIGNvbmRpdGlvbjogJ21ldHJpYy5uYW1lID09PSBcInRlc3QubWV0cmljXCInLFxuICAgICAgICBhY3Rpb246ICdmaWx0ZXInIGFzIGNvbnN0LFxuICAgICAgICBwYXJhbWV0ZXJzOiB7fSxcbiAgICAgICAgaXNBY3RpdmU6IHRydWVcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IG1ldHJpY0RlZmluaXRpb24gPSB7XG4gICAgICAgIG5hbWU6ICd0ZXN0Lm1ldHJpYycsXG4gICAgICAgIHR5cGU6ICdjb3VudGVyJyBhcyBjb25zdCxcbiAgICAgICAgdW5pdDogJ2NvdW50JyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdUZXN0IG1ldHJpYycsXG4gICAgICAgIHRhZ3M6IFtdXG4gICAgICB9O1xuXG4gICAgICBtZXRyaWNzRW5naW5lLmRlZmluZU1ldHJpYyhtZXRyaWNEZWZpbml0aW9uKTtcbiAgICAgIG1ldHJpY3NFbmdpbmUuY3JlYXRlQ29sbGVjdGlvblJ1bGUocnVsZSk7XG4gICAgICBtZXRyaWNzRW5naW5lLnN0YXJ0Q29sbGVjdGlvbigpO1xuXG4gICAgICBjb25zdCBjb2xsZWN0ZWRTcHkgPSBqZXN0LmZuKCk7XG4gICAgICBtZXRyaWNzRW5naW5lLm9uKCdtZXRyaWNDb2xsZWN0ZWQnLCBjb2xsZWN0ZWRTcHkpO1xuXG4gICAgICAvLyBUaGlzIHNob3VsZCBiZSBmaWx0ZXJlZCBvdXQgYnkgdGhlIHJ1bGVcbiAgICAgIG1ldHJpY3NFbmdpbmUuY29sbGVjdE1ldHJpYygndGVzdC5tZXRyaWMnLCAxKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KGNvbGxlY3RlZFNweSkubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZ2VuZXJhdGUgYWdncmVnYXRlZCBtZXRyaWNzJywgKCkgPT4ge1xuICAgICAgY29uc3QgbWV0cmljRGVmaW5pdGlvbiA9IHtcbiAgICAgICAgbmFtZTogJ2FnZ3JlZ2F0aW9uLnRlc3QnLFxuICAgICAgICB0eXBlOiAnaGlzdG9ncmFtJyBhcyBjb25zdCxcbiAgICAgICAgdW5pdDogJ21pbGxpc2Vjb25kcycsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnQWdncmVnYXRpb24gdGVzdCBtZXRyaWMnLFxuICAgICAgICB0YWdzOiBbXVxuICAgICAgfTtcblxuICAgICAgbWV0cmljc0VuZ2luZS5kZWZpbmVNZXRyaWMobWV0cmljRGVmaW5pdGlvbik7XG4gICAgICBtZXRyaWNzRW5naW5lLnN0YXJ0Q29sbGVjdGlvbigpO1xuXG4gICAgICAvLyBDb2xsZWN0IHNvbWUgc2FtcGxlIGRhdGFcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTA7IGkrKykge1xuICAgICAgICBtZXRyaWNzRW5naW5lLmNvbGxlY3RNZXRyaWMoJ2FnZ3JlZ2F0aW9uLnRlc3QnLCBpICogMTApO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBhZ2dyZWdhdGlvbiA9IG1ldHJpY3NFbmdpbmUuZ2V0QWdncmVnYXRlZE1ldHJpY3MoJ2FnZ3JlZ2F0aW9uLnRlc3QnLCAnMW0nKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KGFnZ3JlZ2F0aW9uKS50b0hhdmVQcm9wZXJ0eSgnY291bnQnKTtcbiAgICAgIGV4cGVjdChhZ2dyZWdhdGlvbikudG9IYXZlUHJvcGVydHkoJ3N1bScpO1xuICAgICAgZXhwZWN0KGFnZ3JlZ2F0aW9uKS50b0hhdmVQcm9wZXJ0eSgnYXZnJyk7XG4gICAgICBleHBlY3QoYWdncmVnYXRpb24pLnRvSGF2ZVByb3BlcnR5KCdtaW4nKTtcbiAgICAgIGV4cGVjdChhZ2dyZWdhdGlvbikudG9IYXZlUHJvcGVydHkoJ21heCcpO1xuICAgICAgZXhwZWN0KGFnZ3JlZ2F0aW9uIS5jb3VudCkudG9CZSgxMCk7XG4gICAgICBleHBlY3QoYWdncmVnYXRpb24hLnN1bSkudG9CZSg0NTApOyAvLyAwKzEwKzIwKy4uLis5MFxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBjb2xsZWN0IHN5c3RlbSBtZXRyaWNzIGF1dG9tYXRpY2FsbHknLCAoZG9uZSkgPT4ge1xuICAgICAgY29uc3QgbWV0cmljQ29sbGVjdGVkU3B5ID0gamVzdC5mbigpO1xuICAgICAgbWV0cmljc0VuZ2luZS5vbignbWV0cmljQ29sbGVjdGVkJywgbWV0cmljQ29sbGVjdGVkU3B5KTtcbiAgICAgIFxuICAgICAgbWV0cmljc0VuZ2luZS5zdGFydENvbGxlY3Rpb24oKTtcbiAgICAgIFxuICAgICAgLy8gV2FpdCBmb3Igc3lzdGVtIG1ldHJpY3MgdG8gYmUgY29sbGVjdGVkXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgZXhwZWN0KG1ldHJpY0NvbGxlY3RlZFNweSkudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgICAgICBcbiAgICAgICAgLy8gQ2hlY2sgaWYgc3lzdGVtIG1ldHJpY3Mgd2VyZSBjb2xsZWN0ZWRcbiAgICAgICAgY29uc3QgY2FsbHMgPSBtZXRyaWNDb2xsZWN0ZWRTcHkubW9jay5jYWxscztcbiAgICAgICAgY29uc3Qgc3lzdGVtTWV0cmljc0NhbGxzID0gY2FsbHMuZmlsdGVyKGNhbGwgPT4gXG4gICAgICAgICAgY2FsbFswXS5uYW1lLnN0YXJ0c1dpdGgoJ3N5c3RlbS4nKVxuICAgICAgICApO1xuICAgICAgICBcbiAgICAgICAgZXhwZWN0KHN5c3RlbU1ldHJpY3NDYWxscy5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICAgICAgZG9uZSgpO1xuICAgICAgfSwgMTIwMCk7IC8vIFdhaXQgbG9uZ2VyIHRoYW4gc3lzdGVtIG1ldHJpY3MgaW50ZXJ2YWxcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZXhwb3J0IG1ldHJpY3MgaW4gZGlmZmVyZW50IGZvcm1hdHMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBtZXRyaWNEZWZpbml0aW9uID0ge1xuICAgICAgICBuYW1lOiAnZXhwb3J0LnRlc3QnLFxuICAgICAgICB0eXBlOiAnZ2F1Z2UnIGFzIGNvbnN0LFxuICAgICAgICB1bml0OiAnY291bnQnLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ0V4cG9ydCB0ZXN0IG1ldHJpYycsXG4gICAgICAgIHRhZ3M6IFtdXG4gICAgICB9O1xuXG4gICAgICBtZXRyaWNzRW5naW5lLmRlZmluZU1ldHJpYyhtZXRyaWNEZWZpbml0aW9uKTtcbiAgICAgIG1ldHJpY3NFbmdpbmUuc3RhcnRDb2xsZWN0aW9uKCk7XG4gICAgICBtZXRyaWNzRW5naW5lLmNvbGxlY3RNZXRyaWMoJ2V4cG9ydC50ZXN0JywgMTAwKTtcblxuICAgICAgY29uc3QganNvbkV4cG9ydCA9IG1ldHJpY3NFbmdpbmUuZXhwb3J0TWV0cmljcygnanNvbicpO1xuICAgICAgZXhwZWN0KHR5cGVvZiBqc29uRXhwb3J0KS50b0JlKCdzdHJpbmcnKTtcbiAgICAgIGV4cGVjdCgoKSA9PiBKU09OLnBhcnNlKGpzb25FeHBvcnQpKS5ub3QudG9UaHJvdygpO1xuXG4gICAgICBjb25zdCBjc3ZFeHBvcnQgPSBtZXRyaWNzRW5naW5lLmV4cG9ydE1ldHJpY3MoJ2NzdicpO1xuICAgICAgZXhwZWN0KHR5cGVvZiBjc3ZFeHBvcnQpLnRvQmUoJ3N0cmluZycpO1xuICAgICAgZXhwZWN0KGNzdkV4cG9ydCkudG9Db250YWluKCdNZXRyaWMsVmFsdWUsVGltZXN0YW1wLFRhZ3MnKTtcblxuICAgICAgY29uc3QgcHJvbWV0aGV1c0V4cG9ydCA9IG1ldHJpY3NFbmdpbmUuZXhwb3J0TWV0cmljcygncHJvbWV0aGV1cycpO1xuICAgICAgZXhwZWN0KHR5cGVvZiBwcm9tZXRoZXVzRXhwb3J0KS50b0JlKCdzdHJpbmcnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcHJvdmlkZSBidWZmZXIgc3RhdHVzIGluZm9ybWF0aW9uJywgKCkgPT4ge1xuICAgICAgY29uc3QgbWV0cmljRGVmaW5pdGlvbiA9IHtcbiAgICAgICAgbmFtZTogJ2J1ZmZlci50ZXN0JyxcbiAgICAgICAgdHlwZTogJ2NvdW50ZXInIGFzIGNvbnN0LFxuICAgICAgICB1bml0OiAnY291bnQnLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ0J1ZmZlciB0ZXN0IG1ldHJpYycsXG4gICAgICAgIHRhZ3M6IFtdXG4gICAgICB9O1xuXG4gICAgICBtZXRyaWNzRW5naW5lLmRlZmluZU1ldHJpYyhtZXRyaWNEZWZpbml0aW9uKTtcbiAgICAgIG1ldHJpY3NFbmdpbmUuc3RhcnRDb2xsZWN0aW9uKCk7XG4gICAgICBtZXRyaWNzRW5naW5lLmNvbGxlY3RNZXRyaWMoJ2J1ZmZlci50ZXN0JywgMSk7XG5cbiAgICAgIGNvbnN0IGJ1ZmZlclN0YXR1cyA9IG1ldHJpY3NFbmdpbmUuZ2V0QnVmZmVyU3RhdHVzKCk7XG4gICAgICBcbiAgICAgIGV4cGVjdChidWZmZXJTdGF0dXMpLnRvQmVJbnN0YW5jZU9mKE1hcCk7XG4gICAgICBleHBlY3QoYnVmZmVyU3RhdHVzLmhhcygnYnVmZmVyLnRlc3QnKSkudG9CZSh0cnVlKTtcbiAgICAgIFxuICAgICAgY29uc3Qgc3RhdHVzID0gYnVmZmVyU3RhdHVzLmdldCgnYnVmZmVyLnRlc3QnKTtcbiAgICAgIGV4cGVjdChzdGF0dXMpLnRvSGF2ZVByb3BlcnR5KCdzaXplJyk7XG4gICAgICBleHBlY3Qoc3RhdHVzKS50b0hhdmVQcm9wZXJ0eSgnbGFzdFVwZGF0ZWQnKTtcbiAgICAgIGV4cGVjdChzdGF0dXMhLnNpemUpLnRvQmUoMSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGNsZWFyIG1ldHJpY3MgZGF0YScsICgpID0+IHtcbiAgICAgIGNvbnN0IG1ldHJpY0RlZmluaXRpb24gPSB7XG4gICAgICAgIG5hbWU6ICdjbGVhci50ZXN0JyxcbiAgICAgICAgdHlwZTogJ2dhdWdlJyBhcyBjb25zdCxcbiAgICAgICAgdW5pdDogJ2NvdW50JyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdDbGVhciB0ZXN0IG1ldHJpYycsXG4gICAgICAgIHRhZ3M6IFtdXG4gICAgICB9O1xuXG4gICAgICBtZXRyaWNzRW5naW5lLmRlZmluZU1ldHJpYyhtZXRyaWNEZWZpbml0aW9uKTtcbiAgICAgIG1ldHJpY3NFbmdpbmUuc3RhcnRDb2xsZWN0aW9uKCk7XG4gICAgICBtZXRyaWNzRW5naW5lLmNvbGxlY3RNZXRyaWMoJ2NsZWFyLnRlc3QnLCAxKTtcblxuICAgICAgbGV0IGJ1ZmZlclN0YXR1cyA9IG1ldHJpY3NFbmdpbmUuZ2V0QnVmZmVyU3RhdHVzKCk7XG4gICAgICBleHBlY3QoYnVmZmVyU3RhdHVzLmhhcygnY2xlYXIudGVzdCcpKS50b0JlKHRydWUpO1xuXG4gICAgICBtZXRyaWNzRW5naW5lLmNsZWFyTWV0cmljcygpO1xuICAgICAgXG4gICAgICBidWZmZXJTdGF0dXMgPSBtZXRyaWNzRW5naW5lLmdldEJ1ZmZlclN0YXR1cygpO1xuICAgICAgZXhwZWN0KGJ1ZmZlclN0YXR1cy5oYXMoJ2NsZWFyLnRlc3QnKSkudG9CZShmYWxzZSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdJbnRlcmFjdGl2ZURhc2hib2FyZEVuZ2luZScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGNyZWF0ZSBkYXNoYm9hcmRzIHdpdGggd2lkZ2V0cycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGNvbmZpZzogRGFzaGJvYXJkQ29uZmlnID0ge1xuICAgICAgICBuYW1lOiAnQW5hbHl0aWNzIERhc2hib2FyZCcsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnTWFpbiBhbmFseXRpY3MgZGFzaGJvYXJkJyxcbiAgICAgICAgd2lkZ2V0czogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIHR5cGU6ICdsaW5lLWNoYXJ0JyxcbiAgICAgICAgICAgIHRpdGxlOiAnUGVyZm9ybWFuY2UgQ2hhcnQnLFxuICAgICAgICAgICAgcG9zaXRpb246IHsgeDogMCwgeTogMCwgd2lkdGg6IDYsIGhlaWdodDogNCB9LFxuICAgICAgICAgICAgY29uZmlndXJhdGlvbjogeyBjaGFydFR5cGU6ICdsaW5lJyB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICB0eXBlOiAnbWV0cmljLWNhcmQnLFxuICAgICAgICAgICAgdGl0bGU6ICdTdWNjZXNzIFJhdGUnLFxuICAgICAgICAgICAgcG9zaXRpb246IHsgeDogNiwgeTogMCwgd2lkdGg6IDMsIGhlaWdodDogMiB9LFxuICAgICAgICAgICAgY29uZmlndXJhdGlvbjogeyBtZXRyaWM6ICdzdWNjZXNzX3JhdGUnIH1cbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IGRhc2hib2FyZCA9IGF3YWl0IGRhc2hib2FyZEVuZ2luZS5jcmVhdGVEYXNoYm9hcmQoY29uZmlnKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KGRhc2hib2FyZCkudG9IYXZlUHJvcGVydHkoJ2lkJyk7XG4gICAgICBleHBlY3QoZGFzaGJvYXJkLm5hbWUpLnRvQmUoJ0FuYWx5dGljcyBEYXNoYm9hcmQnKTtcbiAgICAgIGV4cGVjdChkYXNoYm9hcmQud2lkZ2V0cykudG9IYXZlTGVuZ3RoKDIpO1xuICAgICAgZXhwZWN0KGRhc2hib2FyZC53aWRnZXRzWzBdLnR5cGUpLnRvQmUoJ2xpbmUtY2hhcnQnKTtcbiAgICAgIGV4cGVjdChkYXNoYm9hcmQud2lkZ2V0c1sxXS50eXBlKS50b0JlKCdtZXRyaWMtY2FyZCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB1cGRhdGUgZGFzaGJvYXJkIGNvbmZpZ3VyYXRpb25zJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgY29uZmlnOiBEYXNoYm9hcmRDb25maWcgPSB7XG4gICAgICAgIG5hbWU6ICdUZXN0IERhc2hib2FyZCcsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnSW5pdGlhbCBkZXNjcmlwdGlvbidcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IGRhc2hib2FyZCA9IGF3YWl0IGRhc2hib2FyZEVuZ2luZS5jcmVhdGVEYXNoYm9hcmQoY29uZmlnKTtcbiAgICAgIFxuICAgICAgY29uc3QgdXBkYXRlZCA9IGF3YWl0IGRhc2hib2FyZEVuZ2luZS51cGRhdGVEYXNoYm9hcmQoZGFzaGJvYXJkLmlkLCB7XG4gICAgICAgIG5hbWU6ICdVcGRhdGVkIERhc2hib2FyZCcsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnVXBkYXRlZCBkZXNjcmlwdGlvbidcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBleHBlY3QodXBkYXRlZC5uYW1lKS50b0JlKCdVcGRhdGVkIERhc2hib2FyZCcpO1xuICAgICAgZXhwZWN0KHVwZGF0ZWQuZGVzY3JpcHRpb24pLnRvQmUoJ1VwZGF0ZWQgZGVzY3JpcHRpb24nKTtcbiAgICAgIGV4cGVjdCh1cGRhdGVkLnVwZGF0ZWRBdCkubm90LnRvRXF1YWwoZGFzaGJvYXJkLnVwZGF0ZWRBdCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGNyZWF0ZSBhbmQgbWFuYWdlIGluZGl2aWR1YWwgd2lkZ2V0cycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHdpZGdldENvbmZpZyA9IHtcbiAgICAgICAgdHlwZTogJ2Jhci1jaGFydCcgYXMgY29uc3QsXG4gICAgICAgIHRpdGxlOiAnQ29tbWFuZCBVc2FnZScsXG4gICAgICAgIHBvc2l0aW9uOiB7IHg6IDAsIHk6IDAsIHdpZHRoOiA0LCBoZWlnaHQ6IDMgfSxcbiAgICAgICAgY29uZmlndXJhdGlvbjogeyBcbiAgICAgICAgICBjaGFydFR5cGU6ICdiYXInLFxuICAgICAgICAgIGRhdGFTb3VyY2U6IHsgdHlwZTogJ2FuYWx5dGljcycsIHF1ZXJ5OiAnY29tbWFuZF91c2FnZScgfVxuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICBjb25zdCB3aWRnZXQgPSBhd2FpdCBkYXNoYm9hcmRFbmdpbmUuY3JlYXRlV2lkZ2V0KHdpZGdldENvbmZpZyk7XG4gICAgICBcbiAgICAgIGV4cGVjdCh3aWRnZXQpLnRvSGF2ZVByb3BlcnR5KCdpZCcpO1xuICAgICAgZXhwZWN0KHdpZGdldC50eXBlKS50b0JlKCdiYXItY2hhcnQnKTtcbiAgICAgIGV4cGVjdCh3aWRnZXQudGl0bGUpLnRvQmUoJ0NvbW1hbmQgVXNhZ2UnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmVmcmVzaCB3aWRnZXQgZGF0YScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHdpZGdldENvbmZpZyA9IHtcbiAgICAgICAgdHlwZTogJ2dhdWdlJyBhcyBjb25zdCxcbiAgICAgICAgdGl0bGU6ICdTeXN0ZW0gSGVhbHRoJyxcbiAgICAgICAgcG9zaXRpb246IHsgeDogMCwgeTogMCwgd2lkdGg6IDIsIGhlaWdodDogMiB9LFxuICAgICAgICBjb25maWd1cmF0aW9uOiB7IG1pbjogMCwgbWF4OiAxMDAgfVxuICAgICAgfTtcblxuICAgICAgY29uc3Qgd2lkZ2V0ID0gYXdhaXQgZGFzaGJvYXJkRW5naW5lLmNyZWF0ZVdpZGdldCh3aWRnZXRDb25maWcpO1xuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IGRhc2hib2FyZEVuZ2luZS5yZWZyZXNoV2lkZ2V0RGF0YSh3aWRnZXQuaWQpO1xuICAgICAgXG4gICAgICBleHBlY3QoZGF0YSkudG9IYXZlUHJvcGVydHkoJ2lkJyk7XG4gICAgICBleHBlY3QoZGF0YSkudG9IYXZlUHJvcGVydHkoJ3R5cGUnKTtcbiAgICAgIGV4cGVjdChkYXRhKS50b0hhdmVQcm9wZXJ0eSgnZGF0YScpO1xuICAgICAgZXhwZWN0KGRhdGEpLnRvSGF2ZVByb3BlcnR5KCdtZXRhZGF0YScpO1xuICAgICAgZXhwZWN0KGRhdGEuaWQpLnRvQmUod2lkZ2V0LmlkKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgYXBwbHkgZmlsdGVycyB0byBkYXNoYm9hcmRzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgY29uZmlnOiBEYXNoYm9hcmRDb25maWcgPSB7XG4gICAgICAgIG5hbWU6ICdGaWx0ZXJlZCBEYXNoYm9hcmQnLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ0Rhc2hib2FyZCB3aXRoIGZpbHRlcnMnXG4gICAgICB9O1xuXG4gICAgICBjb25zdCBkYXNoYm9hcmQgPSBhd2FpdCBkYXNoYm9hcmRFbmdpbmUuY3JlYXRlRGFzaGJvYXJkKGNvbmZpZyk7XG4gICAgICBcbiAgICAgIGNvbnN0IGZpbHRlcnMgPSBbXG4gICAgICAgIHtcbiAgICAgICAgICBpZDogJ3RpbWVfcmFuZ2UnLFxuICAgICAgICAgIHR5cGU6ICdkYXRlLXJhbmdlJyBhcyBjb25zdCxcbiAgICAgICAgICBsYWJlbDogJ1RpbWUgUmFuZ2UnLFxuICAgICAgICAgIHZhbHVlOiB7IHN0YXJ0OiBuZXcgRGF0ZShEYXRlLm5vdygpIC0gMzYwMDAwMCksIGVuZDogbmV3IERhdGUoKSB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBpZDogJ3VzZXJfZmlsdGVyJyxcbiAgICAgICAgICB0eXBlOiAnc2VsZWN0JyBhcyBjb25zdCxcbiAgICAgICAgICBsYWJlbDogJ1VzZXInLFxuICAgICAgICAgIHZhbHVlOiAndXNlcjEyMycsXG4gICAgICAgICAgb3B0aW9uczogWyd1c2VyMTIzJywgJ3VzZXI0NTYnXVxuICAgICAgICB9XG4gICAgICBdO1xuXG4gICAgICBjb25zdCBhcHBsaWVkU3B5ID0gamVzdC5mbigpO1xuICAgICAgZGFzaGJvYXJkRW5naW5lLm9uKCdmaWx0ZXJzQXBwbGllZCcsIGFwcGxpZWRTcHkpO1xuXG4gICAgICBkYXNoYm9hcmRFbmdpbmUuYXBwbHlGaWx0ZXJzKGRhc2hib2FyZC5pZCwgZmlsdGVycyk7XG4gICAgICBcbiAgICAgIGV4cGVjdChhcHBsaWVkU3B5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIGRhc2hib2FyZElkOiBkYXNoYm9hcmQuaWQsXG4gICAgICAgIGZpbHRlcnNcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBleHBvcnQgZGFzaGJvYXJkcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGNvbmZpZzogRGFzaGJvYXJkQ29uZmlnID0ge1xuICAgICAgICBuYW1lOiAnRXhwb3J0IFRlc3QgRGFzaGJvYXJkJyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdEYXNoYm9hcmQgZm9yIGV4cG9ydCB0ZXN0aW5nJ1xuICAgICAgfTtcblxuICAgICAgY29uc3QgZGFzaGJvYXJkID0gYXdhaXQgZGFzaGJvYXJkRW5naW5lLmNyZWF0ZURhc2hib2FyZChjb25maWcpO1xuICAgICAgY29uc3QgZXhwb3J0RGF0YSA9IGF3YWl0IGRhc2hib2FyZEVuZ2luZS5leHBvcnREYXNoYm9hcmQoZGFzaGJvYXJkLmlkLCAnanNvbicpO1xuICAgICAgXG4gICAgICBleHBlY3QoZXhwb3J0RGF0YSkudG9IYXZlUHJvcGVydHkoJ2Rhc2hib2FyZCcpO1xuICAgICAgZXhwZWN0KGV4cG9ydERhdGEpLnRvSGF2ZVByb3BlcnR5KCdmb3JtYXQnKTtcbiAgICAgIGV4cGVjdChleHBvcnREYXRhKS50b0hhdmVQcm9wZXJ0eSgnZXhwb3J0ZWRBdCcpO1xuICAgICAgZXhwZWN0KGV4cG9ydERhdGEpLnRvSGF2ZVByb3BlcnR5KCdkYXRhJyk7XG4gICAgICBleHBlY3QoZXhwb3J0RGF0YS5mb3JtYXQpLnRvQmUoJ2pzb24nKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgY2xvbmUgZGFzaGJvYXJkcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGNvbmZpZzogRGFzaGJvYXJkQ29uZmlnID0ge1xuICAgICAgICBuYW1lOiAnT3JpZ2luYWwgRGFzaGJvYXJkJyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdPcmlnaW5hbCBkYXNoYm9hcmQgZm9yIGNsb25pbmcnLFxuICAgICAgICB3aWRnZXRzOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgdHlwZTogJ2xpbmUtY2hhcnQnLFxuICAgICAgICAgICAgdGl0bGU6ICdPcmlnaW5hbCBDaGFydCcsXG4gICAgICAgICAgICBwb3NpdGlvbjogeyB4OiAwLCB5OiAwLCB3aWR0aDogNCwgaGVpZ2h0OiAzIH1cbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IG9yaWdpbmFsID0gYXdhaXQgZGFzaGJvYXJkRW5naW5lLmNyZWF0ZURhc2hib2FyZChjb25maWcpO1xuICAgICAgY29uc3QgY2xvbmVkID0gYXdhaXQgZGFzaGJvYXJkRW5naW5lLmNsb25lRGFzaGJvYXJkKG9yaWdpbmFsLmlkLCAnQ2xvbmVkIERhc2hib2FyZCcsICd1c2VyMTIzJyk7XG4gICAgICBcbiAgICAgIGV4cGVjdChjbG9uZWQubmFtZSkudG9CZSgnQ2xvbmVkIERhc2hib2FyZCcpO1xuICAgICAgZXhwZWN0KGNsb25lZC5kZXNjcmlwdGlvbikudG9Db250YWluKCdDbG9uZSBvZicpO1xuICAgICAgZXhwZWN0KGNsb25lZC53aWRnZXRzKS50b0hhdmVMZW5ndGgob3JpZ2luYWwud2lkZ2V0cy5sZW5ndGgpO1xuICAgICAgZXhwZWN0KGNsb25lZC5pZCkubm90LnRvQmUob3JpZ2luYWwuaWQpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBwcm92aWRlIGRhc2hib2FyZCBhbmFseXRpY3MnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBjb25maWc6IERhc2hib2FyZENvbmZpZyA9IHtcbiAgICAgICAgbmFtZTogJ0FuYWx5dGljcyBUZXN0IERhc2hib2FyZCcsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnRGFzaGJvYXJkIGZvciBhbmFseXRpY3MgdGVzdGluZydcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IGRhc2hib2FyZCA9IGF3YWl0IGRhc2hib2FyZEVuZ2luZS5jcmVhdGVEYXNoYm9hcmQoY29uZmlnKTtcbiAgICAgIGNvbnN0IGFuYWx5dGljcyA9IGRhc2hib2FyZEVuZ2luZS5nZXREYXNoYm9hcmRBbmFseXRpY3MoZGFzaGJvYXJkLmlkKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KGFuYWx5dGljcykudG9IYXZlUHJvcGVydHkoJ3ZpZXdzJyk7XG4gICAgICBleHBlY3QoYW5hbHl0aWNzKS50b0hhdmVQcm9wZXJ0eSgnaW50ZXJhY3Rpb25zJyk7XG4gICAgICBleHBlY3QoYW5hbHl0aWNzKS50b0hhdmVQcm9wZXJ0eSgncGVyZm9ybWFuY2UnKTtcbiAgICAgIGV4cGVjdChhbmFseXRpY3MpLnRvSGF2ZVByb3BlcnR5KCd3aWRnZXRzJyk7XG4gICAgICBleHBlY3QodHlwZW9mIGFuYWx5dGljcy52aWV3cykudG9CZSgnbnVtYmVyJyk7XG4gICAgICBleHBlY3QodHlwZW9mIGFuYWx5dGljcy5pbnRlcmFjdGlvbnMpLnRvQmUoJ251bWJlcicpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBtYW5hZ2UgZGFzaGJvYXJkIHRoZW1lcycsICgpID0+IHtcbiAgICAgIGNvbnN0IGN1c3RvbVRoZW1lID0ge1xuICAgICAgICBpZDogJ2N1c3RvbS10aGVtZScsXG4gICAgICAgIG5hbWU6ICdDdXN0b20gVGhlbWUnLFxuICAgICAgICBjb2xvcnM6IHtcbiAgICAgICAgICBwcmltYXJ5OiAnI0ZGNkI2QicsXG4gICAgICAgICAgc2Vjb25kYXJ5OiAnIzRFQ0RDNCcsXG4gICAgICAgICAgc3VjY2VzczogJyM0NUI3RDEnLFxuICAgICAgICAgIHdhcm5pbmc6ICcjRkZBMDdBJyxcbiAgICAgICAgICBlcnJvcjogJyNGRjZCNkInLFxuICAgICAgICAgIGJhY2tncm91bmQ6ICcjRjhGOUZBJyxcbiAgICAgICAgICBzdXJmYWNlOiAnI0ZGRkZGRicsXG4gICAgICAgICAgdGV4dDogJyMzMzMzMzMnXG4gICAgICAgIH0sXG4gICAgICAgIGZvbnRzOiB7XG4gICAgICAgICAgYm9keTogJ0FyaWFsLCBzYW5zLXNlcmlmJyxcbiAgICAgICAgICBoZWFkaW5nOiAnSGVsdmV0aWNhLCBzYW5zLXNlcmlmJyxcbiAgICAgICAgICBtb25vc3BhY2U6ICdDb3VyaWVyIE5ldywgbW9ub3NwYWNlJ1xuICAgICAgICB9LFxuICAgICAgICBzcGFjaW5nOiB7XG4gICAgICAgICAgc21hbGw6ICc0cHgnLFxuICAgICAgICAgIG1lZGl1bTogJzhweCcsXG4gICAgICAgICAgbGFyZ2U6ICcxNnB4J1xuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICBjb25zdCB0aGVtZUNyZWF0ZWRTcHkgPSBqZXN0LmZuKCk7XG4gICAgICBkYXNoYm9hcmRFbmdpbmUub24oJ3RoZW1lQ3JlYXRlZCcsIHRoZW1lQ3JlYXRlZFNweSk7XG5cbiAgICAgIGRhc2hib2FyZEVuZ2luZS5jcmVhdGVUaGVtZShjdXN0b21UaGVtZSk7XG4gICAgICBcbiAgICAgIGV4cGVjdCh0aGVtZUNyZWF0ZWRTcHkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKGN1c3RvbVRoZW1lKTtcbiAgICAgIFxuICAgICAgY29uc3QgdGhlbWVzID0gZGFzaGJvYXJkRW5naW5lLmdldFRoZW1lcygpO1xuICAgICAgZXhwZWN0KHRoZW1lcy5zb21lKHQgPT4gdC5pZCA9PT0gJ2N1c3RvbS10aGVtZScpKS50b0JlKHRydWUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBsaXN0IGF2YWlsYWJsZSB3aWRnZXQgdHlwZXMnLCAoKSA9PiB7XG4gICAgICBjb25zdCB3aWRnZXRUeXBlcyA9IGRhc2hib2FyZEVuZ2luZS5nZXRXaWRnZXRUeXBlcygpO1xuICAgICAgXG4gICAgICBleHBlY3QoQXJyYXkuaXNBcnJheSh3aWRnZXRUeXBlcykpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3Qod2lkZ2V0VHlwZXMubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgICBleHBlY3Qod2lkZ2V0VHlwZXMuc29tZSh0ID0+IHQuaWQgPT09ICdsaW5lLWNoYXJ0JykpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3Qod2lkZ2V0VHlwZXMuc29tZSh0ID0+IHQuaWQgPT09ICdiYXItY2hhcnQnKSkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdCh3aWRnZXRUeXBlcy5zb21lKHQgPT4gdC5pZCA9PT0gJ3BpZS1jaGFydCcpKS50b0JlKHRydWUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBkZWxldGUgZGFzaGJvYXJkcyBhbmQgY2xlYW4gdXAgcmVzb3VyY2VzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgY29uZmlnOiBEYXNoYm9hcmRDb25maWcgPSB7XG4gICAgICAgIG5hbWU6ICdUZW1wb3JhcnkgRGFzaGJvYXJkJyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdEYXNoYm9hcmQgdG8gYmUgZGVsZXRlZCdcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IGRhc2hib2FyZCA9IGF3YWl0IGRhc2hib2FyZEVuZ2luZS5jcmVhdGVEYXNoYm9hcmQoY29uZmlnKTtcbiAgICAgIGV4cGVjdChkYXNoYm9hcmRFbmdpbmUuZ2V0RGFzaGJvYXJkKGRhc2hib2FyZC5pZCkpLnRvQmVEZWZpbmVkKCk7XG5cbiAgICAgIGNvbnN0IGRlbGV0ZWRTcHkgPSBqZXN0LmZuKCk7XG4gICAgICBkYXNoYm9hcmRFbmdpbmUub24oJ2Rhc2hib2FyZERlbGV0ZWQnLCBkZWxldGVkU3B5KTtcblxuICAgICAgY29uc3QgZGVsZXRlZCA9IGRhc2hib2FyZEVuZ2luZS5kZWxldGVEYXNoYm9hcmQoZGFzaGJvYXJkLmlkKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KGRlbGV0ZWQpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QoZGVsZXRlZFNweSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoZGFzaGJvYXJkLmlkKTtcbiAgICAgIGV4cGVjdChkYXNoYm9hcmRFbmdpbmUuZ2V0RGFzaGJvYXJkKGRhc2hib2FyZC5pZCkpLnRvQmVVbmRlZmluZWQoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0ludGVncmF0aW9uIFRlc3RzJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaW50ZWdyYXRlIGFuYWx5dGljcyBlbmdpbmUgd2l0aCBwcmVkaWN0aXZlIGVuZ2luZScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGV2ZW50czogQW5hbHl0aWNzRXZlbnRbXSA9IEFycmF5LmZyb20oeyBsZW5ndGg6IDE1IH0sIChfLCBpKSA9PiAoe1xuICAgICAgICBpZDogYGludGVncmF0aW9uLWV2ZW50LSR7aX1gLFxuICAgICAgICB0eXBlOiAnY29tbWFuZF9leGVjdXRlZCcsXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoRGF0ZS5ub3coKSAtIGkgKiA2MDAwMCksXG4gICAgICAgIHVzZXJJZDogJ2ludGVncmF0aW9uLXVzZXInLFxuICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgIGNvbW1hbmQ6ICducG0gdGVzdCcsXG4gICAgICAgICAgc3VjY2VzczogaSAlIDQgIT09IDAsIC8vIDI1JSBmYWlsdXJlIHJhdGVcbiAgICAgICAgICBleGVjdXRpb25UaW1lOiBNYXRoLnJhbmRvbSgpICogMTAwMCArIDUwMFxuICAgICAgICB9XG4gICAgICB9KSk7XG5cbiAgICAgIGFuYWx5dGljc0VuZ2luZS5zdGFydENvbGxlY3Rpb24oKTtcbiAgICAgIFxuICAgICAgZm9yIChjb25zdCBldmVudCBvZiBldmVudHMpIHtcbiAgICAgICAgYXdhaXQgYW5hbHl0aWNzRW5naW5lLnRyYWNrRXZlbnQoZXZlbnQpO1xuICAgICAgfVxuXG4gICAgICBjb25zdCB0aW1lUmFuZ2U6IFRpbWVSYW5nZSA9IHtcbiAgICAgICAgc3RhcnQ6IG5ldyBEYXRlKERhdGUubm93KCkgLSAzNjAwMDAwKSxcbiAgICAgICAgZW5kOiBuZXcgRGF0ZSgpXG4gICAgICB9O1xuXG4gICAgICBjb25zdCBtZXRyaWNzID0gYXdhaXQgYW5hbHl0aWNzRW5naW5lLmdlbmVyYXRlTWV0cmljcyh0aW1lUmFuZ2UpO1xuICAgICAgZXhwZWN0KG1ldHJpY3MucHJlZGljdGlvbnMpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QoQXJyYXkuaXNBcnJheShtZXRyaWNzLnByZWRpY3Rpb25zKSkudG9CZSh0cnVlKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaW50ZWdyYXRlIG1ldHJpY3MgZW5naW5lIHdpdGggZGFzaGJvYXJkIGVuZ2luZScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1ldHJpY0RlZmluaXRpb24gPSB7XG4gICAgICAgIG5hbWU6ICdpbnRlZ3JhdGlvbi50ZXN0Lm1ldHJpYycsXG4gICAgICAgIHR5cGU6ICdnYXVnZScgYXMgY29uc3QsXG4gICAgICAgIHVuaXQ6ICdjb3VudCcsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnSW50ZWdyYXRpb24gdGVzdCBtZXRyaWMnLFxuICAgICAgICB0YWdzOiBbXVxuICAgICAgfTtcblxuICAgICAgbWV0cmljc0VuZ2luZS5kZWZpbmVNZXRyaWMobWV0cmljRGVmaW5pdGlvbik7XG4gICAgICBtZXRyaWNzRW5naW5lLnN0YXJ0Q29sbGVjdGlvbigpO1xuICAgICAgXG4gICAgICAvLyBDb2xsZWN0IHNvbWUgbWV0cmljc1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxMDsgaSsrKSB7XG4gICAgICAgIG1ldHJpY3NFbmdpbmUuY29sbGVjdE1ldHJpYygnaW50ZWdyYXRpb24udGVzdC5tZXRyaWMnLCBpICogMTApO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBkYXNoYm9hcmRDb25maWc6IERhc2hib2FyZENvbmZpZyA9IHtcbiAgICAgICAgbmFtZTogJ01ldHJpY3MgSW50ZWdyYXRpb24gRGFzaGJvYXJkJyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdEYXNoYm9hcmQgc2hvd2luZyBtZXRyaWNzIGludGVncmF0aW9uJyxcbiAgICAgICAgd2lkZ2V0czogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIHR5cGU6ICdtZXRyaWMtY2FyZCcsXG4gICAgICAgICAgICB0aXRsZTogJ0ludGVncmF0aW9uIE1ldHJpYycsXG4gICAgICAgICAgICBwb3NpdGlvbjogeyB4OiAwLCB5OiAwLCB3aWR0aDogMywgaGVpZ2h0OiAyIH0sXG4gICAgICAgICAgICBjb25maWd1cmF0aW9uOiB7IG1ldHJpYzogJ2ludGVncmF0aW9uLnRlc3QubWV0cmljJyB9XG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9O1xuXG4gICAgICBjb25zdCBkYXNoYm9hcmQgPSBhd2FpdCBkYXNoYm9hcmRFbmdpbmUuY3JlYXRlRGFzaGJvYXJkKGRhc2hib2FyZENvbmZpZyk7XG4gICAgICBcbiAgICAgIGV4cGVjdChkYXNoYm9hcmQud2lkZ2V0cykudG9IYXZlTGVuZ3RoKDEpO1xuICAgICAgZXhwZWN0KGRhc2hib2FyZC53aWRnZXRzWzBdLnRpdGxlKS50b0JlKCdJbnRlZ3JhdGlvbiBNZXRyaWMnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGNvbmN1cnJlbnQgb3BlcmF0aW9ucyBhY3Jvc3MgYWxsIGVuZ2luZXMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBwcm9taXNlczogUHJvbWlzZTxhbnk+W10gPSBbXTtcbiAgICAgIFxuICAgICAgLy8gU3RhcnQgY29uY3VycmVudCBvcGVyYXRpb25zXG4gICAgICBwcm9taXNlcy5wdXNoKGFuYWx5dGljc0VuZ2luZS50cmFja0V2ZW50KHtcbiAgICAgICAgaWQ6ICdjb25jdXJyZW50LTEnLFxuICAgICAgICB0eXBlOiAnY29tbWFuZF9leGVjdXRlZCcsXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgICAgICAgdXNlcklkOiAnY29uY3VycmVudC11c2VyJyxcbiAgICAgICAgbWV0YWRhdGE6IHsgY29tbWFuZDogJ25wbSB0ZXN0Jywgc3VjY2VzczogdHJ1ZSB9XG4gICAgICB9KSk7XG5cbiAgICAgIG1ldHJpY3NFbmdpbmUuY29sbGVjdE1ldHJpYygnY29tbWFuZC5leGVjdXRpb24uY291bnQnLCAxKTtcbiAgICAgIFxuICAgICAgcHJvbWlzZXMucHVzaChkYXNoYm9hcmRFbmdpbmUuY3JlYXRlRGFzaGJvYXJkKHtcbiAgICAgICAgbmFtZTogJ0NvbmN1cnJlbnQgRGFzaGJvYXJkJyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdDcmVhdGVkIGR1cmluZyBjb25jdXJyZW50IHRlc3QnXG4gICAgICB9KSk7XG5cbiAgICAgIGNvbnN0IGV2ZW50cyA9IEFycmF5LmZyb20oeyBsZW5ndGg6IDUgfSwgKF8sIGkpID0+ICh7XG4gICAgICAgIGlkOiBgY29uY3VycmVudC0ke2l9YCxcbiAgICAgICAgdHlwZTogJ2NvbW1hbmRfZXhlY3V0ZWQnLFxuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXG4gICAgICAgIHVzZXJJZDogJ2NvbmN1cnJlbnQtdXNlcicsXG4gICAgICAgIG1ldGFkYXRhOiB7IGNvbW1hbmQ6ICducG0gdGVzdCcsIHN1Y2Nlc3M6IHRydWUgfVxuICAgICAgfSkpO1xuXG4gICAgICBwcm9taXNlcy5wdXNoKHByZWRpY3RpdmVFbmdpbmUuZ2VuZXJhdGVQcmVkaWN0aW9ucyhldmVudHMpKTtcblxuICAgICAgLy8gQWxsIG9wZXJhdGlvbnMgc2hvdWxkIGNvbXBsZXRlIHN1Y2Nlc3NmdWxseVxuICAgICAgYXdhaXQgZXhwZWN0KFByb21pc2UuYWxsKHByb21pc2VzKSkucmVzb2x2ZXMudG9CZURlZmluZWQoKTtcbiAgICB9KTtcbiAgfSk7XG59KTtcbiJdLCJ2ZXJzaW9uIjozfQ==