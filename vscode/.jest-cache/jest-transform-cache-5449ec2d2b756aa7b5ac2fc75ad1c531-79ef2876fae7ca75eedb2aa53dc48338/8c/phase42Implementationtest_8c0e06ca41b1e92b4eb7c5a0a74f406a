ec46fc95b0ff859c6c64ff0f11d03aef
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const globals_1 = require("@jest/globals");
// Mock VSCode
globals_1.jest.mock('vscode', () => ({
    ExtensionContext: globals_1.jest.fn(),
    Disposable: globals_1.jest.fn()
}));
const intelligentSuggestionsEngine_1 = require("../engines/intelligentSuggestionsEngine");
const automatedInsightsEngine_1 = require("../engines/automatedInsightsEngine");
const naturalLanguageQueryEngine_1 = require("../engines/naturalLanguageQueryEngine");
const aiInsightsEngine_1 = require("../aiInsightsEngine");
(0, globals_1.describe)('Phase 4.2 AI Insights Implementation', () => {
    let mockContext;
    let aiInsightsEngine;
    let intelligentSuggestionsEngine;
    let automatedInsightsEngine;
    let naturalLanguageQueryEngine;
    const createMockExecutionContext = () => ({
        project: 'test-project',
        currentFiles: ['src/app.ts', 'src/utils.ts'],
        recentCommands: [],
        gitStatus: {
            branch: 'main',
            hasUncommittedChanges: true,
            changedFiles: ['src/app.ts'],
            commitsBehind: 0,
            commitsAhead: 1,
            lastCommit: {
                hash: 'abc123',
                message: 'Test commit',
                author: 'Test User',
                date: new Date(),
                files: ['src/app.ts'],
                stats: { additions: 10, deletions: 2 }
            }
        },
        testStatus: {
            passing: 15,
            failing: 3,
            skipped: 1,
            coverage: 85,
            lastRun: new Date(),
            failingTests: [
                {
                    suite: 'app.spec.ts',
                    test: 'should handle errors',
                    status: 'failed',
                    duration: 100,
                    error: 'Assertion failed',
                    timestamp: new Date()
                }
            ]
        },
        timestamp: new Date()
    });
    const createMockAnalysisData = () => ({
        commandHistory: [
            {
                id: 'cmd1',
                action: 'nxTest',
                project: 'test-project',
                status: 'completed',
                startTime: new Date(Date.now() - 60000),
                endTime: new Date(),
                progress: 100,
                output: ['Test passed'],
                initiator: {
                    id: 'user1',
                    name: 'Test User',
                    role: 'owner',
                    joinedAt: new Date(),
                    isOnline: true
                },
                sharedWith: []
            }
        ],
        projectFiles: ['src/app.ts', 'src/utils.ts', 'src/types.ts'],
        gitHistory: [
            {
                hash: 'abc123',
                message: 'Add new feature',
                author: 'Test User',
                date: new Date(),
                files: ['src/app.ts'],
                stats: { additions: 25, deletions: 5 }
            }
        ],
        testResults: [
            {
                suite: 'app.spec.ts',
                test: 'should work correctly',
                status: 'passed',
                duration: 50,
                timestamp: new Date()
            },
            {
                suite: 'utils.spec.ts',
                test: 'should handle edge case',
                status: 'failed',
                duration: 120,
                error: 'Expected true but got false',
                timestamp: new Date()
            }
        ],
        performanceMetrics: [
            {
                metric: 'test-execution-time',
                value: 45000,
                unit: 'ms',
                timestamp: new Date(),
                context: { project: 'test-project' }
            }
        ],
        errorPatterns: [
            {
                pattern: 'TypeError: Cannot read property',
                frequency: 5,
                lastSeen: new Date(),
                affectedFiles: ['src/app.ts', 'src/utils.ts'],
                suggestedFix: 'Add null check before property access'
            }
        ]
    });
    (0, globals_1.beforeEach)(() => {
        mockContext = {
            globalState: {
                get: globals_1.jest.fn().mockReturnValue(undefined),
                update: globals_1.jest.fn().mockImplementation((...args) => Promise.resolve())
            }
        };
        aiInsightsEngine = new aiInsightsEngine_1.AIInsightsEngine(mockContext);
        intelligentSuggestionsEngine = new intelligentSuggestionsEngine_1.IntelligentSuggestionsEngine(mockContext);
        automatedInsightsEngine = new automatedInsightsEngine_1.AutomatedInsightsEngine(mockContext);
        naturalLanguageQueryEngine = new naturalLanguageQueryEngine_1.NaturalLanguageQueryEngine(mockContext);
    });
    (0, globals_1.describe)('IntelligentSuggestionsEngine', () => {
        (0, globals_1.test)('should generate intelligent command suggestions', async () => {
            const context = createMockExecutionContext();
            const suggestions = await intelligentSuggestionsEngine.generateIntelligentSuggestions(context);
            (0, globals_1.expect)(suggestions).toBeDefined();
            (0, globals_1.expect)(Array.isArray(suggestions)).toBe(true);
            (0, globals_1.expect)(suggestions.length).toBeGreaterThan(0);
            // Should suggest running tests due to failing tests
            const testSuggestion = suggestions.find(s => s.command === 'nxTest');
            (0, globals_1.expect)(testSuggestion).toBeDefined();
            (0, globals_1.expect)(testSuggestion?.confidence).toBeGreaterThan(0.5); // Reduced expectation due to success prediction adjustments
        });
        (0, globals_1.test)('should analyze execution patterns', async () => {
            const executions = [
                {
                    id: 'cmd1',
                    action: 'nxTest',
                    project: 'test-project',
                    status: 'completed',
                    startTime: new Date(Date.now() - 60000),
                    endTime: new Date(),
                    progress: 100,
                    output: ['Tests passed'],
                    initiator: {
                        id: 'user1',
                        name: 'Test User',
                        role: 'owner',
                        joinedAt: new Date(),
                        isOnline: true
                    },
                    sharedWith: []
                }
            ];
            const patterns = await intelligentSuggestionsEngine.analyzeExecutionPatterns(executions);
            (0, globals_1.expect)(patterns).toBeDefined();
            (0, globals_1.expect)(Array.isArray(patterns)).toBe(true);
        });
        (0, globals_1.test)('should predict command success', async () => {
            const context = createMockExecutionContext();
            const predictions = await intelligentSuggestionsEngine.predictCommandSuccess(context);
            (0, globals_1.expect)(predictions).toBeDefined();
            (0, globals_1.expect)(predictions instanceof Map).toBe(true);
            (0, globals_1.expect)(predictions.size).toBeGreaterThan(0);
        });
    });
    (0, globals_1.describe)('AutomatedInsightsEngine', () => {
        (0, globals_1.test)('should generate automated insights', async () => {
            const data = createMockAnalysisData();
            const insights = await automatedInsightsEngine.generateAutomatedInsights(data);
            (0, globals_1.expect)(insights).toBeDefined();
            (0, globals_1.expect)(Array.isArray(insights)).toBe(true);
            (0, globals_1.expect)(insights.length).toBeGreaterThan(0);
            // Should detect test failures
            const testInsight = insights.find(i => i.category === 'testing');
            (0, globals_1.expect)(testInsight).toBeDefined();
        });
        (0, globals_1.test)('should prioritize insights correctly', async () => {
            const data = createMockAnalysisData();
            const insights = await automatedInsightsEngine.generateAutomatedInsights(data);
            // Insights should be sorted by priority and confidence
            for (let i = 0; i < insights.length - 1; i++) {
                const current = insights[i];
                const next = insights[i + 1];
                const priorityScore = { 'critical': 4, 'high': 3, 'medium': 2, 'low': 1 };
                const currentScore = priorityScore[current.priority] * current.confidence;
                const nextScore = priorityScore[next.priority] * next.confidence;
                (0, globals_1.expect)(currentScore).toBeGreaterThanOrEqual(nextScore);
            }
        });
        (0, globals_1.test)('should generate actionable suggestions', async () => {
            const data = createMockAnalysisData();
            const insights = await automatedInsightsEngine.generateAutomatedInsights(data);
            const actionableInsights = insights.filter(i => i.actionable);
            (0, globals_1.expect)(actionableInsights.length).toBeGreaterThan(0);
            actionableInsights.forEach(insight => {
                (0, globals_1.expect)(insight.suggestions).toBeDefined();
                (0, globals_1.expect)(insight.suggestions.length).toBeGreaterThan(0);
                insight.suggestions.forEach(suggestion => {
                    (0, globals_1.expect)(suggestion.title).toBeDefined();
                    (0, globals_1.expect)(suggestion.description).toBeDefined();
                    (0, globals_1.expect)(suggestion.action).toBeDefined();
                    (0, globals_1.expect)(suggestion.estimatedImpact).toMatch(/^(low|medium|high)$/);
                    (0, globals_1.expect)(suggestion.estimatedEffort).toMatch(/^(minutes|hours|days)$/);
                });
            });
        });
    });
    (0, globals_1.describe)('NaturalLanguageQueryEngine', () => {
        (0, globals_1.test)('should process test-related queries', async () => {
            const query = "Show me failing tests from this week";
            const context = createMockAnalysisData();
            const result = await naturalLanguageQueryEngine.processQuery(query, context);
            (0, globals_1.expect)(result).toBeDefined();
            (0, globals_1.expect)(result.intent).toBe('test-query');
            (0, globals_1.expect)(result.confidence).toBeGreaterThan(0.5);
            (0, globals_1.expect)(result.response).toContain('test');
            (0, globals_1.expect)(result.suggestedActions.length).toBeGreaterThan(0);
        });
        (0, globals_1.test)('should process error-related queries', async () => {
            const query = "What are the most common errors?";
            const context = createMockAnalysisData();
            const result = await naturalLanguageQueryEngine.processQuery(query, context);
            (0, globals_1.expect)(result).toBeDefined();
            (0, globals_1.expect)(result.intent).toBe('error-query');
            (0, globals_1.expect)(result.confidence).toBeGreaterThan(0.5);
            (0, globals_1.expect)(result.response).toContain('error');
        });
        (0, globals_1.test)('should generate contextual query suggestions', async () => {
            const context = createMockAnalysisData();
            const suggestions = await naturalLanguageQueryEngine.getQuerySuggestions(context);
            (0, globals_1.expect)(suggestions).toBeDefined();
            (0, globals_1.expect)(Array.isArray(suggestions)).toBe(true);
            (0, globals_1.expect)(suggestions.length).toBeGreaterThan(0);
            (0, globals_1.expect)(suggestions.length).toBeLessThanOrEqual(8);
            // Should include test-related suggestions due to failing tests
            const testSuggestion = suggestions.find(s => s.toLowerCase().includes('test'));
            (0, globals_1.expect)(testSuggestion).toBeDefined();
        });
    });
    (0, globals_1.describe)('AIInsightsEngine Integration', () => {
        (0, globals_1.test)('should integrate Phase 4.2 engines', async () => {
            const data = createMockAnalysisData();
            const context = createMockExecutionContext();
            // Test enhanced pattern analysis
            const insights = await aiInsightsEngine.analyzePattern(data);
            (0, globals_1.expect)(insights).toBeDefined();
            (0, globals_1.expect)(insights.length).toBeGreaterThan(0);
            // Test enhanced command suggestions
            const suggestions = await aiInsightsEngine.suggestCommand(context);
            (0, globals_1.expect)(suggestions).toBeDefined();
            (0, globals_1.expect)(suggestions.length).toBeGreaterThan(0);
            (0, globals_1.expect)(suggestions.length).toBeLessThanOrEqual(8);
            // Test enhanced natural language processing
            const query = "Show me failing tests";
            const queryResult = await aiInsightsEngine.processNaturalLanguageQuery(query, data);
            (0, globals_1.expect)(queryResult).toBeDefined();
            (0, globals_1.expect)(queryResult.confidence).toBeGreaterThan(0);
        });
        (0, globals_1.test)('should provide Phase 4.2 specific methods', async () => {
            const data = createMockAnalysisData();
            const context = createMockExecutionContext();
            // Test query suggestions
            const querySuggestions = await aiInsightsEngine.getQuerySuggestions(data);
            (0, globals_1.expect)(querySuggestions).toBeDefined();
            (0, globals_1.expect)(Array.isArray(querySuggestions)).toBe(true);
            // Test execution pattern analysis
            await aiInsightsEngine.analyzeExecutionPatterns(data.commandHistory);
            // Should not throw
            // Test command success prediction
            const predictions = await aiInsightsEngine.predictCommandSuccess(context);
            (0, globals_1.expect)(predictions).toBeDefined();
            (0, globals_1.expect)(predictions instanceof Map).toBe(true);
            // Test query analytics
            const analytics = await aiInsightsEngine.getQueryAnalytics();
            (0, globals_1.expect)(analytics).toBeDefined();
            (0, globals_1.expect)(analytics).toHaveProperty('patterns');
        });
        (0, globals_1.test)('should save and dispose engine states properly', async () => {
            await aiInsightsEngine.saveEngineStates();
            // Should not throw
            aiInsightsEngine.dispose();
            // Should not throw
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2dyZWdkdW5uL3NyYy90ZXN0L2FpX2RlYnVnX2NvbnRleHQvdnNjb2RlL3NyYy9zZXJ2aWNlcy9haS1pbnNpZ2h0cy9fX3Rlc3RzX18vcGhhc2U0MkltcGxlbWVudGF0aW9uLnRlc3QudHMiLCJtYXBwaW5ncyI6Ijs7QUFBQSwyQ0FBeUU7QUFnQnpFLGNBQWM7QUFDZCxjQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO0lBQ3ZCLGdCQUFnQixFQUFFLGNBQUksQ0FBQyxFQUFFLEVBQUU7SUFDM0IsVUFBVSxFQUFFLGNBQUksQ0FBQyxFQUFFLEVBQUU7Q0FDeEIsQ0FBQyxDQUFDLENBQUM7QUFsQkosMEZBQXVGO0FBQ3ZGLGdGQUE2RTtBQUM3RSxzRkFBbUY7QUFDbkYsMERBQXVEO0FBaUJ2RCxJQUFBLGtCQUFRLEVBQUMsc0NBQXNDLEVBQUUsR0FBRyxFQUFFO0lBQ2xELElBQUksV0FBb0MsQ0FBQztJQUN6QyxJQUFJLGdCQUFrQyxDQUFDO0lBQ3ZDLElBQUksNEJBQTBELENBQUM7SUFDL0QsSUFBSSx1QkFBZ0QsQ0FBQztJQUNyRCxJQUFJLDBCQUFzRCxDQUFDO0lBRTNELE1BQU0sMEJBQTBCLEdBQUcsR0FBcUIsRUFBRSxDQUFDLENBQUM7UUFDeEQsT0FBTyxFQUFFLGNBQWM7UUFDdkIsWUFBWSxFQUFFLENBQUMsWUFBWSxFQUFFLGNBQWMsQ0FBQztRQUM1QyxjQUFjLEVBQUUsRUFBRTtRQUNsQixTQUFTLEVBQUU7WUFDUCxNQUFNLEVBQUUsTUFBTTtZQUNkLHFCQUFxQixFQUFFLElBQUk7WUFDM0IsWUFBWSxFQUFFLENBQUMsWUFBWSxDQUFDO1lBQzVCLGFBQWEsRUFBRSxDQUFDO1lBQ2hCLFlBQVksRUFBRSxDQUFDO1lBQ2YsVUFBVSxFQUFFO2dCQUNSLElBQUksRUFBRSxRQUFRO2dCQUNkLE9BQU8sRUFBRSxhQUFhO2dCQUN0QixNQUFNLEVBQUUsV0FBVztnQkFDbkIsSUFBSSxFQUFFLElBQUksSUFBSSxFQUFFO2dCQUNoQixL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QUFDLGdEQUFnRCxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQzlELE1BQU0sZ0JBQWdCLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQztZQUMxQyxtQkFBbUI7WUFFbkIsZ0JBQWdCLENBQUMsT0FBTyxFQUFFLENBQUM7WUFDM0IsbUJBQW1CO1FBQ3ZCLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQyxDQUFDLENBQUM7QUFDUCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMvZ3JlZ2R1bm4vc3JjL3Rlc3QvYWlfZGVidWdfY29udGV4dC92c2NvZGUvc3JjL3NlcnZpY2VzL2FpLWluc2lnaHRzL19fdGVzdHNfXy9waGFzZTQySW1wbGVtZW50YXRpb24udGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBkZXNjcmliZSwgdGVzdCwgZXhwZWN0LCBiZWZvcmVFYWNoLCBqZXN0IH0gZnJvbSAnQGplc3QvZ2xvYmFscyc7XG5pbXBvcnQgKiBhcyB2c2NvZGUgZnJvbSAndnNjb2RlJztcbmltcG9ydCB7IEludGVsbGlnZW50U3VnZ2VzdGlvbnNFbmdpbmUgfSBmcm9tICcuLi9lbmdpbmVzL2ludGVsbGlnZW50U3VnZ2VzdGlvbnNFbmdpbmUnO1xuaW1wb3J0IHsgQXV0b21hdGVkSW5zaWdodHNFbmdpbmUgfSBmcm9tICcuLi9lbmdpbmVzL2F1dG9tYXRlZEluc2lnaHRzRW5naW5lJztcbmltcG9ydCB7IE5hdHVyYWxMYW5ndWFnZVF1ZXJ5RW5naW5lIH0gZnJvbSAnLi4vZW5naW5lcy9uYXR1cmFsTGFuZ3VhZ2VRdWVyeUVuZ2luZSc7XG5pbXBvcnQgeyBBSUluc2lnaHRzRW5naW5lIH0gZnJvbSAnLi4vYWlJbnNpZ2h0c0VuZ2luZSc7XG5pbXBvcnQge1xuICAgIEV4ZWN1dGlvbkNvbnRleHQsXG4gICAgQW5hbHlzaXNEYXRhLFxuICAgIENvbW1hbmRFeGVjdXRpb24sXG4gICAgVGVzdFJlc3VsdCxcbiAgICBFcnJvclBhdHRlcm4sXG4gICAgUGVyZm9ybWFuY2VNZXRyaWMsXG4gICAgR2l0Q29tbWl0XG59IGZyb20gJy4uLy4uLy4uL3R5cGVzJztcblxuLy8gTW9jayBWU0NvZGVcbmplc3QubW9jaygndnNjb2RlJywgKCkgPT4gKHtcbiAgICBFeHRlbnNpb25Db250ZXh0OiBqZXN0LmZuKCksXG4gICAgRGlzcG9zYWJsZTogamVzdC5mbigpXG59KSk7XG5cbmRlc2NyaWJlKCdQaGFzZSA0LjIgQUkgSW5zaWdodHMgSW1wbGVtZW50YXRpb24nLCAoKSA9PiB7XG4gICAgbGV0IG1vY2tDb250ZXh0OiB2c2NvZGUuRXh0ZW5zaW9uQ29udGV4dDtcbiAgICBsZXQgYWlJbnNpZ2h0c0VuZ2luZTogQUlJbnNpZ2h0c0VuZ2luZTtcbiAgICBsZXQgaW50ZWxsaWdlbnRTdWdnZXN0aW9uc0VuZ2luZTogSW50ZWxsaWdlbnRTdWdnZXN0aW9uc0VuZ2luZTtcbiAgICBsZXQgYXV0b21hdGVkSW5zaWdodHNFbmdpbmU6IEF1dG9tYXRlZEluc2lnaHRzRW5naW5lO1xuICAgIGxldCBuYXR1cmFsTGFuZ3VhZ2VRdWVyeUVuZ2luZTogTmF0dXJhbExhbmd1YWdlUXVlcnlFbmdpbmU7XG5cbiAgICBjb25zdCBjcmVhdGVNb2NrRXhlY3V0aW9uQ29udGV4dCA9ICgpOiBFeGVjdXRpb25Db250ZXh0ID0+ICh7XG4gICAgICAgIHByb2plY3Q6ICd0ZXN0LXByb2plY3QnLFxuICAgICAgICBjdXJyZW50RmlsZXM6IFsnc3JjL2FwcC50cycsICdzcmMvdXRpbHMudHMnXSxcbiAgICAgICAgcmVjZW50Q29tbWFuZHM6IFtdLFxuICAgICAgICBnaXRTdGF0dXM6IHtcbiAgICAgICAgICAgIGJyYW5jaDogJ21haW4nLFxuICAgICAgICAgICAgaGFzVW5jb21taXR0ZWRDaGFuZ2VzOiB0cnVlLFxuICAgICAgICAgICAgY2hhbmdlZEZpbGVzOiBbJ3NyYy9hcHAudHMnXSxcbiAgICAgICAgICAgIGNvbW1pdHNCZWhpbmQ6IDAsXG4gICAgICAgICAgICBjb21taXRzQWhlYWQ6IDEsXG4gICAgICAgICAgICBsYXN0Q29tbWl0OiB7XG4gICAgICAgICAgICAgICAgaGFzaDogJ2FiYzEyMycsXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogJ1Rlc3QgY29tbWl0JyxcbiAgICAgICAgICAgICAgICBhdXRob3I6ICdUZXN0IFVzZXInLFxuICAgICAgICAgICAgICAgIGRhdGU6IG5ldyBEYXRlKCksXG4gICAgICAgICAgICAgICAgZmlsZXM6IFsnc3JjL2FwcC50cyddLFxuICAgICAgICAgICAgICAgIHN0YXRzOiB7IGFkZGl0aW9uczogMTAsIGRlbGV0aW9uczogMiB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHRlc3RTdGF0dXM6IHtcbiAgICAgICAgICAgIHBhc3Npbmc6IDE1LFxuICAgICAgICAgICAgZmFpbGluZzogMyxcbiAgICAgICAgICAgIHNraXBwZWQ6IDEsXG4gICAgICAgICAgICBjb3ZlcmFnZTogODUsXG4gICAgICAgICAgICBsYXN0UnVuOiBuZXcgRGF0ZSgpLFxuICAgICAgICAgICAgZmFpbGluZ1Rlc3RzOiBbXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBzdWl0ZTogJ2FwcC5zcGVjLnRzJyxcbiAgICAgICAgICAgICAgICAgICAgdGVzdDogJ3Nob3VsZCBoYW5kbGUgZXJyb3JzJyxcbiAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiAnZmFpbGVkJyxcbiAgICAgICAgICAgICAgICAgICAgZHVyYXRpb246IDEwMCxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdBc3NlcnRpb24gZmFpbGVkJyxcbiAgICAgICAgICAgICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgXVxuICAgICAgICB9LFxuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKClcbiAgICB9KTtcblxuICAgIGNvbnN0IGNyZWF0ZU1vY2tBbmFseXNpc0RhdGEgPSAoKTogQW5hbHlzaXNEYXRhID0+ICh7XG4gICAgICAgIGNvbW1hbmRIaXN0b3J5OiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaWQ6ICdjbWQxJyxcbiAgICAgICAgICAgICAgICBhY3Rpb246ICdueFRlc3QnLFxuICAgICAgICAgICAgICAgIHByb2plY3Q6ICd0ZXN0LXByb2plY3QnLFxuICAgICAgICAgICAgICAgIHN0YXR1czogJ2NvbXBsZXRlZCcsXG4gICAgICAgICAgICAgICAgc3RhcnRUaW1lOiBuZXcgRGF0ZShEYXRlLm5vdygpIC0gNjAwMDApLFxuICAgICAgICAgICAgICAgIGVuZFRpbWU6IG5ldyBEYXRlKCksXG4gICAgICAgICAgICAgICAgcHJvZ3Jlc3M6IDEwMCxcbiAgICAgICAgICAgICAgICBvdXRwdXQ6IFsnVGVzdCBwYXNzZWQnXSxcbiAgICAgICAgICAgICAgICBpbml0aWF0b3I6IHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6ICd1c2VyMScsXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6ICdUZXN0IFVzZXInLFxuICAgICAgICAgICAgICAgICAgICByb2xlOiAnb3duZXInLFxuICAgICAgICAgICAgICAgICAgICBqb2luZWRBdDogbmV3IERhdGUoKSxcbiAgICAgICAgICAgICAgICAgICAgaXNPbmxpbmU6IHRydWVcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHNoYXJlZFdpdGg6IFtdXG4gICAgICAgICAgICB9XG4gICAgICAgIF0sXG4gICAgICAgIHByb2plY3RGaWxlczogWydzcmMvYXBwLnRzJywgJ3NyYy91dGlscy50cycsICdzcmMvdHlwZXMudHMnXSxcbiAgICAgICAgZ2l0SGlzdG9yeTogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGhhc2g6ICdhYmMxMjMnLFxuICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICdBZGQgbmV3IGZlYXR1cmUnLFxuICAgICAgICAgICAgICAgIGF1dGhvcjogJ1Rlc3QgVXNlcicsXG4gICAgICAgICAgICAgICAgZGF0ZTogbmV3IERhdGUoKSxcbiAgICAgICAgICAgICAgICBmaWxlczogWydzcmMvYXBwLnRzJ10sXG4gICAgICAgICAgICAgICAgc3RhdHM6IHsgYWRkaXRpb25zOiAyNSwgZGVsZXRpb25zOiA1IH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgXSxcbiAgICAgICAgdGVzdFJlc3VsdHM6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBzdWl0ZTogJ2FwcC5zcGVjLnRzJyxcbiAgICAgICAgICAgICAgICB0ZXN0OiAnc2hvdWxkIHdvcmsgY29ycmVjdGx5JyxcbiAgICAgICAgICAgICAgICBzdGF0dXM6ICdwYXNzZWQnLFxuICAgICAgICAgICAgICAgIGR1cmF0aW9uOiA1MCxcbiAgICAgICAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKClcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgc3VpdGU6ICd1dGlscy5zcGVjLnRzJyxcbiAgICAgICAgICAgICAgICB0ZXN0OiAnc2hvdWxkIGhhbmRsZSBlZGdlIGNhc2UnLFxuICAgICAgICAgICAgICAgIHN0YXR1czogJ2ZhaWxlZCcsXG4gICAgICAgICAgICAgICAgZHVyYXRpb246IDEyMCxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ0V4cGVjdGVkIHRydWUgYnV0IGdvdCBmYWxzZScsXG4gICAgICAgICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpXG4gICAgICAgICAgICB9XG4gICAgICAgIF0sXG4gICAgICAgIHBlcmZvcm1hbmNlTWV0cmljczogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIG1ldHJpYzogJ3Rlc3QtZXhlY3V0aW9uLXRpbWUnLFxuICAgICAgICAgICAgICAgIHZhbHVlOiA0NTAwMCxcbiAgICAgICAgICAgICAgICB1bml0OiAnbXMnLFxuICAgICAgICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgICAgICAgICAgICAgICBjb250ZXh0OiB7IHByb2plY3Q6ICd0ZXN0LXByb2plY3QnIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgXSxcbiAgICAgICAgZXJyb3JQYXR0ZXJuczogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHBhdHRlcm46ICdUeXBlRXJyb3I6IENhbm5vdCByZWFkIHByb3BlcnR5JyxcbiAgICAgICAgICAgICAgICBmcmVxdWVuY3k6IDUsXG4gICAgICAgICAgICAgICAgbGFzdFNlZW46IG5ldyBEYXRlKCksXG4gICAgICAgICAgICAgICAgYWZmZWN0ZWRGaWxlczogWydzcmMvYXBwLnRzJywgJ3NyYy91dGlscy50cyddLFxuICAgICAgICAgICAgICAgIHN1Z2dlc3RlZEZpeDogJ0FkZCBudWxsIGNoZWNrIGJlZm9yZSBwcm9wZXJ0eSBhY2Nlc3MnXG4gICAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICB9KTtcblxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgICBtb2NrQ29udGV4dCA9IHtcbiAgICAgICAgICAgIGdsb2JhbFN0YXRlOiB7XG4gICAgICAgICAgICAgICAgZ2V0OiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHVuZGVmaW5lZCksXG4gICAgICAgICAgICAgICAgdXBkYXRlOiBqZXN0LmZuKCkubW9ja0ltcGxlbWVudGF0aW9uKCguLi5hcmdzOiB1bmtub3duW10pID0+IFByb21pc2UucmVzb2x2ZSgpKVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGFzIGFueTtcblxuICAgICAgICBhaUluc2lnaHRzRW5naW5lID0gbmV3IEFJSW5zaWdodHNFbmdpbmUobW9ja0NvbnRleHQpO1xuICAgICAgICBpbnRlbGxpZ2VudFN1Z2dlc3Rpb25zRW5naW5lID0gbmV3IEludGVsbGlnZW50U3VnZ2VzdGlvbnNFbmdpbmUobW9ja0NvbnRleHQpO1xuICAgICAgICBhdXRvbWF0ZWRJbnNpZ2h0c0VuZ2luZSA9IG5ldyBBdXRvbWF0ZWRJbnNpZ2h0c0VuZ2luZShtb2NrQ29udGV4dCk7XG4gICAgICAgIG5hdHVyYWxMYW5ndWFnZVF1ZXJ5RW5naW5lID0gbmV3IE5hdHVyYWxMYW5ndWFnZVF1ZXJ5RW5naW5lKG1vY2tDb250ZXh0KTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCdJbnRlbGxpZ2VudFN1Z2dlc3Rpb25zRW5naW5lJywgKCkgPT4ge1xuICAgICAgICB0ZXN0KCdzaG91bGQgZ2VuZXJhdGUgaW50ZWxsaWdlbnQgY29tbWFuZCBzdWdnZXN0aW9ucycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGNvbnRleHQgPSBjcmVhdGVNb2NrRXhlY3V0aW9uQ29udGV4dCgpO1xuICAgICAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbnMgPSBhd2FpdCBpbnRlbGxpZ2VudFN1Z2dlc3Rpb25zRW5naW5lLmdlbmVyYXRlSW50ZWxsaWdlbnRTdWdnZXN0aW9ucyhjb250ZXh0KTtcblxuICAgICAgICAgICAgZXhwZWN0KHN1Z2dlc3Rpb25zKS50b0JlRGVmaW5lZCgpO1xuICAgICAgICAgICAgZXhwZWN0KEFycmF5LmlzQXJyYXkoc3VnZ2VzdGlvbnMpKS50b0JlKHRydWUpO1xuICAgICAgICAgICAgZXhwZWN0KHN1Z2dlc3Rpb25zLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBTaG91bGQgc3VnZ2VzdCBydW5uaW5nIHRlc3RzIGR1ZSB0byBmYWlsaW5nIHRlc3RzXG4gICAgICAgICAgICBjb25zdCB0ZXN0U3VnZ2VzdGlvbiA9IHN1Z2dlc3Rpb25zLmZpbmQocyA9PiBzLmNvbW1hbmQgPT09ICdueFRlc3QnKTtcbiAgICAgICAgICAgIGV4cGVjdCh0ZXN0U3VnZ2VzdGlvbikudG9CZURlZmluZWQoKTtcbiAgICAgICAgICAgIGV4cGVjdCh0ZXN0U3VnZ2VzdGlvbj8uY29uZmlkZW5jZSkudG9CZUdyZWF0ZXJUaGFuKDAuNSk7IC8vIFJlZHVjZWQgZXhwZWN0YXRpb24gZHVlIHRvIHN1Y2Nlc3MgcHJlZGljdGlvbiBhZGp1c3RtZW50c1xuICAgICAgICB9KTtcblxuICAgICAgICB0ZXN0KCdzaG91bGQgYW5hbHl6ZSBleGVjdXRpb24gcGF0dGVybnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBleGVjdXRpb25zOiBDb21tYW5kRXhlY3V0aW9uW10gPSBbXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBpZDogJ2NtZDEnLFxuICAgICAgICAgICAgICAgICAgICBhY3Rpb246ICdueFRlc3QnLFxuICAgICAgICAgICAgICAgICAgICBwcm9qZWN0OiAndGVzdC1wcm9qZWN0JyxcbiAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiAnY29tcGxldGVkJyxcbiAgICAgICAgICAgICAgICAgICAgc3RhcnRUaW1lOiBuZXcgRGF0ZShEYXRlLm5vdygpIC0gNjAwMDApLFxuICAgICAgICAgICAgICAgICAgICBlbmRUaW1lOiBuZXcgRGF0ZSgpLFxuICAgICAgICAgICAgICAgICAgICBwcm9ncmVzczogMTAwLFxuICAgICAgICAgICAgICAgICAgICBvdXRwdXQ6IFsnVGVzdHMgcGFzc2VkJ10sXG4gICAgICAgICAgICAgICAgICAgIGluaXRpYXRvcjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6ICd1c2VyMScsXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAnVGVzdCBVc2VyJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvbGU6ICdvd25lcicsXG4gICAgICAgICAgICAgICAgICAgICAgICBqb2luZWRBdDogbmV3IERhdGUoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzT25saW5lOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHNoYXJlZFdpdGg6IFtdXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgXTtcblxuICAgICAgICAgICAgY29uc3QgcGF0dGVybnMgPSBhd2FpdCBpbnRlbGxpZ2VudFN1Z2dlc3Rpb25zRW5naW5lLmFuYWx5emVFeGVjdXRpb25QYXR0ZXJucyhleGVjdXRpb25zKTtcbiAgICAgICAgICAgIGV4cGVjdChwYXR0ZXJucykudG9CZURlZmluZWQoKTtcbiAgICAgICAgICAgIGV4cGVjdChBcnJheS5pc0FycmF5KHBhdHRlcm5zKSkudG9CZSh0cnVlKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGVzdCgnc2hvdWxkIHByZWRpY3QgY29tbWFuZCBzdWNjZXNzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgY29udGV4dCA9IGNyZWF0ZU1vY2tFeGVjdXRpb25Db250ZXh0KCk7XG4gICAgICAgICAgICBjb25zdCBwcmVkaWN0aW9ucyA9IGF3YWl0IGludGVsbGlnZW50U3VnZ2VzdGlvbnNFbmdpbmUucHJlZGljdENvbW1hbmRTdWNjZXNzKGNvbnRleHQpO1xuXG4gICAgICAgICAgICBleHBlY3QocHJlZGljdGlvbnMpLnRvQmVEZWZpbmVkKCk7XG4gICAgICAgICAgICBleHBlY3QocHJlZGljdGlvbnMgaW5zdGFuY2VvZiBNYXApLnRvQmUodHJ1ZSk7XG4gICAgICAgICAgICBleHBlY3QocHJlZGljdGlvbnMuc2l6ZSkudG9CZUdyZWF0ZXJUaGFuKDApO1xuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCdBdXRvbWF0ZWRJbnNpZ2h0c0VuZ2luZScsICgpID0+IHtcbiAgICAgICAgdGVzdCgnc2hvdWxkIGdlbmVyYXRlIGF1dG9tYXRlZCBpbnNpZ2h0cycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBjcmVhdGVNb2NrQW5hbHlzaXNEYXRhKCk7XG4gICAgICAgICAgICBjb25zdCBpbnNpZ2h0cyA9IGF3YWl0IGF1dG9tYXRlZEluc2lnaHRzRW5naW5lLmdlbmVyYXRlQXV0b21hdGVkSW5zaWdodHMoZGF0YSk7XG5cbiAgICAgICAgICAgIGV4cGVjdChpbnNpZ2h0cykudG9CZURlZmluZWQoKTtcbiAgICAgICAgICAgIGV4cGVjdChBcnJheS5pc0FycmF5KGluc2lnaHRzKSkudG9CZSh0cnVlKTtcbiAgICAgICAgICAgIGV4cGVjdChpbnNpZ2h0cy5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKTtcblxuICAgICAgICAgICAgLy8gU2hvdWxkIGRldGVjdCB0ZXN0IGZhaWx1cmVzXG4gICAgICAgICAgICBjb25zdCB0ZXN0SW5zaWdodCA9IGluc2lnaHRzLmZpbmQoaSA9PiBpLmNhdGVnb3J5ID09PSAndGVzdGluZycpO1xuICAgICAgICAgICAgZXhwZWN0KHRlc3RJbnNpZ2h0KS50b0JlRGVmaW5lZCgpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0ZXN0KCdzaG91bGQgcHJpb3JpdGl6ZSBpbnNpZ2h0cyBjb3JyZWN0bHknLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBkYXRhID0gY3JlYXRlTW9ja0FuYWx5c2lzRGF0YSgpO1xuICAgICAgICAgICAgY29uc3QgaW5zaWdodHMgPSBhd2FpdCBhdXRvbWF0ZWRJbnNpZ2h0c0VuZ2luZS5nZW5lcmF0ZUF1dG9tYXRlZEluc2lnaHRzKGRhdGEpO1xuXG4gICAgICAgICAgICAvLyBJbnNpZ2h0cyBzaG91bGQgYmUgc29ydGVkIGJ5IHByaW9yaXR5IGFuZCBjb25maWRlbmNlXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGluc2lnaHRzLmxlbmd0aCAtIDE7IGkrKykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnQgPSBpbnNpZ2h0c1tpXTtcbiAgICAgICAgICAgICAgICBjb25zdCBuZXh0ID0gaW5zaWdodHNbaSArIDFdO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGNvbnN0IHByaW9yaXR5U2NvcmUgPSB7ICdjcml0aWNhbCc6IDQsICdoaWdoJzogMywgJ21lZGl1bSc6IDIsICdsb3cnOiAxIH07XG4gICAgICAgICAgICAgICAgY29uc3QgY3VycmVudFNjb3JlID0gcHJpb3JpdHlTY29yZVtjdXJyZW50LnByaW9yaXR5XSAqIGN1cnJlbnQuY29uZmlkZW5jZTtcbiAgICAgICAgICAgICAgICBjb25zdCBuZXh0U2NvcmUgPSBwcmlvcml0eVNjb3JlW25leHQucHJpb3JpdHldICogbmV4dC5jb25maWRlbmNlO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGV4cGVjdChjdXJyZW50U2NvcmUpLnRvQmVHcmVhdGVyVGhhbk9yRXF1YWwobmV4dFNjb3JlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGVzdCgnc2hvdWxkIGdlbmVyYXRlIGFjdGlvbmFibGUgc3VnZ2VzdGlvbnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBkYXRhID0gY3JlYXRlTW9ja0FuYWx5c2lzRGF0YSgpO1xuICAgICAgICAgICAgY29uc3QgaW5zaWdodHMgPSBhd2FpdCBhdXRvbWF0ZWRJbnNpZ2h0c0VuZ2luZS5nZW5lcmF0ZUF1dG9tYXRlZEluc2lnaHRzKGRhdGEpO1xuXG4gICAgICAgICAgICBjb25zdCBhY3Rpb25hYmxlSW5zaWdodHMgPSBpbnNpZ2h0cy5maWx0ZXIoaSA9PiBpLmFjdGlvbmFibGUpO1xuICAgICAgICAgICAgZXhwZWN0KGFjdGlvbmFibGVJbnNpZ2h0cy5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKTtcblxuICAgICAgICAgICAgYWN0aW9uYWJsZUluc2lnaHRzLmZvckVhY2goaW5zaWdodCA9PiB7XG4gICAgICAgICAgICAgICAgZXhwZWN0KGluc2lnaHQuc3VnZ2VzdGlvbnMpLnRvQmVEZWZpbmVkKCk7XG4gICAgICAgICAgICAgICAgZXhwZWN0KGluc2lnaHQuc3VnZ2VzdGlvbnMubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaW5zaWdodC5zdWdnZXN0aW9ucy5mb3JFYWNoKHN1Z2dlc3Rpb24gPT4ge1xuICAgICAgICAgICAgICAgICAgICBleHBlY3Qoc3VnZ2VzdGlvbi50aXRsZSkudG9CZURlZmluZWQoKTtcbiAgICAgICAgICAgICAgICAgICAgZXhwZWN0KHN1Z2dlc3Rpb24uZGVzY3JpcHRpb24pLnRvQmVEZWZpbmVkKCk7XG4gICAgICAgICAgICAgICAgICAgIGV4cGVjdChzdWdnZXN0aW9uLmFjdGlvbikudG9CZURlZmluZWQoKTtcbiAgICAgICAgICAgICAgICAgICAgZXhwZWN0KHN1Z2dlc3Rpb24uZXN0aW1hdGVkSW1wYWN0KS50b01hdGNoKC9eKGxvd3xtZWRpdW18aGlnaCkkLyk7XG4gICAgICAgICAgICAgICAgICAgIGV4cGVjdChzdWdnZXN0aW9uLmVzdGltYXRlZEVmZm9ydCkudG9NYXRjaCgvXihtaW51dGVzfGhvdXJzfGRheXMpJC8pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ05hdHVyYWxMYW5ndWFnZVF1ZXJ5RW5naW5lJywgKCkgPT4ge1xuICAgICAgICB0ZXN0KCdzaG91bGQgcHJvY2VzcyB0ZXN0LXJlbGF0ZWQgcXVlcmllcycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHF1ZXJ5ID0gXCJTaG93IG1lIGZhaWxpbmcgdGVzdHMgZnJvbSB0aGlzIHdlZWtcIjtcbiAgICAgICAgICAgIGNvbnN0IGNvbnRleHQgPSBjcmVhdGVNb2NrQW5hbHlzaXNEYXRhKCk7XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBuYXR1cmFsTGFuZ3VhZ2VRdWVyeUVuZ2luZS5wcm9jZXNzUXVlcnkocXVlcnksIGNvbnRleHQpO1xuXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0KS50b0JlRGVmaW5lZCgpO1xuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdC5pbnRlbnQpLnRvQmUoJ3Rlc3QtcXVlcnknKTtcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQuY29uZmlkZW5jZSkudG9CZUdyZWF0ZXJUaGFuKDAuNSk7XG4gICAgICAgICAgICBleHBlY3QocmVzdWx0LnJlc3BvbnNlKS50b0NvbnRhaW4oJ3Rlc3QnKTtcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQuc3VnZ2VzdGVkQWN0aW9ucy5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGVzdCgnc2hvdWxkIHByb2Nlc3MgZXJyb3ItcmVsYXRlZCBxdWVyaWVzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgcXVlcnkgPSBcIldoYXQgYXJlIHRoZSBtb3N0IGNvbW1vbiBlcnJvcnM/XCI7XG4gICAgICAgICAgICBjb25zdCBjb250ZXh0ID0gY3JlYXRlTW9ja0FuYWx5c2lzRGF0YSgpO1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgbmF0dXJhbExhbmd1YWdlUXVlcnlFbmdpbmUucHJvY2Vzc1F1ZXJ5KHF1ZXJ5LCBjb250ZXh0KTtcblxuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZURlZmluZWQoKTtcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQuaW50ZW50KS50b0JlKCdlcnJvci1xdWVyeScpO1xuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdC5jb25maWRlbmNlKS50b0JlR3JlYXRlclRoYW4oMC41KTtcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQucmVzcG9uc2UpLnRvQ29udGFpbignZXJyb3InKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGVzdCgnc2hvdWxkIGdlbmVyYXRlIGNvbnRleHR1YWwgcXVlcnkgc3VnZ2VzdGlvbnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBjb250ZXh0ID0gY3JlYXRlTW9ja0FuYWx5c2lzRGF0YSgpO1xuICAgICAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbnMgPSBhd2FpdCBuYXR1cmFsTGFuZ3VhZ2VRdWVyeUVuZ2luZS5nZXRRdWVyeVN1Z2dlc3Rpb25zKGNvbnRleHQpO1xuXG4gICAgICAgICAgICBleHBlY3Qoc3VnZ2VzdGlvbnMpLnRvQmVEZWZpbmVkKCk7XG4gICAgICAgICAgICBleHBlY3QoQXJyYXkuaXNBcnJheShzdWdnZXN0aW9ucykpLnRvQmUodHJ1ZSk7XG4gICAgICAgICAgICBleHBlY3Qoc3VnZ2VzdGlvbnMubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgICAgICAgICBleHBlY3Qoc3VnZ2VzdGlvbnMubGVuZ3RoKS50b0JlTGVzc1RoYW5PckVxdWFsKDgpO1xuXG4gICAgICAgICAgICAvLyBTaG91bGQgaW5jbHVkZSB0ZXN0LXJlbGF0ZWQgc3VnZ2VzdGlvbnMgZHVlIHRvIGZhaWxpbmcgdGVzdHNcbiAgICAgICAgICAgIGNvbnN0IHRlc3RTdWdnZXN0aW9uID0gc3VnZ2VzdGlvbnMuZmluZChzID0+IHMudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygndGVzdCcpKTtcbiAgICAgICAgICAgIGV4cGVjdCh0ZXN0U3VnZ2VzdGlvbikudG9CZURlZmluZWQoKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnQUlJbnNpZ2h0c0VuZ2luZSBJbnRlZ3JhdGlvbicsICgpID0+IHtcbiAgICAgICAgdGVzdCgnc2hvdWxkIGludGVncmF0ZSBQaGFzZSA0LjIgZW5naW5lcycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBjcmVhdGVNb2NrQW5hbHlzaXNEYXRhKCk7XG4gICAgICAgICAgICBjb25zdCBjb250ZXh0ID0gY3JlYXRlTW9ja0V4ZWN1dGlvbkNvbnRleHQoKTtcblxuICAgICAgICAgICAgLy8gVGVzdCBlbmhhbmNlZCBwYXR0ZXJuIGFuYWx5c2lzXG4gICAgICAgICAgICBjb25zdCBpbnNpZ2h0cyA9IGF3YWl0IGFpSW5zaWdodHNFbmdpbmUuYW5hbHl6ZVBhdHRlcm4oZGF0YSk7XG4gICAgICAgICAgICBleHBlY3QoaW5zaWdodHMpLnRvQmVEZWZpbmVkKCk7XG4gICAgICAgICAgICBleHBlY3QoaW5zaWdodHMubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XG5cbiAgICAgICAgICAgIC8vIFRlc3QgZW5oYW5jZWQgY29tbWFuZCBzdWdnZXN0aW9uc1xuICAgICAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbnMgPSBhd2FpdCBhaUluc2lnaHRzRW5naW5lLnN1Z2dlc3RDb21tYW5kKGNvbnRleHQpO1xuICAgICAgICAgICAgZXhwZWN0KHN1Z2dlc3Rpb25zKS50b0JlRGVmaW5lZCgpO1xuICAgICAgICAgICAgZXhwZWN0KHN1Z2dlc3Rpb25zLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApO1xuICAgICAgICAgICAgZXhwZWN0KHN1Z2dlc3Rpb25zLmxlbmd0aCkudG9CZUxlc3NUaGFuT3JFcXVhbCg4KTtcblxuICAgICAgICAgICAgLy8gVGVzdCBlbmhhbmNlZCBuYXR1cmFsIGxhbmd1YWdlIHByb2Nlc3NpbmdcbiAgICAgICAgICAgIGNvbnN0IHF1ZXJ5ID0gXCJTaG93IG1lIGZhaWxpbmcgdGVzdHNcIjtcbiAgICAgICAgICAgIGNvbnN0IHF1ZXJ5UmVzdWx0ID0gYXdhaXQgYWlJbnNpZ2h0c0VuZ2luZS5wcm9jZXNzTmF0dXJhbExhbmd1YWdlUXVlcnkocXVlcnksIGRhdGEpO1xuICAgICAgICAgICAgZXhwZWN0KHF1ZXJ5UmVzdWx0KS50b0JlRGVmaW5lZCgpO1xuICAgICAgICAgICAgZXhwZWN0KHF1ZXJ5UmVzdWx0LmNvbmZpZGVuY2UpLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGVzdCgnc2hvdWxkIHByb3ZpZGUgUGhhc2UgNC4yIHNwZWNpZmljIG1ldGhvZHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBkYXRhID0gY3JlYXRlTW9ja0FuYWx5c2lzRGF0YSgpO1xuICAgICAgICAgICAgY29uc3QgY29udGV4dCA9IGNyZWF0ZU1vY2tFeGVjdXRpb25Db250ZXh0KCk7XG5cbiAgICAgICAgICAgIC8vIFRlc3QgcXVlcnkgc3VnZ2VzdGlvbnNcbiAgICAgICAgICAgIGNvbnN0IHF1ZXJ5U3VnZ2VzdGlvbnMgPSBhd2FpdCBhaUluc2lnaHRzRW5naW5lLmdldFF1ZXJ5U3VnZ2VzdGlvbnMoZGF0YSk7XG4gICAgICAgICAgICBleHBlY3QocXVlcnlTdWdnZXN0aW9ucykudG9CZURlZmluZWQoKTtcbiAgICAgICAgICAgIGV4cGVjdChBcnJheS5pc0FycmF5KHF1ZXJ5U3VnZ2VzdGlvbnMpKS50b0JlKHRydWUpO1xuXG4gICAgICAgICAgICAvLyBUZXN0IGV4ZWN1dGlvbiBwYXR0ZXJuIGFuYWx5c2lzXG4gICAgICAgICAgICBhd2FpdCBhaUluc2lnaHRzRW5naW5lLmFuYWx5emVFeGVjdXRpb25QYXR0ZXJucyhkYXRhLmNvbW1hbmRIaXN0b3J5KTtcbiAgICAgICAgICAgIC8vIFNob3VsZCBub3QgdGhyb3dcblxuICAgICAgICAgICAgLy8gVGVzdCBjb21tYW5kIHN1Y2Nlc3MgcHJlZGljdGlvblxuICAgICAgICAgICAgY29uc3QgcHJlZGljdGlvbnMgPSBhd2FpdCBhaUluc2lnaHRzRW5naW5lLnByZWRpY3RDb21tYW5kU3VjY2Vzcyhjb250ZXh0KTtcbiAgICAgICAgICAgIGV4cGVjdChwcmVkaWN0aW9ucykudG9CZURlZmluZWQoKTtcbiAgICAgICAgICAgIGV4cGVjdChwcmVkaWN0aW9ucyBpbnN0YW5jZW9mIE1hcCkudG9CZSh0cnVlKTtcblxuICAgICAgICAgICAgLy8gVGVzdCBxdWVyeSBhbmFseXRpY3NcbiAgICAgICAgICAgIGNvbnN0IGFuYWx5dGljcyA9IGF3YWl0IGFpSW5zaWdodHNFbmdpbmUuZ2V0UXVlcnlBbmFseXRpY3MoKTtcbiAgICAgICAgICAgIGV4cGVjdChhbmFseXRpY3MpLnRvQmVEZWZpbmVkKCk7XG4gICAgICAgICAgICBleHBlY3QoYW5hbHl0aWNzKS50b0hhdmVQcm9wZXJ0eSgncGF0dGVybnMnKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGVzdCgnc2hvdWxkIHNhdmUgYW5kIGRpc3Bvc2UgZW5naW5lIHN0YXRlcyBwcm9wZXJseScsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGF3YWl0IGFpSW5zaWdodHNFbmdpbmUuc2F2ZUVuZ2luZVN0YXRlcygpO1xuICAgICAgICAgICAgLy8gU2hvdWxkIG5vdCB0aHJvd1xuXG4gICAgICAgICAgICBhaUluc2lnaHRzRW5naW5lLmRpc3Bvc2UoKTtcbiAgICAgICAgICAgIC8vIFNob3VsZCBub3QgdGhyb3dcbiAgICAgICAgfSk7XG4gICAgfSk7XG59KTtcbiJdLCJ2ZXJzaW9uIjozfQ==