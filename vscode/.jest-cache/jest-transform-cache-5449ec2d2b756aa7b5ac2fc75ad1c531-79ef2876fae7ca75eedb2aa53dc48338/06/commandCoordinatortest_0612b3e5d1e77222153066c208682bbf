9a6c7a53d83465d21a53b83d498ec500
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
// Mock dependencies
jest.mock('../statusTracker');
jest.mock('../streamingRunner');
jest.mock('vscode');
const commandCoordinator_1 = require("../commandCoordinator");
const statusTracker_1 = require("../statusTracker");
const streamingRunner_1 = require("../streamingRunner");
describe('CommandCoordinator', () => {
    let coordinator;
    let mockStatusTracker;
    let mockContext;
    let mockStreamingRunner;
    beforeEach(() => {
        mockContext = {
            subscriptions: [],
            globalState: {
                get: jest.fn(),
                update: jest.fn()
            }
        };
        mockStatusTracker = new statusTracker_1.StatusTracker();
        mockStatusTracker.startCommand = jest.fn().mockReturnValue('test-command-id');
        mockStatusTracker.completeCommand = jest.fn();
        mockStatusTracker.updateStatus = jest.fn();
        mockStatusTracker.appendOutput = jest.fn();
        mockStatusTracker.appendError = jest.fn();
        mockStatusTracker.updateProgress = jest.fn();
        mockStatusTracker.cancelCommand = jest.fn();
        mockStatusTracker.getAllStatuses = jest.fn().mockReturnValue([]);
        mockStatusTracker.getRunningCommands = jest.fn().mockReturnValue([]);
        coordinator = new commandCoordinator_1.CommandCoordinator(mockStatusTracker, mockContext);
        // Mock StreamingCommandRunner
        mockStreamingRunner = {
            executeWithStreaming: jest.fn(),
            executeTestCommand: jest.fn(),
            executeGitCommand: jest.fn(),
            executeLintCommand: jest.fn(),
            isRunning: false,
            cancel: jest.fn(),
            getCurrentOutput: jest.fn().mockReturnValue(''),
            clearOutput: jest.fn(),
            on: jest.fn(),
            removeAllListeners: jest.fn(),
            emit: jest.fn()
        };
        // Mock the StreamingCommandRunner constructor
        streamingRunner_1.StreamingCommandRunner.mockImplementation(() => mockStreamingRunner);
    });
    afterEach(() => {
        coordinator.dispose();
        jest.clearAllMocks();
    });
    describe('Command Execution', () => {
        test('should execute aiDebug command', async () => {
            const mockResult = {
                success: true,
                exitCode: 0,
                output: 'Test output',
                duration: 5000,
                outputFiles: ['output.txt']
            };
            mockStreamingRunner.executeWithStreaming.mockResolvedValue(mockResult);
            const result = await coordinator.executeCommand('aiDebug', ['test-project'], {
                project: 'test-project',
                cwd: '/test/path'
            });
            expect(mockStatusTracker.startCommand).toHaveBeenCalledWith('aiDebug', 'test-project', undefined);
            expect(mockStreamingRunner.executeWithStreaming).toHaveBeenCalled();
            expect(mockStatusTracker.completeCommand).toHaveBeenCalledWith('test-command-id', mockResult);
            expect(result).toEqual(mockResult);
        });
        test('should execute nxTest command with streaming', async () => {
            const mockResult = {
                success: true,
                exitCode: 0,
                output: 'Tests passed',
                duration: 3000,
                outputFiles: []
            };
            mockStreamingRunner.executeTestCommand.mockResolvedValue(mockResult);
            const result = await coordinator.executeCommand('nxTest', ['test-project'], {
                project: 'test-project',
                cwd: '/test/path'
            });
            expect(mockStreamingRunner.executeTestCommand).toHaveBeenCalledWith('npx', ['nx', 'test', 'test-project'], '/test/path');
            expect(result).toEqual(mockResult);
        });
        test('should execute gitDiff command', async () => {
            const mockResult = {
                success: true,
                exitCode: 0,
                output: 'Git diff output',
                duration: 2000,
                outputFiles: ['diff.txt']
            };
            mockStreamingRunner.executeGitCommand.mockResolvedValue(mockResult);
            const result = await coordinator.executeCommand('gitDiff', ['--staged'], {
                cwd: '/test/path'
            });
            expect(mockStreamingRunner.executeGitCommand).toHaveBeenCalledWith(['diff', '--staged'], '/test/path');
            expect(result).toEqual(mockResult);
        });
        test('should execute prepareToPush command', async () => {
            const mockResult = {
                success: true,
                exitCode: 0,
                output: 'Lint passed',
                duration: 4000,
                outputFiles: []
            };
            mockStreamingRunner.executeLintCommand.mockResolvedValue(mockResult);
            const result = await coordinator.executeCommand('prepareToPush', ['test-project'], {
                project: 'test-project',
                cwd: '/test/path'
            });
            expect(mockStreamingRunner.executeLintCommand).toHaveBeenCalledWith('npx', ['nx', 'lint', 'test-project'], '/test/path');
            expect(result).toEqual(mockResult);
        });
    });
    describe('Streaming Event Handling', () => {
        test('should handle streaming output events', async () => {
            const mockResult = { success: true, exitCode: 0, output: 'test', duration: 1000, outputFiles: [] };
            mockStreamingRunner.executeWithStreaming.mockResolvedValue(mockResult);
            // Mock the event handler setup
            const eventHandlers = {};
            mockStreamingRunner.on.mockImplementation((eventName, listener) => {
                eventHandlers[eventName] = listener;
                return mockStreamingRunner;
            });
            // Start command execution (don't await yet)
            const promise = coordinator.executeCommand('aiDebug', ['test-project'], {
                project: 'test-project'
            });
            // Simulate streaming events
            eventHandlers['output']('Test output line\\n');
            eventHandlers['error']('Test error line\\n');
            eventHandlers['progress'](50);
            eventHandlers['status']('Processing...');
            await promise;
            expect(mockStatusTracker.appendOutput).toHaveBeenCalledWith('test-command-id', 'Test output line\\n');
            expect(mockStatusTracker.appendError).toHaveBeenCalledWith('test-command-id', 'Test error line\\n');
            expect(mockStatusTracker.updateProgress).toHaveBeenCalledWith('test-command-id', 50);
            // This line needs to be updated based on actual CommandCoordinator implementation
            // expect(mockStatusTracker.updateStatus).toHaveBeenCalledWith({ message: 'Processing...' });
        });
        test('should emit streaming messages', async () => {
            const mockResult = { success: true, exitCode: 0, output: 'test', duration: 1000, outputFiles: [] };
            mockStreamingRunner.executeWithStreaming.mockResolvedValue(mockResult);
            const streamingMessages = [];
            coordinator.on('streaming_message', (message) => {
                streamingMessages.push(message);
            });
            const eventHandlers = {};
            mockStreamingRunner.on.mockImplementation((eventName, listener) => {
                eventHandlers[eventName] = listener;
                return mockStreamingRunner;
            });
            const promise = coordinator.executeCommand('aiDebug', ['test-project'], {
                project: 'test-project'
            });
            // Simulate events
            eventHandlers['output']('Test output');
            eventHandlers['progress'](25);
            await promise;
            expect(streamingMessages).toHaveLength(2);
            expect(streamingMessages[0].type).toBe('output');
            expect(streamingMessages[0].data.text).toBe('Test output');
            expect(streamingMessages[1].type).toBe('progress');
            expect(streamingMessages[1].data.progress).toBe(25);
        });
    });
    describe('Concurrency Control', () => {
        test('should respect maximum concurrent commands', async () => {
            coordinator.setMaxConcurrentCommands(2);
            const mockResult = { success: true, exitCode: 0, output: 'test', duration: 1000, outputFiles: [] };
            // Make the first two commands hang
            let resolveFirst = () => { };
            let resolveSecond = () => { };
            mockStreamingRunner.executeWithStreaming
                .mockImplementationOnce(() => new Promise(resolve => { resolveFirst = () => resolve(mockResult); }))
                .mockImplementationOnce(() => new Promise(resolve => { resolveSecond = () => resolve(mockResult); }))
                .mockResolvedValue(mockResult);
            // Start first two commands
            const promise1 = coordinator.executeCommand('aiDebug', ['project1'], { project: 'project1' });
            const promise2 = coordinator.executeCommand('nxTest', ['project2'], { project: 'project2' });
            // Third command should be queued
            const promise3 = coordinator.executeCommand('gitDiff', [], {});
            const status = coordinator.getExecutionStatus();
            expect(status.active).toBe(2);
            expect(status.queued).toBe(1);
            // Complete first command
            resolveFirst();
            await promise1;
            // Third command should now be processing
            expect(coordinator.getExecutionStatus().active).toBe(2);
            // Complete remaining commands
            resolveSecond();
            await Promise.all([promise2, promise3]);
        });
        test('should handle high priority commands', async () => {
            coordinator.setMaxConcurrentCommands(1);
            const mockResult = { success: true, exitCode: 0, output: 'test', duration: 1000, outputFiles: [] };
            // Make first command hang
            let resolveFirst = () => { };
            mockStreamingRunner.executeWithStreaming
                .mockImplementationOnce(() => new Promise(resolve => { resolveFirst = () => resolve(mockResult); }))
                .mockResolvedValue(mockResult);
            Object.defineProperty(mockStreamingRunner, 'isRunning', { value: true, writable: true });
            // Start first command
            const promise1 = coordinator.executeCommand('aiDebug', ['project1'], { project: 'project1' });
            // High priority command should cancel the first one
            const promise2 = coordinator.executeCommand('nxTest', ['project2'], {
                project: 'project2',
                priority: 'high'
            });
            expect(mockStreamingRunner.cancel).toHaveBeenCalled();
            expect(mockStatusTracker.cancelCommand).toHaveBeenCalled();
            resolveFirst();
            await Promise.all([promise1, promise2]);
        });
    });
    describe('Command Cancellation', () => {
        test('should cancel running command', () => {
            const commandId = 'test-command-id';
            Object.defineProperty(mockStreamingRunner, 'isRunning', { value: true, writable: true });
            // Simulate active command
            coordinator.activeCommands.set(commandId, mockStreamingRunner);
            const result = coordinator.cancelCommand(commandId);
            expect(result).toBe(true);
            expect(mockStreamingRunner.cancel).toHaveBeenCalled();
            expect(mockStatusTracker.cancelCommand).toHaveBeenCalledWith(commandId);
        });
        test('should not cancel non-running command', () => {
            const commandId = 'test-command-id';
            Object.defineProperty(mockStreamingRunner, 'isRunning', { value: false, writable: true });
            const result = coordinator.cancelCommand(commandId);
            expect(result).toBe(false);
            expect(mockStreamingRunner.cancel).not.toHaveBeenCalled();
        });
        test('should cancel all running commands', () => {
            const commands = ['cmd1', 'cmd2', 'cmd3'];
            commands.forEach(cmdId => {
                const runner = { ...mockStreamingRunner, isRunning: true };
                coordinator.activeCommands.set(cmdId, runner);
            });
            coordinator.cancelAllCommands();
            commands.forEach(cmdId => {
                expect(mockStatusTracker.cancelCommand).toHaveBeenCalledWith(cmdId);
            });
        });
    });
    describe('Output Management', () => {
        test('should get command output', () => {
            const commandId = 'test-command-id';
            const expectedOutput = 'Command output here';
            mockStreamingRunner.getCurrentOutput.mockReturnValue(expectedOutput);
            coordinator.activeCommands.set(commandId, mockStreamingRunner);
            const output = coordinator.getCommandOutput(commandId);
            expect(output).toBe(expectedOutput);
            expect(mockStreamingRunner.getCurrentOutput).toHaveBeenCalled();
        });
        test('should clear command output', () => {
            const commandId = 'test-command-id';
            coordinator.activeCommands.set(commandId, mockStreamingRunner);
            coordinator.clearCommandOutput(commandId);
            expect(mockStreamingRunner.clearOutput).toHaveBeenCalled();
        });
        test('should return empty string for non-existent command output', () => {
            const output = coordinator.getCommandOutput('non-existent');
            expect(output).toBe('');
        });
    });
    describe('Metrics and Reporting', () => {
        test('should get execution metrics', () => {
            const mockStats = {
                total: 10,
                successful: 8,
                failed: 2,
                averageDuration: 5000,
                lastRun: new Date(),
                recentCommands: []
            };
            mockStatusTracker.getCommandStats.mockReturnValue(mockStats);
            const metrics = coordinator.getExecutionMetrics();
            expect(metrics.totalCommands).toBe(10);
            expect(metrics.successRate).toBe(80);
            expect(metrics.averageExecutionTime).toBe(5000);
        });
        test('should create health report', () => {
            const mockStatuses = [
                {
                    id: 'cmd1',
                    command: 'aiDebug',
                    action: 'aiDebug',
                    status: 'running',
                    progress: 75,
                    message: 'Processing...',
                    startTime: new Date(),
                    project: 'test-project',
                    output: '',
                    outputFiles: [],
                    metadata: {}
                }
            ];
            mockStatusTracker.getAllStatuses.mockReturnValue(mockStatuses);
            mockStatusTracker.getCommandStats.mockReturnValue({
                total: 5,
                successful: 4,
                failed: 1,
                averageDuration: 3000,
                recentCommands: []
            });
            const report = coordinator.createHealthReport();
            expect(report).toContain('COMMAND EXECUTION HEALTH REPORT');
            expect(report).toContain('ACTIVE COMMANDS');
            expect(report).toContain('PERFORMANCE METRICS');
            expect(report).toContain('RECOMMENDATIONS');
            expect(report).toContain('Processing...');
            expect(report).toContain('75%');
        });
    });
    describe('Queue Management', () => {
        test('should emit queue update events', async () => {
            coordinator.setMaxConcurrentCommands(1);
            const queueUpdates = [];
            coordinator.on('queue_update', (data) => {
                queueUpdates.push(data);
            });
            const mockResult = { success: true, exitCode: 0, output: 'test', duration: 1000, outputFiles: [] };
            let resolveFirst = () => { };
            mockStreamingRunner.executeWithStreaming
                .mockImplementationOnce(() => new Promise(resolve => { resolveFirst = () => resolve(mockResult); }))
                .mockResolvedValue(mockResult);
            // Start first command (will run immediately)
            const promise1 = coordinator.executeCommand('aiDebug', ['project1'], { project: 'project1' });
            // Start second command (will be queued)
            const promise2 = coordinator.executeCommand('nxTest', ['project2'], { project: 'project2' });
            // Should have emitted a queue update
            expect(queueUpdates.length).toBeGreaterThan(0);
            expect(queueUpdates[0]).toHaveProperty('queued');
            resolveFirst();
            await Promise.all([promise1, promise2]);
        });
    });
    describe('Error Handling', () => {
        test('should handle command execution errors', async () => {
            const error = new Error('Command failed');
            mockStreamingRunner.executeWithStreaming.mockRejectedValue(error);
            await expect(coordinator.executeCommand('aiDebug', ['test-project'], {
                project: 'test-project'
            })).rejects.toThrow('Command failed');
            expect(mockStatusTracker.updateStatus).toHaveBeenCalledWith({
                isRunning: false,
                message: 'Command failed'
            });
        });
        test('should handle cleanup after errors', async () => {
            const error = new Error('Test error');
            mockStreamingRunner.executeWithStreaming.mockRejectedValue(error);
            try {
                await coordinator.executeCommand('aiDebug', ['test-project'], {
                    project: 'test-project'
                });
            }
            catch (e) {
                // Expected error
            }
            // Should clean up the runner
            expect(mockStreamingRunner.removeAllListeners).toHaveBeenCalled();
        });
    });
    describe('Configuration', () => {
        test('should set maximum concurrent commands within bounds', () => {
            coordinator.setMaxConcurrentCommands(0); // Below minimum
            expect(coordinator.getExecutionStatus().maxConcurrent).toBe(1);
            coordinator.setMaxConcurrentCommands(15); // Above maximum
            expect(coordinator.getExecutionStatus().maxConcurrent).toBe(10);
            coordinator.setMaxConcurrentCommands(5); // Valid value
            expect(coordinator.getExecutionStatus().maxConcurrent).toBe(5);
        });
    });
    describe('Disposal', () => {
        test('should dispose properly', () => {
            // Add some mock active commands
            coordinator.activeCommands.set('cmd1', mockStreamingRunner);
            coordinator.activeCommands.set('cmd2', mockStreamingRunner);
            coordinator.dispose();
            expect(mockStreamingRunner.cancel).toHaveBeenCalledTimes(2);
            expect(coordinator.activeCommands.size).toBe(0);
            expect(coordinator.commandQueue.length).toBe(0);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2dyZWdkdW5uL3NyYy90ZXN0L2FpX2RlYnVnX2NvbnRleHQvdnNjb2RlL3NyYy91dGlscy9fX3Rlc3RzX18vY29tbWFuZENvb3JkaW5hdG9yLnRlc3QudHMiLCJtYXBwaW5ncyI6Ijs7QUFLQSxvQkFBb0I7QUFDcEIsSUFBSSxDQUFDLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDO0FBQzlCLElBQUksQ0FBQyxJQUFJLENBQUMsb0JBQW9CLENBQUMsQ0FBQztBQUNoQyxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO0FBUnBCLDhEQUEyRDtBQUMzRCxvREFBaUQ7QUFDakQsd0RBQTREO0FBUTVELFFBQVEsQ0FBQyxvQkFBb0IsRUFBRSxHQUFHLEVBQUU7SUFDaEMsSUFBSSxXQUErQixDQUFDO0lBQ3BDLElBQUksaUJBQTZDLENBQUM7SUFDbEQsSUFBSSxXQUFvQyxDQUFDO0lBQ3pDLElBQUksbUJBQXdELENBQUM7SUFFN0QsVUFBVSxDQUFDLEdBQUcsRUFBRTtRQUNaLFdBQVcsR0FBRztZQUNWLGFBQWEsRUFBRSxFQUFFO1lBQ2pCLFdBQVcsRUFBRTtnQkFDVCxHQUFHLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtnQkFDZCxNQUFNLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTthQUNwQjtTQUNHLENBQUM7UUFFVCxpQkFBaUIsR0FBRyxJQUFJLDZCQUFhLEVBQWdDLENBQUM7UUFDdEUsaUJBQWlCLENBQUMsWUFBWSxHQUFHLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxlQUFlLENBQUMsaUJBQWlCLENBQUMsQ0FBQztRQUM5RSxpQkFBaUIsQ0FBQyxlQUFlLEdBQUcsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDO1FBQzlDLGlCQUFpQixDQUFDLFlBQVksR0FBRyxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUM7UUFDM0MsaUJBQWlCLENBQUMsWUFBWSxHQUFHLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQztRQUMzQyxpQkFBaUIsQ0FBQyxXQUFXLEdBQUcsSUFB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O1FBQzdELENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQyxDQUFDLENBQUM7QUFDUCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMvZ3JlZ2R1bm4vc3JjL3Rlc3QvYWlfZGVidWdfY29udGV4dC92c2NvZGUvc3JjL3V0aWxzL19fdGVzdHNfXy9jb21tYW5kQ29vcmRpbmF0b3IudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21tYW5kQ29vcmRpbmF0b3IgfSBmcm9tICcuLi9jb21tYW5kQ29vcmRpbmF0b3InO1xuaW1wb3J0IHsgU3RhdHVzVHJhY2tlciB9IGZyb20gJy4uL3N0YXR1c1RyYWNrZXInO1xuaW1wb3J0IHsgU3RyZWFtaW5nQ29tbWFuZFJ1bm5lciB9IGZyb20gJy4uL3N0cmVhbWluZ1J1bm5lcic7XG5pbXBvcnQgKiBhcyB2c2NvZGUgZnJvbSAndnNjb2RlJztcblxuLy8gTW9jayBkZXBlbmRlbmNpZXNcbmplc3QubW9jaygnLi4vc3RhdHVzVHJhY2tlcicpO1xuamVzdC5tb2NrKCcuLi9zdHJlYW1pbmdSdW5uZXInKTtcbmplc3QubW9jaygndnNjb2RlJyk7XG5cbmRlc2NyaWJlKCdDb21tYW5kQ29vcmRpbmF0b3InLCAoKSA9PiB7XG4gICAgbGV0IGNvb3JkaW5hdG9yOiBDb21tYW5kQ29vcmRpbmF0b3I7XG4gICAgbGV0IG1vY2tTdGF0dXNUcmFja2VyOiBqZXN0Lk1vY2tlZDxTdGF0dXNUcmFja2VyPjtcbiAgICBsZXQgbW9ja0NvbnRleHQ6IHZzY29kZS5FeHRlbnNpb25Db250ZXh0O1xuICAgIGxldCBtb2NrU3RyZWFtaW5nUnVubmVyOiBqZXN0Lk1vY2tlZDxTdHJlYW1pbmdDb21tYW5kUnVubmVyPjtcblxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgICBtb2NrQ29udGV4dCA9IHtcbiAgICAgICAgICAgIHN1YnNjcmlwdGlvbnM6IFtdLFxuICAgICAgICAgICAgZ2xvYmFsU3RhdGU6IHtcbiAgICAgICAgICAgICAgICBnZXQ6IGplc3QuZm4oKSxcbiAgICAgICAgICAgICAgICB1cGRhdGU6IGplc3QuZm4oKVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGFzIGFueTtcblxuICAgICAgICBtb2NrU3RhdHVzVHJhY2tlciA9IG5ldyBTdGF0dXNUcmFja2VyKCkgYXMgamVzdC5Nb2NrZWQ8U3RhdHVzVHJhY2tlcj47XG4gICAgICAgIG1vY2tTdGF0dXNUcmFja2VyLnN0YXJ0Q29tbWFuZCA9IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoJ3Rlc3QtY29tbWFuZC1pZCcpO1xuICAgICAgICBtb2NrU3RhdHVzVHJhY2tlci5jb21wbGV0ZUNvbW1hbmQgPSBqZXN0LmZuKCk7XG4gICAgICAgIG1vY2tTdGF0dXNUcmFja2VyLnVwZGF0ZVN0YXR1cyA9IGplc3QuZm4oKTtcbiAgICAgICAgbW9ja1N0YXR1c1RyYWNrZXIuYXBwZW5kT3V0cHV0ID0gamVzdC5mbigpO1xuICAgICAgICBtb2NrU3RhdHVzVHJhY2tlci5hcHBlbmRFcnJvciA9IGplc3QuZm4oKTtcbiAgICAgICAgbW9ja1N0YXR1c1RyYWNrZXIudXBkYXRlUHJvZ3Jlc3MgPSBqZXN0LmZuKCk7XG4gICAgICAgIG1vY2tTdGF0dXNUcmFja2VyLmNhbmNlbENvbW1hbmQgPSBqZXN0LmZuKCk7XG4gICAgICAgIG1vY2tTdGF0dXNUcmFja2VyLmdldEFsbFN0YXR1c2VzID0gamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZShbXSk7XG4gICAgICAgIG1vY2tTdGF0dXNUcmFja2VyLmdldFJ1bm5pbmdDb21tYW5kcyA9IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoW10pO1xuXG4gICAgICAgIGNvb3JkaW5hdG9yID0gbmV3IENvbW1hbmRDb29yZGluYXRvcihtb2NrU3RhdHVzVHJhY2tlciwgbW9ja0NvbnRleHQpO1xuXG4gICAgICAgIC8vIE1vY2sgU3RyZWFtaW5nQ29tbWFuZFJ1bm5lclxuICAgICAgICBtb2NrU3RyZWFtaW5nUnVubmVyID0ge1xuICAgICAgICAgICAgZXhlY3V0ZVdpdGhTdHJlYW1pbmc6IGplc3QuZm4oKSxcbiAgICAgICAgICAgIGV4ZWN1dGVUZXN0Q29tbWFuZDogamVzdC5mbigpLFxuICAgICAgICAgICAgZXhlY3V0ZUdpdENvbW1hbmQ6IGplc3QuZm4oKSxcbiAgICAgICAgICAgIGV4ZWN1dGVMaW50Q29tbWFuZDogamVzdC5mbigpLFxuICAgICAgICAgICAgaXNSdW5uaW5nOiBmYWxzZSxcbiAgICAgICAgICAgIGNhbmNlbDogamVzdC5mbigpLFxuICAgICAgICAgICAgZ2V0Q3VycmVudE91dHB1dDogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSgnJyksXG4gICAgICAgICAgICBjbGVhck91dHB1dDogamVzdC5mbigpLFxuICAgICAgICAgICAgb246IGplc3QuZm4oKSxcbiAgICAgICAgICAgIHJlbW92ZUFsbExpc3RlbmVyczogamVzdC5mbigpLFxuICAgICAgICAgICAgZW1pdDogamVzdC5mbigpXG4gICAgICAgIH0gYXMgYW55O1xuXG4gICAgICAgIC8vIE1vY2sgdGhlIFN0cmVhbWluZ0NvbW1hbmRSdW5uZXIgY29uc3RydWN0b3JcbiAgICAgICAgKFN0cmVhbWluZ0NvbW1hbmRSdW5uZXIgYXMgamVzdC5Nb2NrZWRDbGFzczx0eXBlb2YgU3RyZWFtaW5nQ29tbWFuZFJ1bm5lcj4pLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiBtb2NrU3RyZWFtaW5nUnVubmVyKTtcbiAgICB9KTtcblxuICAgIGFmdGVyRWFjaCgoKSA9PiB7XG4gICAgICAgIGNvb3JkaW5hdG9yLmRpc3Bvc2UoKTtcbiAgICAgICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnQ29tbWFuZCBFeGVjdXRpb24nLCAoKSA9PiB7XG4gICAgICAgIHRlc3QoJ3Nob3VsZCBleGVjdXRlIGFpRGVidWcgY29tbWFuZCcsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG1vY2tSZXN1bHQgPSB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICBleGl0Q29kZTogMCxcbiAgICAgICAgICAgICAgICBvdXRwdXQ6ICdUZXN0IG91dHB1dCcsXG4gICAgICAgICAgICAgICAgZHVyYXRpb246IDUwMDAsXG4gICAgICAgICAgICAgICAgb3V0cHV0RmlsZXM6IFsnb3V0cHV0LnR4dCddXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBtb2NrU3RyZWFtaW5nUnVubmVyLmV4ZWN1dGVXaXRoU3RyZWFtaW5nLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tSZXN1bHQpO1xuXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb29yZGluYXRvci5leGVjdXRlQ29tbWFuZCgnYWlEZWJ1ZycsIFsndGVzdC1wcm9qZWN0J10sIHtcbiAgICAgICAgICAgICAgICBwcm9qZWN0OiAndGVzdC1wcm9qZWN0JyxcbiAgICAgICAgICAgICAgICBjd2Q6ICcvdGVzdC9wYXRoJ1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGV4cGVjdChtb2NrU3RhdHVzVHJhY2tlci5zdGFydENvbW1hbmQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdhaURlYnVnJywgJ3Rlc3QtcHJvamVjdCcsIHVuZGVmaW5lZCk7XG4gICAgICAgICAgICBleHBlY3QobW9ja1N0cmVhbWluZ1J1bm5lci5leGVjdXRlV2l0aFN0cmVhbWluZykudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgICAgICAgICAgZXhwZWN0KG1vY2tTdGF0dXNUcmFja2VyLmNvbXBsZXRlQ29tbWFuZCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ3Rlc3QtY29tbWFuZC1pZCcsIG1vY2tSZXN1bHQpO1xuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChtb2NrUmVzdWx0KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGVzdCgnc2hvdWxkIGV4ZWN1dGUgbnhUZXN0IGNvbW1hbmQgd2l0aCBzdHJlYW1pbmcnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBtb2NrUmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgZXhpdENvZGU6IDAsXG4gICAgICAgICAgICAgICAgb3V0cHV0OiAnVGVzdHMgcGFzc2VkJyxcbiAgICAgICAgICAgICAgICBkdXJhdGlvbjogMzAwMCxcbiAgICAgICAgICAgICAgICBvdXRwdXRGaWxlczogW11cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIG1vY2tTdHJlYW1pbmdSdW5uZXIuZXhlY3V0ZVRlc3RDb21tYW5kLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tSZXN1bHQpO1xuXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb29yZGluYXRvci5leGVjdXRlQ29tbWFuZCgnbnhUZXN0JywgWyd0ZXN0LXByb2plY3QnXSwge1xuICAgICAgICAgICAgICAgIHByb2plY3Q6ICd0ZXN0LXByb2plY3QnLFxuICAgICAgICAgICAgICAgIGN3ZDogJy90ZXN0L3BhdGgnXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgZXhwZWN0KG1vY2tTdHJlYW1pbmdSdW5uZXIuZXhlY3V0ZVRlc3RDb21tYW5kKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgICAgICAgICAnbnB4JyxcbiAgICAgICAgICAgICAgICBbJ254JywgJ3Rlc3QnLCAndGVzdC1wcm9qZWN0J10sXG4gICAgICAgICAgICAgICAgJy90ZXN0L3BhdGgnXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChtb2NrUmVzdWx0KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGVzdCgnc2hvdWxkIGV4ZWN1dGUgZ2l0RGlmZiBjb21tYW5kJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgbW9ja1Jlc3VsdCA9IHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICAgIGV4aXRDb2RlOiAwLFxuICAgICAgICAgICAgICAgIG91dHB1dDogJ0dpdCBkaWZmIG91dHB1dCcsXG4gICAgICAgICAgICAgICAgZHVyYXRpb246IDIwMDAsXG4gICAgICAgICAgICAgICAgb3V0cHV0RmlsZXM6IFsnZGlmZi50eHQnXVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgbW9ja1N0cmVhbWluZ1J1bm5lci5leGVjdXRlR2l0Q29tbWFuZC5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrUmVzdWx0KTtcblxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29vcmRpbmF0b3IuZXhlY3V0ZUNvbW1hbmQoJ2dpdERpZmYnLCBbJy0tc3RhZ2VkJ10sIHtcbiAgICAgICAgICAgICAgICBjd2Q6ICcvdGVzdC9wYXRoJ1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGV4cGVjdChtb2NrU3RyZWFtaW5nUnVubmVyLmV4ZWN1dGVHaXRDb21tYW5kKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgICAgICAgICBbJ2RpZmYnLCAnLS1zdGFnZWQnXSxcbiAgICAgICAgICAgICAgICAnL3Rlc3QvcGF0aCdcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKG1vY2tSZXN1bHQpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0ZXN0KCdzaG91bGQgZXhlY3V0ZSBwcmVwYXJlVG9QdXNoIGNvbW1hbmQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBtb2NrUmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgZXhpdENvZGU6IDAsXG4gICAgICAgICAgICAgICAgb3V0cHV0OiAnTGludCBwYXNzZWQnLFxuICAgICAgICAgICAgICAgIGR1cmF0aW9uOiA0MDAwLFxuICAgICAgICAgICAgICAgIG91dHB1dEZpbGVzOiBbXVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgbW9ja1N0cmVhbWluZ1J1bm5lci5leGVjdXRlTGludENvbW1hbmQubW9ja1Jlc29sdmVkVmFsdWUobW9ja1Jlc3VsdCk7XG5cbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvb3JkaW5hdG9yLmV4ZWN1dGVDb21tYW5kKCdwcmVwYXJlVG9QdXNoJywgWyd0ZXN0LXByb2plY3QnXSwge1xuICAgICAgICAgICAgICAgIHByb2plY3Q6ICd0ZXN0LXByb2plY3QnLFxuICAgICAgICAgICAgICAgIGN3ZDogJy90ZXN0L3BhdGgnXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgZXhwZWN0KG1vY2tTdHJlYW1pbmdSdW5uZXIuZXhlY3V0ZUxpbnRDb21tYW5kKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgICAgICAgICAnbnB4JyxcbiAgICAgICAgICAgICAgICBbJ254JywgJ2xpbnQnLCAndGVzdC1wcm9qZWN0J10sXG4gICAgICAgICAgICAgICAgJy90ZXN0L3BhdGgnXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChtb2NrUmVzdWx0KTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnU3RyZWFtaW5nIEV2ZW50IEhhbmRsaW5nJywgKCkgPT4ge1xuICAgICAgICB0ZXN0KCdzaG91bGQgaGFuZGxlIHN0cmVhbWluZyBvdXRwdXQgZXZlbnRzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgbW9ja1Jlc3VsdCA9IHsgc3VjY2VzczogdHJ1ZSwgZXhpdENvZGU6IDAsIG91dHB1dDogJ3Rlc3QnLCBkdXJhdGlvbjogMTAwMCwgb3V0cHV0RmlsZXM6IFtdIH07XG4gICAgICAgICAgICBtb2NrU3RyZWFtaW5nUnVubmVyLmV4ZWN1dGVXaXRoU3RyZWFtaW5nLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tSZXN1bHQpO1xuXG4gICAgICAgICAgICAvLyBNb2NrIHRoZSBldmVudCBoYW5kbGVyIHNldHVwXG4gICAgICAgICAgICBjb25zdCBldmVudEhhbmRsZXJzOiBSZWNvcmQ8c3RyaW5nLCBGdW5jdGlvbj4gPSB7fTtcbiAgICAgICAgICAgIG1vY2tTdHJlYW1pbmdSdW5uZXIub24ubW9ja0ltcGxlbWVudGF0aW9uKChldmVudE5hbWU6IHN0cmluZyB8IHN5bWJvbCwgbGlzdGVuZXI6ICguLi5hcmdzOiBhbnlbXSkgPT4gdm9pZCkgPT4ge1xuICAgICAgICAgICAgICAgIGV2ZW50SGFuZGxlcnNbZXZlbnROYW1lIGFzIHN0cmluZ10gPSBsaXN0ZW5lcjtcbiAgICAgICAgICAgICAgICByZXR1cm4gbW9ja1N0cmVhbWluZ1J1bm5lcjtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBTdGFydCBjb21tYW5kIGV4ZWN1dGlvbiAoZG9uJ3QgYXdhaXQgeWV0KVxuICAgICAgICAgICAgY29uc3QgcHJvbWlzZSA9IGNvb3JkaW5hdG9yLmV4ZWN1dGVDb21tYW5kKCdhaURlYnVnJywgWyd0ZXN0LXByb2plY3QnXSwge1xuICAgICAgICAgICAgICAgIHByb2plY3Q6ICd0ZXN0LXByb2plY3QnXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gU2ltdWxhdGUgc3RyZWFtaW5nIGV2ZW50c1xuICAgICAgICAgICAgZXZlbnRIYW5kbGVyc1snb3V0cHV0J10oJ1Rlc3Qgb3V0cHV0IGxpbmVcXFxcbicpO1xuICAgICAgICAgICAgZXZlbnRIYW5kbGVyc1snZXJyb3InXSgnVGVzdCBlcnJvciBsaW5lXFxcXG4nKTtcbiAgICAgICAgICAgIGV2ZW50SGFuZGxlcnNbJ3Byb2dyZXNzJ10oNTApO1xuICAgICAgICAgICAgZXZlbnRIYW5kbGVyc1snc3RhdHVzJ10oJ1Byb2Nlc3NpbmcuLi4nKTtcblxuICAgICAgICAgICAgYXdhaXQgcHJvbWlzZTtcblxuICAgICAgICAgICAgZXhwZWN0KG1vY2tTdGF0dXNUcmFja2VyLmFwcGVuZE91dHB1dCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ3Rlc3QtY29tbWFuZC1pZCcsICdUZXN0IG91dHB1dCBsaW5lXFxcXG4nKTtcbiAgICAgICAgICAgIGV4cGVjdChtb2NrU3RhdHVzVHJhY2tlci5hcHBlbmRFcnJvcikudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ3Rlc3QtY29tbWFuZC1pZCcsICdUZXN0IGVycm9yIGxpbmVcXFxcbicpO1xuICAgICAgICAgICAgZXhwZWN0KG1vY2tTdGF0dXNUcmFja2VyLnVwZGF0ZVByb2dyZXNzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgndGVzdC1jb21tYW5kLWlkJywgNTApO1xuICAgICAgICAgICAgLy8gVGhpcyBsaW5lIG5lZWRzIHRvIGJlIHVwZGF0ZWQgYmFzZWQgb24gYWN0dWFsIENvbW1hbmRDb29yZGluYXRvciBpbXBsZW1lbnRhdGlvblxuICAgICAgICAgICAgLy8gZXhwZWN0KG1vY2tTdGF0dXNUcmFja2VyLnVwZGF0ZVN0YXR1cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoeyBtZXNzYWdlOiAnUHJvY2Vzc2luZy4uLicgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRlc3QoJ3Nob3VsZCBlbWl0IHN0cmVhbWluZyBtZXNzYWdlcycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG1vY2tSZXN1bHQgPSB7IHN1Y2Nlc3M6IHRydWUsIGV4aXRDb2RlOiAwLCBvdXRwdXQ6ICd0ZXN0JywgZHVyYXRpb246IDEwMDAsIG91dHB1dEZpbGVzOiBbXSB9O1xuICAgICAgICAgICAgbW9ja1N0cmVhbWluZ1J1bm5lci5leGVjdXRlV2l0aFN0cmVhbWluZy5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrUmVzdWx0KTtcblxuICAgICAgICAgICAgY29uc3Qgc3RyZWFtaW5nTWVzc2FnZXM6IGFueVtdID0gW107XG4gICAgICAgICAgICBjb29yZGluYXRvci5vbignc3RyZWFtaW5nX21lc3NhZ2UnLCAobWVzc2FnZSkgPT4ge1xuICAgICAgICAgICAgICAgIHN0cmVhbWluZ01lc3NhZ2VzLnB1c2gobWVzc2FnZSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgY29uc3QgZXZlbnRIYW5kbGVyczogUmVjb3JkPHN0cmluZywgRnVuY3Rpb24+ID0ge307XG4gICAgICAgICAgICBtb2NrU3RyZWFtaW5nUnVubmVyLm9uLm1vY2tJbXBsZW1lbnRhdGlvbigoZXZlbnROYW1lOiBzdHJpbmcgfCBzeW1ib2wsIGxpc3RlbmVyOiAoLi4uYXJnczogYW55W10pID0+IHZvaWQpID0+IHtcbiAgICAgICAgICAgICAgICBldmVudEhhbmRsZXJzW2V2ZW50TmFtZSBhcyBzdHJpbmddID0gbGlzdGVuZXI7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1vY2tTdHJlYW1pbmdSdW5uZXI7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgY29uc3QgcHJvbWlzZSA9IGNvb3JkaW5hdG9yLmV4ZWN1dGVDb21tYW5kKCdhaURlYnVnJywgWyd0ZXN0LXByb2plY3QnXSwge1xuICAgICAgICAgICAgICAgIHByb2plY3Q6ICd0ZXN0LXByb2plY3QnXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gU2ltdWxhdGUgZXZlbnRzXG4gICAgICAgICAgICBldmVudEhhbmRsZXJzWydvdXRwdXQnXSgnVGVzdCBvdXRwdXQnKTtcbiAgICAgICAgICAgIGV2ZW50SGFuZGxlcnNbJ3Byb2dyZXNzJ10oMjUpO1xuXG4gICAgICAgICAgICBhd2FpdCBwcm9taXNlO1xuXG4gICAgICAgICAgICBleHBlY3Qoc3RyZWFtaW5nTWVzc2FnZXMpLnRvSGF2ZUxlbmd0aCgyKTtcbiAgICAgICAgICAgIGV4cGVjdChzdHJlYW1pbmdNZXNzYWdlc1swXS50eXBlKS50b0JlKCdvdXRwdXQnKTtcbiAgICAgICAgICAgIGV4cGVjdChzdHJlYW1pbmdNZXNzYWdlc1swXS5kYXRhLnRleHQpLnRvQmUoJ1Rlc3Qgb3V0cHV0Jyk7XG4gICAgICAgICAgICBleHBlY3Qoc3RyZWFtaW5nTWVzc2FnZXNbMV0udHlwZSkudG9CZSgncHJvZ3Jlc3MnKTtcbiAgICAgICAgICAgIGV4cGVjdChzdHJlYW1pbmdNZXNzYWdlc1sxXS5kYXRhLnByb2dyZXNzKS50b0JlKDI1KTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnQ29uY3VycmVuY3kgQ29udHJvbCcsICgpID0+IHtcbiAgICAgICAgdGVzdCgnc2hvdWxkIHJlc3BlY3QgbWF4aW11bSBjb25jdXJyZW50IGNvbW1hbmRzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgY29vcmRpbmF0b3Iuc2V0TWF4Q29uY3VycmVudENvbW1hbmRzKDIpO1xuXG4gICAgICAgICAgICBjb25zdCBtb2NrUmVzdWx0ID0geyBzdWNjZXNzOiB0cnVlLCBleGl0Q29kZTogMCwgb3V0cHV0OiAndGVzdCcsIGR1cmF0aW9uOiAxMDAwLCBvdXRwdXRGaWxlczogW10gfTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gTWFrZSB0aGUgZmlyc3QgdHdvIGNvbW1hbmRzIGhhbmdcbiAgICAgICAgICAgIGxldCByZXNvbHZlRmlyc3Q6IEZ1bmN0aW9uID0gKCkgPT4ge307XG4gICAgICAgICAgICBsZXQgcmVzb2x2ZVNlY29uZDogRnVuY3Rpb24gPSAoKSA9PiB7fTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgbW9ja1N0cmVhbWluZ1J1bm5lci5leGVjdXRlV2l0aFN0cmVhbWluZ1xuICAgICAgICAgICAgICAgIC5tb2NrSW1wbGVtZW50YXRpb25PbmNlKCgpID0+IG5ldyBQcm9taXNlKHJlc29sdmUgPT4geyByZXNvbHZlRmlyc3QgPSAoKSA9PiByZXNvbHZlKG1vY2tSZXN1bHQpOyB9KSlcbiAgICAgICAgICAgICAgICAubW9ja0ltcGxlbWVudGF0aW9uT25jZSgoKSA9PiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHsgcmVzb2x2ZVNlY29uZCA9ICgpID0+IHJlc29sdmUobW9ja1Jlc3VsdCk7IH0pKVxuICAgICAgICAgICAgICAgIC5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrUmVzdWx0KTtcblxuICAgICAgICAgICAgLy8gU3RhcnQgZmlyc3QgdHdvIGNvbW1hbmRzXG4gICAgICAgICAgICBjb25zdCBwcm9taXNlMSA9IGNvb3JkaW5hdG9yLmV4ZWN1dGVDb21tYW5kKCdhaURlYnVnJywgWydwcm9qZWN0MSddLCB7IHByb2plY3Q6ICdwcm9qZWN0MScgfSk7XG4gICAgICAgICAgICBjb25zdCBwcm9taXNlMiA9IGNvb3JkaW5hdG9yLmV4ZWN1dGVDb21tYW5kKCdueFRlc3QnLCBbJ3Byb2plY3QyJ10sIHsgcHJvamVjdDogJ3Byb2plY3QyJyB9KTtcblxuICAgICAgICAgICAgLy8gVGhpcmQgY29tbWFuZCBzaG91bGQgYmUgcXVldWVkXG4gICAgICAgICAgICBjb25zdCBwcm9taXNlMyA9IGNvb3JkaW5hdG9yLmV4ZWN1dGVDb21tYW5kKCdnaXREaWZmJywgW10sIHt9KTtcblxuICAgICAgICAgICAgY29uc3Qgc3RhdHVzID0gY29vcmRpbmF0b3IuZ2V0RXhlY3V0aW9uU3RhdHVzKCk7XG4gICAgICAgICAgICBleHBlY3Qoc3RhdHVzLmFjdGl2ZSkudG9CZSgyKTtcbiAgICAgICAgICAgIGV4cGVjdChzdGF0dXMucXVldWVkKS50b0JlKDEpO1xuXG4gICAgICAgICAgICAvLyBDb21wbGV0ZSBmaXJzdCBjb21tYW5kXG4gICAgICAgICAgICByZXNvbHZlRmlyc3QoKTtcbiAgICAgICAgICAgIGF3YWl0IHByb21pc2UxO1xuXG4gICAgICAgICAgICAvLyBUaGlyZCBjb21tYW5kIHNob3VsZCBub3cgYmUgcHJvY2Vzc2luZ1xuICAgICAgICAgICAgZXhwZWN0KGNvb3JkaW5hdG9yLmdldEV4ZWN1dGlvblN0YXR1cygpLmFjdGl2ZSkudG9CZSgyKTtcblxuICAgICAgICAgICAgLy8gQ29tcGxldGUgcmVtYWluaW5nIGNvbW1hbmRzXG4gICAgICAgICAgICByZXNvbHZlU2Vjb25kKCk7XG4gICAgICAgICAgICBhd2FpdCBQcm9taXNlLmFsbChbcHJvbWlzZTIsIHByb21pc2UzXSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRlc3QoJ3Nob3VsZCBoYW5kbGUgaGlnaCBwcmlvcml0eSBjb21tYW5kcycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGNvb3JkaW5hdG9yLnNldE1heENvbmN1cnJlbnRDb21tYW5kcygxKTtcblxuICAgICAgICAgICAgY29uc3QgbW9ja1Jlc3VsdCA9IHsgc3VjY2VzczogdHJ1ZSwgZXhpdENvZGU6IDAsIG91dHB1dDogJ3Rlc3QnLCBkdXJhdGlvbjogMTAwMCwgb3V0cHV0RmlsZXM6IFtdIH07XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIE1ha2UgZmlyc3QgY29tbWFuZCBoYW5nXG4gICAgICAgICAgICBsZXQgcmVzb2x2ZUZpcnN0OiBGdW5jdGlvbiA9ICgpID0+IHt9O1xuICAgICAgICAgICAgbW9ja1N0cmVhbWluZ1J1bm5lci5leGVjdXRlV2l0aFN0cmVhbWluZ1xuICAgICAgICAgICAgICAgIC5tb2NrSW1wbGVtZW50YXRpb25PbmNlKCgpID0+IG5ldyBQcm9taXNlKHJlc29sdmUgPT4geyByZXNvbHZlRmlyc3QgPSAoKSA9PiByZXNvbHZlKG1vY2tSZXN1bHQpOyB9KSlcbiAgICAgICAgICAgICAgICAubW9ja1Jlc29sdmVkVmFsdWUobW9ja1Jlc3VsdCk7XG5cbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShtb2NrU3RyZWFtaW5nUnVubmVyLCAnaXNSdW5uaW5nJywgeyB2YWx1ZTogdHJ1ZSwgd3JpdGFibGU6IHRydWUgfSk7XG5cbiAgICAgICAgICAgIC8vIFN0YXJ0IGZpcnN0IGNvbW1hbmRcbiAgICAgICAgICAgIGNvbnN0IHByb21pc2UxID0gY29vcmRpbmF0b3IuZXhlY3V0ZUNvbW1hbmQoJ2FpRGVidWcnLCBbJ3Byb2plY3QxJ10sIHsgcHJvamVjdDogJ3Byb2plY3QxJyB9KTtcblxuICAgICAgICAgICAgLy8gSGlnaCBwcmlvcml0eSBjb21tYW5kIHNob3VsZCBjYW5jZWwgdGhlIGZpcnN0IG9uZVxuICAgICAgICAgICAgY29uc3QgcHJvbWlzZTIgPSBjb29yZGluYXRvci5leGVjdXRlQ29tbWFuZCgnbnhUZXN0JywgWydwcm9qZWN0MiddLCB7IFxuICAgICAgICAgICAgICAgIHByb2plY3Q6ICdwcm9qZWN0MicsXG4gICAgICAgICAgICAgICAgcHJpb3JpdHk6ICdoaWdoJ1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGV4cGVjdChtb2NrU3RyZWFtaW5nUnVubmVyLmNhbmNlbCkudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgICAgICAgICAgZXhwZWN0KG1vY2tTdGF0dXNUcmFja2VyLmNhbmNlbENvbW1hbmQpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcblxuICAgICAgICAgICAgcmVzb2x2ZUZpcnN0KCk7XG4gICAgICAgICAgICBhd2FpdCBQcm9taXNlLmFsbChbcHJvbWlzZTEsIHByb21pc2UyXSk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ0NvbW1hbmQgQ2FuY2VsbGF0aW9uJywgKCkgPT4ge1xuICAgICAgICB0ZXN0KCdzaG91bGQgY2FuY2VsIHJ1bm5pbmcgY29tbWFuZCcsICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGNvbW1hbmRJZCA9ICd0ZXN0LWNvbW1hbmQtaWQnO1xuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG1vY2tTdHJlYW1pbmdSdW5uZXIsICdpc1J1bm5pbmcnLCB7IHZhbHVlOiB0cnVlLCB3cml0YWJsZTogdHJ1ZSB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gU2ltdWxhdGUgYWN0aXZlIGNvbW1hbmRcbiAgICAgICAgICAgIChjb29yZGluYXRvciBhcyBhbnkpLmFjdGl2ZUNvbW1hbmRzLnNldChjb21tYW5kSWQsIG1vY2tTdHJlYW1pbmdSdW5uZXIpO1xuXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBjb29yZGluYXRvci5jYW5jZWxDb21tYW5kKGNvbW1hbmRJZCk7XG5cbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmUodHJ1ZSk7XG4gICAgICAgICAgICBleHBlY3QobW9ja1N0cmVhbWluZ1J1bm5lci5jYW5jZWwpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgICAgICAgIGV4cGVjdChtb2NrU3RhdHVzVHJhY2tlci5jYW5jZWxDb21tYW5kKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChjb21tYW5kSWQpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0ZXN0KCdzaG91bGQgbm90IGNhbmNlbCBub24tcnVubmluZyBjb21tYW5kJywgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgY29tbWFuZElkID0gJ3Rlc3QtY29tbWFuZC1pZCc7XG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobW9ja1N0cmVhbWluZ1J1bm5lciwgJ2lzUnVubmluZycsIHsgdmFsdWU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gY29vcmRpbmF0b3IuY2FuY2VsQ29tbWFuZChjb21tYW5kSWQpO1xuXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0KS50b0JlKGZhbHNlKTtcbiAgICAgICAgICAgIGV4cGVjdChtb2NrU3RyZWFtaW5nUnVubmVyLmNhbmNlbCkubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGVzdCgnc2hvdWxkIGNhbmNlbCBhbGwgcnVubmluZyBjb21tYW5kcycsICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGNvbW1hbmRzID0gWydjbWQxJywgJ2NtZDInLCAnY21kMyddO1xuICAgICAgICAgICAgY29tbWFuZHMuZm9yRWFjaChjbWRJZCA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgcnVubmVyID0geyAuLi5tb2NrU3RyZWFtaW5nUnVubmVyLCBpc1J1bm5pbmc6IHRydWUgfTtcbiAgICAgICAgICAgICAgICAoY29vcmRpbmF0b3IgYXMgYW55KS5hY3RpdmVDb21tYW5kcy5zZXQoY21kSWQsIHJ1bm5lcik7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgY29vcmRpbmF0b3IuY2FuY2VsQWxsQ29tbWFuZHMoKTtcblxuICAgICAgICAgICAgY29tbWFuZHMuZm9yRWFjaChjbWRJZCA9PiB7XG4gICAgICAgICAgICAgICAgZXhwZWN0KG1vY2tTdGF0dXNUcmFja2VyLmNhbmNlbENvbW1hbmQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKGNtZElkKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCdPdXRwdXQgTWFuYWdlbWVudCcsICgpID0+IHtcbiAgICAgICAgdGVzdCgnc2hvdWxkIGdldCBjb21tYW5kIG91dHB1dCcsICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGNvbW1hbmRJZCA9ICd0ZXN0LWNvbW1hbmQtaWQnO1xuICAgICAgICAgICAgY29uc3QgZXhwZWN0ZWRPdXRwdXQgPSAnQ29tbWFuZCBvdXRwdXQgaGVyZSc7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIG1vY2tTdHJlYW1pbmdSdW5uZXIuZ2V0Q3VycmVudE91dHB1dC5tb2NrUmV0dXJuVmFsdWUoZXhwZWN0ZWRPdXRwdXQpO1xuICAgICAgICAgICAgKGNvb3JkaW5hdG9yIGFzIGFueSkuYWN0aXZlQ29tbWFuZHMuc2V0KGNvbW1hbmRJZCwgbW9ja1N0cmVhbWluZ1J1bm5lcik7XG5cbiAgICAgICAgICAgIGNvbnN0IG91dHB1dCA9IGNvb3JkaW5hdG9yLmdldENvbW1hbmRPdXRwdXQoY29tbWFuZElkKTtcblxuICAgICAgICAgICAgZXhwZWN0KG91dHB1dCkudG9CZShleHBlY3RlZE91dHB1dCk7XG4gICAgICAgICAgICBleHBlY3QobW9ja1N0cmVhbWluZ1J1bm5lci5nZXRDdXJyZW50T3V0cHV0KS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRlc3QoJ3Nob3VsZCBjbGVhciBjb21tYW5kIG91dHB1dCcsICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGNvbW1hbmRJZCA9ICd0ZXN0LWNvbW1hbmQtaWQnO1xuICAgICAgICAgICAgKGNvb3JkaW5hdG9yIGFzIGFueSkuYWN0aXZlQ29tbWFuZHMuc2V0KGNvbW1hbmRJZCwgbW9ja1N0cmVhbWluZ1J1bm5lcik7XG5cbiAgICAgICAgICAgIGNvb3JkaW5hdG9yLmNsZWFyQ29tbWFuZE91dHB1dChjb21tYW5kSWQpO1xuXG4gICAgICAgICAgICBleHBlY3QobW9ja1N0cmVhbWluZ1J1bm5lci5jbGVhck91dHB1dCkudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0ZXN0KCdzaG91bGQgcmV0dXJuIGVtcHR5IHN0cmluZyBmb3Igbm9uLWV4aXN0ZW50IGNvbW1hbmQgb3V0cHV0JywgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3Qgb3V0cHV0ID0gY29vcmRpbmF0b3IuZ2V0Q29tbWFuZE91dHB1dCgnbm9uLWV4aXN0ZW50Jyk7XG4gICAgICAgICAgICBleHBlY3Qob3V0cHV0KS50b0JlKCcnKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnTWV0cmljcyBhbmQgUmVwb3J0aW5nJywgKCkgPT4ge1xuICAgICAgICB0ZXN0KCdzaG91bGQgZ2V0IGV4ZWN1dGlvbiBtZXRyaWNzJywgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgbW9ja1N0YXRzID0ge1xuICAgICAgICAgICAgICAgIHRvdGFsOiAxMCxcbiAgICAgICAgICAgICAgICBzdWNjZXNzZnVsOiA4LFxuICAgICAgICAgICAgICAgIGZhaWxlZDogMixcbiAgICAgICAgICAgICAgICBhdmVyYWdlRHVyYXRpb246IDUwMDAsXG4gICAgICAgICAgICAgICAgbGFzdFJ1bjogbmV3IERhdGUoKSxcbiAgICAgICAgICAgICAgICByZWNlbnRDb21tYW5kczogW11cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIG1vY2tTdGF0dXNUcmFja2VyLmdldENvbW1hbmRTdGF0cy5tb2NrUmV0dXJuVmFsdWUobW9ja1N0YXRzKTtcblxuICAgICAgICAgICAgY29uc3QgbWV0cmljcyA9IGNvb3JkaW5hdG9yLmdldEV4ZWN1dGlvbk1ldHJpY3MoKTtcblxuICAgICAgICAgICAgZXhwZWN0KG1ldHJpY3MudG90YWxDb21tYW5kcykudG9CZSgxMCk7XG4gICAgICAgICAgICBleHBlY3QobWV0cmljcy5zdWNjZXNzUmF0ZSkudG9CZSg4MCk7XG4gICAgICAgICAgICBleHBlY3QobWV0cmljcy5hdmVyYWdlRXhlY3V0aW9uVGltZSkudG9CZSg1MDAwKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGVzdCgnc2hvdWxkIGNyZWF0ZSBoZWFsdGggcmVwb3J0JywgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgbW9ja1N0YXR1c2VzID0gW1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6ICdjbWQxJyxcbiAgICAgICAgICAgICAgICAgICAgY29tbWFuZDogJ2FpRGVidWcnLFxuICAgICAgICAgICAgICAgICAgICBhY3Rpb246ICdhaURlYnVnJyxcbiAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiAncnVubmluZycgYXMgY29uc3QsXG4gICAgICAgICAgICAgICAgICAgIHByb2dyZXNzOiA3NSxcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogJ1Byb2Nlc3NpbmcuLi4nLFxuICAgICAgICAgICAgICAgICAgICBzdGFydFRpbWU6IG5ldyBEYXRlKCksXG4gICAgICAgICAgICAgICAgICAgIHByb2plY3Q6ICd0ZXN0LXByb2plY3QnLFxuICAgICAgICAgICAgICAgICAgICBvdXRwdXQ6ICcnLFxuICAgICAgICAgICAgICAgICAgICBvdXRwdXRGaWxlczogW10sXG4gICAgICAgICAgICAgICAgICAgIG1ldGFkYXRhOiB7fVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF07XG5cbiAgICAgICAgICAgIG1vY2tTdGF0dXNUcmFja2VyLmdldEFsbFN0YXR1c2VzLm1vY2tSZXR1cm5WYWx1ZShtb2NrU3RhdHVzZXMpO1xuICAgICAgICAgICAgbW9ja1N0YXR1c1RyYWNrZXIuZ2V0Q29tbWFuZFN0YXRzLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgICAgICAgICAgdG90YWw6IDUsXG4gICAgICAgICAgICAgICAgc3VjY2Vzc2Z1bDogNCxcbiAgICAgICAgICAgICAgICBmYWlsZWQ6IDEsXG4gICAgICAgICAgICAgICAgYXZlcmFnZUR1cmF0aW9uOiAzMDAwLFxuICAgICAgICAgICAgICAgIHJlY2VudENvbW1hbmRzOiBbXVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNvbnN0IHJlcG9ydCA9IGNvb3JkaW5hdG9yLmNyZWF0ZUhlYWx0aFJlcG9ydCgpO1xuXG4gICAgICAgICAgICBleHBlY3QocmVwb3J0KS50b0NvbnRhaW4oJ0NPTU1BTkQgRVhFQ1VUSU9OIEhFQUxUSCBSRVBPUlQnKTtcbiAgICAgICAgICAgIGV4cGVjdChyZXBvcnQpLnRvQ29udGFpbignQUNUSVZFIENPTU1BTkRTJyk7XG4gICAgICAgICAgICBleHBlY3QocmVwb3J0KS50b0NvbnRhaW4oJ1BFUkZPUk1BTkNFIE1FVFJJQ1MnKTtcbiAgICAgICAgICAgIGV4cGVjdChyZXBvcnQpLnRvQ29udGFpbignUkVDT01NRU5EQVRJT05TJyk7XG4gICAgICAgICAgICBleHBlY3QocmVwb3J0KS50b0NvbnRhaW4oJ1Byb2Nlc3NpbmcuLi4nKTtcbiAgICAgICAgICAgIGV4cGVjdChyZXBvcnQpLnRvQ29udGFpbignNzUlJyk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ1F1ZXVlIE1hbmFnZW1lbnQnLCAoKSA9PiB7XG4gICAgICAgIHRlc3QoJ3Nob3VsZCBlbWl0IHF1ZXVlIHVwZGF0ZSBldmVudHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBjb29yZGluYXRvci5zZXRNYXhDb25jdXJyZW50Q29tbWFuZHMoMSk7XG5cbiAgICAgICAgICAgIGNvbnN0IHF1ZXVlVXBkYXRlczogYW55W10gPSBbXTtcbiAgICAgICAgICAgIGNvb3JkaW5hdG9yLm9uKCdxdWV1ZV91cGRhdGUnLCAoZGF0YSkgPT4ge1xuICAgICAgICAgICAgICAgIHF1ZXVlVXBkYXRlcy5wdXNoKGRhdGEpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNvbnN0IG1vY2tSZXN1bHQgPSB7IHN1Y2Nlc3M6IHRydWUsIGV4aXRDb2RlOiAwLCBvdXRwdXQ6ICd0ZXN0JywgZHVyYXRpb246IDEwMDAsIG91dHB1dEZpbGVzOiBbXSB9O1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBsZXQgcmVzb2x2ZUZpcnN0OiBGdW5jdGlvbiA9ICgpID0+IHt9O1xuICAgICAgICAgICAgbW9ja1N0cmVhbWluZ1J1bm5lci5leGVjdXRlV2l0aFN0cmVhbWluZ1xuICAgICAgICAgICAgICAgIC5tb2NrSW1wbGVtZW50YXRpb25PbmNlKCgpID0+IG5ldyBQcm9taXNlKHJlc29sdmUgPT4geyByZXNvbHZlRmlyc3QgPSAoKSA9PiByZXNvbHZlKG1vY2tSZXN1bHQpOyB9KSlcbiAgICAgICAgICAgICAgICAubW9ja1Jlc29sdmVkVmFsdWUobW9ja1Jlc3VsdCk7XG5cbiAgICAgICAgICAgIC8vIFN0YXJ0IGZpcnN0IGNvbW1hbmQgKHdpbGwgcnVuIGltbWVkaWF0ZWx5KVxuICAgICAgICAgICAgY29uc3QgcHJvbWlzZTEgPSBjb29yZGluYXRvci5leGVjdXRlQ29tbWFuZCgnYWlEZWJ1ZycsIFsncHJvamVjdDEnXSwgeyBwcm9qZWN0OiAncHJvamVjdDEnIH0pO1xuXG4gICAgICAgICAgICAvLyBTdGFydCBzZWNvbmQgY29tbWFuZCAod2lsbCBiZSBxdWV1ZWQpXG4gICAgICAgICAgICBjb25zdCBwcm9taXNlMiA9IGNvb3JkaW5hdG9yLmV4ZWN1dGVDb21tYW5kKCdueFRlc3QnLCBbJ3Byb2plY3QyJ10sIHsgcHJvamVjdDogJ3Byb2plY3QyJyB9KTtcblxuICAgICAgICAgICAgLy8gU2hvdWxkIGhhdmUgZW1pdHRlZCBhIHF1ZXVlIHVwZGF0ZVxuICAgICAgICAgICAgZXhwZWN0KHF1ZXVlVXBkYXRlcy5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICAgICAgICAgIGV4cGVjdChxdWV1ZVVwZGF0ZXNbMF0pLnRvSGF2ZVByb3BlcnR5KCdxdWV1ZWQnKTtcblxuICAgICAgICAgICAgcmVzb2x2ZUZpcnN0KCk7XG4gICAgICAgICAgICBhd2FpdCBQcm9taXNlLmFsbChbcHJvbWlzZTEsIHByb21pc2UyXSk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ0Vycm9yIEhhbmRsaW5nJywgKCkgPT4ge1xuICAgICAgICB0ZXN0KCdzaG91bGQgaGFuZGxlIGNvbW1hbmQgZXhlY3V0aW9uIGVycm9ycycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKCdDb21tYW5kIGZhaWxlZCcpO1xuICAgICAgICAgICAgbW9ja1N0cmVhbWluZ1J1bm5lci5leGVjdXRlV2l0aFN0cmVhbWluZy5tb2NrUmVqZWN0ZWRWYWx1ZShlcnJvcik7XG5cbiAgICAgICAgICAgIGF3YWl0IGV4cGVjdChjb29yZGluYXRvci5leGVjdXRlQ29tbWFuZCgnYWlEZWJ1ZycsIFsndGVzdC1wcm9qZWN0J10sIHtcbiAgICAgICAgICAgICAgICBwcm9qZWN0OiAndGVzdC1wcm9qZWN0J1xuICAgICAgICAgICAgfSkpLnJlamVjdHMudG9UaHJvdygnQ29tbWFuZCBmYWlsZWQnKTtcblxuICAgICAgICAgICAgZXhwZWN0KG1vY2tTdGF0dXNUcmFja2VyLnVwZGF0ZVN0YXR1cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICAgICAgICAgIGlzUnVubmluZzogZmFsc2UsXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogJ0NvbW1hbmQgZmFpbGVkJ1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRlc3QoJ3Nob3VsZCBoYW5kbGUgY2xlYW51cCBhZnRlciBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBlcnJvciA9IG5ldyBFcnJvcignVGVzdCBlcnJvcicpO1xuICAgICAgICAgICAgbW9ja1N0cmVhbWluZ1J1bm5lci5leGVjdXRlV2l0aFN0cmVhbWluZy5tb2NrUmVqZWN0ZWRWYWx1ZShlcnJvcik7XG5cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgY29vcmRpbmF0b3IuZXhlY3V0ZUNvbW1hbmQoJ2FpRGVidWcnLCBbJ3Rlc3QtcHJvamVjdCddLCB7XG4gICAgICAgICAgICAgICAgICAgIHByb2plY3Q6ICd0ZXN0LXByb2plY3QnXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgLy8gRXhwZWN0ZWQgZXJyb3JcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gU2hvdWxkIGNsZWFuIHVwIHRoZSBydW5uZXJcbiAgICAgICAgICAgIGV4cGVjdChtb2NrU3RyZWFtaW5nUnVubmVyLnJlbW92ZUFsbExpc3RlbmVycykudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCdDb25maWd1cmF0aW9uJywgKCkgPT4ge1xuICAgICAgICB0ZXN0KCdzaG91bGQgc2V0IG1heGltdW0gY29uY3VycmVudCBjb21tYW5kcyB3aXRoaW4gYm91bmRzJywgKCkgPT4ge1xuICAgICAgICAgICAgY29vcmRpbmF0b3Iuc2V0TWF4Q29uY3VycmVudENvbW1hbmRzKDApOyAvLyBCZWxvdyBtaW5pbXVtXG4gICAgICAgICAgICBleHBlY3QoY29vcmRpbmF0b3IuZ2V0RXhlY3V0aW9uU3RhdHVzKCkubWF4Q29uY3VycmVudCkudG9CZSgxKTtcblxuICAgICAgICAgICAgY29vcmRpbmF0b3Iuc2V0TWF4Q29uY3VycmVudENvbW1hbmRzKDE1KTsgLy8gQWJvdmUgbWF4aW11bVxuICAgICAgICAgICAgZXhwZWN0KGNvb3JkaW5hdG9yLmdldEV4ZWN1dGlvblN0YXR1cygpLm1heENvbmN1cnJlbnQpLnRvQmUoMTApO1xuXG4gICAgICAgICAgICBjb29yZGluYXRvci5zZXRNYXhDb25jdXJyZW50Q29tbWFuZHMoNSk7IC8vIFZhbGlkIHZhbHVlXG4gICAgICAgICAgICBleHBlY3QoY29vcmRpbmF0b3IuZ2V0RXhlY3V0aW9uU3RhdHVzKCkubWF4Q29uY3VycmVudCkudG9CZSg1KTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnRGlzcG9zYWwnLCAoKSA9PiB7XG4gICAgICAgIHRlc3QoJ3Nob3VsZCBkaXNwb3NlIHByb3Blcmx5JywgKCkgPT4ge1xuICAgICAgICAgICAgLy8gQWRkIHNvbWUgbW9jayBhY3RpdmUgY29tbWFuZHNcbiAgICAgICAgICAgIChjb29yZGluYXRvciBhcyBhbnkpLmFjdGl2ZUNvbW1hbmRzLnNldCgnY21kMScsIG1vY2tTdHJlYW1pbmdSdW5uZXIpO1xuICAgICAgICAgICAgKGNvb3JkaW5hdG9yIGFzIGFueSkuYWN0aXZlQ29tbWFuZHMuc2V0KCdjbWQyJywgbW9ja1N0cmVhbWluZ1J1bm5lcik7XG5cbiAgICAgICAgICAgIGNvb3JkaW5hdG9yLmRpc3Bvc2UoKTtcblxuICAgICAgICAgICAgZXhwZWN0KG1vY2tTdHJlYW1pbmdSdW5uZXIuY2FuY2VsKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMik7XG4gICAgICAgICAgICBleHBlY3QoKGNvb3JkaW5hdG9yIGFzIGFueSkuYWN0aXZlQ29tbWFuZHMuc2l6ZSkudG9CZSgwKTtcbiAgICAgICAgICAgIGV4cGVjdCgoY29vcmRpbmF0b3IgYXMgYW55KS5jb21tYW5kUXVldWUubGVuZ3RoKS50b0JlKDApO1xuICAgICAgICB9KTtcbiAgICB9KTtcbn0pO1xuIl0sInZlcnNpb24iOjN9