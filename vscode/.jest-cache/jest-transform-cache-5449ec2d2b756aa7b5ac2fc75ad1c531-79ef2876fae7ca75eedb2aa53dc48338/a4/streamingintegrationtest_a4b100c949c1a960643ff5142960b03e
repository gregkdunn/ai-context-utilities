96c8a8efb8b38a093c2bc5aa3ec4e54e
"use strict";
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
// Mock VSCode completely for integration tests
jest.mock('vscode', () => ({
    StatusBarAlignment: {
        Left: 1,
        Right: 2
    },
    Uri: {
        joinPath: jest.fn(() => ({ toString: () => 'mock://uri' })),
        parse: jest.fn(() => ({ toString: () => 'mock://uri' }))
    },
    workspace: {
        workspaceFolders: [{ uri: { fsPath: '/test/workspace' } }],
        getConfiguration: jest.fn(() => ({
            get: jest.fn(() => true)
        }))
    },
    window: {
        createStatusBarItem: jest.fn(() => ({
            show: jest.fn(),
            hide: jest.fn(),
            dispose: jest.fn(),
            text: '',
            tooltip: '',
            command: ''
        })),
        showInformationMessage: jest.fn(),
        showErrorMessage: jest.fn(),
        createOutputChannel: jest.fn(() => ({
            append: jest.fn(),
            appendLine: jest.fn(),
            show: jest.fn(),
            hide: jest.fn(),
            dispose: jest.fn()
        }))
    }
}));
jest.mock('child_process', () => ({
    spawn: jest.fn(() => mockChildProcess)
}));
const provider_1 = require("../webview/provider");
const streamingRunner_1 = require("../utils/streamingRunner");
const statusTracker_1 = require("../utils/statusTracker");
const vscode = __importStar(require("vscode"));
const events_1 = require("events");
// Mock child_process for integration
const mockChildProcess = new events_1.EventEmitter();
mockChildProcess.stdout = new events_1.EventEmitter();
mockChildProcess.stderr = new events_1.EventEmitter();
mockChildProcess.kill = jest.fn();
describe('Streaming Integration Tests', () => {
    let provider;
    let streamingRunner;
    let mockProjectDetector;
    let mockCommandRunner;
    let mockFileManager;
    let mockWebviewView;
    let mockWebview;
    let receivedMessages = [];
    beforeEach(() => {
        jest.clearAllMocks();
        receivedMessages = [];
        // Create real streaming runner for integration testing
        streamingRunner = new streamingRunner_1.StreamingCommandRunner({});
        // Setup mocked dependencies
        mockProjectDetector = {
            getProjects: jest.fn().mockResolvedValue([
                { name: 'test-app', root: 'apps/test-app', projectType: 'application' }
            ]),
            getCurrentProject: jest.fn().mockResolvedValue({ name: 'test-app', root: 'apps/test-app', projectType: 'application' })
        };
        mockCommandRunner = {
            runAiDebug: jest.fn().mockResolvedValue({ success: true, exitCode: 0, output: 'AI debug complete', duration: 2000 })
        };
        mockFileManager = {
            watchFiles: jest.fn(),
            getFileContent: jest.fn().mockResolvedValue('test file content'),
            openFile: jest.fn()
        };
        // Setup webview mocks that capture messages
        mockWebview = {
            asWebviewUri: jest.fn().mockReturnValue('mock://webview-uri'),
            postMessage: jest.fn((message) => {
                receivedMessages.push(message);
                return Promise.resolve(true);
            }),
            onDidReceiveMessage: jest.fn(),
            html: '',
            options: {}
        };
        mockWebviewView = {
            webview: mockWebview,
            show: jest.fn()
        };
        // Create provider with real streaming runner
        const mockStatusTracker = new statusTracker_1.StatusTracker();
        provider = new provider_1.WebviewProvider(vscode.Uri.parse('test://extension'), mockProjectDetector, mockCommandRunner, mockFileManager, mockStatusTracker);
        // Replace the internal streaming runner with our test instance
        provider.streamingRunner = streamingRunner;
        provider.setupStreamingListeners();
    });
    afterEach(() => {
        streamingRunner.removeAllListeners();
    });
    describe('end-to-end command execution with streaming', () => {
        beforeEach(() => {
            provider.resolveWebviewView(mockWebviewView, {}, {});
        });
        it('should stream output during command execution', async () => {
            // Arrange
            const { spawn } = require('child_process');
            let commandPromise;
            // Act - start command
            commandPromise = provider.runCommand('nxTest', { project: 'test-app' });
            // Simulate command output streaming
            await new Promise(resolve => setTimeout(resolve, 10)); // Let command start
            mockChildProcess.stdout.emit('data', Buffer.from('Determining test suites to run...\n'));
            await new Promise(resolve => setTimeout(resolve, 10));
            mockChildProcess.stdout.emit('data', Buffer.from('Found 5 test suites\n'));
            await new Promise(resolve => setTimeout(resolve, 10));
            mockChildProcess.stdout.emit('data', Buffer.from('Running tests...\n'));
            await new Promise(resolve => setTimeout(resolve, 10));
            mockChildProcess.stdout.emit('data', Buffer.from('Test results:\n PASS src/app.spec.ts\n'));
            await new Promise(resolve => setTimeout(resolve, 10));
            // Complete command
            mockChildProcess.emit('close', 0);
            // Wait for command to complete
            await commandPromise;
            // Assert - check that streaming messages were sent
            const streamingMessages = receivedMessages.filter(msg => msg.command === 'streamingUpdate');
            expect(streamingMessages.length).toBeGreaterThan(0);
            // Check for output messages
            const outputMessages = streamingMessages.filter(msg => msg.message.type === 'output');
            expect(outputMessages.length).toBeGreaterThan(0);
            expect(outputMessages[0].message.data.text).toContain('Determining test suites');
            // Check for progress messages
            const progressMessages = streamingMessages.filter(msg => msg.message.type === 'progress');
            expect(progressMessages.length).toBeGreaterThan(0);
            // Check for completion message
            const completeMessages = streamingMessages.filter(msg => msg.message.type === 'complete');
            expect(completeMessages.length).toBe(1);
            expect(completeMessages[0].message.data.result.success).toBe(true);
        });
        it('should handle command cancellation', async () => {
            // Arrange
            let commandPromise;
            // Act - start command
            commandPromise = provider.runCommand('nxTest', { project: 'test-app' });
            await new Promise(resolve => setTimeout(resolve, 10)); // Let command start
            // Simulate user cancellation
            const cancelMessage = {
                command: 'cancelCommand',
                data: {}
            };
            const messageHandler = mockWebview.onDidReceiveMessage.mock.calls[0][0];
            await messageHandler(cancelMessage);
            // Complete the cancelled command
            mockChildProcess.emit('close', 1);
            await commandPromise;
            // Assert
            expect(mockChildProcess.kill).toHaveBeenCalledWith('SIGTERM');
            expect(provider._state.isStreaming).toBe(false);
        });
        it('should handle command failure with error streaming', async () => {
            // Arrange
            let commandPromise;
            // Act - start command
            commandPromise = provider.runCommand('nxTest', { project: 'test-app' });
            await new Promise(resolve => setTimeout(resolve, 10));
            // Simulate error output
            mockChildProcess.stderr.emit('data', Buffer.from('Error: Test failed\n'));
            mockChildProcess.stdout.emit('data', Buffer.from('FAIL src/app.spec.ts\n'));
            // Complete with failure
            mockChildProcess.emit('close', 1);
            await commandPromise;
            // Assert
            const streamingMessages = receivedMessages.filter(msg => msg.command === 'streamingUpdate');
            const errorMessages = streamingMessages.filter(msg => msg.message.type === 'error');
            expect(errorMessages.length).toBeGreaterThan(0);
            expect(errorMessages[0].message.data.text).toContain('Error: Test failed');
            const completeMessages = streamingMessages.filter(msg => msg.message.type === 'complete');
            expect(completeMessages[0].message.data.result.success).toBe(false);
        });
        it('should coordinate multi-step AI Debug workflow', async () => {
            // Arrange
            let commandPromise;
            // Act - start AI Debug command
            commandPromise = provider.runCommand('aiDebug', { project: 'test-app' });
            await new Promise(resolve => setTimeout(resolve, 10));
            // Simulate Step 1: Tests
            mockChildProcess.stdout.emit('data', Buffer.from('Determining test suites to run...\n'));
            mockChildProcess.emit('close', 0);
            await new Promise(resolve => setTimeout(resolve, 10));
            // The workflow should continue to git diff step
            // Reset for next command
            mockChildProcess.removeAllListeners();
            mockChildProcess.stdout = new events_1.EventEmitter();
            mockChildProcess.stderr = new events_1.EventEmitter();
            // Simulate Step 2: Git diff
            mockChildProcess.stdout.emit('data', Buffer.from('Analyzing repository...\n'));
            mockChildProcess.emit('close', 0);
            await new Promise(resolve => setTimeout(resolve, 10));
            // Wait for command to complete
            await commandPromise;
            // Assert
            const streamingMessages = receivedMessages.filter(msg => msg.command === 'streamingUpdate');
            const statusMessages = streamingMessages.filter(msg => msg.message.type === 'status');
            // Should have status messages for each step
            const stepMessages = statusMessages.filter(msg => msg.message.data.status.includes('Step 1/3') ||
                msg.message.data.status.includes('Step 2/3') ||
                msg.message.data.status.includes('Step 3/3'));
            expect(stepMessages.length).toBeGreaterThan(0);
            // Should complete successfully
            const completeMessages = streamingMessages.filter(msg => msg.message.type === 'complete');
            expect(completeMessages.length).toBe(1);
            expect(mockCommandRunner.runAiDebug).toHaveBeenCalled();
        });
    });
    describe('webview message handling integration', () => {
        beforeEach(() => {
            provider.resolveWebviewView(mockWebviewView, {}, {});
        });
        it('should handle runCommand message and stream results', async () => {
            // Arrange
            const message = {
                command: 'runCommand',
                data: {
                    action: 'nxTest',
                    project: 'test-app'
                }
            };
            const messageHandler = mockWebview.onDidReceiveMessage.mock.calls[0][0];
            // Act
            const handlePromise = messageHandler(message);
            await new Promise(resolve => setTimeout(resolve, 10));
            // Simulate command execution
            mockChildProcess.stdout.emit('data', Buffer.from('Test output\n'));
            mockChildProcess.emit('close', 0);
            await handlePromise;
            // Assert
            const streamingMessages = receivedMessages.filter(msg => msg.command === 'streamingUpdate');
            expect(streamingMessages.length).toBeGreaterThan(0);
        });
        it('should handle clearOutput message', async () => {
            // Arrange
            const message = {
                command: 'clearOutput',
                data: {}
            };
            const messageHandler = mockWebview.onDidReceiveMessage.mock.calls[0][0];
            // Add some output first
            streamingRunner.emit('output', 'test output');
            // Act
            await messageHandler(message);
            // Assert
            // Should have cleared output
            expect(receivedMessages.some(msg => msg.command === 'clearOutput')).toBe(true);
        });
    });
    describe('progress tracking integration', () => {
        beforeEach(() => {
            provider.resolveWebviewView(mockWebviewView, {}, {});
        });
        it('should track progress through command execution phases', async () => {
            // Arrange
            let commandPromise;
            // Act
            commandPromise = provider.runCommand('nxTest', { project: 'test-app' });
            await new Promise(resolve => setTimeout(resolve, 10));
            // Simulate different progress phases
            mockChildProcess.stdout.emit('data', Buffer.from('Determining test suites to run...\n'));
            await new Promise(resolve => setTimeout(resolve, 10));
            mockChildProcess.stdout.emit('data', Buffer.from('Found test suites\n'));
            await new Promise(resolve => setTimeout(resolve, 10));
            mockChildProcess.stdout.emit('data', Buffer.from('Running tests\n'));
            await new Promise(resolve => setTimeout(resolve, 10));
            mockChildProcess.stdout.emit('data', Buffer.from('Test suites completed\n'));
            await new Promise(resolve => setTimeout(resolve, 10));
            mockChildProcess.emit('close', 0);
            await commandPromise;
            // Assert
            const streamingMessages = receivedMessages.filter(msg => msg.command === 'streamingUpdate');
            const progressMessages = streamingMessages.filter(msg => msg.message.type === 'progress');
            // Should have progress updates
            expect(progressMessages.length).toBeGreaterThan(0);
            // Progress should increase over time
            const progressValues = progressMessages.map(msg => msg.message.data.progress);
            for (let i = 1; i < progressValues.length; i++) {
                expect(progressValues[i]).toBeGreaterThanOrEqual(progressValues[i - 1]);
            }
        });
        it('should update action button progress in state', async () => {
            // Arrange
            let commandPromise;
            // Act
            commandPromise = provider.runCommand('nxTest', { project: 'test-app' });
            await new Promise(resolve => setTimeout(resolve, 10));
            // Simulate progress
            mockChildProcess.stdout.emit('data', Buffer.from('Running tests\n'));
            await new Promise(resolve => setTimeout(resolve, 10));
            // Check intermediate state
            const state = provider._state;
            expect(state.actions.nxTest.status).toBe('running');
            mockChildProcess.emit('close', 0);
            await commandPromise;
            // Check final state
            expect(state.actions.nxTest.status).toBe('success');
            expect(state.actions.nxTest.progress).toBeUndefined(); // Should be cleared on completion
        });
    });
    describe('error handling integration', () => {
        beforeEach(() => {
            provider.resolveWebviewView(mockWebviewView, {}, {});
        });
        it('should handle process spawn errors', async () => {
            // Arrange
            const { spawn } = require('child_process');
            spawn.mockImplementationOnce(() => {
                const errorProcess = new events_1.EventEmitter();
                setTimeout(() => {
                    errorProcess.emit('error', new Error('Command not found'));
                }, 10);
                return errorProcess;
            });
            // Act
            await provider.runCommand('nxTest', { project: 'test-app' });
            // Assert
            const streamingMessages = receivedMessages.filter(msg => msg.command === 'streamingUpdate');
            const completeMessages = streamingMessages.filter(msg => msg.message.type === 'complete');
            expect(completeMessages.length).toBe(1);
            expect(completeMessages[0].message.data.result.success).toBe(false);
            expect(completeMessages[0].message.data.result.error).toContain('Command not found');
        });
        it('should handle invalid action gracefully', async () => {
            // Act & Assert - should not throw
            await expect(provider.runCommand('invalidAction', {})).resolves.toBeUndefined();
            expect(vscode.window.showErrorMessage).toHaveBeenCalledWith(expect.stringContaining('Unknown action: invalidAction'));
        });
    });
    describe('state consistency integration', () => {
        beforeEach(() => {
            provider.resolveWebviewView(mockWebviewView, {}, {});
        });
        it('should maintain consistent state throughout command lifecycle', async () => {
            // Arrange
            const state = provider._state;
            expect(state.isStreaming).toBe(false);
            expect(state.currentAction).toBeUndefined();
            // Act - start command
            const commandPromise = provider.runCommand('nxTest', { project: 'test-app' });
            await new Promise(resolve => setTimeout(resolve, 10));
            // Assert - during execution
            expect(state.isStreaming).toBe(true);
            expect(state.currentAction).toBe('nxTest');
            expect(state.actions.nxTest.status).toBe('running');
            // Complete command
            mockChildProcess.emit('close', 0);
            await commandPromise;
            // Assert - after completion
            expect(state.isStreaming).toBe(false);
            expect(state.currentAction).toBeUndefined();
            expect(state.actions.nxTest.status).toBe('success');
        });
        it('should reset state properly on command failure', async () => {
            // Arrange
            const state = provider._state;
            // Act - start and fail command
            const commandPromise = provider.runCommand('nxTest', { project: 'test-app' });
            await new Promise(resolve => setTimeout(resolve, 10));
            mockChildProcess.emit('close', 1); // Failure
            await commandPromise;
            // Assert
            expect(state.isStreaming).toBe(false);
            expect(state.currentAction).toBeUndefined();
            expect(state.actions.nxTest.status).toBe('error');
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2dyZWdkdW5uL3NyYy90ZXN0L2FpX2RlYnVnX2NvbnRleHQvdnNjb2RlL3NyYy9fX3Rlc3RzX18vc3RyZWFtaW5nLmludGVncmF0aW9uLnRlc3QudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFVQSwrQ0FBK0M7QUFDL0MsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUN2QixrQkFBa0IsRUFBRTtRQUNoQixJQUFJLEVBQUUsQ0FBQztRQUNQLEtBQUssRUFBRSxDQUFDO0tBQ1g7SUFDRCxHQUFHLEVBQUU7UUFDRCxRQUFRLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDLEVBQUUsUUFBUSxFQUFFLEdBQUcsRUFBRSxDQUFDLFlBQVksRUFBRSxDQUFDLENBQUM7UUFDM0QsS0FBSyxFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQyxFQUFFLFFBQVEsRUFBRSxHQUFHLEVBQUUsQ0FBQyxZQUFZLEVBQUUsQ0FBQyxDQUFDO0tBQzNEO0lBQ0QsU0FBUyxFQUFFO1FBQ1AsZ0JBQWdCLEVBQUUsQ0FBQyxFQUFFLEdBQUcsRUFBRSxFQUFFLE1BQU0sRUFBRSxpQkFBaUIsRUFBRSxFQUFFLENBQUM7UUFDMUQsZ0JBQWdCLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDO1lBQzdCLEdBQUcsRUFBRSxJQUFJLENBQUMsRUFBRSxDQUFDLEdBQUcsRUFBRSxDQUFDLElBQUksQ0FBQztTQUMzQixDQUFDLENBQUM7S0FDTjtJQUNELE1BQU0sRUFBRTtRQUNKLG1CQUFtQixFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQztZQUNoQyxJQUFJLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtZQUNmLElBQUksRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1lBQ2YsT0FBTyxFQUFF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Q0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUM7UUFDeEQsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsZ0RBQWdELEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDNUQsVUFBVTtZQUNWLE1BQU0sS0FBSyxHQUFJLFFBQWdCLENBQUMsTUFBTSxDQUFDO1lBRXZDLCtCQUErQjtZQUMvQixNQUFNLGNBQWMsR0FBSSxRQUFnQixDQUFDLFVBQVUsQ0FBQyxRQUFRLEVBQUUsRUFBRSxPQUFPLEVBQUUsVUFBVSxFQUFFLENBQUMsQ0FBQztZQUN2RixNQUFNLElBQUksT0FBTyxDQUFDLE9BQU8sQ0FBQyxFQUFFLENBQUMsVUFBVSxDQUFDLE9BQU8sRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDO1lBRXRELGdCQUFnQixDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxVQUFVO1lBQzdDLE1BQU0sY0FBYyxDQUFDO1lBRXJCLFNBQVM7WUFDVCxNQUFNLENBQUMsS0FBSyxDQUFDLFdBQVcsQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUN0QyxNQUFNLENBQUMsS0FBSyxDQUFDLGFBQWEsQ0FBQyxDQUFDLGFBQWEsRUFBRSxDQUFDO1lBQzVDLE1BQU0sQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDdEQsQ0FBQyxDQUFDLENBQUM7SUFDUCxDQUFDLENBQUMsQ0FBQztBQUNQLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9ncmVnZHVubi9zcmMvdGVzdC9haV9kZWJ1Z19jb250ZXh0L3ZzY29kZS9zcmMvX190ZXN0c19fL3N0cmVhbWluZy5pbnRlZ3JhdGlvbi50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFdlYnZpZXdQcm92aWRlciB9IGZyb20gJy4uL3dlYnZpZXcvcHJvdmlkZXInO1xuaW1wb3J0IHsgU3RyZWFtaW5nQ29tbWFuZFJ1bm5lciB9IGZyb20gJy4uL3V0aWxzL3N0cmVhbWluZ1J1bm5lcic7XG5pbXBvcnQgeyBQcm9qZWN0RGV0ZWN0b3IgfSBmcm9tICcuLi91dGlscy9wcm9qZWN0RGV0ZWN0b3InO1xuaW1wb3J0IHsgQ29tbWFuZFJ1bm5lciB9IGZyb20gJy4uL3V0aWxzL3NoZWxsUnVubmVyJztcbmltcG9ydCB7IEZpbGVNYW5hZ2VyIH0gZnJvbSAnLi4vdXRpbHMvZmlsZU1hbmFnZXInO1xuaW1wb3J0IHsgU3RhdHVzVHJhY2tlciB9IGZyb20gJy4uL3V0aWxzL3N0YXR1c1RyYWNrZXInO1xuaW1wb3J0IHsgU3RyZWFtaW5nTWVzc2FnZSwgV2Vidmlld01lc3NhZ2UgfSBmcm9tICcuLi90eXBlcyc7XG5pbXBvcnQgKiBhcyB2c2NvZGUgZnJvbSAndnNjb2RlJztcbmltcG9ydCB7IEV2ZW50RW1pdHRlciB9IGZyb20gJ2V2ZW50cyc7XG5cbi8vIE1vY2sgVlNDb2RlIGNvbXBsZXRlbHkgZm9yIGludGVncmF0aW9uIHRlc3RzXG5qZXN0Lm1vY2soJ3ZzY29kZScsICgpID0+ICh7XG4gICAgU3RhdHVzQmFyQWxpZ25tZW50OiB7XG4gICAgICAgIExlZnQ6IDEsXG4gICAgICAgIFJpZ2h0OiAyXG4gICAgfSxcbiAgICBVcmk6IHtcbiAgICAgICAgam9pblBhdGg6IGplc3QuZm4oKCkgPT4gKHsgdG9TdHJpbmc6ICgpID0+ICdtb2NrOi8vdXJpJyB9KSksXG4gICAgICAgIHBhcnNlOiBqZXN0LmZuKCgpID0+ICh7IHRvU3RyaW5nOiAoKSA9PiAnbW9jazovL3VyaScgfSkpXG4gICAgfSxcbiAgICB3b3Jrc3BhY2U6IHtcbiAgICAgICAgd29ya3NwYWNlRm9sZGVyczogW3sgdXJpOiB7IGZzUGF0aDogJy90ZXN0L3dvcmtzcGFjZScgfSB9XSxcbiAgICAgICAgZ2V0Q29uZmlndXJhdGlvbjogamVzdC5mbigoKSA9PiAoe1xuICAgICAgICAgICAgZ2V0OiBqZXN0LmZuKCgpID0+IHRydWUpXG4gICAgICAgIH0pKVxuICAgIH0sXG4gICAgd2luZG93OiB7XG4gICAgICAgIGNyZWF0ZVN0YXR1c0Jhckl0ZW06IGplc3QuZm4oKCkgPT4gKHtcbiAgICAgICAgICAgIHNob3c6IGplc3QuZm4oKSxcbiAgICAgICAgICAgIGhpZGU6IGplc3QuZm4oKSxcbiAgICAgICAgICAgIGRpc3Bvc2U6IGplc3QuZm4oKSxcbiAgICAgICAgICAgIHRleHQ6ICcnLFxuICAgICAgICAgICAgdG9vbHRpcDogJycsXG4gICAgICAgICAgICBjb21tYW5kOiAnJ1xuICAgICAgICB9KSksXG4gICAgICAgIHNob3dJbmZvcm1hdGlvbk1lc3NhZ2U6IGplc3QuZm4oKSxcbiAgICAgICAgc2hvd0Vycm9yTWVzc2FnZTogamVzdC5mbigpLFxuICAgICAgICBjcmVhdGVPdXRwdXRDaGFubmVsOiBqZXN0LmZuKCgpID0+ICh7XG4gICAgICAgICAgICBhcHBlbmQ6IGplc3QuZm4oKSxcbiAgICAgICAgICAgIGFwcGVuZExpbmU6IGplc3QuZm4oKSxcbiAgICAgICAgICAgIHNob3c6IGplc3QuZm4oKSxcbiAgICAgICAgICAgIGhpZGU6IGplc3QuZm4oKSxcbiAgICAgICAgICAgIGRpc3Bvc2U6IGplc3QuZm4oKVxuICAgICAgICB9KSlcbiAgICB9XG59KSk7XG5cbi8vIE1vY2sgY2hpbGRfcHJvY2VzcyBmb3IgaW50ZWdyYXRpb25cbmNvbnN0IG1vY2tDaGlsZFByb2Nlc3MgPSBuZXcgRXZlbnRFbWl0dGVyKCkgYXMgYW55O1xubW9ja0NoaWxkUHJvY2Vzcy5zdGRvdXQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG5tb2NrQ2hpbGRQcm9jZXNzLnN0ZGVyciA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbm1vY2tDaGlsZFByb2Nlc3Mua2lsbCA9IGplc3QuZm4oKTtcblxuamVzdC5tb2NrKCdjaGlsZF9wcm9jZXNzJywgKCkgPT4gKHtcbiAgICBzcGF3bjogamVzdC5mbigoKSA9PiBtb2NrQ2hpbGRQcm9jZXNzKVxufSkpO1xuXG5kZXNjcmliZSgnU3RyZWFtaW5nIEludGVncmF0aW9uIFRlc3RzJywgKCkgPT4ge1xuICAgIGxldCBwcm92aWRlcjogV2Vidmlld1Byb3ZpZGVyO1xuICAgIGxldCBzdHJlYW1pbmdSdW5uZXI6IFN0cmVhbWluZ0NvbW1hbmRSdW5uZXI7XG4gICAgbGV0IG1vY2tQcm9qZWN0RGV0ZWN0b3I6IGplc3QuTW9ja2VkPFByb2plY3REZXRlY3Rvcj47XG4gICAgbGV0IG1vY2tDb21tYW5kUnVubmVyOiBqZXN0Lk1vY2tlZDxDb21tYW5kUnVubmVyPjtcbiAgICBsZXQgbW9ja0ZpbGVNYW5hZ2VyOiBqZXN0Lk1vY2tlZDxGaWxlTWFuYWdlcj47XG4gICAgbGV0IG1vY2tXZWJ2aWV3VmlldzogamVzdC5Nb2NrZWQ8dnNjb2RlLldlYnZpZXdWaWV3PjtcbiAgICBsZXQgbW9ja1dlYnZpZXc6IGplc3QuTW9ja2VkPHZzY29kZS5XZWJ2aWV3PjtcbiAgICBsZXQgcmVjZWl2ZWRNZXNzYWdlczogYW55W10gPSBbXTtcblxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcbiAgICAgICAgcmVjZWl2ZWRNZXNzYWdlcyA9IFtdO1xuXG4gICAgICAgIC8vIENyZWF0ZSByZWFsIHN0cmVhbWluZyBydW5uZXIgZm9yIGludGVncmF0aW9uIHRlc3RpbmdcbiAgICAgICAgc3RyZWFtaW5nUnVubmVyID0gbmV3IFN0cmVhbWluZ0NvbW1hbmRSdW5uZXIoe30gYXMgYW55KTtcblxuICAgICAgICAvLyBTZXR1cCBtb2NrZWQgZGVwZW5kZW5jaWVzXG4gICAgICAgIG1vY2tQcm9qZWN0RGV0ZWN0b3IgPSB7XG4gICAgICAgICAgICBnZXRQcm9qZWN0czogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKFtcbiAgICAgICAgICAgICAgICB7IG5hbWU6ICd0ZXN0LWFwcCcsIHJvb3Q6ICdhcHBzL3Rlc3QtYXBwJywgcHJvamVjdFR5cGU6ICdhcHBsaWNhdGlvbicgfVxuICAgICAgICAgICAgXSksXG4gICAgICAgICAgICBnZXRDdXJyZW50UHJvamVjdDogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHsgbmFtZTogJ3Rlc3QtYXBwJywgcm9vdDogJ2FwcHMvdGVzdC1hcHAnLCBwcm9qZWN0VHlwZTogJ2FwcGxpY2F0aW9uJyB9KVxuICAgICAgICB9IGFzIGFueTtcblxuICAgICAgICBtb2NrQ29tbWFuZFJ1bm5lciA9IHtcbiAgICAgICAgICAgIHJ1bkFpRGVidWc6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7IHN1Y2Nlc3M6IHRydWUsIGV4aXRDb2RlOiAwLCBvdXRwdXQ6ICdBSSBkZWJ1ZyBjb21wbGV0ZScsIGR1cmF0aW9uOiAyMDAwIH0pXG4gICAgICAgIH0gYXMgYW55O1xuXG4gICAgICAgIG1vY2tGaWxlTWFuYWdlciA9IHtcbiAgICAgICAgICAgIHdhdGNoRmlsZXM6IGplc3QuZm4oKSxcbiAgICAgICAgICAgIGdldEZpbGVDb250ZW50OiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoJ3Rlc3QgZmlsZSBjb250ZW50JyksXG4gICAgICAgICAgICBvcGVuRmlsZTogamVzdC5mbigpXG4gICAgICAgIH0gYXMgYW55O1xuXG4gICAgICAgIC8vIFNldHVwIHdlYnZpZXcgbW9ja3MgdGhhdCBjYXB0dXJlIG1lc3NhZ2VzXG4gICAgICAgIG1vY2tXZWJ2aWV3ID0ge1xuICAgICAgICAgICAgYXNXZWJ2aWV3VXJpOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKCdtb2NrOi8vd2Vidmlldy11cmknKSxcbiAgICAgICAgICAgIHBvc3RNZXNzYWdlOiBqZXN0LmZuKChtZXNzYWdlKSA9PiB7XG4gICAgICAgICAgICAgICAgcmVjZWl2ZWRNZXNzYWdlcy5wdXNoKG1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodHJ1ZSk7XG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIG9uRGlkUmVjZWl2ZU1lc3NhZ2U6IGplc3QuZm4oKSxcbiAgICAgICAgICAgIGh0bWw6ICcnLFxuICAgICAgICAgICAgb3B0aW9uczoge31cbiAgICAgICAgfSBhcyBhbnk7XG5cbiAgICAgICAgbW9ja1dlYnZpZXdWaWV3ID0ge1xuICAgICAgICAgICAgd2VidmlldzogbW9ja1dlYnZpZXcsXG4gICAgICAgICAgICBzaG93OiBqZXN0LmZuKClcbiAgICAgICAgfSBhcyBhbnk7XG5cbiAgICAgICAgLy8gQ3JlYXRlIHByb3ZpZGVyIHdpdGggcmVhbCBzdHJlYW1pbmcgcnVubmVyXG4gICAgICAgIGNvbnN0IG1vY2tTdGF0dXNUcmFja2VyID0gbmV3IFN0YXR1c1RyYWNrZXIoKTtcbiAgICAgICAgcHJvdmlkZXIgPSBuZXcgV2Vidmlld1Byb3ZpZGVyKFxuICAgICAgICAgICAgdnNjb2RlLlVyaS5wYXJzZSgndGVzdDovL2V4dGVuc2lvbicpLFxuICAgICAgICAgICAgbW9ja1Byb2plY3REZXRlY3RvcixcbiAgICAgICAgICAgIG1vY2tDb21tYW5kUnVubmVyLFxuICAgICAgICAgICAgbW9ja0ZpbGVNYW5hZ2VyLFxuICAgICAgICAgICAgbW9ja1N0YXR1c1RyYWNrZXJcbiAgICAgICAgKTtcblxuICAgICAgICAvLyBSZXBsYWNlIHRoZSBpbnRlcm5hbCBzdHJlYW1pbmcgcnVubmVyIHdpdGggb3VyIHRlc3QgaW5zdGFuY2VcbiAgICAgICAgKHByb3ZpZGVyIGFzIGFueSkuc3RyZWFtaW5nUnVubmVyID0gc3RyZWFtaW5nUnVubmVyO1xuICAgICAgICAocHJvdmlkZXIgYXMgYW55KS5zZXR1cFN0cmVhbWluZ0xpc3RlbmVycygpO1xuICAgIH0pO1xuXG4gICAgYWZ0ZXJFYWNoKCgpID0+IHtcbiAgICAgICAgc3RyZWFtaW5nUnVubmVyLnJlbW92ZUFsbExpc3RlbmVycygpO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ2VuZC10by1lbmQgY29tbWFuZCBleGVjdXRpb24gd2l0aCBzdHJlYW1pbmcnLCAoKSA9PiB7XG4gICAgICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgICAgICAgcHJvdmlkZXIucmVzb2x2ZVdlYnZpZXdWaWV3KG1vY2tXZWJ2aWV3Vmlldywge30gYXMgYW55LCB7fSBhcyBhbnkpO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdCgnc2hvdWxkIHN0cmVhbSBvdXRwdXQgZHVyaW5nIGNvbW1hbmQgZXhlY3V0aW9uJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgLy8gQXJyYW5nZVxuICAgICAgICAgICAgY29uc3QgeyBzcGF3biB9ID0gcmVxdWlyZSgnY2hpbGRfcHJvY2VzcycpO1xuICAgICAgICAgICAgbGV0IGNvbW1hbmRQcm9taXNlOiBQcm9taXNlPGFueT47XG5cbiAgICAgICAgICAgIC8vIEFjdCAtIHN0YXJ0IGNvbW1hbmRcbiAgICAgICAgICAgIGNvbW1hbmRQcm9taXNlID0gKHByb3ZpZGVyIGFzIGFueSkucnVuQ29tbWFuZCgnbnhUZXN0JywgeyBwcm9qZWN0OiAndGVzdC1hcHAnIH0pO1xuXG4gICAgICAgICAgICAvLyBTaW11bGF0ZSBjb21tYW5kIG91dHB1dCBzdHJlYW1pbmdcbiAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAxMCkpOyAvLyBMZXQgY29tbWFuZCBzdGFydFxuXG4gICAgICAgICAgICBtb2NrQ2hpbGRQcm9jZXNzLnN0ZG91dC5lbWl0KCdkYXRhJywgQnVmZmVyLmZyb20oJ0RldGVybWluaW5nIHRlc3Qgc3VpdGVzIHRvIHJ1bi4uLlxcbicpKTtcbiAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAxMCkpO1xuXG4gICAgICAgICAgICBtb2NrQ2hpbGRQcm9jZXNzLnN0ZG91dC5lbWl0KCdkYXRhJywgQnVmZmVyLmZyb20oJ0ZvdW5kIDUgdGVzdCBzdWl0ZXNcXG4nKSk7XG4gICAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMTApKTtcblxuICAgICAgICAgICAgbW9ja0NoaWxkUHJvY2Vzcy5zdGRvdXQuZW1pdCgnZGF0YScsIEJ1ZmZlci5mcm9tKCdSdW5uaW5nIHRlc3RzLi4uXFxuJykpO1xuICAgICAgICAgICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDEwKSk7XG5cbiAgICAgICAgICAgIG1vY2tDaGlsZFByb2Nlc3Muc3Rkb3V0LmVtaXQoJ2RhdGEnLCBCdWZmZXIuZnJvbSgnVGVzdCByZXN1bHRzOlxcbiBQQVNTIHNyYy9hcHAuc3BlYy50c1xcbicpKTtcbiAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAxMCkpO1xuXG4gICAgICAgICAgICAvLyBDb21wbGV0ZSBjb21tYW5kXG4gICAgICAgICAgICBtb2NrQ2hpbGRQcm9jZXNzLmVtaXQoJ2Nsb3NlJywgMCk7XG5cbiAgICAgICAgICAgIC8vIFdhaXQgZm9yIGNvbW1hbmQgdG8gY29tcGxldGVcbiAgICAgICAgICAgIGF3YWl0IGNvbW1hbmRQcm9taXNlO1xuXG4gICAgICAgICAgICAvLyBBc3NlcnQgLSBjaGVjayB0aGF0IHN0cmVhbWluZyBtZXNzYWdlcyB3ZXJlIHNlbnRcbiAgICAgICAgICAgIGNvbnN0IHN0cmVhbWluZ01lc3NhZ2VzID0gcmVjZWl2ZWRNZXNzYWdlcy5maWx0ZXIobXNnID0+IG1zZy5jb21tYW5kID09PSAnc3RyZWFtaW5nVXBkYXRlJyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGV4cGVjdChzdHJlYW1pbmdNZXNzYWdlcy5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQ2hlY2sgZm9yIG91dHB1dCBtZXNzYWdlc1xuICAgICAgICAgICAgY29uc3Qgb3V0cHV0TWVzc2FnZXMgPSBzdHJlYW1pbmdNZXNzYWdlcy5maWx0ZXIobXNnID0+IG1zZy5tZXNzYWdlLnR5cGUgPT09ICdvdXRwdXQnKTtcbiAgICAgICAgICAgIGV4cGVjdChvdXRwdXRNZXNzYWdlcy5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICAgICAgICAgIGV4cGVjdChvdXRwdXRNZXNzYWdlc1swXS5tZXNzYWdlLmRhdGEudGV4dCkudG9Db250YWluKCdEZXRlcm1pbmluZyB0ZXN0IHN1aXRlcycpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBDaGVjayBmb3IgcHJvZ3Jlc3MgbWVzc2FnZXNcbiAgICAgICAgICAgIGNvbnN0IHByb2dyZXNzTWVzc2FnZXMgPSBzdHJlYW1pbmdNZXNzYWdlcy5maWx0ZXIobXNnID0+IG1zZy5tZXNzYWdlLnR5cGUgPT09ICdwcm9ncmVzcycpO1xuICAgICAgICAgICAgZXhwZWN0KHByb2dyZXNzTWVzc2FnZXMubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIENoZWNrIGZvciBjb21wbGV0aW9uIG1lc3NhZ2VcbiAgICAgICAgICAgIGNvbnN0IGNvbXBsZXRlTWVzc2FnZXMgPSBzdHJlYW1pbmdNZXNzYWdlcy5maWx0ZXIobXNnID0+IG1zZy5tZXNzYWdlLnR5cGUgPT09ICdjb21wbGV0ZScpO1xuICAgICAgICAgICAgZXhwZWN0KGNvbXBsZXRlTWVzc2FnZXMubGVuZ3RoKS50b0JlKDEpO1xuICAgICAgICAgICAgZXhwZWN0KGNvbXBsZXRlTWVzc2FnZXNbMF0ubWVzc2FnZS5kYXRhLnJlc3VsdC5zdWNjZXNzKS50b0JlKHRydWUpO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSBjb21tYW5kIGNhbmNlbGxhdGlvbicsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIC8vIEFycmFuZ2VcbiAgICAgICAgICAgIGxldCBjb21tYW5kUHJvbWlzZTogUHJvbWlzZTxhbnk+O1xuXG4gICAgICAgICAgICAvLyBBY3QgLSBzdGFydCBjb21tYW5kXG4gICAgICAgICAgICBjb21tYW5kUHJvbWlzZSA9IChwcm92aWRlciBhcyBhbnkpLnJ1bkNvbW1hbmQoJ254VGVzdCcsIHsgcHJvamVjdDogJ3Rlc3QtYXBwJyB9KTtcbiAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAxMCkpOyAvLyBMZXQgY29tbWFuZCBzdGFydFxuXG4gICAgICAgICAgICAvLyBTaW11bGF0ZSB1c2VyIGNhbmNlbGxhdGlvblxuICAgICAgICAgICAgY29uc3QgY2FuY2VsTWVzc2FnZTogV2Vidmlld01lc3NhZ2UgPSB7XG4gICAgICAgICAgICAgICAgY29tbWFuZDogJ2NhbmNlbENvbW1hbmQnLFxuICAgICAgICAgICAgICAgIGRhdGE6IHt9XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBjb25zdCBtZXNzYWdlSGFuZGxlciA9IG1vY2tXZWJ2aWV3Lm9uRGlkUmVjZWl2ZU1lc3NhZ2UubW9jay5jYWxsc1swXVswXTtcbiAgICAgICAgICAgIGF3YWl0IG1lc3NhZ2VIYW5kbGVyKGNhbmNlbE1lc3NhZ2UpO1xuXG4gICAgICAgICAgICAvLyBDb21wbGV0ZSB0aGUgY2FuY2VsbGVkIGNvbW1hbmRcbiAgICAgICAgICAgIG1vY2tDaGlsZFByb2Nlc3MuZW1pdCgnY2xvc2UnLCAxKTtcbiAgICAgICAgICAgIGF3YWl0IGNvbW1hbmRQcm9taXNlO1xuXG4gICAgICAgICAgICAvLyBBc3NlcnRcbiAgICAgICAgICAgIGV4cGVjdChtb2NrQ2hpbGRQcm9jZXNzLmtpbGwpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdTSUdURVJNJyk7XG4gICAgICAgICAgICBleHBlY3QoKHByb3ZpZGVyIGFzIGFueSkuX3N0YXRlLmlzU3RyZWFtaW5nKS50b0JlKGZhbHNlKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgY29tbWFuZCBmYWlsdXJlIHdpdGggZXJyb3Igc3RyZWFtaW5nJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgLy8gQXJyYW5nZVxuICAgICAgICAgICAgbGV0IGNvbW1hbmRQcm9taXNlOiBQcm9taXNlPGFueT47XG5cbiAgICAgICAgICAgIC8vIEFjdCAtIHN0YXJ0IGNvbW1hbmRcbiAgICAgICAgICAgIGNvbW1hbmRQcm9taXNlID0gKHByb3ZpZGVyIGFzIGFueSkucnVuQ29tbWFuZCgnbnhUZXN0JywgeyBwcm9qZWN0OiAndGVzdC1hcHAnIH0pO1xuICAgICAgICAgICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDEwKSk7XG5cbiAgICAgICAgICAgIC8vIFNpbXVsYXRlIGVycm9yIG91dHB1dFxuICAgICAgICAgICAgbW9ja0NoaWxkUHJvY2Vzcy5zdGRlcnIuZW1pdCgnZGF0YScsIEJ1ZmZlci5mcm9tKCdFcnJvcjogVGVzdCBmYWlsZWRcXG4nKSk7XG4gICAgICAgICAgICBtb2NrQ2hpbGRQcm9jZXNzLnN0ZG91dC5lbWl0KCdkYXRhJywgQnVmZmVyLmZyb20oJ0ZBSUwgc3JjL2FwcC5zcGVjLnRzXFxuJykpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBDb21wbGV0ZSB3aXRoIGZhaWx1cmVcbiAgICAgICAgICAgIG1vY2tDaGlsZFByb2Nlc3MuZW1pdCgnY2xvc2UnLCAxKTtcbiAgICAgICAgICAgIGF3YWl0IGNvbW1hbmRQcm9taXNlO1xuXG4gICAgICAgICAgICAvLyBBc3NlcnRcbiAgICAgICAgICAgIGNvbnN0IHN0cmVhbWluZ01lc3NhZ2VzID0gcmVjZWl2ZWRNZXNzYWdlcy5maWx0ZXIobXNnID0+IG1zZy5jb21tYW5kID09PSAnc3RyZWFtaW5nVXBkYXRlJyk7XG4gICAgICAgICAgICBjb25zdCBlcnJvck1lc3NhZ2VzID0gc3RyZWFtaW5nTWVzc2FnZXMuZmlsdGVyKG1zZyA9PiBtc2cubWVzc2FnZS50eXBlID09PSAnZXJyb3InKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgZXhwZWN0KGVycm9yTWVzc2FnZXMubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgICAgICAgICBleHBlY3QoZXJyb3JNZXNzYWdlc1swXS5tZXNzYWdlLmRhdGEudGV4dCkudG9Db250YWluKCdFcnJvcjogVGVzdCBmYWlsZWQnKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3QgY29tcGxldGVNZXNzYWdlcyA9IHN0cmVhbWluZ01lc3NhZ2VzLmZpbHRlcihtc2cgPT4gbXNnLm1lc3NhZ2UudHlwZSA9PT0gJ2NvbXBsZXRlJyk7XG4gICAgICAgICAgICBleHBlY3QoY29tcGxldGVNZXNzYWdlc1swXS5tZXNzYWdlLmRhdGEucmVzdWx0LnN1Y2Nlc3MpLnRvQmUoZmFsc2UpO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdCgnc2hvdWxkIGNvb3JkaW5hdGUgbXVsdGktc3RlcCBBSSBEZWJ1ZyB3b3JrZmxvdycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIC8vIEFycmFuZ2VcbiAgICAgICAgICAgIGxldCBjb21tYW5kUHJvbWlzZTogUHJvbWlzZTxhbnk+O1xuXG4gICAgICAgICAgICAvLyBBY3QgLSBzdGFydCBBSSBEZWJ1ZyBjb21tYW5kXG4gICAgICAgICAgICBjb21tYW5kUHJvbWlzZSA9IChwcm92aWRlciBhcyBhbnkpLnJ1bkNvbW1hbmQoJ2FpRGVidWcnLCB7IHByb2plY3Q6ICd0ZXN0LWFwcCcgfSk7XG4gICAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMTApKTtcblxuICAgICAgICAgICAgLy8gU2ltdWxhdGUgU3RlcCAxOiBUZXN0c1xuICAgICAgICAgICAgbW9ja0NoaWxkUHJvY2Vzcy5zdGRvdXQuZW1pdCgnZGF0YScsIEJ1ZmZlci5mcm9tKCdEZXRlcm1pbmluZyB0ZXN0IHN1aXRlcyB0byBydW4uLi5cXG4nKSk7XG4gICAgICAgICAgICBtb2NrQ2hpbGRQcm9jZXNzLmVtaXQoJ2Nsb3NlJywgMCk7XG4gICAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMTApKTtcblxuICAgICAgICAgICAgLy8gVGhlIHdvcmtmbG93IHNob3VsZCBjb250aW51ZSB0byBnaXQgZGlmZiBzdGVwXG4gICAgICAgICAgICAvLyBSZXNldCBmb3IgbmV4dCBjb21tYW5kXG4gICAgICAgICAgICBtb2NrQ2hpbGRQcm9jZXNzLnJlbW92ZUFsbExpc3RlbmVycygpO1xuICAgICAgICAgICAgbW9ja0NoaWxkUHJvY2Vzcy5zdGRvdXQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgICAgICAgICBtb2NrQ2hpbGRQcm9jZXNzLnN0ZGVyciA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcblxuICAgICAgICAgICAgLy8gU2ltdWxhdGUgU3RlcCAyOiBHaXQgZGlmZlxuICAgICAgICAgICAgbW9ja0NoaWxkUHJvY2Vzcy5zdGRvdXQuZW1pdCgnZGF0YScsIEJ1ZmZlci5mcm9tKCdBbmFseXppbmcgcmVwb3NpdG9yeS4uLlxcbicpKTtcbiAgICAgICAgICAgIG1vY2tDaGlsZFByb2Nlc3MuZW1pdCgnY2xvc2UnLCAwKTtcbiAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAxMCkpO1xuXG4gICAgICAgICAgICAvLyBXYWl0IGZvciBjb21tYW5kIHRvIGNvbXBsZXRlXG4gICAgICAgICAgICBhd2FpdCBjb21tYW5kUHJvbWlzZTtcblxuICAgICAgICAgICAgLy8gQXNzZXJ0XG4gICAgICAgICAgICBjb25zdCBzdHJlYW1pbmdNZXNzYWdlcyA9IHJlY2VpdmVkTWVzc2FnZXMuZmlsdGVyKG1zZyA9PiBtc2cuY29tbWFuZCA9PT0gJ3N0cmVhbWluZ1VwZGF0ZScpO1xuICAgICAgICAgICAgY29uc3Qgc3RhdHVzTWVzc2FnZXMgPSBzdHJlYW1pbmdNZXNzYWdlcy5maWx0ZXIobXNnID0+IG1zZy5tZXNzYWdlLnR5cGUgPT09ICdzdGF0dXMnKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gU2hvdWxkIGhhdmUgc3RhdHVzIG1lc3NhZ2VzIGZvciBlYWNoIHN0ZXBcbiAgICAgICAgICAgIGNvbnN0IHN0ZXBNZXNzYWdlcyA9IHN0YXR1c01lc3NhZ2VzLmZpbHRlcihtc2cgPT4gXG4gICAgICAgICAgICAgICAgbXNnLm1lc3NhZ2UuZGF0YS5zdGF0dXMuaW5jbHVkZXMoJ1N0ZXAgMS8zJykgfHwgXG4gICAgICAgICAgICAgICAgbXNnLm1lc3NhZ2UuZGF0YS5zdGF0dXMuaW5jbHVkZXMoJ1N0ZXAgMi8zJykgfHxcbiAgICAgICAgICAgICAgICBtc2cubWVzc2FnZS5kYXRhLnN0YXR1cy5pbmNsdWRlcygnU3RlcCAzLzMnKVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGV4cGVjdChzdGVwTWVzc2FnZXMubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFNob3VsZCBjb21wbGV0ZSBzdWNjZXNzZnVsbHlcbiAgICAgICAgICAgIGNvbnN0IGNvbXBsZXRlTWVzc2FnZXMgPSBzdHJlYW1pbmdNZXNzYWdlcy5maWx0ZXIobXNnID0+IG1zZy5tZXNzYWdlLnR5cGUgPT09ICdjb21wbGV0ZScpO1xuICAgICAgICAgICAgZXhwZWN0KGNvbXBsZXRlTWVzc2FnZXMubGVuZ3RoKS50b0JlKDEpO1xuICAgICAgICAgICAgZXhwZWN0KG1vY2tDb21tYW5kUnVubmVyLnJ1bkFpRGVidWcpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnd2VidmlldyBtZXNzYWdlIGhhbmRsaW5nIGludGVncmF0aW9uJywgKCkgPT4ge1xuICAgICAgICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICAgICAgICAgIHByb3ZpZGVyLnJlc29sdmVXZWJ2aWV3Vmlldyhtb2NrV2Vidmlld1ZpZXcsIHt9IGFzIGFueSwge30gYXMgYW55KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgcnVuQ29tbWFuZCBtZXNzYWdlIGFuZCBzdHJlYW0gcmVzdWx0cycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIC8vIEFycmFuZ2VcbiAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2U6IFdlYnZpZXdNZXNzYWdlID0ge1xuICAgICAgICAgICAgICAgIGNvbW1hbmQ6ICdydW5Db21tYW5kJyxcbiAgICAgICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbjogJ254VGVzdCcsXG4gICAgICAgICAgICAgICAgICAgIHByb2plY3Q6ICd0ZXN0LWFwcCdcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBjb25zdCBtZXNzYWdlSGFuZGxlciA9IG1vY2tXZWJ2aWV3Lm9uRGlkUmVjZWl2ZU1lc3NhZ2UubW9jay5jYWxsc1swXVswXTtcblxuICAgICAgICAgICAgLy8gQWN0XG4gICAgICAgICAgICBjb25zdCBoYW5kbGVQcm9taXNlID0gbWVzc2FnZUhhbmRsZXIobWVzc2FnZSk7XG4gICAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMTApKTtcblxuICAgICAgICAgICAgLy8gU2ltdWxhdGUgY29tbWFuZCBleGVjdXRpb25cbiAgICAgICAgICAgIG1vY2tDaGlsZFByb2Nlc3Muc3Rkb3V0LmVtaXQoJ2RhdGEnLCBCdWZmZXIuZnJvbSgnVGVzdCBvdXRwdXRcXG4nKSk7XG4gICAgICAgICAgICBtb2NrQ2hpbGRQcm9jZXNzLmVtaXQoJ2Nsb3NlJywgMCk7XG5cbiAgICAgICAgICAgIGF3YWl0IGhhbmRsZVByb21pc2U7XG5cbiAgICAgICAgICAgIC8vIEFzc2VydFxuICAgICAgICAgICAgY29uc3Qgc3RyZWFtaW5nTWVzc2FnZXMgPSByZWNlaXZlZE1lc3NhZ2VzLmZpbHRlcihtc2cgPT4gbXNnLmNvbW1hbmQgPT09ICdzdHJlYW1pbmdVcGRhdGUnKTtcbiAgICAgICAgICAgIGV4cGVjdChzdHJlYW1pbmdNZXNzYWdlcy5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgY2xlYXJPdXRwdXQgbWVzc2FnZScsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIC8vIEFycmFuZ2VcbiAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2U6IFdlYnZpZXdNZXNzYWdlID0ge1xuICAgICAgICAgICAgICAgIGNvbW1hbmQ6ICdjbGVhck91dHB1dCcsXG4gICAgICAgICAgICAgICAgZGF0YToge31cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2VIYW5kbGVyID0gbW9ja1dlYnZpZXcub25EaWRSZWNlaXZlTWVzc2FnZS5tb2NrLmNhbGxzWzBdWzBdO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBBZGQgc29tZSBvdXRwdXQgZmlyc3RcbiAgICAgICAgICAgIHN0cmVhbWluZ1J1bm5lci5lbWl0KCdvdXRwdXQnLCAndGVzdCBvdXRwdXQnKTtcblxuICAgICAgICAgICAgLy8gQWN0XG4gICAgICAgICAgICBhd2FpdCBtZXNzYWdlSGFuZGxlcihtZXNzYWdlKTtcblxuICAgICAgICAgICAgLy8gQXNzZXJ0XG4gICAgICAgICAgICAvLyBTaG91bGQgaGF2ZSBjbGVhcmVkIG91dHB1dFxuICAgICAgICAgICAgZXhwZWN0KHJlY2VpdmVkTWVzc2FnZXMuc29tZShtc2cgPT4gbXNnLmNvbW1hbmQgPT09ICdjbGVhck91dHB1dCcpKS50b0JlKHRydWUpO1xuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCdwcm9ncmVzcyB0cmFja2luZyBpbnRlZ3JhdGlvbicsICgpID0+IHtcbiAgICAgICAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgICAgICAgICBwcm92aWRlci5yZXNvbHZlV2Vidmlld1ZpZXcobW9ja1dlYnZpZXdWaWV3LCB7fSBhcyBhbnksIHt9IGFzIGFueSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KCdzaG91bGQgdHJhY2sgcHJvZ3Jlc3MgdGhyb3VnaCBjb21tYW5kIGV4ZWN1dGlvbiBwaGFzZXMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAvLyBBcnJhbmdlXG4gICAgICAgICAgICBsZXQgY29tbWFuZFByb21pc2U6IFByb21pc2U8YW55PjtcblxuICAgICAgICAgICAgLy8gQWN0XG4gICAgICAgICAgICBjb21tYW5kUHJvbWlzZSA9IChwcm92aWRlciBhcyBhbnkpLnJ1bkNvbW1hbmQoJ254VGVzdCcsIHsgcHJvamVjdDogJ3Rlc3QtYXBwJyB9KTtcbiAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAxMCkpO1xuXG4gICAgICAgICAgICAvLyBTaW11bGF0ZSBkaWZmZXJlbnQgcHJvZ3Jlc3MgcGhhc2VzXG4gICAgICAgICAgICBtb2NrQ2hpbGRQcm9jZXNzLnN0ZG91dC5lbWl0KCdkYXRhJywgQnVmZmVyLmZyb20oJ0RldGVybWluaW5nIHRlc3Qgc3VpdGVzIHRvIHJ1bi4uLlxcbicpKTtcbiAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAxMCkpO1xuXG4gICAgICAgICAgICBtb2NrQ2hpbGRQcm9jZXNzLnN0ZG91dC5lbWl0KCdkYXRhJywgQnVmZmVyLmZyb20oJ0ZvdW5kIHRlc3Qgc3VpdGVzXFxuJykpO1xuICAgICAgICAgICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDEwKSk7XG5cbiAgICAgICAgICAgIG1vY2tDaGlsZFByb2Nlc3Muc3Rkb3V0LmVtaXQoJ2RhdGEnLCBCdWZmZXIuZnJvbSgnUnVubmluZyB0ZXN0c1xcbicpKTtcbiAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAxMCkpO1xuXG4gICAgICAgICAgICBtb2NrQ2hpbGRQcm9jZXNzLnN0ZG91dC5lbWl0KCdkYXRhJywgQnVmZmVyLmZyb20oJ1Rlc3Qgc3VpdGVzIGNvbXBsZXRlZFxcbicpKTtcbiAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAxMCkpO1xuXG4gICAgICAgICAgICBtb2NrQ2hpbGRQcm9jZXNzLmVtaXQoJ2Nsb3NlJywgMCk7XG4gICAgICAgICAgICBhd2FpdCBjb21tYW5kUHJvbWlzZTtcblxuICAgICAgICAgICAgLy8gQXNzZXJ0XG4gICAgICAgICAgICBjb25zdCBzdHJlYW1pbmdNZXNzYWdlcyA9IHJlY2VpdmVkTWVzc2FnZXMuZmlsdGVyKG1zZyA9PiBtc2cuY29tbWFuZCA9PT0gJ3N0cmVhbWluZ1VwZGF0ZScpO1xuICAgICAgICAgICAgY29uc3QgcHJvZ3Jlc3NNZXNzYWdlcyA9IHN0cmVhbWluZ01lc3NhZ2VzLmZpbHRlcihtc2cgPT4gbXNnLm1lc3NhZ2UudHlwZSA9PT0gJ3Byb2dyZXNzJyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFNob3VsZCBoYXZlIHByb2dyZXNzIHVwZGF0ZXNcbiAgICAgICAgICAgIGV4cGVjdChwcm9ncmVzc01lc3NhZ2VzLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBQcm9ncmVzcyBzaG91bGQgaW5jcmVhc2Ugb3ZlciB0aW1lXG4gICAgICAgICAgICBjb25zdCBwcm9ncmVzc1ZhbHVlcyA9IHByb2dyZXNzTWVzc2FnZXMubWFwKG1zZyA9PiBtc2cubWVzc2FnZS5kYXRhLnByb2dyZXNzKTtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgcHJvZ3Jlc3NWYWx1ZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBleHBlY3QocHJvZ3Jlc3NWYWx1ZXNbaV0pLnRvQmVHcmVhdGVyVGhhbk9yRXF1YWwocHJvZ3Jlc3NWYWx1ZXNbaSAtIDFdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoJ3Nob3VsZCB1cGRhdGUgYWN0aW9uIGJ1dHRvbiBwcm9ncmVzcyBpbiBzdGF0ZScsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIC8vIEFycmFuZ2VcbiAgICAgICAgICAgIGxldCBjb21tYW5kUHJvbWlzZTogUHJvbWlzZTxhbnk+O1xuXG4gICAgICAgICAgICAvLyBBY3RcbiAgICAgICAgICAgIGNvbW1hbmRQcm9taXNlID0gKHByb3ZpZGVyIGFzIGFueSkucnVuQ29tbWFuZCgnbnhUZXN0JywgeyBwcm9qZWN0OiAndGVzdC1hcHAnIH0pO1xuICAgICAgICAgICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDEwKSk7XG5cbiAgICAgICAgICAgIC8vIFNpbXVsYXRlIHByb2dyZXNzXG4gICAgICAgICAgICBtb2NrQ2hpbGRQcm9jZXNzLnN0ZG91dC5lbWl0KCdkYXRhJywgQnVmZmVyLmZyb20oJ1J1bm5pbmcgdGVzdHNcXG4nKSk7XG4gICAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMTApKTtcblxuICAgICAgICAgICAgLy8gQ2hlY2sgaW50ZXJtZWRpYXRlIHN0YXRlXG4gICAgICAgICAgICBjb25zdCBzdGF0ZSA9IChwcm92aWRlciBhcyBhbnkpLl9zdGF0ZTtcbiAgICAgICAgICAgIGV4cGVjdChzdGF0ZS5hY3Rpb25zLm54VGVzdC5zdGF0dXMpLnRvQmUoJ3J1bm5pbmcnKTtcblxuICAgICAgICAgICAgbW9ja0NoaWxkUHJvY2Vzcy5lbWl0KCdjbG9zZScsIDApO1xuICAgICAgICAgICAgYXdhaXQgY29tbWFuZFByb21pc2U7XG5cbiAgICAgICAgICAgIC8vIENoZWNrIGZpbmFsIHN0YXRlXG4gICAgICAgICAgICBleHBlY3Qoc3RhdGUuYWN0aW9ucy5ueFRlc3Quc3RhdHVzKS50b0JlKCdzdWNjZXNzJyk7XG4gICAgICAgICAgICBleHBlY3Qoc3RhdGUuYWN0aW9ucy5ueFRlc3QucHJvZ3Jlc3MpLnRvQmVVbmRlZmluZWQoKTsgLy8gU2hvdWxkIGJlIGNsZWFyZWQgb24gY29tcGxldGlvblxuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCdlcnJvciBoYW5kbGluZyBpbnRlZ3JhdGlvbicsICgpID0+IHtcbiAgICAgICAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgICAgICAgICBwcm92aWRlci5yZXNvbHZlV2Vidmlld1ZpZXcobW9ja1dlYnZpZXdWaWV3LCB7fSBhcyBhbnksIHt9IGFzIGFueSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KCdzaG91bGQgaGFuZGxlIHByb2Nlc3Mgc3Bhd24gZXJyb3JzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgLy8gQXJyYW5nZVxuICAgICAgICAgICAgY29uc3QgeyBzcGF3biB9ID0gcmVxdWlyZSgnY2hpbGRfcHJvY2VzcycpO1xuICAgICAgICAgICAgc3Bhd24ubW9ja0ltcGxlbWVudGF0aW9uT25jZSgoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgZXJyb3JQcm9jZXNzID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBlcnJvclByb2Nlc3MuZW1pdCgnZXJyb3InLCBuZXcgRXJyb3IoJ0NvbW1hbmQgbm90IGZvdW5kJykpO1xuICAgICAgICAgICAgICAgIH0sIDEwKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZXJyb3JQcm9jZXNzO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIEFjdFxuICAgICAgICAgICAgYXdhaXQgKHByb3ZpZGVyIGFzIGFueSkucnVuQ29tbWFuZCgnbnhUZXN0JywgeyBwcm9qZWN0OiAndGVzdC1hcHAnIH0pO1xuXG4gICAgICAgICAgICAvLyBBc3NlcnRcbiAgICAgICAgICAgIGNvbnN0IHN0cmVhbWluZ01lc3NhZ2VzID0gcmVjZWl2ZWRNZXNzYWdlcy5maWx0ZXIobXNnID0+IG1zZy5jb21tYW5kID09PSAnc3RyZWFtaW5nVXBkYXRlJyk7XG4gICAgICAgICAgICBjb25zdCBjb21wbGV0ZU1lc3NhZ2VzID0gc3RyZWFtaW5nTWVzc2FnZXMuZmlsdGVyKG1zZyA9PiBtc2cubWVzc2FnZS50eXBlID09PSAnY29tcGxldGUnKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgZXhwZWN0KGNvbXBsZXRlTWVzc2FnZXMubGVuZ3RoKS50b0JlKDEpO1xuICAgICAgICAgICAgZXhwZWN0KGNvbXBsZXRlTWVzc2FnZXNbMF0ubWVzc2FnZS5kYXRhLnJlc3VsdC5zdWNjZXNzKS50b0JlKGZhbHNlKTtcbiAgICAgICAgICAgIGV4cGVjdChjb21wbGV0ZU1lc3NhZ2VzWzBdLm1lc3NhZ2UuZGF0YS5yZXN1bHQuZXJyb3IpLnRvQ29udGFpbignQ29tbWFuZCBub3QgZm91bmQnKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgaW52YWxpZCBhY3Rpb24gZ3JhY2VmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIC8vIEFjdCAmIEFzc2VydCAtIHNob3VsZCBub3QgdGhyb3dcbiAgICAgICAgICAgIGF3YWl0IGV4cGVjdCgocHJvdmlkZXIgYXMgYW55KS5ydW5Db21tYW5kKCdpbnZhbGlkQWN0aW9uJyBhcyBhbnksIHt9KSkucmVzb2x2ZXMudG9CZVVuZGVmaW5lZCgpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBleHBlY3QodnNjb2RlLndpbmRvdy5zaG93RXJyb3JNZXNzYWdlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgICAgICAgICBleHBlY3Quc3RyaW5nQ29udGFpbmluZygnVW5rbm93biBhY3Rpb246IGludmFsaWRBY3Rpb24nKVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnc3RhdGUgY29uc2lzdGVuY3kgaW50ZWdyYXRpb24nLCAoKSA9PiB7XG4gICAgICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgICAgICAgcHJvdmlkZXIucmVzb2x2ZVdlYnZpZXdWaWV3KG1vY2tXZWJ2aWV3Vmlldywge30gYXMgYW55LCB7fSBhcyBhbnkpO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdCgnc2hvdWxkIG1haW50YWluIGNvbnNpc3RlbnQgc3RhdGUgdGhyb3VnaG91dCBjb21tYW5kIGxpZmVjeWNsZScsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIC8vIEFycmFuZ2VcbiAgICAgICAgICAgIGNvbnN0IHN0YXRlID0gKHByb3ZpZGVyIGFzIGFueSkuX3N0YXRlO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBleHBlY3Qoc3RhdGUuaXNTdHJlYW1pbmcpLnRvQmUoZmFsc2UpO1xuICAgICAgICAgICAgZXhwZWN0KHN0YXRlLmN1cnJlbnRBY3Rpb24pLnRvQmVVbmRlZmluZWQoKTtcblxuICAgICAgICAgICAgLy8gQWN0IC0gc3RhcnQgY29tbWFuZFxuICAgICAgICAgICAgY29uc3QgY29tbWFuZFByb21pc2UgPSAocHJvdmlkZXIgYXMgYW55KS5ydW5Db21tYW5kKCdueFRlc3QnLCB7IHByb2plY3Q6ICd0ZXN0LWFwcCcgfSk7XG4gICAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMTApKTtcblxuICAgICAgICAgICAgLy8gQXNzZXJ0IC0gZHVyaW5nIGV4ZWN1dGlvblxuICAgICAgICAgICAgZXhwZWN0KHN0YXRlLmlzU3RyZWFtaW5nKS50b0JlKHRydWUpO1xuICAgICAgICAgICAgZXhwZWN0KHN0YXRlLmN1cnJlbnRBY3Rpb24pLnRvQmUoJ254VGVzdCcpO1xuICAgICAgICAgICAgZXhwZWN0KHN0YXRlLmFjdGlvbnMubnhUZXN0LnN0YXR1cykudG9CZSgncnVubmluZycpO1xuXG4gICAgICAgICAgICAvLyBDb21wbGV0ZSBjb21tYW5kXG4gICAgICAgICAgICBtb2NrQ2hpbGRQcm9jZXNzLmVtaXQoJ2Nsb3NlJywgMCk7XG4gICAgICAgICAgICBhd2FpdCBjb21tYW5kUHJvbWlzZTtcblxuICAgICAgICAgICAgLy8gQXNzZXJ0IC0gYWZ0ZXIgY29tcGxldGlvblxuICAgICAgICAgICAgZXhwZWN0KHN0YXRlLmlzU3RyZWFtaW5nKS50b0JlKGZhbHNlKTtcbiAgICAgICAgICAgIGV4cGVjdChzdGF0ZS5jdXJyZW50QWN0aW9uKS50b0JlVW5kZWZpbmVkKCk7XG4gICAgICAgICAgICBleHBlY3Qoc3RhdGUuYWN0aW9ucy5ueFRlc3Quc3RhdHVzKS50b0JlKCdzdWNjZXNzJyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KCdzaG91bGQgcmVzZXQgc3RhdGUgcHJvcGVybHkgb24gY29tbWFuZCBmYWlsdXJlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgLy8gQXJyYW5nZVxuICAgICAgICAgICAgY29uc3Qgc3RhdGUgPSAocHJvdmlkZXIgYXMgYW55KS5fc3RhdGU7XG5cbiAgICAgICAgICAgIC8vIEFjdCAtIHN0YXJ0IGFuZCBmYWlsIGNvbW1hbmRcbiAgICAgICAgICAgIGNvbnN0IGNvbW1hbmRQcm9taXNlID0gKHByb3ZpZGVyIGFzIGFueSkucnVuQ29tbWFuZCgnbnhUZXN0JywgeyBwcm9qZWN0OiAndGVzdC1hcHAnIH0pO1xuICAgICAgICAgICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDEwKSk7XG5cbiAgICAgICAgICAgIG1vY2tDaGlsZFByb2Nlc3MuZW1pdCgnY2xvc2UnLCAxKTsgLy8gRmFpbHVyZVxuICAgICAgICAgICAgYXdhaXQgY29tbWFuZFByb21pc2U7XG5cbiAgICAgICAgICAgIC8vIEFzc2VydFxuICAgICAgICAgICAgZXhwZWN0KHN0YXRlLmlzU3RyZWFtaW5nKS50b0JlKGZhbHNlKTtcbiAgICAgICAgICAgIGV4cGVjdChzdGF0ZS5jdXJyZW50QWN0aW9uKS50b0JlVW5kZWZpbmVkKCk7XG4gICAgICAgICAgICBleHBlY3Qoc3RhdGUuYWN0aW9ucy5ueFRlc3Quc3RhdHVzKS50b0JlKCdlcnJvcicpO1xuICAgICAgICB9KTtcbiAgICB9KTtcbn0pOyJdLCJ2ZXJzaW9uIjozfQ==