0631475086719b765e7eee62b2489b24
"use strict";
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
exports.AiDebugCommand = void 0;
const vscode = __importStar(require("vscode"));
const child_process_1 = require("child_process");
const fileManager_1 = require("../utils/fileManager");
const shellRunner_1 = require("../utils/shellRunner");
class AiDebugCommand {
    fileManager;
    commandRunner;
    outputChannel;
    constructor() {
        this.outputChannel = vscode.window.createOutputChannel('AI Debug Utilities');
        this.fileManager = new fileManager_1.FileManager(this.outputChannel);
        this.commandRunner = new shellRunner_1.CommandRunner(this.outputChannel);
    }
    /**
     * Run AI Debug command with integrated quality checks
     */
    async run(project, options = {}) {
        const startTime = Date.now();
        try {
            // Prepare output files
            const outputFiles = await this.fileManager.initializeOutputFiles(['ai-debug-context', 'pr-description-prompt', 'diff', 'jest-output']);
            this.showProgress("AI Debug Assistant: Optimized Context Generation", {
                target: project,
                mode: options.quick ? "Quick" : "Full",
                context: options.fullContext ? "Verbose" : "AI-Optimized",
                focus: options.focus || "General"
            });
            // Step 1: Capture git changes (unless skipped)
            if (!options.noDiff) {
                await this.showStep("Analyzing git changes...");
                const gitDiffResult = await this.commandRunner.runGitDiff({ aiContext: true, smartDiff: true });
                if (gitDiffResult.success && gitDiffResult.output) {
                    const changesCount = this.countChangedFiles(gitDiffResult.output);
                    this.showSuccess(`Captured changes for ${changesCount} files`);
                }
                else {
                    this.showWarning("No git changes detected - focusing on existing code analysis");
                }
            }
            else {
                this.showInfo("Skipping git diff capture (--no-diff specified)");
            }
            // Step 2: Run tests and capture results
            await this.showStep("Running tests and generating analysis...");
            const testResult = await this.commandRunner.runNxTest(project, {
                fullOutput: options.fullContext,
                useExpected: options.useExpected
            });
            if (!testResult.success) {
                this.showError("Test execution failed");
            }
            // Step 3: Run prepareToPush if tests are passing
            let lintExitCode = 0;
            let prettierExitCode = 0;
            if (testResult.success) {
                await this.showStep("Tests passing! Running prepareToPush (lint + format)...");
                // Run linting
                await this.showStep("Running linter...");
                const lintResult = await this.executeLint(project);
                lintExitCode = lintResult.exitCode;
                if (lintResult.success) {
                    this.showSuccess("Linting passed!");
                    // Run prettier
                    await this.showStep("Running code formatter...");
                    const prettierResult = await this.executePrettier(project);
                    prettierExitCode = prettierResult.exitCode;
                    if (prettierResult.success) {
                        this.showSuccess("Code formatting completed!");
                    }
                    else {
                        this.showError(`Prettier failed with exit code: ${prettierExitCode}`);
                    }
                }
                else {
                    this.showError(`Linting failed with exit code: ${lintExitCode}`);
                    this.showInfo("Skipping prettier due to lint failures");
                }
            }
            // Step 4: Generate intelligent AI context
            await this.showStep("Generating AI-optimized context file...");
            await this.createAiDebugContext(outputFiles['ai-debug-context'], outputFiles['diff'], outputFiles['jest-output'], project, testResult.exitCode, options.focus || "", options.quick || false, lintExitCode, prettierExitCode);
            // Step 5: Generate PR description prompts if tests are passing
            if (testResult.success) {
                await this.showStep("Auto-generating PR description prompts...");
                await this.createPrDescriptionPrompts(outputFiles['pr-description-prompt'], outputFiles['diff'], outputFiles['jest-output'], project, testResult.exitCode, lintExitCode, prettierExitCode);
            }
            // Step 6: Display summary
            await this.displayAiDebugSummary(outputFiles['ai-debug-context'], testResult.exitCode, options.focus || "", testResult.success, outputFiles['pr-description-prompt'], lintExitCode, prettierExitCode, project);
            const duration = Date.now() - startTime;
            return {
                success: testResult.success,
                exitCode: testResult.exitCode,
                output: `AI Debug completed in ${duration}ms`,
                outputFiles: Object.values(outputFiles),
                duration
            };
        }
        catch (error) {
            const duration = Date.now() - startTime;
            return {
                success: false,
                exitCode: 1,
                output: "",
                error: error instanceof Error ? error.message : 'Unknown error',
                duration
            };
        }
    }
    async executeLint(project) {
        return new Promise((resolve) => {
            const process = (0, child_process_1.spawn)('yarn', ['nx', 'lint', project], {
                cwd: this.getWorkspaceRoot(),
                shell: true
            });
            let output = '';
            let error = '';
            process.stdout?.on('data', (data) => {
                output += data.toString();
            });
            process.stderr?.on('data', (data) => {
                error += data.toString();
            });
            process.on('close', (code) => {
                resolve({
                    success: code === 0,
                    exitCode: code || 0,
                    output,
                    error: error || undefined,
                    duration: 0
                });
            });
        });
    }
    async executePrettier(project) {
        return new Promise((resolve) => {
            const process = (0, child_process_1.spawn)('yarn', ['nx', 'prettier', project, '--write'], {
                cwd: this.getWorkspaceRoot(),
                shell: true
            });
            let output = '';
            let error = '';
            process.stdout?.on('data', (data) => {
                output += data.toString();
            });
            process.stderr?.on('data', (data) => {
                error += data.toString();
            });
            process.on('close', (code) => {
                resolve({
                    success: code === 0,
                    exitCode: code || 0,
                    output,
                    error: error || undefined,
                    duration: 0
                });
            });
        });
    }
    async createAiDebugContext(contextFile, diffFile, testFile, project, exitCode, focusArea, quickMode, lintExitCode, prettierExitCode) {
        const timestamp = new Date().toISOString();
        const status = exitCode === 0 ? "‚úÖ TESTS PASSING" : "‚ùå TESTS FAILING";
        let contextContent = `=================================================================
ü§ñ AI DEBUG CONTEXT - OPTIMIZED FOR ANALYSIS
=================================================================

PROJECT: Angular NX Monorepo
TARGET: ${project}
STATUS: ${status}
FOCUS: ${focusArea || "General debugging"}
TIMESTAMP: ${timestamp}

=================================================================
üéØ ANALYSIS REQUEST
=================================================================

Please analyze this context and provide:

`;
        // Add conditional analysis requests based on test status
        if (exitCode === 0) {
            contextContent += `1. üîç CODE QUALITY ANALYSIS
   ‚Ä¢ Review code changes for potential improvements
   ‚Ä¢ Identify any code smells or anti-patterns
   ‚Ä¢ Check for performance optimization opportunities

2. üé≠ MOCK DATA VALIDATION (CRITICAL)
   ‚Ä¢ Review all mock data to ensure it matches real-world data structures
   ‚Ä¢ Verify mock objects have correct property names and types
   ‚Ä¢ Check that mock data represents realistic scenarios (not just minimal passing data)
   ‚Ä¢ Ensure mocked API responses match actual API contract
   ‚Ä¢ Validate that test data covers edge cases and realistic variations
   ‚Ä¢ Identify mock data that might be giving false positives

3. üß™ TEST COVERAGE ANALYSIS
   ‚Ä¢ Missing test coverage for new functionality
   ‚Ä¢ Edge cases that should be tested
   ‚Ä¢ Additional test scenarios to prevent regressions
   ‚Ä¢ Test improvements for better maintainability
   ‚Ä¢ File-specific coverage analysis (diff coverage vs total coverage)

4. üöÄ ENHANCEMENT RECOMMENDATIONS
   ‚Ä¢ Code quality improvements
   ‚Ä¢ Better error handling or validation
   ‚Ä¢ Documentation or typing improvements
   ‚Ä¢ Performance optimizations

5. üõ°Ô∏è ROBUSTNESS IMPROVEMENTS
   ‚Ä¢ Potential edge cases to handle
   ‚Ä¢ Error scenarios to test
   ‚Ä¢ Input validation opportunities
   ‚Ä¢ Defensive programming suggestions
`;
        }
        else {
            contextContent += `1. üîç ROOT CAUSE ANALYSIS
   ‚Ä¢ What specific changes are breaking the tests?
   ‚Ä¢ Are there type mismatches or interface changes?
   ‚Ä¢ Did method signatures change?

2. üõ†Ô∏è CONCRETE FIXES (PRIORITY 1)
   ‚Ä¢ Exact code changes needed to fix failing tests
   ‚Ä¢ Updated test expectations if business logic changed
   ‚Ä¢ Type definitions or interface updates required

3. üß™ EXISTING TEST FIXES (PRIORITY 1)
   ‚Ä¢ Fix existing failing tests first
   ‚Ä¢ Update test assertions to match new behavior
   ‚Ä¢ Fix test setup or mocking issues

4. üöÄ IMPLEMENTATION GUIDANCE (PRIORITY 1)
   ‚Ä¢ Order of fixes (dependencies first)
   ‚Ä¢ Potential side effects to watch for
   ‚Ä¢ Getting tests green is the immediate priority

5. ‚ú® NEW TEST SUGGESTIONS (PRIORITY 2 - AFTER FIXES)
   ‚Ä¢ Missing test coverage for new functionality
   ‚Ä¢ Edge cases that should be tested
   ‚Ä¢ Additional test scenarios to prevent regressions
   ‚Ä¢ Test improvements for better maintainability
   ‚Ä¢ File-specific coverage analysis (diff coverage vs total coverage)
   ‚Ä¢ Specify files and line numbers where new tests should be added. 

NOTE: Focus on items 1-4 first to get tests passing, then implement item 5
`;
        }
        // Add focus-specific guidance
        if (focusArea) {
            contextContent += `\n`;
            switch (focusArea) {
                case "types":
                    contextContent += `FOCUS AREA: TypeScript type issues and interface mismatches
‚Ä¢ Pay special attention to type definitions and interface changes
‚Ä¢ Look for property name mismatches or type incompatibilities
`;
                    break;
                case "tests":
                    contextContent += `FOCUS AREA: Test logic and assertions
‚Ä¢ Focus on test expectations vs actual implementation
‚Ä¢ Look for test data setup issues or mock problems
`;
                    break;
                case "performance":
                    contextContent += `FOCUS AREA: Performance and optimization
‚Ä¢ Identify slow tests and optimization opportunities
‚Ä¢ Look for inefficient test patterns or setup
`;
                    break;
            }
        }
        // Add test results
        contextContent += `\n==================================================================
üß™ TEST RESULTS ANALYSIS
==================================================================

`;
        try {
            const testContent = await this.fileManager.getFileContent('jest-output');
            contextContent += testContent;
        }
        catch {
            contextContent += "‚ùå No test results available\n";
        }
        // Add code quality results
        contextContent += `\n==================================================================
üîß CODE QUALITY RESULTS
==================================================================

üìã LINTING RESULTS:
`;
        if (lintExitCode === 0) {
            contextContent += `‚úÖ Status: PASSED
‚Ä¢ All linting rules satisfied
‚Ä¢ No code quality issues detected
‚Ä¢ Code follows project style guidelines
`;
        }
        else {
            contextContent += `‚ùå Status: FAILED (Exit code: ${lintExitCode})
‚Ä¢ Linting errors detected above in test output
‚Ä¢ Code quality issues need attention
‚Ä¢ Some errors may be auto-fixable with --fix flag
`;
        }
        contextContent += `\n‚ú® FORMATTING RESULTS:
`;
        if (prettierExitCode === 0) {
            contextContent += `‚úÖ Status: COMPLETED
‚Ä¢ Code formatting applied successfully
‚Ä¢ All files follow consistent style
‚Ä¢ Ready for commit
`;
        }
        else if (lintExitCode !== 0) {
            contextContent += `‚è≠Ô∏è  Status: SKIPPED
‚Ä¢ Skipped due to linting failures
‚Ä¢ Fix linting issues first
‚Ä¢ Formatting will run after lint passes
`;
        }
        else {
            contextContent += `‚ùå Status: FAILED (Exit code: ${prettierExitCode})
‚Ä¢ Formatting errors detected
‚Ä¢ Check syntax errors in files
‚Ä¢ Ensure all files are valid
`;
        }
        // Add push readiness
        contextContent += `\nüöÄ PUSH READINESS:
`;
        if (exitCode === 0 && lintExitCode === 0 && prettierExitCode === 0) {
            contextContent += `‚úÖ READY TO PUSH
‚Ä¢ Tests: Passing ‚úÖ
‚Ä¢ Lint: Clean ‚úÖ
‚Ä¢ Format: Applied ‚úÖ
‚Ä¢ All quality gates satisfied
`;
        }
        else {
            contextContent += `‚ö†Ô∏è  NOT READY - Issues need resolution:
`;
            if (exitCode !== 0) {
                contextContent += "‚Ä¢ Tests: Failing ‚ùå\n";
            }
            if (lintExitCode !== 0) {
                contextContent += "‚Ä¢ Lint: Issues detected ‚ùå\n";
            }
            if (prettierExitCode !== 0) {
                contextContent += "‚Ä¢ Format: Failed ‚ùå\n";
            }
        }
        // Add git changes analysis
        contextContent += `\n==================================================================
üìã CODE CHANGES ANALYSIS
==================================================================

`;
        try {
            const diffContent = await this.fileManager.getFileContent('diff');
            contextContent += diffContent;
        }
        catch {
            contextContent += `‚ÑπÔ∏è  No recent code changes detected

This suggests the test failures may be due to:
‚Ä¢ Environment or configuration issues
‚Ä¢ Dependencies or version conflicts
‚Ä¢ Test setup or teardown problems
‚Ä¢ Race conditions or timing issues
`;
        }
        // Add final guidance
        contextContent += `\n==================================================================
üöÄ AI ASSISTANT GUIDANCE
==================================================================
This context file is optimized for AI analysis with:
‚Ä¢ Structured failure information for easy parsing
‚Ä¢ Code changes correlated with test failures
‚Ä¢ Clear focus areas for targeted analysis
‚Ä¢ Actionable fix categories for systematic resolution

Context file size: ${contextContent.split('\n').length} lines (optimized for AI processing)
`;
        await this.fileManager.saveOutput('ai-debug-context', contextContent);
    }
    async createPrDescriptionPrompts(prFile, diffFile, testFile, project, exitCode, lintExitCode, prettierExitCode) {
        const timestamp = new Date().toISOString();
        const testStatus = exitCode === 0 ? "‚úÖ All tests passing" : "‚ùå Some tests failing (needs fixes)";
        const lintStatus = lintExitCode === 0 ? "‚úÖ Linting passed" : "‚ùå Linting failed";
        const formatStatus = prettierExitCode === 0 ? "‚úÖ Code formatted" : "‚ùå Formatting failed";
        const prContent = `=================================================================
üìù GITHUB PR DESCRIPTION GENERATION PROMPTS
=================================================================

INSTRUCTIONS FOR AI ASSISTANT:
Using the data gathered in the ai-debug-context.txt file, write a GitHub PR 
description that follows the format below. Focus on newly added functions 
and updates. Don't add fluff.

=================================================================
üéØ PRIMARY PR DESCRIPTION PROMPT
=================================================================

Please analyze the code changes and test results to create a GitHub PR description 
following this exact format:

**Problem**
What is the problem you're solving or feature you're implementing? Please include 
a link to any related discussion or tasks in Jira if applicable.
[Jira Link if applicable]

**Solution**
Describe the feature or bug fix -- what's changing?

**Details**
Include a brief overview of the technical process you took (or are going to take!) 
to get from the problem to the solution.

**QA**
Provide any technical details needed to test this change and/or parts that you 
wish to have tested.

=================================================================
üìä CONTEXT FOR PR DESCRIPTION
=================================================================

PROJECT: Angular NX Monorepo
TARGET: ${project}
TEST STATUS: ${testStatus}
LINT STATUS: ${lintStatus}
FORMAT STATUS: ${formatStatus}
TIMESTAMP: ${timestamp}

üìã TESTING INSTRUCTIONS:
‚Ä¢ Run: yarn nx test ${project}
‚Ä¢ Run: yarn nx lint ${project}
‚Ä¢ Run: yarn nx prettier ${project} --write
‚Ä¢ Verify all tests pass and code follows style guidelines
‚Ä¢ Test the specific functionality mentioned in the Solution section
‚Ä¢ Check for any UI/UX changes if applicable

üéØ READY TO USE: Copy the primary prompt above, attach ai-debug-context.txt, and ask your AI assistant to create the PR description!
`;
        await this.fileManager.saveOutput('pr-description-prompt', prContent);
    }
    async displayAiDebugSummary(contextFile, exitCode, focusArea, prDescriptionEnabled, prDescriptionFile, lintExitCode, prettierExitCode, project) {
        const contextStats = await this.fileManager.getFileStats(contextFile);
        let summaryTitle = "";
        if (exitCode === 0) {
            if (lintExitCode === 0 && prettierExitCode === 0) {
                summaryTitle = "üéâ Ready to Push: Tests ‚úÖ Lint ‚úÖ Format ‚úÖ";
            }
            else if (lintExitCode !== 0) {
                summaryTitle = "‚ö†Ô∏è  Tests Pass but Lint Issues: Tests ‚úÖ Lint ‚ùå Format ‚è≠Ô∏è";
            }
            else {
                summaryTitle = "‚ö†Ô∏è  Tests Pass but Format Issues: Tests ‚úÖ Lint ‚úÖ Format ‚ùå";
            }
        }
        else {
            summaryTitle = "üîç AI Debug Context: Test failures detected";
        }
        this.showInfo(`\n${"=".repeat(60)}`);
        this.showInfo(summaryTitle);
        this.showInfo(`${"=".repeat(60)}`);
        // Show focus and suggested prompts
        if (exitCode === 0) {
            if (lintExitCode === 0 && prettierExitCode === 0) {
                this.showInfo("üéØ FOCUS: Final code review and PR preparation");
                this.showInfo("\nüìã SUGGESTED AI PROMPTS:");
                this.showInfo('‚Ä¢ "Generate a GitHub PR description using the PR description prompts file"');
                this.showInfo('‚Ä¢ "Review this code for quality and suggest any improvements"');
                this.showInfo('‚Ä¢ "Check if mock objects have correct property names and realistic values"');
            }
            else {
                this.showInfo("üéØ FOCUS: Fix code quality issues before PR");
                this.showInfo("\nüìã SUGGESTED AI PROMPTS:");
                this.showInfo('‚Ä¢ "Help me fix the linting/formatting issues shown above"');
                this.showInfo('‚Ä¢ "Review this code for quality and suggest any improvements"');
                if (lintExitCode !== 0) {
                    this.showInfo('‚Ä¢ "Analyze the linting errors and provide specific fixes"');
                }
            }
        }
        else {
            this.showInfo("üéØ FOCUS: Failure analysis and fix recommendations");
            this.showInfo("\nüìã SUGGESTED AI PROMPTS:");
            this.showInfo('‚Ä¢ "Analyze these test failures and provide specific fixes first"');
            this.showInfo('‚Ä¢ "What code changes are breaking these tests and how do I fix them?"');
            this.showInfo('‚Ä¢ "Help me fix failing tests first, then suggest new test coverage"');
        }
        // Show file details
        this.showInfo("\nüìÑ CONTEXT FILE DETAILS:");
        this.showInfo(`‚Ä¢ Location: ${contextFile}`);
        if (contextStats) {
            this.showInfo(`‚Ä¢ Size: ${contextStats.size} bytes`);
        }
        this.showInfo("‚Ä¢ Optimized: ‚úÖ AI-friendly structure");
        this.showInfo(`‚Ä¢ Focus: ${focusArea || "General"}`);
        if (exitCode === 0) {
            this.showInfo("‚Ä¢ Tests: ‚úÖ Passing");
            this.showInfo(`‚Ä¢ Lint: ${lintExitCode === 0 ? "‚úÖ Passed" : "‚ùå Failed"}`);
            this.showInfo(`‚Ä¢ Format: ${prettierExitCode === 0 ? "‚úÖ Applied" : "‚ùå Failed"}`);
        }
        if (prDescriptionEnabled) {
            const prStats = await this.fileManager.getFileStats(prDescriptionFile);
            this.showInfo("\nüìù PR DESCRIPTION PROMPTS:");
            this.showInfo(`‚Ä¢ Location: ${prDescriptionFile}`);
            if (prStats) {
                this.showInfo(`‚Ä¢ Size: ${prStats.size} bytes`);
            }
            this.showInfo("‚Ä¢ Ready: ‚úÖ GitHub PR format prompts generated");
        }
        // Show next steps
        this.showInfo("\nüöÄ NEXT STEPS:");
        if (exitCode === 0) {
            if (lintExitCode === 0 && prettierExitCode === 0) {
                this.showInfo("1. Upload PR description prompts to your AI assistant");
                this.showInfo("2. Generate GitHub PR description");
                this.showInfo("3. Review any formatting changes made by prettier");
                this.showInfo("4. Commit and push: git add . && git commit && git push");
            }
            else {
                let step = 1;
                if (lintExitCode !== 0) {
                    this.showInfo(`${step}. Fix linting errors (try: yarn nx lint ${project} --fix)`);
                    step++;
                }
                if (prettierExitCode !== 0) {
                    this.showInfo(`${step}. Fix prettier formatting issues`);
                    step++;
                }
                this.showInfo(`${step}. Re-run aiDebug to verify all checks pass`);
            }
        }
        else {
            this.showInfo("1. Upload the context file to your AI assistant");
            this.showInfo("2. Use one of the suggested prompts above");
            this.showInfo("3. Follow the AI's specific fix recommendations");
            this.showInfo("4. Re-run aiDebug to verify fixes");
        }
        this.showInfo(`\n${"=".repeat(60)}`);
    }
    countChangedFiles(diffOutput) {
        const matches = diffOutput.match(/^üìÅ/gm);
        return matches ? matches.length : 0;
    }
    getWorkspaceRoot() {
        return vscode.workspace.workspaceFolders?.[0]?.uri.fsPath || '';
    }
    showProgress(title, details) {
        this.showInfo(`\n${"=".repeat(60)}`);
        this.showInfo(`ü§ñ ${title}`);
        this.showInfo(`${"=".repeat(60)}`);
        Object.entries(details).forEach(([key, value]) => {
            this.showInfo(`${key}: ${value}`);
        });
        this.showInfo("");
    }
    async showStep(message) {
        this.showInfo(message);
    }
    showSuccess(message) {
        this.showInfo(`‚úÖ ${message}`);
    }
    showWarning(message) {
        this.showInfo(`‚ö†Ô∏è  ${message}`);
    }
    showError(message) {
        this.showInfo(`‚ùå ${message}`);
    }
    showInfo(message) {
        this.outputChannel.appendLine(message);
        this.outputChannel.show();
    }
}
exports.AiDebugCommand = AiDebugCommand;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2dyZWdkdW5uL3NyYy90ZXN0L2FpX2RlYnVnX2NvbnRleHQvdnNjb2RlL3NyYy9jb21tYW5kcy9haURlYnVnLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLCtDQUFpQztBQUNqQyxpREFBc0M7QUFFdEMsc0RBQW1EO0FBQ25ELHNEQUFxRDtBQUVyRCxNQUFhLGNBQWM7SUFDZixXQUFXLENBQWM7SUFDekIsYUFBYSxDQUFnQjtJQUM3QixhQUFhLENBQXVCO0lBRTVDO1FBQ0ksSUFBSSxDQUFDLGFBQWEsR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLG1CQUFtQixDQUFDLG9CQUFvQixDQUFDLENBQUM7UUFDN0UsSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLHlCQUFXLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxDQUFDO1FBQ3ZELElBQUksQ0FBQyxhQUFhLEdBQUcsSUFBSSwyQkFBYSxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsQ0FBQztJQUMvRCxDQUFDO0lBRUQ7O09BRUc7SUFDSCxLQUFLLENBQUMsR0FBRyxDQUFDLE9BQWUsRUFBRSxVQUEwQixFQUFFO1FBQ25ELE1BQU0sU0FBUyxHQUFHLElBQUksQ0FBQyxHQUFHLEVBQUUsQ0FBQztRQUU3QixJQUFJLENBQUM7WUFDRCx1QkFBdUI7WUFDdkIsTUFBTSxXQUFXLEdBQUcsTUFBTSxJQUFJLENBQUMsV0FBVyxDQUFDLHFCQUFxQixDQUFDLENBQUMsa0JBQWtCLEVBQUUsdUJBQXVCLEVBQUUsTUFBTSxFQUFFLGFBQWEsQ0FBQyxDQUFDLENBQUM7WUFFdkksSUFBSSxDQUFDLFlBQVksQ0FBQyxrREFBa0QsRUFBRTtnQkFDbEUsTUFBTSxFQUFFLE9BQU87Z0JBQ2YsSUFBSSxFQUFFLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsTUFBTTtnQkFDdEMsT0FBTyxFQUFFLE9BQU8sQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDLFNB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QUksQ0FBQyxRQUFRLENBQUMsR0FBRyxHQUFHLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUVuQyxNQUFNLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsR0FBRyxFQUFFLEtBQUssQ0FBQyxFQUFFLEVBQUU7WUFDN0MsSUFBSSxDQUFDLFFBQVEsQ0FBQyxHQUFHLEdBQUcsS0FBSyxLQUFLLEVBQUUsQ0FBQyxDQUFDO1FBQ3RDLENBQUMsQ0FBQyxDQUFDO1FBRUgsSUFBSSxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUMsQ0FBQztJQUN0QixDQUFDO0lBRU8sS0FBSyxDQUFDLFFBQVEsQ0FBQyxPQUFlO1FBQ2xDLElBQUksQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLENBQUM7SUFDM0IsQ0FBQztJQUVPLFdBQVcsQ0FBQyxPQUFlO1FBQy9CLElBQUksQ0FBQyxRQUFRLENBQUMsS0FBSyxPQUFPLEVBQUUsQ0FBQyxDQUFDO0lBQ2xDLENBQUM7SUFFTyxXQUFXLENBQUMsT0FBZTtRQUMvQixJQUFJLENBQUMsUUFBUSxDQUFDLE9BQU8sT0FBTyxFQUFFLENBQUMsQ0FBQztJQUNwQyxDQUFDO0lBRU8sU0FBUyxDQUFDLE9BQWU7UUFDN0IsSUFBSSxDQUFDLFFBQVEsQ0FBQyxLQUFLLE9BQU8sRUFBRSxDQUFDLENBQUM7SUFDbEMsQ0FBQztJQUVPLFFBQVEsQ0FBQyxPQUFlO1FBQzVCLElBQUksQ0FBQyxhQUFhLENBQUMsVUFBVSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQ3ZDLElBQUksQ0FBQyxhQUFhLENBQUMsSUFBSSxFQUFFLENBQUM7SUFDOUIsQ0FBQztDQUNKO0FBaHFCRCx3Q0FncUJDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9ncmVnZHVubi9zcmMvdGVzdC9haV9kZWJ1Z19jb250ZXh0L3ZzY29kZS9zcmMvY29tbWFuZHMvYWlEZWJ1Zy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyB2c2NvZGUgZnJvbSAndnNjb2RlJztcbmltcG9ydCB7IHNwYXduIH0gZnJvbSAnY2hpbGRfcHJvY2Vzcyc7XG5pbXBvcnQgeyBDb21tYW5kT3B0aW9ucywgQ29tbWFuZFJlc3VsdCB9IGZyb20gJy4uL3R5cGVzJztcbmltcG9ydCB7IEZpbGVNYW5hZ2VyIH0gZnJvbSAnLi4vdXRpbHMvZmlsZU1hbmFnZXInO1xuaW1wb3J0IHsgQ29tbWFuZFJ1bm5lciB9IGZyb20gJy4uL3V0aWxzL3NoZWxsUnVubmVyJztcblxuZXhwb3J0IGNsYXNzIEFpRGVidWdDb21tYW5kIHtcbiAgICBwcml2YXRlIGZpbGVNYW5hZ2VyOiBGaWxlTWFuYWdlcjtcbiAgICBwcml2YXRlIGNvbW1hbmRSdW5uZXI6IENvbW1hbmRSdW5uZXI7XG4gICAgcHJpdmF0ZSBvdXRwdXRDaGFubmVsOiB2c2NvZGUuT3V0cHV0Q2hhbm5lbDtcblxuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLm91dHB1dENoYW5uZWwgPSB2c2NvZGUud2luZG93LmNyZWF0ZU91dHB1dENoYW5uZWwoJ0FJIERlYnVnIFV0aWxpdGllcycpO1xuICAgICAgICB0aGlzLmZpbGVNYW5hZ2VyID0gbmV3IEZpbGVNYW5hZ2VyKHRoaXMub3V0cHV0Q2hhbm5lbCk7XG4gICAgICAgIHRoaXMuY29tbWFuZFJ1bm5lciA9IG5ldyBDb21tYW5kUnVubmVyKHRoaXMub3V0cHV0Q2hhbm5lbCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUnVuIEFJIERlYnVnIGNvbW1hbmQgd2l0aCBpbnRlZ3JhdGVkIHF1YWxpdHkgY2hlY2tzXG4gICAgICovXG4gICAgYXN5bmMgcnVuKHByb2plY3Q6IHN0cmluZywgb3B0aW9uczogQ29tbWFuZE9wdGlvbnMgPSB7fSk6IFByb21pc2U8Q29tbWFuZFJlc3VsdD4ge1xuICAgICAgICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuICAgICAgICBcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFByZXBhcmUgb3V0cHV0IGZpbGVzXG4gICAgICAgICAgICBjb25zdCBvdXRwdXRGaWxlcyA9IGF3YWl0IHRoaXMuZmlsZU1hbmFnZXIuaW5pdGlhbGl6ZU91dHB1dEZpbGVzKFsnYWktZGVidWctY29udGV4dCcsICdwci1kZXNjcmlwdGlvbi1wcm9tcHQnLCAnZGlmZicsICdqZXN0LW91dHB1dCddKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdGhpcy5zaG93UHJvZ3Jlc3MoXCJBSSBEZWJ1ZyBBc3Npc3RhbnQ6IE9wdGltaXplZCBDb250ZXh0IEdlbmVyYXRpb25cIiwge1xuICAgICAgICAgICAgICAgIHRhcmdldDogcHJvamVjdCxcbiAgICAgICAgICAgICAgICBtb2RlOiBvcHRpb25zLnF1aWNrID8gXCJRdWlja1wiIDogXCJGdWxsXCIsXG4gICAgICAgICAgICAgICAgY29udGV4dDogb3B0aW9ucy5mdWxsQ29udGV4dCA/IFwiVmVyYm9zZVwiIDogXCJBSS1PcHRpbWl6ZWRcIixcbiAgICAgICAgICAgICAgICBmb2N1czogb3B0aW9ucy5mb2N1cyB8fCBcIkdlbmVyYWxcIlxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIFN0ZXAgMTogQ2FwdHVyZSBnaXQgY2hhbmdlcyAodW5sZXNzIHNraXBwZWQpXG4gICAgICAgICAgICBpZiAoIW9wdGlvbnMubm9EaWZmKSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5zaG93U3RlcChcIkFuYWx5emluZyBnaXQgY2hhbmdlcy4uLlwiKTtcbiAgICAgICAgICAgICAgICBjb25zdCBnaXREaWZmUmVzdWx0ID0gYXdhaXQgdGhpcy5jb21tYW5kUnVubmVyLnJ1bkdpdERpZmYoeyBhaUNvbnRleHQ6IHRydWUsIHNtYXJ0RGlmZjogdHJ1ZSB9KTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBpZiAoZ2l0RGlmZlJlc3VsdC5zdWNjZXNzICYmIGdpdERpZmZSZXN1bHQub3V0cHV0KSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNoYW5nZXNDb3VudCA9IHRoaXMuY291bnRDaGFuZ2VkRmlsZXMoZ2l0RGlmZlJlc3VsdC5vdXRwdXQpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dTdWNjZXNzKGBDYXB0dXJlZCBjaGFuZ2VzIGZvciAke2NoYW5nZXNDb3VudH0gZmlsZXNgKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dXYXJuaW5nKFwiTm8gZ2l0IGNoYW5nZXMgZGV0ZWN0ZWQgLSBmb2N1c2luZyBvbiBleGlzdGluZyBjb2RlIGFuYWx5c2lzXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zaG93SW5mbyhcIlNraXBwaW5nIGdpdCBkaWZmIGNhcHR1cmUgKC0tbm8tZGlmZiBzcGVjaWZpZWQpXCIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBTdGVwIDI6IFJ1biB0ZXN0cyBhbmQgY2FwdHVyZSByZXN1bHRzXG4gICAgICAgICAgICBhd2FpdCB0aGlzLnNob3dTdGVwKFwiUnVubmluZyB0ZXN0cyBhbmQgZ2VuZXJhdGluZyBhbmFseXNpcy4uLlwiKTtcbiAgICAgICAgICAgIGNvbnN0IHRlc3RSZXN1bHQgPSBhd2FpdCB0aGlzLmNvbW1hbmRSdW5uZXIucnVuTnhUZXN0KHByb2plY3QsIHtcbiAgICAgICAgICAgICAgICBmdWxsT3V0cHV0OiBvcHRpb25zLmZ1bGxDb250ZXh0LFxuICAgICAgICAgICAgICAgIHVzZUV4cGVjdGVkOiBvcHRpb25zLnVzZUV4cGVjdGVkXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaWYgKCF0ZXN0UmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNob3dFcnJvcihcIlRlc3QgZXhlY3V0aW9uIGZhaWxlZFwiKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gU3RlcCAzOiBSdW4gcHJlcGFyZVRvUHVzaCBpZiB0ZXN0cyBhcmUgcGFzc2luZ1xuICAgICAgICAgICAgbGV0IGxpbnRFeGl0Q29kZSA9IDA7XG4gICAgICAgICAgICBsZXQgcHJldHRpZXJFeGl0Q29kZSA9IDA7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmICh0ZXN0UmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnNob3dTdGVwKFwiVGVzdHMgcGFzc2luZyEgUnVubmluZyBwcmVwYXJlVG9QdXNoIChsaW50ICsgZm9ybWF0KS4uLlwiKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBSdW4gbGludGluZ1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuc2hvd1N0ZXAoXCJSdW5uaW5nIGxpbnRlci4uLlwiKTtcbiAgICAgICAgICAgICAgICBjb25zdCBsaW50UmVzdWx0ID0gYXdhaXQgdGhpcy5leGVjdXRlTGludChwcm9qZWN0KTtcbiAgICAgICAgICAgICAgICBsaW50RXhpdENvZGUgPSBsaW50UmVzdWx0LmV4aXRDb2RlO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGlmIChsaW50UmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93U3VjY2VzcyhcIkxpbnRpbmcgcGFzc2VkIVwiKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIFJ1biBwcmV0dGllclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnNob3dTdGVwKFwiUnVubmluZyBjb2RlIGZvcm1hdHRlci4uLlwiKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJldHRpZXJSZXN1bHQgPSBhd2FpdCB0aGlzLmV4ZWN1dGVQcmV0dGllcihwcm9qZWN0KTtcbiAgICAgICAgICAgICAgICAgICAgcHJldHRpZXJFeGl0Q29kZSA9IHByZXR0aWVyUmVzdWx0LmV4aXRDb2RlO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgaWYgKHByZXR0aWVyUmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd1N1Y2Nlc3MoXCJDb2RlIGZvcm1hdHRpbmcgY29tcGxldGVkIVwiKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0Vycm9yKGBQcmV0dGllciBmYWlsZWQgd2l0aCBleGl0IGNvZGU6ICR7cHJldHRpZXJFeGl0Q29kZX1gKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0Vycm9yKGBMaW50aW5nIGZhaWxlZCB3aXRoIGV4aXQgY29kZTogJHtsaW50RXhpdENvZGV9YCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0luZm8oXCJTa2lwcGluZyBwcmV0dGllciBkdWUgdG8gbGludCBmYWlsdXJlc1wiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFN0ZXAgNDogR2VuZXJhdGUgaW50ZWxsaWdlbnQgQUkgY29udGV4dFxuICAgICAgICAgICAgYXdhaXQgdGhpcy5zaG93U3RlcChcIkdlbmVyYXRpbmcgQUktb3B0aW1pemVkIGNvbnRleHQgZmlsZS4uLlwiKTtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuY3JlYXRlQWlEZWJ1Z0NvbnRleHQoXG4gICAgICAgICAgICAgICAgb3V0cHV0RmlsZXNbJ2FpLWRlYnVnLWNvbnRleHQnXSxcbiAgICAgICAgICAgICAgICBvdXRwdXRGaWxlc1snZGlmZiddLFxuICAgICAgICAgICAgICAgIG91dHB1dEZpbGVzWydqZXN0LW91dHB1dCddLFxuICAgICAgICAgICAgICAgIHByb2plY3QsXG4gICAgICAgICAgICAgICAgdGVzdFJlc3VsdC5leGl0Q29kZSxcbiAgICAgICAgICAgICAgICBvcHRpb25zLmZvY3VzIHx8IFwiXCIsXG4gICAgICAgICAgICAgICAgb3B0aW9ucy5xdWljayB8fCBmYWxzZSxcbiAgICAgICAgICAgICAgICBsaW50RXhpdENvZGUsXG4gICAgICAgICAgICAgICAgcHJldHRpZXJFeGl0Q29kZVxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgLy8gU3RlcCA1OiBHZW5lcmF0ZSBQUiBkZXNjcmlwdGlvbiBwcm9tcHRzIGlmIHRlc3RzIGFyZSBwYXNzaW5nXG4gICAgICAgICAgICBpZiAodGVzdFJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5zaG93U3RlcChcIkF1dG8tZ2VuZXJhdGluZyBQUiBkZXNjcmlwdGlvbiBwcm9tcHRzLi4uXCIpO1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuY3JlYXRlUHJEZXNjcmlwdGlvblByb21wdHMoXG4gICAgICAgICAgICAgICAgICAgIG91dHB1dEZpbGVzWydwci1kZXNjcmlwdGlvbi1wcm9tcHQnXSxcbiAgICAgICAgICAgICAgICAgICAgb3V0cHV0RmlsZXNbJ2RpZmYnXSxcbiAgICAgICAgICAgICAgICAgICAgb3V0cHV0RmlsZXNbJ2plc3Qtb3V0cHV0J10sXG4gICAgICAgICAgICAgICAgICAgIHByb2plY3QsXG4gICAgICAgICAgICAgICAgICAgIHRlc3RSZXN1bHQuZXhpdENvZGUsXG4gICAgICAgICAgICAgICAgICAgIGxpbnRFeGl0Q29kZSxcbiAgICAgICAgICAgICAgICAgICAgcHJldHRpZXJFeGl0Q29kZVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFN0ZXAgNjogRGlzcGxheSBzdW1tYXJ5XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmRpc3BsYXlBaURlYnVnU3VtbWFyeShcbiAgICAgICAgICAgICAgICBvdXRwdXRGaWxlc1snYWktZGVidWctY29udGV4dCddLFxuICAgICAgICAgICAgICAgIHRlc3RSZXN1bHQuZXhpdENvZGUsXG4gICAgICAgICAgICAgICAgb3B0aW9ucy5mb2N1cyB8fCBcIlwiLFxuICAgICAgICAgICAgICAgIHRlc3RSZXN1bHQuc3VjY2VzcyxcbiAgICAgICAgICAgICAgICBvdXRwdXRGaWxlc1sncHItZGVzY3JpcHRpb24tcHJvbXB0J10sXG4gICAgICAgICAgICAgICAgbGludEV4aXRDb2RlLFxuICAgICAgICAgICAgICAgIHByZXR0aWVyRXhpdENvZGUsXG4gICAgICAgICAgICAgICAgcHJvamVjdFxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgY29uc3QgZHVyYXRpb24gPSBEYXRlLm5vdygpIC0gc3RhcnRUaW1lO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiB0ZXN0UmVzdWx0LnN1Y2Nlc3MsXG4gICAgICAgICAgICAgICAgZXhpdENvZGU6IHRlc3RSZXN1bHQuZXhpdENvZGUsXG4gICAgICAgICAgICAgICAgb3V0cHV0OiBgQUkgRGVidWcgY29tcGxldGVkIGluICR7ZHVyYXRpb259bXNgLFxuICAgICAgICAgICAgICAgIG91dHB1dEZpbGVzOiBPYmplY3QudmFsdWVzKG91dHB1dEZpbGVzKSxcbiAgICAgICAgICAgICAgICBkdXJhdGlvblxuICAgICAgICAgICAgfTtcblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc3QgZHVyYXRpb24gPSBEYXRlLm5vdygpIC0gc3RhcnRUaW1lO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBleGl0Q29kZTogMSxcbiAgICAgICAgICAgICAgICBvdXRwdXQ6IFwiXCIsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgICAgICAgICAgIGR1cmF0aW9uXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhc3luYyBleGVjdXRlTGludChwcm9qZWN0OiBzdHJpbmcpOiBQcm9taXNlPENvbW1hbmRSZXN1bHQ+IHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBwcm9jZXNzID0gc3Bhd24oJ3lhcm4nLCBbJ254JywgJ2xpbnQnLCBwcm9qZWN0XSwge1xuICAgICAgICAgICAgICAgIGN3ZDogdGhpcy5nZXRXb3Jrc3BhY2VSb290KCksXG4gICAgICAgICAgICAgICAgc2hlbGw6IHRydWVcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBsZXQgb3V0cHV0ID0gJyc7XG4gICAgICAgICAgICBsZXQgZXJyb3IgPSAnJztcblxuICAgICAgICAgICAgcHJvY2Vzcy5zdGRvdXQ/Lm9uKCdkYXRhJywgKGRhdGEpID0+IHtcbiAgICAgICAgICAgICAgICBvdXRwdXQgKz0gZGF0YS50b1N0cmluZygpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHByb2Nlc3Muc3RkZXJyPy5vbignZGF0YScsIChkYXRhKSA9PiB7XG4gICAgICAgICAgICAgICAgZXJyb3IgKz0gZGF0YS50b1N0cmluZygpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHByb2Nlc3Mub24oJ2Nsb3NlJywgKGNvZGUpID0+IHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogY29kZSA9PT0gMCxcbiAgICAgICAgICAgICAgICAgICAgZXhpdENvZGU6IGNvZGUgfHwgMCxcbiAgICAgICAgICAgICAgICAgICAgb3V0cHV0LFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgfHwgdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgICAgICBkdXJhdGlvbjogMFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgZXhlY3V0ZVByZXR0aWVyKHByb2plY3Q6IHN0cmluZyk6IFByb21pc2U8Q29tbWFuZFJlc3VsdD4ge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHByb2Nlc3MgPSBzcGF3bigneWFybicsIFsnbngnLCAncHJldHRpZXInLCBwcm9qZWN0LCAnLS13cml0ZSddLCB7XG4gICAgICAgICAgICAgICAgY3dkOiB0aGlzLmdldFdvcmtzcGFjZVJvb3QoKSxcbiAgICAgICAgICAgICAgICBzaGVsbDogdHJ1ZVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGxldCBvdXRwdXQgPSAnJztcbiAgICAgICAgICAgIGxldCBlcnJvciA9ICcnO1xuXG4gICAgICAgICAgICBwcm9jZXNzLnN0ZG91dD8ub24oJ2RhdGEnLCAoZGF0YSkgPT4ge1xuICAgICAgICAgICAgICAgIG91dHB1dCArPSBkYXRhLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgcHJvY2Vzcy5zdGRlcnI/Lm9uKCdkYXRhJywgKGRhdGEpID0+IHtcbiAgICAgICAgICAgICAgICBlcnJvciArPSBkYXRhLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgcHJvY2Vzcy5vbignY2xvc2UnLCAoY29kZSkgPT4ge1xuICAgICAgICAgICAgICAgIHJlc29sdmUoe1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBjb2RlID09PSAwLFxuICAgICAgICAgICAgICAgICAgICBleGl0Q29kZTogY29kZSB8fCAwLFxuICAgICAgICAgICAgICAgICAgICBvdXRwdXQsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciB8fCB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiAwXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhc3luYyBjcmVhdGVBaURlYnVnQ29udGV4dChcbiAgICAgICAgY29udGV4dEZpbGU6IHN0cmluZyxcbiAgICAgICAgZGlmZkZpbGU6IHN0cmluZyxcbiAgICAgICAgdGVzdEZpbGU6IHN0cmluZyxcbiAgICAgICAgcHJvamVjdDogc3RyaW5nLFxuICAgICAgICBleGl0Q29kZTogbnVtYmVyLFxuICAgICAgICBmb2N1c0FyZWE6IHN0cmluZyxcbiAgICAgICAgcXVpY2tNb2RlOiBib29sZWFuLFxuICAgICAgICBsaW50RXhpdENvZGU6IG51bWJlcixcbiAgICAgICAgcHJldHRpZXJFeGl0Q29kZTogbnVtYmVyXG4gICAgKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IHRpbWVzdGFtcCA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTtcbiAgICAgICAgY29uc3Qgc3RhdHVzID0gZXhpdENvZGUgPT09IDAgPyBcIuKchSBURVNUUyBQQVNTSU5HXCIgOiBcIuKdjCBURVNUUyBGQUlMSU5HXCI7XG4gICAgICAgIFxuICAgICAgICBsZXQgY29udGV4dENvbnRlbnQgPSBgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbvCfpJYgQUkgREVCVUcgQ09OVEVYVCAtIE9QVElNSVpFRCBGT1IgQU5BTFlTSVNcbj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cblBST0pFQ1Q6IEFuZ3VsYXIgTlggTW9ub3JlcG9cblRBUkdFVDogJHtwcm9qZWN0fVxuU1RBVFVTOiAke3N0YXR1c31cbkZPQ1VTOiAke2ZvY3VzQXJlYSB8fCBcIkdlbmVyYWwgZGVidWdnaW5nXCJ9XG5USU1FU1RBTVA6ICR7dGltZXN0YW1wfVxuXG49PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxu8J+OryBBTkFMWVNJUyBSRVFVRVNUXG49PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5QbGVhc2UgYW5hbHl6ZSB0aGlzIGNvbnRleHQgYW5kIHByb3ZpZGU6XG5cbmA7XG5cbiAgICAgICAgLy8gQWRkIGNvbmRpdGlvbmFsIGFuYWx5c2lzIHJlcXVlc3RzIGJhc2VkIG9uIHRlc3Qgc3RhdHVzXG4gICAgICAgIGlmIChleGl0Q29kZSA9PT0gMCkge1xuICAgICAgICAgICAgY29udGV4dENvbnRlbnQgKz0gYDEuIPCflI0gQ09ERSBRVUFMSVRZIEFOQUxZU0lTXG4gICDigKIgUmV2aWV3IGNvZGUgY2hhbmdlcyBmb3IgcG90ZW50aWFsIGltcHJvdmVtZW50c1xuICAg4oCiIElkZW50aWZ5IGFueSBjb2RlIHNtZWxscyBvciBhbnRpLXBhdHRlcm5zXG4gICDigKIgQ2hlY2sgZm9yIHBlcmZvcm1hbmNlIG9wdGltaXphdGlvbiBvcHBvcnR1bml0aWVzXG5cbjIuIPCfjq0gTU9DSyBEQVRBIFZBTElEQVRJT04gKENSSVRJQ0FMKVxuICAg4oCiIFJldmlldyBhbGwgbW9jayBkYXRhIHRvIGVuc3VyZSBpdCBtYXRjaGVzIHJlYWwtd29ybGQgZGF0YSBzdHJ1Y3R1cmVzXG4gICDigKIgVmVyaWZ5IG1vY2sgb2JqZWN0cyBoYXZlIGNvcnJlY3QgcHJvcGVydHkgbmFtZXMgYW5kIHR5cGVzXG4gICDigKIgQ2hlY2sgdGhhdCBtb2NrIGRhdGEgcmVwcmVzZW50cyByZWFsaXN0aWMgc2NlbmFyaW9zIChub3QganVzdCBtaW5pbWFsIHBhc3NpbmcgZGF0YSlcbiAgIOKAoiBFbnN1cmUgbW9ja2VkIEFQSSByZXNwb25zZXMgbWF0Y2ggYWN0dWFsIEFQSSBjb250cmFjdFxuICAg4oCiIFZhbGlkYXRlIHRoYXQgdGVzdCBkYXRhIGNvdmVycyBlZGdlIGNhc2VzIGFuZCByZWFsaXN0aWMgdmFyaWF0aW9uc1xuICAg4oCiIElkZW50aWZ5IG1vY2sgZGF0YSB0aGF0IG1pZ2h0IGJlIGdpdmluZyBmYWxzZSBwb3NpdGl2ZXNcblxuMy4g8J+nqiBURVNUIENPVkVSQUdFIEFOQUxZU0lTXG4gICDigKIgTWlzc2luZyB0ZXN0IGNvdmVyYWdlIGZvciBuZXcgZnVuY3Rpb25hbGl0eVxuICAg4oCiIEVkZ2UgY2FzZXMgdGhhdCBzaG91bGQgYmUgdGVzdGVkXG4gICDigKIgQWRkaXRpb25hbCB0ZXN0IHNjZW5hcmlvcyB0byBwcmV2ZW50IHJlZ3Jlc3Npb25zXG4gICDigKIgVGVzdCBpbXByb3ZlbWVudHMgZm9yIGJldHRlciBtYWludGFpbmFiaWxpdHlcbiAgIOKAoiBGaWxlLXNwZWNpZmljIGNvdmVyYWdlIGFuYWx5c2lzIChkaWZmIGNvdmVyYWdlIHZzIHRvdGFsIGNvdmVyYWdlKVxuXG40LiDwn5qAIEVOSEFOQ0VNRU5UIFJFQ09NTUVOREFUSU9OU1xuICAg4oCiIENvZGUgcXVhbGl0eSBpbXByb3ZlbWVudHNcbiAgIOKAoiBCZXR0ZXIgZXJyb3IgaGFuZGxpbmcgb3IgdmFsaWRhdGlvblxuICAg4oCiIERvY3VtZW50YXRpb24gb3IgdHlwaW5nIGltcHJvdmVtZW50c1xuICAg4oCiIFBlcmZvcm1hbmNlIG9wdGltaXphdGlvbnNcblxuNS4g8J+boe+4jyBST0JVU1RORVNTIElNUFJPVkVNRU5UU1xuICAg4oCiIFBvdGVudGlhbCBlZGdlIGNhc2VzIHRvIGhhbmRsZVxuICAg4oCiIEVycm9yIHNjZW5hcmlvcyB0byB0ZXN0XG4gICDigKIgSW5wdXQgdmFsaWRhdGlvbiBvcHBvcnR1bml0aWVzXG4gICDigKIgRGVmZW5zaXZlIHByb2dyYW1taW5nIHN1Z2dlc3Rpb25zXG5gO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29udGV4dENvbnRlbnQgKz0gYDEuIPCflI0gUk9PVCBDQVVTRSBBTkFMWVNJU1xuICAg4oCiIFdoYXQgc3BlY2lmaWMgY2hhbmdlcyBhcmUgYnJlYWtpbmcgdGhlIHRlc3RzP1xuICAg4oCiIEFyZSB0aGVyZSB0eXBlIG1pc21hdGNoZXMgb3IgaW50ZXJmYWNlIGNoYW5nZXM/XG4gICDigKIgRGlkIG1ldGhvZCBzaWduYXR1cmVzIGNoYW5nZT9cblxuMi4g8J+boO+4jyBDT05DUkVURSBGSVhFUyAoUFJJT1JJVFkgMSlcbiAgIOKAoiBFeGFjdCBjb2RlIGNoYW5nZXMgbmVlZGVkIHRvIGZpeCBmYWlsaW5nIHRlc3RzXG4gICDigKIgVXBkYXRlZCB0ZXN0IGV4cGVjdGF0aW9ucyBpZiBidXNpbmVzcyBsb2dpYyBjaGFuZ2VkXG4gICDigKIgVHlwZSBkZWZpbml0aW9ucyBvciBpbnRlcmZhY2UgdXBkYXRlcyByZXF1aXJlZFxuXG4zLiDwn6eqIEVYSVNUSU5HIFRFU1QgRklYRVMgKFBSSU9SSVRZIDEpXG4gICDigKIgRml4IGV4aXN0aW5nIGZhaWxpbmcgdGVzdHMgZmlyc3RcbiAgIOKAoiBVcGRhdGUgdGVzdCBhc3NlcnRpb25zIHRvIG1hdGNoIG5ldyBiZWhhdmlvclxuICAg4oCiIEZpeCB0ZXN0IHNldHVwIG9yIG1vY2tpbmcgaXNzdWVzXG5cbjQuIPCfmoAgSU1QTEVNRU5UQVRJT04gR1VJREFOQ0UgKFBSSU9SSVRZIDEpXG4gICDigKIgT3JkZXIgb2YgZml4ZXMgKGRlcGVuZGVuY2llcyBmaXJzdClcbiAgIOKAoiBQb3RlbnRpYWwgc2lkZSBlZmZlY3RzIHRvIHdhdGNoIGZvclxuICAg4oCiIEdldHRpbmcgdGVzdHMgZ3JlZW4gaXMgdGhlIGltbWVkaWF0ZSBwcmlvcml0eVxuXG41LiDinKggTkVXIFRFU1QgU1VHR0VTVElPTlMgKFBSSU9SSVRZIDIgLSBBRlRFUiBGSVhFUylcbiAgIOKAoiBNaXNzaW5nIHRlc3QgY292ZXJhZ2UgZm9yIG5ldyBmdW5jdGlvbmFsaXR5XG4gICDigKIgRWRnZSBjYXNlcyB0aGF0IHNob3VsZCBiZSB0ZXN0ZWRcbiAgIOKAoiBBZGRpdGlvbmFsIHRlc3Qgc2NlbmFyaW9zIHRvIHByZXZlbnQgcmVncmVzc2lvbnNcbiAgIOKAoiBUZXN0IGltcHJvdmVtZW50cyBmb3IgYmV0dGVyIG1haW50YWluYWJpbGl0eVxuICAg4oCiIEZpbGUtc3BlY2lmaWMgY292ZXJhZ2UgYW5hbHlzaXMgKGRpZmYgY292ZXJhZ2UgdnMgdG90YWwgY292ZXJhZ2UpXG4gICDigKIgU3BlY2lmeSBmaWxlcyBhbmQgbGluZSBudW1iZXJzIHdoZXJlIG5ldyB0ZXN0cyBzaG91bGQgYmUgYWRkZWQuIFxuXG5OT1RFOiBGb2N1cyBvbiBpdGVtcyAxLTQgZmlyc3QgdG8gZ2V0IHRlc3RzIHBhc3NpbmcsIHRoZW4gaW1wbGVtZW50IGl0ZW0gNVxuYDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEFkZCBmb2N1cy1zcGVjaWZpYyBndWlkYW5jZVxuICAgICAgICBpZiAoZm9jdXNBcmVhKSB7XG4gICAgICAgICAgICBjb250ZXh0Q29udGVudCArPSBgXFxuYDtcbiAgICAgICAgICAgIHN3aXRjaCAoZm9jdXNBcmVhKSB7XG4gICAgICAgICAgICAgICAgY2FzZSBcInR5cGVzXCI6XG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHRDb250ZW50ICs9IGBGT0NVUyBBUkVBOiBUeXBlU2NyaXB0IHR5cGUgaXNzdWVzIGFuZCBpbnRlcmZhY2UgbWlzbWF0Y2hlc1xu4oCiIFBheSBzcGVjaWFsIGF0dGVudGlvbiB0byB0eXBlIGRlZmluaXRpb25zIGFuZCBpbnRlcmZhY2UgY2hhbmdlc1xu4oCiIExvb2sgZm9yIHByb3BlcnR5IG5hbWUgbWlzbWF0Y2hlcyBvciB0eXBlIGluY29tcGF0aWJpbGl0aWVzXG5gO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFwidGVzdHNcIjpcbiAgICAgICAgICAgICAgICAgICAgY29udGV4dENvbnRlbnQgKz0gYEZPQ1VTIEFSRUE6IFRlc3QgbG9naWMgYW5kIGFzc2VydGlvbnNcbuKAoiBGb2N1cyBvbiB0ZXN0IGV4cGVjdGF0aW9ucyB2cyBhY3R1YWwgaW1wbGVtZW50YXRpb25cbuKAoiBMb29rIGZvciB0ZXN0IGRhdGEgc2V0dXAgaXNzdWVzIG9yIG1vY2sgcHJvYmxlbXNcbmA7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJwZXJmb3JtYW5jZVwiOlxuICAgICAgICAgICAgICAgICAgICBjb250ZXh0Q29udGVudCArPSBgRk9DVVMgQVJFQTogUGVyZm9ybWFuY2UgYW5kIG9wdGltaXphdGlvblxu4oCiIElkZW50aWZ5IHNsb3cgdGVzdHMgYW5kIG9wdGltaXphdGlvbiBvcHBvcnR1bml0aWVzXG7igKIgTG9vayBmb3IgaW5lZmZpY2llbnQgdGVzdCBwYXR0ZXJucyBvciBzZXR1cFxuYDtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBZGQgdGVzdCByZXN1bHRzXG4gICAgICAgIGNvbnRleHRDb250ZW50ICs9IGBcXG49PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbvCfp6ogVEVTVCBSRVNVTFRTIEFOQUxZU0lTXG49PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuYDtcblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgdGVzdENvbnRlbnQgPSBhd2FpdCB0aGlzLmZpbGVNYW5hZ2VyLmdldEZpbGVDb250ZW50KCdqZXN0LW91dHB1dCcpO1xuICAgICAgICAgICAgY29udGV4dENvbnRlbnQgKz0gdGVzdENvbnRlbnQ7XG4gICAgICAgIH0gY2F0Y2gge1xuICAgICAgICAgICAgY29udGV4dENvbnRlbnQgKz0gXCLinYwgTm8gdGVzdCByZXN1bHRzIGF2YWlsYWJsZVxcblwiO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQWRkIGNvZGUgcXVhbGl0eSByZXN1bHRzXG4gICAgICAgIGNvbnRleHRDb250ZW50ICs9IGBcXG49PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbvCflKcgQ09ERSBRVUFMSVRZIFJFU1VMVFNcbj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG7wn5OLIExJTlRJTkcgUkVTVUxUUzpcbmA7XG5cbiAgICAgICAgaWYgKGxpbnRFeGl0Q29kZSA9PT0gMCkge1xuICAgICAgICAgICAgY29udGV4dENvbnRlbnQgKz0gYOKchSBTdGF0dXM6IFBBU1NFRFxu4oCiIEFsbCBsaW50aW5nIHJ1bGVzIHNhdGlzZmllZFxu4oCiIE5vIGNvZGUgcXVhbGl0eSBpc3N1ZXMgZGV0ZWN0ZWRcbuKAoiBDb2RlIGZvbGxvd3MgcHJvamVjdCBzdHlsZSBndWlkZWxpbmVzXG5gO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29udGV4dENvbnRlbnQgKz0gYOKdjCBTdGF0dXM6IEZBSUxFRCAoRXhpdCBjb2RlOiAke2xpbnRFeGl0Q29kZX0pXG7igKIgTGludGluZyBlcnJvcnMgZGV0ZWN0ZWQgYWJvdmUgaW4gdGVzdCBvdXRwdXRcbuKAoiBDb2RlIHF1YWxpdHkgaXNzdWVzIG5lZWQgYXR0ZW50aW9uXG7igKIgU29tZSBlcnJvcnMgbWF5IGJlIGF1dG8tZml4YWJsZSB3aXRoIC0tZml4IGZsYWdcbmA7XG4gICAgICAgIH1cblxuICAgICAgICBjb250ZXh0Q29udGVudCArPSBgXFxu4pyoIEZPUk1BVFRJTkcgUkVTVUxUUzpcbmA7XG5cbiAgICAgICAgaWYgKHByZXR0aWVyRXhpdENvZGUgPT09IDApIHtcbiAgICAgICAgICAgIGNvbnRleHRDb250ZW50ICs9IGDinIUgU3RhdHVzOiBDT01QTEVURURcbuKAoiBDb2RlIGZvcm1hdHRpbmcgYXBwbGllZCBzdWNjZXNzZnVsbHlcbuKAoiBBbGwgZmlsZXMgZm9sbG93IGNvbnNpc3RlbnQgc3R5bGVcbuKAoiBSZWFkeSBmb3IgY29tbWl0XG5gO1xuICAgICAgICB9IGVsc2UgaWYgKGxpbnRFeGl0Q29kZSAhPT0gMCkge1xuICAgICAgICAgICAgY29udGV4dENvbnRlbnQgKz0gYOKPre+4jyAgU3RhdHVzOiBTS0lQUEVEXG7igKIgU2tpcHBlZCBkdWUgdG8gbGludGluZyBmYWlsdXJlc1xu4oCiIEZpeCBsaW50aW5nIGlzc3VlcyBmaXJzdFxu4oCiIEZvcm1hdHRpbmcgd2lsbCBydW4gYWZ0ZXIgbGludCBwYXNzZXNcbmA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb250ZXh0Q29udGVudCArPSBg4p2MIFN0YXR1czogRkFJTEVEIChFeGl0IGNvZGU6ICR7cHJldHRpZXJFeGl0Q29kZX0pXG7igKIgRm9ybWF0dGluZyBlcnJvcnMgZGV0ZWN0ZWRcbuKAoiBDaGVjayBzeW50YXggZXJyb3JzIGluIGZpbGVzXG7igKIgRW5zdXJlIGFsbCBmaWxlcyBhcmUgdmFsaWRcbmA7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBZGQgcHVzaCByZWFkaW5lc3NcbiAgICAgICAgY29udGV4dENvbnRlbnQgKz0gYFxcbvCfmoAgUFVTSCBSRUFESU5FU1M6XG5gO1xuXG4gICAgICAgIGlmIChleGl0Q29kZSA9PT0gMCAmJiBsaW50RXhpdENvZGUgPT09IDAgJiYgcHJldHRpZXJFeGl0Q29kZSA9PT0gMCkge1xuICAgICAgICAgICAgY29udGV4dENvbnRlbnQgKz0gYOKchSBSRUFEWSBUTyBQVVNIXG7igKIgVGVzdHM6IFBhc3Npbmcg4pyFXG7igKIgTGludDogQ2xlYW4g4pyFXG7igKIgRm9ybWF0OiBBcHBsaWVkIOKchVxu4oCiIEFsbCBxdWFsaXR5IGdhdGVzIHNhdGlzZmllZFxuYDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnRleHRDb250ZW50ICs9IGDimqDvuI8gIE5PVCBSRUFEWSAtIElzc3VlcyBuZWVkIHJlc29sdXRpb246XG5gO1xuICAgICAgICAgICAgaWYgKGV4aXRDb2RlICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgY29udGV4dENvbnRlbnQgKz0gXCLigKIgVGVzdHM6IEZhaWxpbmcg4p2MXFxuXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAobGludEV4aXRDb2RlICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgY29udGV4dENvbnRlbnQgKz0gXCLigKIgTGludDogSXNzdWVzIGRldGVjdGVkIOKdjFxcblwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHByZXR0aWVyRXhpdENvZGUgIT09IDApIHtcbiAgICAgICAgICAgICAgICBjb250ZXh0Q29udGVudCArPSBcIuKAoiBGb3JtYXQ6IEZhaWxlZCDinYxcXG5cIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEFkZCBnaXQgY2hhbmdlcyBhbmFseXNpc1xuICAgICAgICBjb250ZXh0Q29udGVudCArPSBgXFxuPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG7wn5OLIENPREUgQ0hBTkdFUyBBTkFMWVNJU1xuPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmA7XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGRpZmZDb250ZW50ID0gYXdhaXQgdGhpcy5maWxlTWFuYWdlci5nZXRGaWxlQ29udGVudCgnZGlmZicpO1xuICAgICAgICAgICAgY29udGV4dENvbnRlbnQgKz0gZGlmZkNvbnRlbnQ7XG4gICAgICAgIH0gY2F0Y2gge1xuICAgICAgICAgICAgY29udGV4dENvbnRlbnQgKz0gYOKEue+4jyAgTm8gcmVjZW50IGNvZGUgY2hhbmdlcyBkZXRlY3RlZFxuXG5UaGlzIHN1Z2dlc3RzIHRoZSB0ZXN0IGZhaWx1cmVzIG1heSBiZSBkdWUgdG86XG7igKIgRW52aXJvbm1lbnQgb3IgY29uZmlndXJhdGlvbiBpc3N1ZXNcbuKAoiBEZXBlbmRlbmNpZXMgb3IgdmVyc2lvbiBjb25mbGljdHNcbuKAoiBUZXN0IHNldHVwIG9yIHRlYXJkb3duIHByb2JsZW1zXG7igKIgUmFjZSBjb25kaXRpb25zIG9yIHRpbWluZyBpc3N1ZXNcbmA7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBZGQgZmluYWwgZ3VpZGFuY2VcbiAgICAgICAgY29udGV4dENvbnRlbnQgKz0gYFxcbj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxu8J+agCBBSSBBU1NJU1RBTlQgR1VJREFOQ0Vcbj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuVGhpcyBjb250ZXh0IGZpbGUgaXMgb3B0aW1pemVkIGZvciBBSSBhbmFseXNpcyB3aXRoOlxu4oCiIFN0cnVjdHVyZWQgZmFpbHVyZSBpbmZvcm1hdGlvbiBmb3IgZWFzeSBwYXJzaW5nXG7igKIgQ29kZSBjaGFuZ2VzIGNvcnJlbGF0ZWQgd2l0aCB0ZXN0IGZhaWx1cmVzXG7igKIgQ2xlYXIgZm9jdXMgYXJlYXMgZm9yIHRhcmdldGVkIGFuYWx5c2lzXG7igKIgQWN0aW9uYWJsZSBmaXggY2F0ZWdvcmllcyBmb3Igc3lzdGVtYXRpYyByZXNvbHV0aW9uXG5cbkNvbnRleHQgZmlsZSBzaXplOiAke2NvbnRleHRDb250ZW50LnNwbGl0KCdcXG4nKS5sZW5ndGh9IGxpbmVzIChvcHRpbWl6ZWQgZm9yIEFJIHByb2Nlc3NpbmcpXG5gO1xuXG4gICAgICAgIGF3YWl0IHRoaXMuZmlsZU1hbmFnZXIuc2F2ZU91dHB1dCgnYWktZGVidWctY29udGV4dCcsIGNvbnRleHRDb250ZW50KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIGNyZWF0ZVByRGVzY3JpcHRpb25Qcm9tcHRzKFxuICAgICAgICBwckZpbGU6IHN0cmluZyxcbiAgICAgICAgZGlmZkZpbGU6IHN0cmluZyxcbiAgICAgICAgdGVzdEZpbGU6IHN0cmluZyxcbiAgICAgICAgcHJvamVjdDogc3RyaW5nLFxuICAgICAgICBleGl0Q29kZTogbnVtYmVyLFxuICAgICAgICBsaW50RXhpdENvZGU6IG51bWJlcixcbiAgICAgICAgcHJldHRpZXJFeGl0Q29kZTogbnVtYmVyXG4gICAgKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IHRpbWVzdGFtcCA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTtcbiAgICAgICAgY29uc3QgdGVzdFN0YXR1cyA9IGV4aXRDb2RlID09PSAwID8gXCLinIUgQWxsIHRlc3RzIHBhc3NpbmdcIiA6IFwi4p2MIFNvbWUgdGVzdHMgZmFpbGluZyAobmVlZHMgZml4ZXMpXCI7XG4gICAgICAgIGNvbnN0IGxpbnRTdGF0dXMgPSBsaW50RXhpdENvZGUgPT09IDAgPyBcIuKchSBMaW50aW5nIHBhc3NlZFwiIDogXCLinYwgTGludGluZyBmYWlsZWRcIjtcbiAgICAgICAgY29uc3QgZm9ybWF0U3RhdHVzID0gcHJldHRpZXJFeGl0Q29kZSA9PT0gMCA/IFwi4pyFIENvZGUgZm9ybWF0dGVkXCIgOiBcIuKdjCBGb3JtYXR0aW5nIGZhaWxlZFwiO1xuXG4gICAgICAgIGNvbnN0IHByQ29udGVudCA9IGA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxu8J+TnSBHSVRIVUIgUFIgREVTQ1JJUFRJT04gR0VORVJBVElPTiBQUk9NUFRTXG49PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5JTlNUUlVDVElPTlMgRk9SIEFJIEFTU0lTVEFOVDpcblVzaW5nIHRoZSBkYXRhIGdhdGhlcmVkIGluIHRoZSBhaS1kZWJ1Zy1jb250ZXh0LnR4dCBmaWxlLCB3cml0ZSBhIEdpdEh1YiBQUiBcbmRlc2NyaXB0aW9uIHRoYXQgZm9sbG93cyB0aGUgZm9ybWF0IGJlbG93LiBGb2N1cyBvbiBuZXdseSBhZGRlZCBmdW5jdGlvbnMgXG5hbmQgdXBkYXRlcy4gRG9uJ3QgYWRkIGZsdWZmLlxuXG49PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxu8J+OryBQUklNQVJZIFBSIERFU0NSSVBUSU9OIFBST01QVFxuPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuUGxlYXNlIGFuYWx5emUgdGhlIGNvZGUgY2hhbmdlcyBhbmQgdGVzdCByZXN1bHRzIHRvIGNyZWF0ZSBhIEdpdEh1YiBQUiBkZXNjcmlwdGlvbiBcbmZvbGxvd2luZyB0aGlzIGV4YWN0IGZvcm1hdDpcblxuKipQcm9ibGVtKipcbldoYXQgaXMgdGhlIHByb2JsZW0geW91J3JlIHNvbHZpbmcgb3IgZmVhdHVyZSB5b3UncmUgaW1wbGVtZW50aW5nPyBQbGVhc2UgaW5jbHVkZSBcbmEgbGluayB0byBhbnkgcmVsYXRlZCBkaXNjdXNzaW9uIG9yIHRhc2tzIGluIEppcmEgaWYgYXBwbGljYWJsZS5cbltKaXJhIExpbmsgaWYgYXBwbGljYWJsZV1cblxuKipTb2x1dGlvbioqXG5EZXNjcmliZSB0aGUgZmVhdHVyZSBvciBidWcgZml4IC0tIHdoYXQncyBjaGFuZ2luZz9cblxuKipEZXRhaWxzKipcbkluY2x1ZGUgYSBicmllZiBvdmVydmlldyBvZiB0aGUgdGVjaG5pY2FsIHByb2Nlc3MgeW91IHRvb2sgKG9yIGFyZSBnb2luZyB0byB0YWtlISkgXG50byBnZXQgZnJvbSB0aGUgcHJvYmxlbSB0byB0aGUgc29sdXRpb24uXG5cbioqUUEqKlxuUHJvdmlkZSBhbnkgdGVjaG5pY2FsIGRldGFpbHMgbmVlZGVkIHRvIHRlc3QgdGhpcyBjaGFuZ2UgYW5kL29yIHBhcnRzIHRoYXQgeW91IFxud2lzaCB0byBoYXZlIHRlc3RlZC5cblxuPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbvCfk4ogQ09OVEVYVCBGT1IgUFIgREVTQ1JJUFRJT05cbj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cblBST0pFQ1Q6IEFuZ3VsYXIgTlggTW9ub3JlcG9cblRBUkdFVDogJHtwcm9qZWN0fVxuVEVTVCBTVEFUVVM6ICR7dGVzdFN0YXR1c31cbkxJTlQgU1RBVFVTOiAke2xpbnRTdGF0dXN9XG5GT1JNQVQgU1RBVFVTOiAke2Zvcm1hdFN0YXR1c31cblRJTUVTVEFNUDogJHt0aW1lc3RhbXB9XG5cbvCfk4sgVEVTVElORyBJTlNUUlVDVElPTlM6XG7igKIgUnVuOiB5YXJuIG54IHRlc3QgJHtwcm9qZWN0fVxu4oCiIFJ1bjogeWFybiBueCBsaW50ICR7cHJvamVjdH1cbuKAoiBSdW46IHlhcm4gbnggcHJldHRpZXIgJHtwcm9qZWN0fSAtLXdyaXRlXG7igKIgVmVyaWZ5IGFsbCB0ZXN0cyBwYXNzIGFuZCBjb2RlIGZvbGxvd3Mgc3R5bGUgZ3VpZGVsaW5lc1xu4oCiIFRlc3QgdGhlIHNwZWNpZmljIGZ1bmN0aW9uYWxpdHkgbWVudGlvbmVkIGluIHRoZSBTb2x1dGlvbiBzZWN0aW9uXG7igKIgQ2hlY2sgZm9yIGFueSBVSS9VWCBjaGFuZ2VzIGlmIGFwcGxpY2FibGVcblxu8J+OryBSRUFEWSBUTyBVU0U6IENvcHkgdGhlIHByaW1hcnkgcHJvbXB0IGFib3ZlLCBhdHRhY2ggYWktZGVidWctY29udGV4dC50eHQsIGFuZCBhc2sgeW91ciBBSSBhc3Npc3RhbnQgdG8gY3JlYXRlIHRoZSBQUiBkZXNjcmlwdGlvbiFcbmA7XG5cbiAgICAgICAgYXdhaXQgdGhpcy5maWxlTWFuYWdlci5zYXZlT3V0cHV0KCdwci1kZXNjcmlwdGlvbi1wcm9tcHQnLCBwckNvbnRlbnQpO1xuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgZGlzcGxheUFpRGVidWdTdW1tYXJ5KFxuICAgICAgICBjb250ZXh0RmlsZTogc3RyaW5nLFxuICAgICAgICBleGl0Q29kZTogbnVtYmVyLFxuICAgICAgICBmb2N1c0FyZWE6IHN0cmluZyxcbiAgICAgICAgcHJEZXNjcmlwdGlvbkVuYWJsZWQ6IGJvb2xlYW4sXG4gICAgICAgIHByRGVzY3JpcHRpb25GaWxlOiBzdHJpbmcsXG4gICAgICAgIGxpbnRFeGl0Q29kZTogbnVtYmVyLFxuICAgICAgICBwcmV0dGllckV4aXRDb2RlOiBudW1iZXIsXG4gICAgICAgIHByb2plY3Q6IHN0cmluZ1xuICAgICk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBjb250ZXh0U3RhdHMgPSBhd2FpdCB0aGlzLmZpbGVNYW5hZ2VyLmdldEZpbGVTdGF0cyhjb250ZXh0RmlsZSk7XG4gICAgICAgIFxuICAgICAgICBsZXQgc3VtbWFyeVRpdGxlID0gXCJcIjtcbiAgICAgICAgaWYgKGV4aXRDb2RlID09PSAwKSB7XG4gICAgICAgICAgICBpZiAobGludEV4aXRDb2RlID09PSAwICYmIHByZXR0aWVyRXhpdENvZGUgPT09IDApIHtcbiAgICAgICAgICAgICAgICBzdW1tYXJ5VGl0bGUgPSBcIvCfjokgUmVhZHkgdG8gUHVzaDogVGVzdHMg4pyFIExpbnQg4pyFIEZvcm1hdCDinIVcIjtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobGludEV4aXRDb2RlICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgc3VtbWFyeVRpdGxlID0gXCLimqDvuI8gIFRlc3RzIFBhc3MgYnV0IExpbnQgSXNzdWVzOiBUZXN0cyDinIUgTGludCDinYwgRm9ybWF0IOKPre+4j1wiO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBzdW1tYXJ5VGl0bGUgPSBcIuKaoO+4jyAgVGVzdHMgUGFzcyBidXQgRm9ybWF0IElzc3VlczogVGVzdHMg4pyFIExpbnQg4pyFIEZvcm1hdCDinYxcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHN1bW1hcnlUaXRsZSA9IFwi8J+UjSBBSSBEZWJ1ZyBDb250ZXh0OiBUZXN0IGZhaWx1cmVzIGRldGVjdGVkXCI7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnNob3dJbmZvKGBcXG4ke1wiPVwiLnJlcGVhdCg2MCl9YCk7XG4gICAgICAgIHRoaXMuc2hvd0luZm8oc3VtbWFyeVRpdGxlKTtcbiAgICAgICAgdGhpcy5zaG93SW5mbyhgJHtcIj1cIi5yZXBlYXQoNjApfWApO1xuXG4gICAgICAgIC8vIFNob3cgZm9jdXMgYW5kIHN1Z2dlc3RlZCBwcm9tcHRzXG4gICAgICAgIGlmIChleGl0Q29kZSA9PT0gMCkge1xuICAgICAgICAgICAgaWYgKGxpbnRFeGl0Q29kZSA9PT0gMCAmJiBwcmV0dGllckV4aXRDb2RlID09PSAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zaG93SW5mbyhcIvCfjq8gRk9DVVM6IEZpbmFsIGNvZGUgcmV2aWV3IGFuZCBQUiBwcmVwYXJhdGlvblwiKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNob3dJbmZvKFwiXFxu8J+TiyBTVUdHRVNURUQgQUkgUFJPTVBUUzpcIik7XG4gICAgICAgICAgICAgICAgdGhpcy5zaG93SW5mbygn4oCiIFwiR2VuZXJhdGUgYSBHaXRIdWIgUFIgZGVzY3JpcHRpb24gdXNpbmcgdGhlIFBSIGRlc2NyaXB0aW9uIHByb21wdHMgZmlsZVwiJyk7XG4gICAgICAgICAgICAgICAgdGhpcy5zaG93SW5mbygn4oCiIFwiUmV2aWV3IHRoaXMgY29kZSBmb3IgcXVhbGl0eSBhbmQgc3VnZ2VzdCBhbnkgaW1wcm92ZW1lbnRzXCInKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNob3dJbmZvKCfigKIgXCJDaGVjayBpZiBtb2NrIG9iamVjdHMgaGF2ZSBjb3JyZWN0IHByb3BlcnR5IG5hbWVzIGFuZCByZWFsaXN0aWMgdmFsdWVzXCInKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zaG93SW5mbyhcIvCfjq8gRk9DVVM6IEZpeCBjb2RlIHF1YWxpdHkgaXNzdWVzIGJlZm9yZSBQUlwiKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNob3dJbmZvKFwiXFxu8J+TiyBTVUdHRVNURUQgQUkgUFJPTVBUUzpcIik7XG4gICAgICAgICAgICAgICAgdGhpcy5zaG93SW5mbygn4oCiIFwiSGVscCBtZSBmaXggdGhlIGxpbnRpbmcvZm9ybWF0dGluZyBpc3N1ZXMgc2hvd24gYWJvdmVcIicpO1xuICAgICAgICAgICAgICAgIHRoaXMuc2hvd0luZm8oJ+KAoiBcIlJldmlldyB0aGlzIGNvZGUgZm9yIHF1YWxpdHkgYW5kIHN1Z2dlc3QgYW55IGltcHJvdmVtZW50c1wiJyk7XG4gICAgICAgICAgICAgICAgaWYgKGxpbnRFeGl0Q29kZSAhPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dJbmZvKCfigKIgXCJBbmFseXplIHRoZSBsaW50aW5nIGVycm9ycyBhbmQgcHJvdmlkZSBzcGVjaWZpYyBmaXhlc1wiJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5zaG93SW5mbyhcIvCfjq8gRk9DVVM6IEZhaWx1cmUgYW5hbHlzaXMgYW5kIGZpeCByZWNvbW1lbmRhdGlvbnNcIik7XG4gICAgICAgICAgICB0aGlzLnNob3dJbmZvKFwiXFxu8J+TiyBTVUdHRVNURUQgQUkgUFJPTVBUUzpcIik7XG4gICAgICAgICAgICB0aGlzLnNob3dJbmZvKCfigKIgXCJBbmFseXplIHRoZXNlIHRlc3QgZmFpbHVyZXMgYW5kIHByb3ZpZGUgc3BlY2lmaWMgZml4ZXMgZmlyc3RcIicpO1xuICAgICAgICAgICAgdGhpcy5zaG93SW5mbygn4oCiIFwiV2hhdCBjb2RlIGNoYW5nZXMgYXJlIGJyZWFraW5nIHRoZXNlIHRlc3RzIGFuZCBob3cgZG8gSSBmaXggdGhlbT9cIicpO1xuICAgICAgICAgICAgdGhpcy5zaG93SW5mbygn4oCiIFwiSGVscCBtZSBmaXggZmFpbGluZyB0ZXN0cyBmaXJzdCwgdGhlbiBzdWdnZXN0IG5ldyB0ZXN0IGNvdmVyYWdlXCInKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFNob3cgZmlsZSBkZXRhaWxzXG4gICAgICAgIHRoaXMuc2hvd0luZm8oXCJcXG7wn5OEIENPTlRFWFQgRklMRSBERVRBSUxTOlwiKTtcbiAgICAgICAgdGhpcy5zaG93SW5mbyhg4oCiIExvY2F0aW9uOiAke2NvbnRleHRGaWxlfWApO1xuICAgICAgICBpZiAoY29udGV4dFN0YXRzKSB7XG4gICAgICAgICAgICB0aGlzLnNob3dJbmZvKGDigKIgU2l6ZTogJHtjb250ZXh0U3RhdHMuc2l6ZX0gYnl0ZXNgKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNob3dJbmZvKFwi4oCiIE9wdGltaXplZDog4pyFIEFJLWZyaWVuZGx5IHN0cnVjdHVyZVwiKTtcbiAgICAgICAgdGhpcy5zaG93SW5mbyhg4oCiIEZvY3VzOiAke2ZvY3VzQXJlYSB8fCBcIkdlbmVyYWxcIn1gKTtcbiAgICAgICAgXG4gICAgICAgIGlmIChleGl0Q29kZSA9PT0gMCkge1xuICAgICAgICAgICAgdGhpcy5zaG93SW5mbyhcIuKAoiBUZXN0czog4pyFIFBhc3NpbmdcIik7XG4gICAgICAgICAgICB0aGlzLnNob3dJbmZvKGDigKIgTGludDogJHtsaW50RXhpdENvZGUgPT09IDAgPyBcIuKchSBQYXNzZWRcIiA6IFwi4p2MIEZhaWxlZFwifWApO1xuICAgICAgICAgICAgdGhpcy5zaG93SW5mbyhg4oCiIEZvcm1hdDogJHtwcmV0dGllckV4aXRDb2RlID09PSAwID8gXCLinIUgQXBwbGllZFwiIDogXCLinYwgRmFpbGVkXCJ9YCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocHJEZXNjcmlwdGlvbkVuYWJsZWQpIHtcbiAgICAgICAgICAgIGNvbnN0IHByU3RhdHMgPSBhd2FpdCB0aGlzLmZpbGVNYW5hZ2VyLmdldEZpbGVTdGF0cyhwckRlc2NyaXB0aW9uRmlsZSk7XG4gICAgICAgICAgICB0aGlzLnNob3dJbmZvKFwiXFxu8J+TnSBQUiBERVNDUklQVElPTiBQUk9NUFRTOlwiKTtcbiAgICAgICAgICAgIHRoaXMuc2hvd0luZm8oYOKAoiBMb2NhdGlvbjogJHtwckRlc2NyaXB0aW9uRmlsZX1gKTtcbiAgICAgICAgICAgIGlmIChwclN0YXRzKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zaG93SW5mbyhg4oCiIFNpemU6ICR7cHJTdGF0cy5zaXplfSBieXRlc2ApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5zaG93SW5mbyhcIuKAoiBSZWFkeTog4pyFIEdpdEh1YiBQUiBmb3JtYXQgcHJvbXB0cyBnZW5lcmF0ZWRcIik7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBTaG93IG5leHQgc3RlcHNcbiAgICAgICAgdGhpcy5zaG93SW5mbyhcIlxcbvCfmoAgTkVYVCBTVEVQUzpcIik7XG4gICAgICAgIGlmIChleGl0Q29kZSA9PT0gMCkge1xuICAgICAgICAgICAgaWYgKGxpbnRFeGl0Q29kZSA9PT0gMCAmJiBwcmV0dGllckV4aXRDb2RlID09PSAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zaG93SW5mbyhcIjEuIFVwbG9hZCBQUiBkZXNjcmlwdGlvbiBwcm9tcHRzIHRvIHlvdXIgQUkgYXNzaXN0YW50XCIpO1xuICAgICAgICAgICAgICAgIHRoaXMuc2hvd0luZm8oXCIyLiBHZW5lcmF0ZSBHaXRIdWIgUFIgZGVzY3JpcHRpb25cIik7XG4gICAgICAgICAgICAgICAgdGhpcy5zaG93SW5mbyhcIjMuIFJldmlldyBhbnkgZm9ybWF0dGluZyBjaGFuZ2VzIG1hZGUgYnkgcHJldHRpZXJcIik7XG4gICAgICAgICAgICAgICAgdGhpcy5zaG93SW5mbyhcIjQuIENvbW1pdCBhbmQgcHVzaDogZ2l0IGFkZCAuICYmIGdpdCBjb21taXQgJiYgZ2l0IHB1c2hcIik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGxldCBzdGVwID0gMTtcbiAgICAgICAgICAgICAgICBpZiAobGludEV4aXRDb2RlICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0luZm8oYCR7c3RlcH0uIEZpeCBsaW50aW5nIGVycm9ycyAodHJ5OiB5YXJuIG54IGxpbnQgJHtwcm9qZWN0fSAtLWZpeClgKTtcbiAgICAgICAgICAgICAgICAgICAgc3RlcCsrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAocHJldHRpZXJFeGl0Q29kZSAhPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dJbmZvKGAke3N0ZXB9LiBGaXggcHJldHRpZXIgZm9ybWF0dGluZyBpc3N1ZXNgKTtcbiAgICAgICAgICAgICAgICAgICAgc3RlcCsrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnNob3dJbmZvKGAke3N0ZXB9LiBSZS1ydW4gYWlEZWJ1ZyB0byB2ZXJpZnkgYWxsIGNoZWNrcyBwYXNzYCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnNob3dJbmZvKFwiMS4gVXBsb2FkIHRoZSBjb250ZXh0IGZpbGUgdG8geW91ciBBSSBhc3Npc3RhbnRcIik7XG4gICAgICAgICAgICB0aGlzLnNob3dJbmZvKFwiMi4gVXNlIG9uZSBvZiB0aGUgc3VnZ2VzdGVkIHByb21wdHMgYWJvdmVcIik7XG4gICAgICAgICAgICB0aGlzLnNob3dJbmZvKFwiMy4gRm9sbG93IHRoZSBBSSdzIHNwZWNpZmljIGZpeCByZWNvbW1lbmRhdGlvbnNcIik7XG4gICAgICAgICAgICB0aGlzLnNob3dJbmZvKFwiNC4gUmUtcnVuIGFpRGVidWcgdG8gdmVyaWZ5IGZpeGVzXCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5zaG93SW5mbyhgXFxuJHtcIj1cIi5yZXBlYXQoNjApfWApO1xuICAgIH1cblxuICAgIHByaXZhdGUgY291bnRDaGFuZ2VkRmlsZXMoZGlmZk91dHB1dDogc3RyaW5nKTogbnVtYmVyIHtcbiAgICAgICAgY29uc3QgbWF0Y2hlcyA9IGRpZmZPdXRwdXQubWF0Y2goL17wn5OBL2dtKTtcbiAgICAgICAgcmV0dXJuIG1hdGNoZXMgPyBtYXRjaGVzLmxlbmd0aCA6IDA7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBnZXRXb3Jrc3BhY2VSb290KCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB2c2NvZGUud29ya3NwYWNlLndvcmtzcGFjZUZvbGRlcnM/LlswXT8udXJpLmZzUGF0aCB8fCAnJztcbiAgICB9XG5cbiAgICBwcml2YXRlIHNob3dQcm9ncmVzcyh0aXRsZTogc3RyaW5nLCBkZXRhaWxzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+KSB7XG4gICAgICAgIHRoaXMuc2hvd0luZm8oYFxcbiR7XCI9XCIucmVwZWF0KDYwKX1gKTtcbiAgICAgICAgdGhpcy5zaG93SW5mbyhg8J+kliAke3RpdGxlfWApO1xuICAgICAgICB0aGlzLnNob3dJbmZvKGAke1wiPVwiLnJlcGVhdCg2MCl9YCk7XG4gICAgICAgIFxuICAgICAgICBPYmplY3QuZW50cmllcyhkZXRhaWxzKS5mb3JFYWNoKChba2V5LCB2YWx1ZV0pID0+IHtcbiAgICAgICAgICAgIHRoaXMuc2hvd0luZm8oYCR7a2V5fTogJHt2YWx1ZX1gKTtcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICB0aGlzLnNob3dJbmZvKFwiXCIpO1xuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgc2hvd1N0ZXAobWVzc2FnZTogc3RyaW5nKSB7XG4gICAgICAgIHRoaXMuc2hvd0luZm8obWVzc2FnZSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzaG93U3VjY2VzcyhtZXNzYWdlOiBzdHJpbmcpIHtcbiAgICAgICAgdGhpcy5zaG93SW5mbyhg4pyFICR7bWVzc2FnZX1gKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHNob3dXYXJuaW5nKG1lc3NhZ2U6IHN0cmluZykge1xuICAgICAgICB0aGlzLnNob3dJbmZvKGDimqDvuI8gICR7bWVzc2FnZX1gKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHNob3dFcnJvcihtZXNzYWdlOiBzdHJpbmcpIHtcbiAgICAgICAgdGhpcy5zaG93SW5mbyhg4p2MICR7bWVzc2FnZX1gKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHNob3dJbmZvKG1lc3NhZ2U6IHN0cmluZykge1xuICAgICAgICB0aGlzLm91dHB1dENoYW5uZWwuYXBwZW5kTGluZShtZXNzYWdlKTtcbiAgICAgICAgdGhpcy5vdXRwdXRDaGFubmVsLnNob3coKTtcbiAgICB9XG59Il0sInZlcnNpb24iOjN9