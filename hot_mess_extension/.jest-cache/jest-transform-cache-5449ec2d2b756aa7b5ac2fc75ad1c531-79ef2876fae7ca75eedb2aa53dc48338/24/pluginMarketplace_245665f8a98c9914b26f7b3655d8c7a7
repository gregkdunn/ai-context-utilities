183ab2c3184ada9138a22cc9ec57cdb2
"use strict";
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
exports.PluginMarketplaceService = void 0;
const vscode = __importStar(require("vscode"));
const path = __importStar(require("path"));
const fs = __importStar(require("fs"));
const pluginDiscovery_1 = require("./pluginDiscovery");
class PluginMarketplaceService {
    context;
    discoveryService;
    pluginsDirectory;
    constructor(context) {
        this.context = context;
        this.discoveryService = new pluginDiscovery_1.PluginDiscoveryService(context);
        this.pluginsDirectory = path.join(context.extensionPath, 'plugins');
        // Ensure plugins directory exists
        if (!fs.existsSync(this.pluginsDirectory)) {
            fs.mkdirSync(this.pluginsDirectory, { recursive: true });
        }
    }
    async search(query) {
        return this.searchPlugins(query);
    }
    async searchPlugins(query) {
        // In a real implementation, this would search a remote registry
        // For now, we'll search local plugins and simulate some results
        const localPlugins = await this.listInstalledPlugins();
        const filteredPlugins = localPlugins.filter(plugin => plugin.name.toLowerCase().includes(query.toLowerCase()) ||
            plugin.description.toLowerCase().includes(query.toLowerCase()) ||
            plugin.tags.some(tag => tag.toLowerCase().includes(query.toLowerCase())));
        // Add some mock plugins for demonstration
        const mockPlugins = this.getMockPlugins().filter(plugin => plugin.name.toLowerCase().includes(query.toLowerCase()) ||
            plugin.description.toLowerCase().includes(query.toLowerCase()) ||
            plugin.tags.some(tag => tag.toLowerCase().includes(query.toLowerCase())));
        return [...filteredPlugins, ...mockPlugins];
    }
    async getPlugin(id) {
        const localPlugins = await this.listInstalledPlugins();
        const localPlugin = localPlugins.find(p => p.id === id);
        if (localPlugin) {
            return localPlugin;
        }
        // Check mock plugins
        const mockPlugins = this.getMockPlugins();
        const mockPlugin = mockPlugins.find(p => p.id === id);
        if (mockPlugin) {
            return mockPlugin;
        }
        throw new Error(`Plugin not found: ${id}`);
    }
    async install(id, version) {
        return this.installPlugin(id, version);
    }
    async installPlugin(id, version) {
        try {
            // In a real implementation, this would download from a registry
            // For now, we'll simulate installation
            const pluginInfo = await this.getPlugin(id);
            const targetVersion = version || pluginInfo.version;
            // Create plugin directory
            const pluginDir = path.join(this.pluginsDirectory, id);
            if (!fs.existsSync(pluginDir)) {
                fs.mkdirSync(pluginDir, { recursive: true });
            }
            // Generate package.json
            const packageJson = {
                name: pluginInfo.id,
                displayName: pluginInfo.name,
                version: targetVersion,
                description: pluginInfo.description,
                author: pluginInfo.author,
                license: pluginInfo.license,
                repository: {
                    type: 'git',
                    url: pluginInfo.repository
                },
                homepage: pluginInfo.homepage,
                bugs: pluginInfo.bugs,
                keywords: [...pluginInfo.tags, 'ai-debug-plugin'],
                main: 'index.js',
                dependencies: pluginInfo.dependencies,
                peerDependencies: pluginInfo.peerDependencies,
                aiDebugPlugin: {
                    capabilities: this.getDefaultCapabilities(pluginInfo),
                    config: {},
                    engineVersion: '1.0.0'
                }
            };
            fs.writeFileSync(path.join(pluginDir, 'package.json'), JSON.stringify(packageJson, null, 2));
            // Generate basic plugin implementation
            const pluginCode = this.generatePluginCode(pluginInfo);
            fs.writeFileSync(path.join(pluginDir, 'index.js'), pluginCode);
            // Generate README
            const readme = this.generateReadme(pluginInfo);
            fs.writeFileSync(path.join(pluginDir, 'README.md'), readme);
            vscode.window.showInformationMessage(`Plugin ${pluginInfo.name} installed successfully!`);
        }
        catch (error) {
            vscode.window.showErrorMessage(`Failed to install plugin: ${error.message}`);
            throw error;
        }
    }
    async update(id, version) {
        return this.updatePlugin(id, version);
    }
    async updatePlugin(id, version) {
        try {
            const pluginInfo = await this.getPlugin(id);
            const currentVersion = pluginInfo.version;
            const targetVersion = version || 'latest';
            // In a real implementation, this would check for updates and download
            // For now, we'll simulate an update
            if (targetVersion === currentVersion) {
                vscode.window.showInformationMessage(`Plugin ${pluginInfo.name} is already up to date.`);
                return;
            }
            // Simulate update process
            await new Promise(resolve => setTimeout(resolve, 2000));
            vscode.window.showInformationMessage(`Plugin ${pluginInfo.name} updated to version ${targetVersion}!`);
        }
        catch (error) {
            vscode.window.showErrorMessage(`Failed to update plugin: ${error.message}`);
            throw error;
        }
    }
    async uninstall(id) {
        return this.uninstallPlugin(id);
    }
    async uninstallPlugin(id) {
        try {
            const pluginDir = path.join(this.pluginsDirectory, id);
            if (fs.existsSync(pluginDir)) {
                // Remove plugin directory
                fs.rmSync(pluginDir, { recursive: true, force: true });
                vscode.window.showInformationMessage(`Plugin ${id} uninstalled successfully!`);
            }
            else {
                throw new Error(`Plugin ${id} is not installed`);
            }
        }
        catch (error) {
            vscode.window.showErrorMessage(`Failed to uninstall plugin: ${error.message}`);
            throw error;
        }
    }
    async listInstalledPlugins() {
        const plugins = [];
        try {
            const manifests = await this.discoveryService.discoverPlugins(this.pluginsDirectory);
            for (const manifest of manifests) {
                const pluginInfo = {
                    id: manifest.metadata.id,
                    name: manifest.metadata.name,
                    version: manifest.metadata.version,
                    description: manifest.metadata.description || '',
                    author: manifest.metadata.author || '',
                    downloads: 0, // Would be fetched from registry
                    rating: 0, // Would be fetched from registry
                    tags: manifest.metadata.keywords || [],
                    screenshots: [],
                    readme: this.getReadme(manifest.path),
                    changelog: this.getChangelog(manifest.path),
                    license: manifest.metadata.license || '',
                    repository: manifest.metadata.repository || '',
                    homepage: manifest.metadata.homepage || '',
                    bugs: '',
                    dependencies: manifest.packageJson.dependencies || {},
                    peerDependencies: manifest.packageJson.peerDependencies || {},
                    publishedAt: new Date(fs.statSync(manifest.path).birthtime),
                    updatedAt: new Date(fs.statSync(manifest.path).mtime)
                };
                plugins.push(pluginInfo);
            }
        }
        catch (error) {
            console.error('Failed to list installed plugins:', error);
        }
        return plugins;
    }
    getMockPlugins() {
        const now = new Date();
        const weekAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
        return [
            {
                id: 'git-enhanced-analyzer',
                name: 'Git Enhanced Analyzer',
                version: '1.2.0',
                description: 'Advanced Git analysis with commit pattern recognition and branch optimization suggestions',
                author: 'AI Debug Community',
                downloads: 1250,
                rating: 4.8,
                tags: ['git', 'analysis', 'vcs', 'optimization'],
                screenshots: [],
                readme: '# Git Enhanced Analyzer\n\nAdvanced Git analysis plugin...',
                changelog: '## 1.2.0\n- Added branch optimization\n- Improved commit analysis',
                license: 'MIT',
                repository: 'https://github.com/ai-debug/git-enhanced-analyzer',
                homepage: 'https://ai-debug.com/plugins/git-enhanced-analyzer',
                bugs: 'https://github.com/ai-debug/git-enhanced-analyzer/issues',
                dependencies: {
                    'simple-git': '^3.0.0',
                    'moment': '^2.29.0'
                },
                peerDependencies: {},
                publishedAt: weekAgo,
                updatedAt: now
            },
            {
                id: 'test-coverage-insights',
                name: 'Test Coverage Insights',
                version: '2.1.3',
                description: 'Intelligent test coverage analysis with AI-powered suggestions for improving test quality',
                author: 'TestBot Inc.',
                downloads: 2100,
                rating: 4.6,
                tags: ['testing', 'coverage', 'quality', 'ai'],
                screenshots: [],
                readme: '# Test Coverage Insights\n\nIntelligent test coverage analysis...',
                changelog: '## 2.1.3\n- Fixed coverage calculation\n- Added AI suggestions',
                license: 'Apache-2.0',
                repository: 'https://github.com/testbot/test-coverage-insights',
                homepage: 'https://testbot.com/plugins/coverage-insights',
                bugs: 'https://github.com/testbot/test-coverage-insights/issues',
                dependencies: {
                    'istanbul': '^0.4.5',
                    'nyc': '^15.0.0'
                },
                peerDependencies: {},
                publishedAt: weekAgo,
                updatedAt: now
            },
            {
                id: 'performance-profiler',
                name: 'Performance Profiler',
                version: '1.0.5',
                description: 'Real-time performance monitoring and optimization suggestions for your development workflow',
                author: 'SpeedDev',
                downloads: 890,
                rating: 4.3,
                tags: ['performance', 'profiling', 'optimization', 'monitoring'],
                screenshots: [],
                readme: '# Performance Profiler\n\nReal-time performance monitoring...',
                changelog: '## 1.0.5\n- Added memory profiling\n- Performance improvements',
                license: 'MIT',
                repository: 'https://github.com/speeddev/performance-profiler',
                homepage: 'https://speeddev.com/plugins/performance-profiler',
                bugs: 'https://github.com/speeddev/performance-profiler/issues',
                dependencies: {
                    'perf_hooks': '^1.0.0',
                    'v8-profiler': '^5.7.0'
                },
                peerDependencies: {},
                publishedAt: weekAgo,
                updatedAt: now
            },
            {
                id: 'ai-code-reviewer',
                name: 'AI Code Reviewer',
                version: '3.0.1',
                description: 'AI-powered code review with smart suggestions, bug detection, and code quality analysis',
                author: 'CodeAI Labs',
                downloads: 3200,
                rating: 4.9,
                tags: ['ai', 'code-review', 'quality', 'bugs', 'analysis'],
                screenshots: [],
                readme: '# AI Code Reviewer\n\nAI-powered code review...',
                changelog: '## 3.0.1\n- Enhanced AI model\n- Better bug detection',
                license: 'Commercial',
                repository: 'https://github.com/codeai/ai-code-reviewer',
                homepage: 'https://codeai.com/plugins/ai-code-reviewer',
                bugs: 'https://github.com/codeai/ai-code-reviewer/issues',
                dependencies: {
                    'openai': '^4.0.0',
                    'typescript': '^5.0.0'
                },
                peerDependencies: {},
                publishedAt: weekAgo,
                updatedAt: now
            }
        ];
    }
    getDefaultCapabilities(pluginInfo) {
        const capabilities = [];
        // Add capabilities based on plugin tags
        if (pluginInfo.tags.includes('git')) {
            capabilities.push({
                type: 'analyzer',
                name: 'git-analyzer',
                description: 'Analyze Git repositories and commits'
            });
        }
        if (pluginInfo.tags.includes('testing')) {
            capabilities.push({
                type: 'analyzer',
                name: 'test-analyzer',
                description: 'Analyze test results and coverage'
            });
        }
        if (pluginInfo.tags.includes('performance')) {
            capabilities.push({
                type: 'analyzer',
                name: 'performance-analyzer',
                description: 'Analyze performance metrics'
            });
        }
        if (pluginInfo.tags.includes('ai')) {
            capabilities.push({
                type: 'ai-provider',
                name: 'ai-provider',
                description: 'Provide AI-powered insights'
            });
        }
        return capabilities;
    }
    generatePluginCode(pluginInfo) {
        const className = this.toPascalCase(pluginInfo.id);
        return `
class ${className} {
  constructor() {
    this.metadata = {
      id: '${pluginInfo.id}',
      name: '${pluginInfo.name}',
      version: '${pluginInfo.version}',
      description: '${pluginInfo.description}',
      author: '${pluginInfo.author}',
      license: '${pluginInfo.license}',
      enabled: true,
      capabilities: ${JSON.stringify(this.getDefaultCapabilities(pluginInfo), null, 6)}
    };
  }

  async activate(api, context) {
    console.log('${pluginInfo.name} plugin activated');
    
    // Register plugin capabilities
    if (this.commands) {
      for (const command of this.commands) {
        api.registerCommand(command);
      }
    }
    
    if (this.analyzers) {
      for (const analyzer of this.analyzers) {
        api.registerAnalyzer(analyzer);
      }
    }
    
    // Plugin-specific initialization
    await this.initialize(api, context);
  }

  async deactivate(api, context) {
    console.log('${pluginInfo.name} plugin deactivated');
    
    // Cleanup plugin resources
    await this.cleanup(api, context);
  }

  async initialize(api, context) {
    // Plugin-specific initialization logic
    console.log('Initializing ${pluginInfo.name}...');
  }

  async cleanup(api, context) {
    // Plugin-specific cleanup logic
    console.log('Cleaning up ${pluginInfo.name}...');
  }

  // Example analyzer (if plugin has analysis capabilities)
  get analyzers() {
    return [
      {
        id: '${pluginInfo.id}-analyzer',
        name: '${pluginInfo.name} Analyzer',
        description: '${pluginInfo.description}',
        filePatterns: ['**/*'],
        
        async analyze(content, filePath, context) {
          // Implement analysis logic here
          return {
            issues: [],
            metrics: {},
            suggestions: [],
            confidence: 0.8
          };
        }
      }
    ];
  }

  // Example commands (if plugin has command capabilities)
  get commands() {
    return [
      {
        id: '${pluginInfo.id}-command',
        title: '${pluginInfo.name} Command',
        description: 'Execute ${pluginInfo.name} functionality',
        category: 'AI Debug',
        
        async execute(context, args) {
          // Implement command logic here
          return 'Command executed successfully';
        }
      }
    ];
  }
}

module.exports = ${className};
    `.trim();
    }
    generateReadme(pluginInfo) {
        return `
# ${pluginInfo.name}

${pluginInfo.description}

## Installation

Install this plugin through the AI Debug Plugin Marketplace:

1. Open AI Debug extension
2. Go to Plugin Marketplace
3. Search for "${pluginInfo.name}"
4. Click Install

## Usage

After installation, the plugin will be automatically activated and its features will be available in the AI Debug extension.

## Features

- Advanced analysis capabilities
- Smart suggestions and insights
- Seamless integration with AI Debug workflow

## Configuration

The plugin can be configured through the AI Debug settings panel.

## Support

For issues and questions, please visit: ${pluginInfo.bugs || 'N/A'}

## License

${pluginInfo.license}
    `.trim();
    }
    getReadme(pluginPath) {
        const readmePath = path.join(pluginPath, 'README.md');
        if (fs.existsSync(readmePath)) {
            return fs.readFileSync(readmePath, 'utf8');
        }
        return '';
    }
    getChangelog(pluginPath) {
        const changelogPath = path.join(pluginPath, 'CHANGELOG.md');
        if (fs.existsSync(changelogPath)) {
            return fs.readFileSync(changelogPath, 'utf8');
        }
        return '';
    }
    toPascalCase(str) {
        return str
            .replace(/[-_]/g, ' ')
            .replace(/\w\S*/g, (txt) => txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase())
            .replace(/\s/g, '');
    }
}
exports.PluginMarketplaceService = PluginMarketplaceService;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2dyZWdkdW5uL3NyYy90ZXN0L2FpX2RlYnVnX2NvbnRleHQvdnNjb2RlL3NyYy9zZXJ2aWNlcy9wbHVnaW5zL3BsdWdpbk1hcmtldHBsYWNlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLCtDQUFpQztBQUNqQywyQ0FBNkI7QUFDN0IsdUNBQXlCO0FBT3pCLHVEQUEyRDtBQUUzRCxNQUFhLHdCQUF3QjtJQUlmO0lBSFosZ0JBQWdCLENBQXlCO0lBQ3pDLGdCQUFnQixDQUFTO0lBRWpDLFlBQW9CLE9BQWdDO1FBQWhDLFlBQU8sR0FBUCxPQUFPLENBQXlCO1FBQ2xELElBQUksQ0FBQyxnQkFBZ0IsR0FBRyxJQUFJLHdDQUFzQixDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQzVELElBQUksQ0FBQyxnQkFBZ0IsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxhQUFhLEVBQUUsU0FBUyxDQUFDLENBQUM7UUFFcEUsa0NBQWtDO1FBQ2xDLElBQUksQ0FBQyxFQUFFLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxFQUFFLENBQUM7WUFDMUMsRUFBRSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsZ0JBQWdCLEVBQUUsRUFBRSxTQUFTLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQztRQUMzRCxDQUFDO0lBQ0gsQ0FBQztJQUVELEtBQUssQ0FBQyxNQUFNLENBQUMsS0FBYTtRQUN4QixPQUFPLElBQUksQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDbkMsQ0FBQztJQUVELEtBQUssQ0FBQyxhQUFhLENBQUMsS0FBYTtRQUMvQixnRUFBZ0U7UUFDaEUsZ0VBQWdFO1FBRWhFLE1BQU0sWUFBWSxHQUFHLE1BQU0sSUFBSSxDQUFDLG9CQUFvQixFQUFFLENBQUM7UUFDdkQsTUFBTSxlQUFlLEdBQUcsWUFBWSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUNuRCxNQUFNLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsV0FBVyxFQUFFLENBQUM7WUFDdkQsTUFBTSxDQUFDLFdBQVcsQ0FBQyxXQUFXLEVBQUUsQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBQzlELE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxDQUFDLFdBQVcsRUFBRSxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsV0FBVyxFQUFFLENBQUMsQ0FBQyxDQUN6RSxDQUFDO1FBRUYsMENBQTBDO1FBQzFDLE1BQU0sV0FBVyxHQUFHLElBQUksQ0FBQyxjQUFjLEVBQUUsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FDeEQsTUFBTSxDQUFDLElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBQ3ZELE1BQU0sQ0FBQyxXQUFXLENBQUMsV0FBVyxFQUFFLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxXQUFXLEVBQUUsQ0FBQztZQUM5RCxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxXQUFXLEVBQUUsQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLFdBQVcsRUFBRSxDQUFDLENBQUMsQ0FDekUsQ0FBQztRQUVGLE9BQU8sQ0FBQyxHQUFHLGVBQWUsRUFBRSxHQUFHLFdBQVcsQ0FBQyxDQUFDO0lBQzlDLENBQUM7SUFFRCxLQUFLLENBQUMsU0FBUyxDQUFDLEVBQVU7UUFDeEIsTUFBTSxZQUFZLEdBQUcsTUFBTSxJQUFJLENBQUMsb0JBQW9CLEVBQUUsQ0FBQztRQUN2RCxNQUFNLFdBQVcsR0FBRyxZQUFZLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsS0FBSyxFQUFFLENBQUMsQ0FBQztRQUV4RCxJQUFJLFdBQVcsRUFBRSxDQUFDO1lBQ2hCLE9BQU8sV0FBVyxDQUFDO1FBQ3JCLENBQUM7UUFFRCxxQkFBcUI7UUFDckIsTUFBTSxXQUFXLEdBQUcsSUFBSSxDQUFDLGNBQWMsRUFBRSxDQUFDO1FBQzFDLE1BQU0sVUFBVSxHQUFHLFdBQVcsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBRSxLQUFLLEVBQUUsQ0FBQyxDQUFDO1FBRXRELElBQUksVUFBVSxFQUFFLENBQUM7WUFDZixPQUFPLFVBQVUsQ0FBQztRQUNwQixDQUFDO1FBRUQsTUFBTSxJQUFJLEtBQUssQ0FBQyxxQkFBcUIsRUFBRSxFQUFFLENBQUMsQ0FBQztJQUM3QyxDQUFDO0lBRUQsS0FBSyxDQUFDLE9BQU8sQ0FBQyxFQUFVLEVBQUUsT0FBZ0I7UUFDeEMsT0FBTyxJQUFJLENBQUMsYUFBYSxDQUFDLEVBQUUsRUFBRSxPQUFPLENBQUMsQ0FBQztJQUN6QyxDQUFDO0lBRUQsS0FBSyxDQUFDLGFBQWEsQ0FBQyxFQUFVLEVBQUUsT0FBZ0I7UUFDOUMsSUFBSSxDQUFDO1lBQ0gsZ0VBQWdFO1lBQ2hFLHVDQUF1QztZQUV2QyxNQUFNLFVBQVUsR0FBRyxNQUFNLElBQUksQ0FBQyxTQUFTLENBQUMsRUFBRSxDQUFDLENBQUM7WUFDNUMsTUFBTSxhQUFhLEdBQUcsT0FBTyxJQUFJLFVBQVUsQ0FBQyxPQUFPLENBQUM7WUFFcEQsMEJBQTBCO1lBQzFCLE1BQU0sU0FBUyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLGdCQUFnQixFQUFFLEVBQUUsQ0FBQyxDQUFDO1lBQ3ZELElBQUksQ0FBQyxFQUFFLENBQUMsVUFBVSxDQUFDLFNBQVMsQ0FBQyxFQUFFLENBQUM7Z0JBQzlCLEVBQUUsQ0FBQyxTQUFTLENBQUMsU0FBUyxFQUFFLEVBQUUsU0FBUyxFQUFFLElBQUksRUFBRSxDQUFDLENBQUM7WUFDL0MsQ0FBQztZQUVELHdCQUF3QjtZQUN4QixNQUFNLFdBQVcsR0FBRztnQkFDbEIsSUFBSSxFQUFFLFVBQVUsQ0FBQyxFQUFFO2dCQUNuQixXQUFXLEVBQUUsVUFBVSxDQUFDLElBQUk7Z0JBQzVCLE9BQU8sRUFBRSxhQUFhO2dCQUN0QixXQUFXLEVBQUUsVUFBVSxDQUFDLFdBQVc7Z0JBQ25DLE1BQU0sRUFBRSxVQUFVLENBQUMsTUFBTTtnQkFDekIsT0FBTyxFQUFFLFVBQVUsQ0FBQyxPQUFPO2dCQUMzQixVQUFVLEVBQUU7b0JBQ1YsSUFBSSxFQUFFLEtBQUs7b0JBQ1gsR0FBRyxFQUFFLFVBQVUsQ0FBQyxVQUFVO2lCQUMzQjtnQkFDRCxRQUFRLEVBQUUsVUFBVSxDQUFDLFFBQVE7Z0JBQzdCLElBQUksRUFBRSxVQUFVLENBQUMsSUFBSTtnQkFDckIsUUFBUSxFQUFFLENBQUMsR0FBRyxVQUFVLENBQUMsSUFBSSxFQUFFLGlCQUFpQixDQUFDO2dCQUNqRCxJQUFJLEVBQUUsVUFBVTtnQkFDaEIsWUFBWSxFQUFFLFVBQVUsQ0FBQyxZQUFZO2dCQUNyQyxnQkFBZ0IsRUFBRSxVQUFVLENBQUMsZ0JBQWdCO2dCQUM3QyxhQUFhLEVBQUU7b0JBQ2IsWUFBWSxFQUFFLElBQUksQ0FBQyxzQkFBc0IsQ0FBQyxVQUFVLENBQUM7b0JBQ3JELE1BQU0sRUFBRSxFQUFFO29CQUNWLGFBQWEsRUFBRSxPQUFPO2lCQUN2QjthQUNGLENBQUM7WUFFRixFQUFFLENBQUMsYUFBYSxDQUNkLElBQUksQ0FBQyxJQUFJLENBQUMsU0FBUyxFQUFFLGNBQWMsQ0FBQyxFQUNwQyxJQUFJLENBQUMsU0FBUyxDQUFDLFdBQVcsRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDLENBQ3JDLENBQUM7WUFFRix1Q0FBdUM7WUFDdkMsTUFBTSxVQUFVLEdBQUcsSUFBSSxDQUFDLGtCQUFrQixDQUFDLFVBQVUsQ0FBQyxDQUFDO1lBQ3ZELEVBQUUsQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxTQUFTLEVBQUUsVUFBVSxDQUFDLEVBQUUsVUFBVSxDQUFDLENBQUM7WUFFL0Qsa0JBQWtCO1lBQ2xCLE1BQU0sTUFBTSxHQUFHLElBQUksQ0FBQyxjQUFjLENBQUMsVUFBVSxDQUFDLENBQUM7WUFDL0MsRUFBRSxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFNBQVMsRUFBRSxXQUFXLENBQUMsRUFBRSxNQUFNLENBQUMsQ0FBQztZQUU1RCxNQUFNLENBQUMsTUFBTSxDQUFDLHNCQUFzQixDQUFDLFVBQVUsVUFBVSxDQUFDLElBQUksMEJBQTBCLENBQUMsQ0FBQztRQUU1RixDQUFDO1FBQUMsT0FBTyxLQUFLLEVBQUUsQ0FBQztZQUNmLE1BQU0sQ0FBQyxNQUFNLENBQUMsZ0JBQWdCLENBQUMsNkJBQThCLEtBQWUsQ0FBQyxPQUFPLEVBQUUsQ0FBQyxDQUFDO1lBQ3hGLE1BQU0sS0FBSyxDQUFDO1FBQ2QsQ0FBQztJQUNILENBQUM7SUFFRCxLQUFLLENBQUMsTUFBTSxDQUFDLEVBQVUsRUFBRSxPQUFnQjtRQUN2QyxPQUFPLElBQUksQ0FBQyxZQUFZLENBQUMsRUFBRSxFQUFFLE9BQU8sQ0FBQyxDQUFDO0lBQ3hDLENBQUM7SUFFRCxLQUFLLENBQUMsWUFBWSxDQUFDLEVBQVUsRUFBRSxPQUFnQjtRQUM3QyxJQUFJLENBQUM7WUFDSCxNQUFNLFVBQVUsR0FBRyxNQUFNLElBQUksQ0FBQyxTQUFTLENBQUMsRUFBRSxDQUFDLENBQUM7WUFDNUMsTUFBTSxjQUFjLEdBQUcsVUFBVSxDQUFDLE9BQU8sQ0FBQztZQUMxQyxNQUFNLGFBQWEsR0FBRyxPQUFPLElBQUksUUFBUSxDQUFDO1lBRTFDLHNFQUFzRTtZQUN0RSxvQ0FBb0M7WUFFcEMsSUFBSSxhQUFhLEtBQUssY0FBYyxFQUFFLENBQUM7Z0JBQ3JDLE1BQU0sQ0FBQyxNQUFNLENBQUMsc0JBQXNCLENBQUMsVUFBVSxVQUFVLENBQUMsSUFBSSx5QkFBeUIsQ0FBQyxDQUFDO2dCQUN6RixPQUFPO1lBQ1QsQ0FBQztZQUVELDBCQUEwQjtZQUMxQixNQUFNLElBQUksT0FBTyxDQUFDLE9BQU8sQ0FBQyxFQUFFLENBQUMsVUFBVSxDQUFDLE9BQU8sRUFBRSxJQUFJLENBQUMsQ0FBQyxDQUFDO1lBRXhELE1BQU0sQ0FBQyxNQUFNLENBQUMsc0JBQXNCLENBQUMsVUFBVSxVQUFVLENBQUMsSUFBSSx1QkFBdUIsYUFBYSxHQUFHLENBQUMsQ0FBQztRQUV6RyxDQUFDO1FBQUMsT0FBTyxLQUFLLEVBQUUsQ0FBQztZQUNmLE1BQU0sQ0FBQyxNQUFNLENBQUMsZ0JBQWdCLENBQUMsNEJBQTZCLEtBQWUsQ0FBQyxPQUFPLEVBQUUsQ0FBQyxDQUFDO1lBQ3ZGLE1BQU0sS0FBSyxDQUFDO1FBQ2QsQ0FBQztJQUNILENBQUM7SUFFRCxLQUFLLENBQUMsU0FBUyxDQUFDLEVBQVU7UUFDeEIsT0FBTyxJQUFJLENBQUMsZUFBZSxDQUFDLEVBQUUsQ0FBQyxDQUFDO0lBQ2xDLENBQUM7SUFFRCxLQUFLLENBQUMsZUFBZSxDQUFDLEVBQVU7UUFDOUIsSUFBSSxDQUFDO1lBQ0gsTUFBTSxTQUFTLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsZ0JBQWdCLEVBQUUsRUFBRSxDQUFDLENBQUM7WUFFdkQsSUFBSSxFQUFFLENBQUMsVUFBVSxDQUFDLFNBQVMsQ0FBQyxFQUFFLENBQUM7Z0JBQzdCLDBCQUEwQjtnQkFDMUIsRUFBRSxDQUFDLE1BQU0sQ0FBQyxTQUFTLEVBQUUsRUFBRSxTQUFTLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDO2dCQUV2RCxNQUFNLENBQUMsTUFBTSxDQUFDLHNCQUFzQixDQUFDLFVBQVUsRUFBRSw0QkFBNEIsQ0FBQyxDQUFDO1lBQ2pGLENBQUM7aUJBQU0sQ0FBQztnQkFDTixNQUFNLElBQUksS0FBSyxDQUFDLFVBQVUsRUFBRSxtQkFBbUIsQ0FBQyxDQUFDO1lBQ25ELENBQUM7UUFFSCxDQUFDO1FBQUMsT0FBTyxLQUFLLEVBQUUsQ0FBQztZQUNmLE1BQU0sQ0FBQyxNQUFNLENBQUMsZ0JBQWdCLENBQUMsK0JBQWdDLEtBQWUsQ0FBQyxPQUFPLEVBQUUsQ0FBQyxDQUFDO1lBQzFGLE1BQU0sS0FBSyxDQUFDO1FBQ2QsQ0FBQztJQUNILENBQUM7SUFFRCxLQUFLLENBQUMsb0JBQW9CO1FBQ3hCLE1BQU0sT0FBTyxHQUFpQixFQUFFLENBQUM7UUFFakMsSUFBSSxDQUFDO1lBQ0gsTUFBTSxTQUFTLEdBQUcsTUFBTSxJQUFJLENBQUMsZ0JBQWdCLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO1lBRXJGLEtBQUssTUFBTSxRQUFRLElBQUksU0FBUyxFQUFFLENBQUM7Z0JBQ2pDLE1BQU0sVUFBVSxHQUFlO29CQUM3QixFQUFFLEVBQUUsUUFBUSxDQUFDLFFBQVEsQ0FBQyxFQUFFO29CQUN4QixJQUFJLEVBQUUsUUFBUSxDQUFDLFFBQVEsQ0FBQyxJQUFJO29CQUM1QixPQUFPLEVBQUUsUUFBUSxDQUFDLFFBQVEsQ0FBQyxPQUFPO29CQUNsQyxXQUFXLEVBQUUsUUFBUSxDQUFDLFFBQVEsQ0FBQyxXQUFXLElBQUksRUFBRTtvQkFDaEQsTUFBTSxFQUFFLFFBQVEsQ0FBQyxRQUFRLENBQUMsTUFBTSxJQUFJLEVBQUU7b0JBQ3RDLFNBQVMsRUFBRSxDQUFDLEVBQUUsaUNBQWlDO29CQUMvQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLGlDQUFpQztvQkFDNUMsSUFBSSxFQUFFLFFBQVEsQ0FBQyxRQUFRLENBQUMsUUFBUSxJQUFJLEVBQUU7b0JBQ3RDLFdBQVcsRUFBRSxFQUFFO29CQUNmLE1BQU0sRUFBRSxJQUFJLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUM7b0JBQ3JDLFNBQVMsRUFBRSxJQUFJLENBQUMsWUFBWSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUM7b0JBQzNDLE9BQU8sRUFBRSxRQUFRLENBQUMsUUFBUSxDQUFDLE9BQU8sSUFBSSxFQUFFO29CQUN4QyxVQUFVLEVBQUUsUUFBUSxDQUFDLFFBQVEsQ0FBQyxVQUFVLElBQUksRUFBRTtvQkFDOUMsUUFBUSxFQUFFLFFBQVEsQ0FBQyxRQUFRLENBQUMsUUFBUSxJQUFJLEVBQUU7b0JBQzFDLElBQUksRUFBRSxFQUFFO29CQUNSLFlBQVksRUFBRSxRQUFRLENBQUMsV0FBVyxDQUFDLFlBQVksSUFBSSxFQUFFO29CQUNyRCxnQkFBZ0IsRUFBRSxRQUFRLENBQUMsV0FBVyxDQUFDLGdCQUFnQixJQUFJLEVBQUU7b0JBQzdELFdBQVcsRUFBRSxJQUFJLElBQUksQ0FBQyxFQUFFLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxTQUFTLENBQUM7b0JBQzNELFNBQVMsRUFBRSxJQUFJLElBQUksQ0FBQyxFQUFFLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxLQUFLLENBQUM7aUJBQ3RELENBQUM7Z0JBRUYsT0FBTyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQztZQUMzQixDQUFDO1FBRUgsQ0FBQztRQUFDLE9BQU8sS0FBSyxFQUFFLENBQUM7WUFDZixPQUFPLENBQUMsS0FBSyxDQUFDLG1DQUFtQyxFQUFFLEtBQUssQ0FBQyxDQUFDO1FBQzVELENBQUM7UUFFRCxPQUFPLE9BQU8sQ0FBQztJQUNqQixDQUFDO0lBRU8sY0FBYztRQUNwQixNQUFNLEdBQUcsR0FBRyxJQUFJLElBQUksRUFBRSxDQUFDO1FBQ3ZCLE1BQU0sT0FBTyxHQUFHLElBQUksSUFBSSxDQUFDLEdBQUcsQ0FBQyxPQUFPLEVBQUUsR0FBRyxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsSUFBSSxDQUFDLENBQUM7UUFFbEUsT0FBTztZQUNMO2dCQUNFLEVBQUUsRUFBRSx1QkFBdUI7Z0JBQzNCLElBQUksRUFBRSx1QkFBdUI7Z0JBQzdCLE9BQU8sRUFBRSxPQUFPO2dCQUNoQixXQUFXLEVBQUUsMkZBQTJGO2dCQUN4RyxNQUFNLEVBQUUsb0JBQW9CO2dCQUM1QixTQUFTLEVBQUUsSUFBSTtnQkFDZixNQUFNLEVBQUUsR0FBRztnQkFDWCxJQUFJLEVBQUUsQ0FBQyxLQUFLLEVBQUUsVUFBVSxFQUFFLEtBQUssRUFBRSxjQUFjLENBQUM7Z0JBQ2hELFdBQVcsRUFBRSxFQUFFO2dCQUNmLE1BQU0sRUFBRSw0REFBNEQ7Z0JBQ3BFLFNBQVMsRUFBRSxtRUFBbUU7Z0JBQzlFLE9BQU8sRUFBRSxLQUFLO2dCQUNkLFVBQVUsRUFBRSxtREFBbUQ7Z0JBQy9ELFFBQVEsRUFBRSxvREFBb0Q7Z0JBQzlELElBQUksRUFBRSwwREFBMEQ7Z0JBQ2hFLFlBQVksRUFBRTtvQkFDWixZQUFZLEVBQUUsUUFBUTtvQkFDdEIsUUFBUSxFQUFFLFNBQVM7aUJBQ3BCO2dCQUNELGdCQUFnQixFQUFFLEVBQUU7Z0JBQ3BCLFdBQVcsRUFBRSxPQUFPO2dCQUNwQixTQUFTLEVBQUUsR0FBRzthQUNmO1lBQ0Q7Z0JBQ0UsRUFBRSxFQUFFLHdCQUF3QjtnQkFDNUIsSUFBSSxFQUFFLHdCQUF3QjtnQkFDOUIsT0FBTyxFQUFFLE9BQU87Z0JBQ2hCLFdBQVcsRUFBRSwyRkFBMkY7Z0JBQ3hHLE1BQU0sRUFBRSxjQUFjO2dCQUN0QixTQUFTLEVBQUUsSUFBSTtnQkFDZixNQUFNLEVBQUUsR0FBRztnQkFDWCxJQUFJLEVBQUUsQ0FBQyxTQUFTLEVBQUUsVUFBVSxFQUFFLFNBQVMsRUFBRSxJQUFJLENBQUM7Z0JBQzlDLFdBQVcsRUFBRSxFQUFFO2dCQUNmLE1BQU0sRUFBRSxtRUFBbUU7Z0JBQzNFLFNBQVMsRUFBRSxnRUFBZ0U7Z0JBQzNFLE9BQU8sRUFBRSxZQUFZO2dCQUNyQixVQUFVLEVBQUUsbURBQW1EO2dCQUMvRCxRQUFRLEVBQUUsK0NBQStDO2dCQUN6RCxJQUFJLEVBQUUsMERBQTBEO2dCQUNoRSxZQUFZLEVBQUU7b0JBQ1osVUFBVSxFQUFFLFFBQVE7b0JBQ3BCLEtBQUssRUFBRSxTQUFTO2lCQUNqQjtnQkFDRCxnQkFBZ0IsRUFBRSxFQUFFO2dCQUNwQixXQUFXLEVBQUUsT0FBTztnQkFDcEIsU0FBUyxFQUFFLEdBQUc7YUFDZjtZQUNEO2dCQUNFLEVBQUUsRUFBRSxzQkFBc0I7Z0JBQzFCLElBQUksRUFBRSxzQkFBc0I7Z0JBQzVCLE9BQU8sRUFBRSxPQUFPO2dCQUNoQixXQUFXLEVBQUUsNkZBQTZGO2dCQUMxRyxNQUFNLEVBQUUsVUFBVTtnQkFDbEIsU0FBUyxFQUFFLEdBQUc7Z0JBQ2QsTUFBTSxFQUFFLEdBQUc7Z0JBQ1gsSUFBSSxFQUFFLENBQUMsYUFBYSxFQUFFLFdBQVcsRUFBRSxjQUFjLEVBQUUsWUFBWSxDQUFDO2dCQUNoRSxXQUFXLEVBQUUsRUFBRTtnQkFDZixNQUFNLEVBQUUsK0RBQStEO2dCQUN2RSxTQUFTLEVBQUUsZ0VBQWdFO2dCQUMzRSxPQUFPLEVBQUUsS0FBSztnQkFDZCxVQUFVLEVBQUUsa0RBQWtEO2dCQUM5RCxRQUFRLEVBQUUsbURBQW1EO2dCQUM3RCxJQUFJLEVBQUUseURBQXlEO2dCQUMvRCxZQUFZLEVBQUU7b0JBQ1osWUFBWSxFQUFFLFFBQVE7b0JBQ3RCLGFBQWEsRUFBRSxRQUFRO2lCQUN4QjtnQkFDRCxnQkFBZ0IsRUFBRSxFQUFFO2dCQUNwQixXQUFXLEVBQUUsT0FBTztnQkFDcEIsU0FBUyxFQUFFLEdBQUc7YUFDZjtZQUNEO2dCQUNFLEVBQUUsRUFBRSxrQkFBa0I7Z0JBQ3RCLElBQUksRUFBRSxrQkFBa0I7Z0JBQ3hCLE9BQU8sRUFBRSxPQUFPO2dCQUNoQixXQUFXLEVBQUUseUZBQXlGO2dCQUN0RyxNQUFNLEVBQUUsYUFBYTtnQkFDckIsU0FBUyxFQUFFLElBQUk7Z0JBQ2YsTUFBTSxFQUFFLEdBQUc7Z0JBQ1gsSUFBSSxFQUFFLENBQUMsSUFBSSxFQUFFLGFBQWEsRUFBRSxTQUFTLEVBQUUsTUFBTSxFQUFFLFVBQVUsQ0FBQztnQkFDMUQsV0FBVyxFQUFFLEVBQUU7Z0JBQ2YsTUFBTSxFQUFFLGlEQUFpRDtnQkFDekQsU0FBUyxFQUFFLHVEQUF1RDtnQkFDbEUsT0FBTyxFQUFFLFlBQVk7Z0JBQ3JCLFVBQVUsRUFBRSw0Q0FBNEM7Z0JBQ3hELFFBQVEsRUFBRSw2Q0FBNkM7Z0JBQ3ZELElBQUksRUFBRSxtREFBbUQ7Z0JBQ3pELFlBQVksRUFBRTtvQkFDWixRQUFRLEVBQUUsUUFBUTtvQkFDbEIsWUFBWSxFQUFFLFFBQVE7aUJBQ3ZCO2dCQUNELGdCQUFnQixFQUFFLEVBQUU7Z0JBQ3BCLFdBQVcsRUFBRSxPQUFPO2dCQUNwQixTQUFTLEVBQUUsR0FBRzthQUNmO1NBQ0YsQ0FBQztJQUNKLENBQUM7SUFFTyxzQkFBc0IsQ0FBQyxVQUFzQjtRQUNuRCxNQUFNLFlBQVksR0FBRyxFQUFFLENBQUM7UUFFeEIsd0NBQXdDO1FBQ3hDLElBQUksVUFBVSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQztZQUNwQyxZQUFZLENBQUMsSUFBSSxDQUFDO2dCQUNoQixJQUFJLEVBQUUsVUFBVTtnQkFDaEIsSUFBSSxFQUFFLGNBQWM7Z0JBQ3BCLFdBQVcsRUFBRSxzQ0FBc0M7YUFDcEQsQ0FBQyxDQUFDO1FBQ0wsQ0FBQztRQUVELElBQUksVUFBVSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsU0FBUyxDQUFDLEVBQUUsQ0FBQztZQUN4QyxZQUFZLENBQUMsSUFBSSxDQUFDO2dCQUNoQixJQUFJLEVBQUUsVUFBVTtnQkFDaEIsSUFBSSxFQUFFLGVBQWU7Z0JBQ3JCLFdBQVcsRUFBRSxtQ0FBbUM7YUFDakQsQ0FBQyxDQUFDO1FBQ0wsQ0FBQztRQUVELElBQUksVUFBVSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsYUFBYSxDQUFDLEVBQUUsQ0FBQztZQUM1QyxZQUFZLENBQUMsSUFBSSxDQUFDO2dCQUNoQixJQUFJLEVBQUUsVUFBVTtnQkFDaEIsSUFBSSxFQUFFLHNCQUFzQjtnQkFDNUIsV0FBVyxFQUFFLDZCQUE2QjthQUMzQyxDQUFDLENBQUM7UUFDTCxDQUFDO1FBRUQsSUFBSSxVQUFVLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDO1lBQ25DLFlBQVksQ0FBQyxJQUFJLENBQUM7Z0JBQ2hCLElBQUksRUFBRSxhQUFhO2dCQUNuQixJQUFJLEVBQUUsYUFBYTtnQkFDbkIsV0FBVyxFQUFFLDZCQUE2QjthQUMzQyxDQUFDLENBQUM7UUFDTCxDQUFDO1FBRUQsT0FBTyxZQUFZLENBQUM7SUFDdEIsQ0FBQztJQUVPLGtCQUFrQixDQUFDLFVBQXNCO1FBQy9DLE1BQU0sU0FBUyxHQUFHLElBQUksQ0FBQyxZQUFZLENBQUMsVUFBVSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1FBRW5ELE9BQU87UUFDSCxTQUFTOzs7YUFHSixVQUFVLENBQUMsRUFBRTtlQUNYLFVBQVUsQ0FBQyxJQUFJO2tCQUNaLFVBQVUsQ0FBQyxPQUFPO3NCQUNkLFVBQVUsQ0FBQyxXQUFXO2lCQUMzQixVQUFVLENBQUMsTUFBTTtrQkFDaEIsVUFBVSxDQUFDLE9BQU87O3NCQUVkLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLHNCQUFzQixDQUFDLFVBQVUsQ0FBQyxFQUFFLElBQUksRUFBRSxDQUFDLENBQUM7Ozs7O21CQUtuRSxVQUFVLENBQUMsSUFBSTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7bUJBb0JmLFVBQVUsQ0FBQyxJQUFJOzs7Ozs7OztnQ0FRRixVQUFVLENBQUMsSUFBSTs7Ozs7K0JBS2hCLFVBQVUsQ0FBQyxJQUFJOzs7Ozs7O2VBTy9CLFVBQVUsQ0FBQyxFQUFFO2lCQUNYLFVBQVUsQ0FBQyxJQUFJO3dCQUNSLFVBQVUsQ0FBQyxXQUFXOzs7Ozs7Ozs7Ozs7Ozs7Ozs7OztlQW9CL0IsVUFBVSxDQUFDLEVBQUU7a0JBQ1YsVUFBVSxDQUFDLElBQUk7Z0NBQ0QsVUFBVSxDQUFDLElBQUk7Ozs7Ozs7Ozs7OzttQkFZNUIsU0FBUztLQUN2QixDQUFDLElBQUksRUFBRSxDQUFDO0lBQ1gsQ0FBQztJQUVPLGNBQWMsQ0FBQyxVQUFzQjtRQUMzQyxPQUFPO0lBQ1AsVUFBVSxDQUFDLElBQUk7O0VBRWpCLFVBQVUsQ0FBQyxXQUFXOzs7Ozs7OztpQkFRUCxVQUFVLENBQUMsSUFBSTs7Ozs7Ozs7Ozs7Ozs7Ozs7OzswQ0FtQlUsVUFBVSxDQUFDLElBQUksSUFBSSxLQUFLOzs7O0VBSWhFLFVBQVUsQ0FBQyxPQUFPO0tBQ2YsQ0FBQyxJQUFJLEVBQUUsQ0FBQztJQUNYLENBQUM7SUFFTyxTQUFTLENBQUMsVUFBa0I7UUFDbEMsTUFBTSxVQUFVLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxVQUFVLEVBQUUsV0FBVyxDQUFDLENBQUM7UUFDdEQsSUFBSSxFQUFFLENBQUMsVUFBVSxDQUFDLFVBQVUsQ0FBQyxFQUFFLENBQUM7WUFDOUIsT0FBTyxFQUFFLENBQUMsWUFBWSxDQUFDLFVBQVUsRUFBRSxNQUFNLENBQUMsQ0FBQztRQUM3QyxDQUFDO1FBQ0QsT0FBTyxFQUFFLENBQUM7SUFDWixDQUFDO0lBRU8sWUFBWSxDQUFDLFVBQWtCO1FBQ3JDLE1BQU0sYUFBYSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsVUFBVSxFQUFFLGNBQWMsQ0FBQyxDQUFDO1FBQzVELElBQUksRUFBRSxDQUFDLFVBQVUsQ0FBQyxhQUFhLENBQUMsRUFBRSxDQUFDO1lBQ2pDLE9BQU8sRUFBRSxDQUFDLFlBQVksQ0FBQyxhQUFhLEVBQUUsTUFBTSxDQUFDLENBQUM7UUFDaEQsQ0FBQztRQUNELE9BQU8sRUFBRSxDQUFDO0lBQ1osQ0FBQztJQUVPLFlBQVksQ0FBQyxHQUFXO1FBQzlCLE9BQU8sR0FBRzthQUNQLE9BQU8sQ0FBQyxPQUFPLEVBQUUsR0FBRyxDQUFDO2FBQ3JCLE9BQU8sQ0FBQyxRQUFRLEVBQUUsQ0FBQyxHQUFHLEVBQUUsRUFBRSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsV0FBVyxFQUFFLEdBQUcsR0FBRyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQzthQUNyRixPQUFPLENBQUMsS0FBSyxFQUFFLEVBQUUsQ0FBQyxDQUFDO0lBQ3hCLENBQUM7Q0FDRjtBQXBnQkQsNERBb2dCQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMvZ3JlZ2R1bm4vc3JjL3Rlc3QvYWlfZGVidWdfY29udGV4dC92c2NvZGUvc3JjL3NlcnZpY2VzL3BsdWdpbnMvcGx1Z2luTWFya2V0cGxhY2UudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgdnNjb2RlIGZyb20gJ3ZzY29kZSc7XG5pbXBvcnQgKiBhcyBwYXRoIGZyb20gJ3BhdGgnO1xuaW1wb3J0ICogYXMgZnMgZnJvbSAnZnMnO1xuaW1wb3J0IHsgXG4gIFBsdWdpbk1hcmtldHBsYWNlLCBcbiAgUGx1Z2luSW5mbyxcbiAgUGx1Z2luTWFuaWZlc3QsXG4gIFBsdWdpblxufSBmcm9tICcuLi8uLi90eXBlcy9wbHVnaW4nO1xuaW1wb3J0IHsgUGx1Z2luRGlzY292ZXJ5U2VydmljZSB9IGZyb20gJy4vcGx1Z2luRGlzY292ZXJ5JztcblxuZXhwb3J0IGNsYXNzIFBsdWdpbk1hcmtldHBsYWNlU2VydmljZSBpbXBsZW1lbnRzIFBsdWdpbk1hcmtldHBsYWNlIHtcbiAgcHJpdmF0ZSBkaXNjb3ZlcnlTZXJ2aWNlOiBQbHVnaW5EaXNjb3ZlcnlTZXJ2aWNlO1xuICBwcml2YXRlIHBsdWdpbnNEaXJlY3Rvcnk6IHN0cmluZztcblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIGNvbnRleHQ6IHZzY29kZS5FeHRlbnNpb25Db250ZXh0KSB7XG4gICAgdGhpcy5kaXNjb3ZlcnlTZXJ2aWNlID0gbmV3IFBsdWdpbkRpc2NvdmVyeVNlcnZpY2UoY29udGV4dCk7XG4gICAgdGhpcy5wbHVnaW5zRGlyZWN0b3J5ID0gcGF0aC5qb2luKGNvbnRleHQuZXh0ZW5zaW9uUGF0aCwgJ3BsdWdpbnMnKTtcbiAgICBcbiAgICAvLyBFbnN1cmUgcGx1Z2lucyBkaXJlY3RvcnkgZXhpc3RzXG4gICAgaWYgKCFmcy5leGlzdHNTeW5jKHRoaXMucGx1Z2luc0RpcmVjdG9yeSkpIHtcbiAgICAgIGZzLm1rZGlyU3luYyh0aGlzLnBsdWdpbnNEaXJlY3RvcnksIHsgcmVjdXJzaXZlOiB0cnVlIH0pO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHNlYXJjaChxdWVyeTogc3RyaW5nKTogUHJvbWlzZTxQbHVnaW5JbmZvW10+IHtcbiAgICByZXR1cm4gdGhpcy5zZWFyY2hQbHVnaW5zKHF1ZXJ5KTtcbiAgfVxuICBcbiAgYXN5bmMgc2VhcmNoUGx1Z2lucyhxdWVyeTogc3RyaW5nKTogUHJvbWlzZTxQbHVnaW5JbmZvW10+IHtcbiAgICAvLyBJbiBhIHJlYWwgaW1wbGVtZW50YXRpb24sIHRoaXMgd291bGQgc2VhcmNoIGEgcmVtb3RlIHJlZ2lzdHJ5XG4gICAgLy8gRm9yIG5vdywgd2UnbGwgc2VhcmNoIGxvY2FsIHBsdWdpbnMgYW5kIHNpbXVsYXRlIHNvbWUgcmVzdWx0c1xuICAgIFxuICAgIGNvbnN0IGxvY2FsUGx1Z2lucyA9IGF3YWl0IHRoaXMubGlzdEluc3RhbGxlZFBsdWdpbnMoKTtcbiAgICBjb25zdCBmaWx0ZXJlZFBsdWdpbnMgPSBsb2NhbFBsdWdpbnMuZmlsdGVyKHBsdWdpbiA9PiBcbiAgICAgIHBsdWdpbi5uYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMocXVlcnkudG9Mb3dlckNhc2UoKSkgfHxcbiAgICAgIHBsdWdpbi5kZXNjcmlwdGlvbi50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHF1ZXJ5LnRvTG93ZXJDYXNlKCkpIHx8XG4gICAgICBwbHVnaW4udGFncy5zb21lKHRhZyA9PiB0YWcudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhxdWVyeS50b0xvd2VyQ2FzZSgpKSlcbiAgICApO1xuXG4gICAgLy8gQWRkIHNvbWUgbW9jayBwbHVnaW5zIGZvciBkZW1vbnN0cmF0aW9uXG4gICAgY29uc3QgbW9ja1BsdWdpbnMgPSB0aGlzLmdldE1vY2tQbHVnaW5zKCkuZmlsdGVyKHBsdWdpbiA9PlxuICAgICAgcGx1Z2luLm5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhxdWVyeS50b0xvd2VyQ2FzZSgpKSB8fFxuICAgICAgcGx1Z2luLmRlc2NyaXB0aW9uLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMocXVlcnkudG9Mb3dlckNhc2UoKSkgfHxcbiAgICAgIHBsdWdpbi50YWdzLnNvbWUodGFnID0+IHRhZy50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHF1ZXJ5LnRvTG93ZXJDYXNlKCkpKVxuICAgICk7XG5cbiAgICByZXR1cm4gWy4uLmZpbHRlcmVkUGx1Z2lucywgLi4ubW9ja1BsdWdpbnNdO1xuICB9XG5cbiAgYXN5bmMgZ2V0UGx1Z2luKGlkOiBzdHJpbmcpOiBQcm9taXNlPFBsdWdpbkluZm8+IHtcbiAgICBjb25zdCBsb2NhbFBsdWdpbnMgPSBhd2FpdCB0aGlzLmxpc3RJbnN0YWxsZWRQbHVnaW5zKCk7XG4gICAgY29uc3QgbG9jYWxQbHVnaW4gPSBsb2NhbFBsdWdpbnMuZmluZChwID0+IHAuaWQgPT09IGlkKTtcbiAgICBcbiAgICBpZiAobG9jYWxQbHVnaW4pIHtcbiAgICAgIHJldHVybiBsb2NhbFBsdWdpbjtcbiAgICB9XG5cbiAgICAvLyBDaGVjayBtb2NrIHBsdWdpbnNcbiAgICBjb25zdCBtb2NrUGx1Z2lucyA9IHRoaXMuZ2V0TW9ja1BsdWdpbnMoKTtcbiAgICBjb25zdCBtb2NrUGx1Z2luID0gbW9ja1BsdWdpbnMuZmluZChwID0+IHAuaWQgPT09IGlkKTtcbiAgICBcbiAgICBpZiAobW9ja1BsdWdpbikge1xuICAgICAgcmV0dXJuIG1vY2tQbHVnaW47XG4gICAgfVxuXG4gICAgdGhyb3cgbmV3IEVycm9yKGBQbHVnaW4gbm90IGZvdW5kOiAke2lkfWApO1xuICB9XG5cbiAgYXN5bmMgaW5zdGFsbChpZDogc3RyaW5nLCB2ZXJzaW9uPzogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgcmV0dXJuIHRoaXMuaW5zdGFsbFBsdWdpbihpZCwgdmVyc2lvbik7XG4gIH1cbiAgXG4gIGFzeW5jIGluc3RhbGxQbHVnaW4oaWQ6IHN0cmluZywgdmVyc2lvbj86IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBJbiBhIHJlYWwgaW1wbGVtZW50YXRpb24sIHRoaXMgd291bGQgZG93bmxvYWQgZnJvbSBhIHJlZ2lzdHJ5XG4gICAgICAvLyBGb3Igbm93LCB3ZSdsbCBzaW11bGF0ZSBpbnN0YWxsYXRpb25cbiAgICAgIFxuICAgICAgY29uc3QgcGx1Z2luSW5mbyA9IGF3YWl0IHRoaXMuZ2V0UGx1Z2luKGlkKTtcbiAgICAgIGNvbnN0IHRhcmdldFZlcnNpb24gPSB2ZXJzaW9uIHx8IHBsdWdpbkluZm8udmVyc2lvbjtcbiAgICAgIFxuICAgICAgLy8gQ3JlYXRlIHBsdWdpbiBkaXJlY3RvcnlcbiAgICAgIGNvbnN0IHBsdWdpbkRpciA9IHBhdGguam9pbih0aGlzLnBsdWdpbnNEaXJlY3RvcnksIGlkKTtcbiAgICAgIGlmICghZnMuZXhpc3RzU3luYyhwbHVnaW5EaXIpKSB7XG4gICAgICAgIGZzLm1rZGlyU3luYyhwbHVnaW5EaXIsIHsgcmVjdXJzaXZlOiB0cnVlIH0pO1xuICAgICAgfVxuXG4gICAgICAvLyBHZW5lcmF0ZSBwYWNrYWdlLmpzb25cbiAgICAgIGNvbnN0IHBhY2thZ2VKc29uID0ge1xuICAgICAgICBuYW1lOiBwbHVnaW5JbmZvLmlkLFxuICAgICAgICBkaXNwbGF5TmFtZTogcGx1Z2luSW5mby5uYW1lLFxuICAgICAgICB2ZXJzaW9uOiB0YXJnZXRWZXJzaW9uLFxuICAgICAgICBkZXNjcmlwdGlvbjogcGx1Z2luSW5mby5kZXNjcmlwdGlvbixcbiAgICAgICAgYXV0aG9yOiBwbHVnaW5JbmZvLmF1dGhvcixcbiAgICAgICAgbGljZW5zZTogcGx1Z2luSW5mby5saWNlbnNlLFxuICAgICAgICByZXBvc2l0b3J5OiB7XG4gICAgICAgICAgdHlwZTogJ2dpdCcsXG4gICAgICAgICAgdXJsOiBwbHVnaW5JbmZvLnJlcG9zaXRvcnlcbiAgICAgICAgfSxcbiAgICAgICAgaG9tZXBhZ2U6IHBsdWdpbkluZm8uaG9tZXBhZ2UsXG4gICAgICAgIGJ1Z3M6IHBsdWdpbkluZm8uYnVncyxcbiAgICAgICAga2V5d29yZHM6IFsuLi5wbHVnaW5JbmZvLnRhZ3MsICdhaS1kZWJ1Zy1wbHVnaW4nXSxcbiAgICAgICAgbWFpbjogJ2luZGV4LmpzJyxcbiAgICAgICAgZGVwZW5kZW5jaWVzOiBwbHVnaW5JbmZvLmRlcGVuZGVuY2llcyxcbiAgICAgICAgcGVlckRlcGVuZGVuY2llczogcGx1Z2luSW5mby5wZWVyRGVwZW5kZW5jaWVzLFxuICAgICAgICBhaURlYnVnUGx1Z2luOiB7XG4gICAgICAgICAgY2FwYWJpbGl0aWVzOiB0aGlzLmdldERlZmF1bHRDYXBhYmlsaXRpZXMocGx1Z2luSW5mbyksXG4gICAgICAgICAgY29uZmlnOiB7fSxcbiAgICAgICAgICBlbmdpbmVWZXJzaW9uOiAnMS4wLjAnXG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIGZzLndyaXRlRmlsZVN5bmMoXG4gICAgICAgIHBhdGguam9pbihwbHVnaW5EaXIsICdwYWNrYWdlLmpzb24nKSxcbiAgICAgICAgSlNPTi5zdHJpbmdpZnkocGFja2FnZUpzb24sIG51bGwsIDIpXG4gICAgICApO1xuXG4gICAgICAvLyBHZW5lcmF0ZSBiYXNpYyBwbHVnaW4gaW1wbGVtZW50YXRpb25cbiAgICAgIGNvbnN0IHBsdWdpbkNvZGUgPSB0aGlzLmdlbmVyYXRlUGx1Z2luQ29kZShwbHVnaW5JbmZvKTtcbiAgICAgIGZzLndyaXRlRmlsZVN5bmMocGF0aC5qb2luKHBsdWdpbkRpciwgJ2luZGV4LmpzJyksIHBsdWdpbkNvZGUpO1xuXG4gICAgICAvLyBHZW5lcmF0ZSBSRUFETUVcbiAgICAgIGNvbnN0IHJlYWRtZSA9IHRoaXMuZ2VuZXJhdGVSZWFkbWUocGx1Z2luSW5mbyk7XG4gICAgICBmcy53cml0ZUZpbGVTeW5jKHBhdGguam9pbihwbHVnaW5EaXIsICdSRUFETUUubWQnKSwgcmVhZG1lKTtcblxuICAgICAgdnNjb2RlLndpbmRvdy5zaG93SW5mb3JtYXRpb25NZXNzYWdlKGBQbHVnaW4gJHtwbHVnaW5JbmZvLm5hbWV9IGluc3RhbGxlZCBzdWNjZXNzZnVsbHkhYCk7XG4gICAgICBcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdnNjb2RlLndpbmRvdy5zaG93RXJyb3JNZXNzYWdlKGBGYWlsZWQgdG8gaW5zdGFsbCBwbHVnaW46ICR7KGVycm9yIGFzIEVycm9yKS5tZXNzYWdlfWApO1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgdXBkYXRlKGlkOiBzdHJpbmcsIHZlcnNpb24/OiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICByZXR1cm4gdGhpcy51cGRhdGVQbHVnaW4oaWQsIHZlcnNpb24pO1xuICB9XG4gIFxuICBhc3luYyB1cGRhdGVQbHVnaW4oaWQ6IHN0cmluZywgdmVyc2lvbj86IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBwbHVnaW5JbmZvID0gYXdhaXQgdGhpcy5nZXRQbHVnaW4oaWQpO1xuICAgICAgY29uc3QgY3VycmVudFZlcnNpb24gPSBwbHVnaW5JbmZvLnZlcnNpb247XG4gICAgICBjb25zdCB0YXJnZXRWZXJzaW9uID0gdmVyc2lvbiB8fCAnbGF0ZXN0JztcbiAgICAgIFxuICAgICAgLy8gSW4gYSByZWFsIGltcGxlbWVudGF0aW9uLCB0aGlzIHdvdWxkIGNoZWNrIGZvciB1cGRhdGVzIGFuZCBkb3dubG9hZFxuICAgICAgLy8gRm9yIG5vdywgd2UnbGwgc2ltdWxhdGUgYW4gdXBkYXRlXG4gICAgICBcbiAgICAgIGlmICh0YXJnZXRWZXJzaW9uID09PSBjdXJyZW50VmVyc2lvbikge1xuICAgICAgICB2c2NvZGUud2luZG93LnNob3dJbmZvcm1hdGlvbk1lc3NhZ2UoYFBsdWdpbiAke3BsdWdpbkluZm8ubmFtZX0gaXMgYWxyZWFkeSB1cCB0byBkYXRlLmApO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIFNpbXVsYXRlIHVwZGF0ZSBwcm9jZXNzXG4gICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMjAwMCkpO1xuICAgICAgXG4gICAgICB2c2NvZGUud2luZG93LnNob3dJbmZvcm1hdGlvbk1lc3NhZ2UoYFBsdWdpbiAke3BsdWdpbkluZm8ubmFtZX0gdXBkYXRlZCB0byB2ZXJzaW9uICR7dGFyZ2V0VmVyc2lvbn0hYCk7XG4gICAgICBcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdnNjb2RlLndpbmRvdy5zaG93RXJyb3JNZXNzYWdlKGBGYWlsZWQgdG8gdXBkYXRlIHBsdWdpbjogJHsoZXJyb3IgYXMgRXJyb3IpLm1lc3NhZ2V9YCk7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH1cblxuICBhc3luYyB1bmluc3RhbGwoaWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIHJldHVybiB0aGlzLnVuaW5zdGFsbFBsdWdpbihpZCk7XG4gIH1cbiAgXG4gIGFzeW5jIHVuaW5zdGFsbFBsdWdpbihpZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHBsdWdpbkRpciA9IHBhdGguam9pbih0aGlzLnBsdWdpbnNEaXJlY3RvcnksIGlkKTtcbiAgICAgIFxuICAgICAgaWYgKGZzLmV4aXN0c1N5bmMocGx1Z2luRGlyKSkge1xuICAgICAgICAvLyBSZW1vdmUgcGx1Z2luIGRpcmVjdG9yeVxuICAgICAgICBmcy5ybVN5bmMocGx1Z2luRGlyLCB7IHJlY3Vyc2l2ZTogdHJ1ZSwgZm9yY2U6IHRydWUgfSk7XG4gICAgICAgIFxuICAgICAgICB2c2NvZGUud2luZG93LnNob3dJbmZvcm1hdGlvbk1lc3NhZ2UoYFBsdWdpbiAke2lkfSB1bmluc3RhbGxlZCBzdWNjZXNzZnVsbHkhYCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFBsdWdpbiAke2lkfSBpcyBub3QgaW5zdGFsbGVkYCk7XG4gICAgICB9XG4gICAgICBcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdnNjb2RlLndpbmRvdy5zaG93RXJyb3JNZXNzYWdlKGBGYWlsZWQgdG8gdW5pbnN0YWxsIHBsdWdpbjogJHsoZXJyb3IgYXMgRXJyb3IpLm1lc3NhZ2V9YCk7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH1cblxuICBhc3luYyBsaXN0SW5zdGFsbGVkUGx1Z2lucygpOiBQcm9taXNlPFBsdWdpbkluZm9bXT4ge1xuICAgIGNvbnN0IHBsdWdpbnM6IFBsdWdpbkluZm9bXSA9IFtdO1xuICAgIFxuICAgIHRyeSB7XG4gICAgICBjb25zdCBtYW5pZmVzdHMgPSBhd2FpdCB0aGlzLmRpc2NvdmVyeVNlcnZpY2UuZGlzY292ZXJQbHVnaW5zKHRoaXMucGx1Z2luc0RpcmVjdG9yeSk7XG4gICAgICBcbiAgICAgIGZvciAoY29uc3QgbWFuaWZlc3Qgb2YgbWFuaWZlc3RzKSB7XG4gICAgICAgIGNvbnN0IHBsdWdpbkluZm86IFBsdWdpbkluZm8gPSB7XG4gICAgICAgICAgaWQ6IG1hbmlmZXN0Lm1ldGFkYXRhLmlkLFxuICAgICAgICAgIG5hbWU6IG1hbmlmZXN0Lm1ldGFkYXRhLm5hbWUsXG4gICAgICAgICAgdmVyc2lvbjogbWFuaWZlc3QubWV0YWRhdGEudmVyc2lvbixcbiAgICAgICAgICBkZXNjcmlwdGlvbjogbWFuaWZlc3QubWV0YWRhdGEuZGVzY3JpcHRpb24gfHwgJycsXG4gICAgICAgICAgYXV0aG9yOiBtYW5pZmVzdC5tZXRhZGF0YS5hdXRob3IgfHwgJycsXG4gICAgICAgICAgZG93bmxvYWRzOiAwLCAvLyBXb3VsZCBiZSBmZXRjaGVkIGZyb20gcmVnaXN0cnlcbiAgICAgICAgICByYXRpbmc6IDAsIC8vIFdvdWxkIGJlIGZldGNoZWQgZnJvbSByZWdpc3RyeVxuICAgICAgICAgIHRhZ3M6IG1hbmlmZXN0Lm1ldGFkYXRhLmtleXdvcmRzIHx8IFtdLFxuICAgICAgICAgIHNjcmVlbnNob3RzOiBbXSxcbiAgICAgICAgICByZWFkbWU6IHRoaXMuZ2V0UmVhZG1lKG1hbmlmZXN0LnBhdGgpLFxuICAgICAgICAgIGNoYW5nZWxvZzogdGhpcy5nZXRDaGFuZ2Vsb2cobWFuaWZlc3QucGF0aCksXG4gICAgICAgICAgbGljZW5zZTogbWFuaWZlc3QubWV0YWRhdGEubGljZW5zZSB8fCAnJyxcbiAgICAgICAgICByZXBvc2l0b3J5OiBtYW5pZmVzdC5tZXRhZGF0YS5yZXBvc2l0b3J5IHx8ICcnLFxuICAgICAgICAgIGhvbWVwYWdlOiBtYW5pZmVzdC5tZXRhZGF0YS5ob21lcGFnZSB8fCAnJyxcbiAgICAgICAgICBidWdzOiAnJyxcbiAgICAgICAgICBkZXBlbmRlbmNpZXM6IG1hbmlmZXN0LnBhY2thZ2VKc29uLmRlcGVuZGVuY2llcyB8fCB7fSxcbiAgICAgICAgICBwZWVyRGVwZW5kZW5jaWVzOiBtYW5pZmVzdC5wYWNrYWdlSnNvbi5wZWVyRGVwZW5kZW5jaWVzIHx8IHt9LFxuICAgICAgICAgIHB1Ymxpc2hlZEF0OiBuZXcgRGF0ZShmcy5zdGF0U3luYyhtYW5pZmVzdC5wYXRoKS5iaXJ0aHRpbWUpLFxuICAgICAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoZnMuc3RhdFN5bmMobWFuaWZlc3QucGF0aCkubXRpbWUpXG4gICAgICAgIH07XG4gICAgICAgIFxuICAgICAgICBwbHVnaW5zLnB1c2gocGx1Z2luSW5mbyk7XG4gICAgICB9XG4gICAgICBcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGxpc3QgaW5zdGFsbGVkIHBsdWdpbnM6JywgZXJyb3IpO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4gcGx1Z2lucztcbiAgfVxuXG4gIHByaXZhdGUgZ2V0TW9ja1BsdWdpbnMoKTogUGx1Z2luSW5mb1tdIHtcbiAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuICAgIGNvbnN0IHdlZWtBZ28gPSBuZXcgRGF0ZShub3cuZ2V0VGltZSgpIC0gNyAqIDI0ICogNjAgKiA2MCAqIDEwMDApO1xuICAgIFxuICAgIHJldHVybiBbXG4gICAgICB7XG4gICAgICAgIGlkOiAnZ2l0LWVuaGFuY2VkLWFuYWx5emVyJyxcbiAgICAgICAgbmFtZTogJ0dpdCBFbmhhbmNlZCBBbmFseXplcicsXG4gICAgICAgIHZlcnNpb246ICcxLjIuMCcsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnQWR2YW5jZWQgR2l0IGFuYWx5c2lzIHdpdGggY29tbWl0IHBhdHRlcm4gcmVjb2duaXRpb24gYW5kIGJyYW5jaCBvcHRpbWl6YXRpb24gc3VnZ2VzdGlvbnMnLFxuICAgICAgICBhdXRob3I6ICdBSSBEZWJ1ZyBDb21tdW5pdHknLFxuICAgICAgICBkb3dubG9hZHM6IDEyNTAsXG4gICAgICAgIHJhdGluZzogNC44LFxuICAgICAgICB0YWdzOiBbJ2dpdCcsICdhbmFseXNpcycsICd2Y3MnLCAnb3B0aW1pemF0aW9uJ10sXG4gICAgICAgIHNjcmVlbnNob3RzOiBbXSxcbiAgICAgICAgcmVhZG1lOiAnIyBHaXQgRW5oYW5jZWQgQW5hbHl6ZXJcXG5cXG5BZHZhbmNlZCBHaXQgYW5hbHlzaXMgcGx1Z2luLi4uJyxcbiAgICAgICAgY2hhbmdlbG9nOiAnIyMgMS4yLjBcXG4tIEFkZGVkIGJyYW5jaCBvcHRpbWl6YXRpb25cXG4tIEltcHJvdmVkIGNvbW1pdCBhbmFseXNpcycsXG4gICAgICAgIGxpY2Vuc2U6ICdNSVQnLFxuICAgICAgICByZXBvc2l0b3J5OiAnaHR0cHM6Ly9naXRodWIuY29tL2FpLWRlYnVnL2dpdC1lbmhhbmNlZC1hbmFseXplcicsXG4gICAgICAgIGhvbWVwYWdlOiAnaHR0cHM6Ly9haS1kZWJ1Zy5jb20vcGx1Z2lucy9naXQtZW5oYW5jZWQtYW5hbHl6ZXInLFxuICAgICAgICBidWdzOiAnaHR0cHM6Ly9naXRodWIuY29tL2FpLWRlYnVnL2dpdC1lbmhhbmNlZC1hbmFseXplci9pc3N1ZXMnLFxuICAgICAgICBkZXBlbmRlbmNpZXM6IHtcbiAgICAgICAgICAnc2ltcGxlLWdpdCc6ICdeMy4wLjAnLFxuICAgICAgICAgICdtb21lbnQnOiAnXjIuMjkuMCdcbiAgICAgICAgfSxcbiAgICAgICAgcGVlckRlcGVuZGVuY2llczoge30sXG4gICAgICAgIHB1Ymxpc2hlZEF0OiB3ZWVrQWdvLFxuICAgICAgICB1cGRhdGVkQXQ6IG5vd1xuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgaWQ6ICd0ZXN0LWNvdmVyYWdlLWluc2lnaHRzJyxcbiAgICAgICAgbmFtZTogJ1Rlc3QgQ292ZXJhZ2UgSW5zaWdodHMnLFxuICAgICAgICB2ZXJzaW9uOiAnMi4xLjMnLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ0ludGVsbGlnZW50IHRlc3QgY292ZXJhZ2UgYW5hbHlzaXMgd2l0aCBBSS1wb3dlcmVkIHN1Z2dlc3Rpb25zIGZvciBpbXByb3ZpbmcgdGVzdCBxdWFsaXR5JyxcbiAgICAgICAgYXV0aG9yOiAnVGVzdEJvdCBJbmMuJyxcbiAgICAgICAgZG93bmxvYWRzOiAyMTAwLFxuICAgICAgICByYXRpbmc6IDQuNixcbiAgICAgICAgdGFnczogWyd0ZXN0aW5nJywgJ2NvdmVyYWdlJywgJ3F1YWxpdHknLCAnYWknXSxcbiAgICAgICAgc2NyZWVuc2hvdHM6IFtdLFxuICAgICAgICByZWFkbWU6ICcjIFRlc3QgQ292ZXJhZ2UgSW5zaWdodHNcXG5cXG5JbnRlbGxpZ2VudCB0ZXN0IGNvdmVyYWdlIGFuYWx5c2lzLi4uJyxcbiAgICAgICAgY2hhbmdlbG9nOiAnIyMgMi4xLjNcXG4tIEZpeGVkIGNvdmVyYWdlIGNhbGN1bGF0aW9uXFxuLSBBZGRlZCBBSSBzdWdnZXN0aW9ucycsXG4gICAgICAgIGxpY2Vuc2U6ICdBcGFjaGUtMi4wJyxcbiAgICAgICAgcmVwb3NpdG9yeTogJ2h0dHBzOi8vZ2l0aHViLmNvbS90ZXN0Ym90L3Rlc3QtY292ZXJhZ2UtaW5zaWdodHMnLFxuICAgICAgICBob21lcGFnZTogJ2h0dHBzOi8vdGVzdGJvdC5jb20vcGx1Z2lucy9jb3ZlcmFnZS1pbnNpZ2h0cycsXG4gICAgICAgIGJ1Z3M6ICdodHRwczovL2dpdGh1Yi5jb20vdGVzdGJvdC90ZXN0LWNvdmVyYWdlLWluc2lnaHRzL2lzc3VlcycsXG4gICAgICAgIGRlcGVuZGVuY2llczoge1xuICAgICAgICAgICdpc3RhbmJ1bCc6ICdeMC40LjUnLFxuICAgICAgICAgICdueWMnOiAnXjE1LjAuMCdcbiAgICAgICAgfSxcbiAgICAgICAgcGVlckRlcGVuZGVuY2llczoge30sXG4gICAgICAgIHB1Ymxpc2hlZEF0OiB3ZWVrQWdvLFxuICAgICAgICB1cGRhdGVkQXQ6IG5vd1xuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgaWQ6ICdwZXJmb3JtYW5jZS1wcm9maWxlcicsXG4gICAgICAgIG5hbWU6ICdQZXJmb3JtYW5jZSBQcm9maWxlcicsXG4gICAgICAgIHZlcnNpb246ICcxLjAuNScsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnUmVhbC10aW1lIHBlcmZvcm1hbmNlIG1vbml0b3JpbmcgYW5kIG9wdGltaXphdGlvbiBzdWdnZXN0aW9ucyBmb3IgeW91ciBkZXZlbG9wbWVudCB3b3JrZmxvdycsXG4gICAgICAgIGF1dGhvcjogJ1NwZWVkRGV2JyxcbiAgICAgICAgZG93bmxvYWRzOiA4OTAsXG4gICAgICAgIHJhdGluZzogNC4zLFxuICAgICAgICB0YWdzOiBbJ3BlcmZvcm1hbmNlJywgJ3Byb2ZpbGluZycsICdvcHRpbWl6YXRpb24nLCAnbW9uaXRvcmluZyddLFxuICAgICAgICBzY3JlZW5zaG90czogW10sXG4gICAgICAgIHJlYWRtZTogJyMgUGVyZm9ybWFuY2UgUHJvZmlsZXJcXG5cXG5SZWFsLXRpbWUgcGVyZm9ybWFuY2UgbW9uaXRvcmluZy4uLicsXG4gICAgICAgIGNoYW5nZWxvZzogJyMjIDEuMC41XFxuLSBBZGRlZCBtZW1vcnkgcHJvZmlsaW5nXFxuLSBQZXJmb3JtYW5jZSBpbXByb3ZlbWVudHMnLFxuICAgICAgICBsaWNlbnNlOiAnTUlUJyxcbiAgICAgICAgcmVwb3NpdG9yeTogJ2h0dHBzOi8vZ2l0aHViLmNvbS9zcGVlZGRldi9wZXJmb3JtYW5jZS1wcm9maWxlcicsXG4gICAgICAgIGhvbWVwYWdlOiAnaHR0cHM6Ly9zcGVlZGRldi5jb20vcGx1Z2lucy9wZXJmb3JtYW5jZS1wcm9maWxlcicsXG4gICAgICAgIGJ1Z3M6ICdodHRwczovL2dpdGh1Yi5jb20vc3BlZWRkZXYvcGVyZm9ybWFuY2UtcHJvZmlsZXIvaXNzdWVzJyxcbiAgICAgICAgZGVwZW5kZW5jaWVzOiB7XG4gICAgICAgICAgJ3BlcmZfaG9va3MnOiAnXjEuMC4wJyxcbiAgICAgICAgICAndjgtcHJvZmlsZXInOiAnXjUuNy4wJ1xuICAgICAgICB9LFxuICAgICAgICBwZWVyRGVwZW5kZW5jaWVzOiB7fSxcbiAgICAgICAgcHVibGlzaGVkQXQ6IHdlZWtBZ28sXG4gICAgICAgIHVwZGF0ZWRBdDogbm93XG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBpZDogJ2FpLWNvZGUtcmV2aWV3ZXInLFxuICAgICAgICBuYW1lOiAnQUkgQ29kZSBSZXZpZXdlcicsXG4gICAgICAgIHZlcnNpb246ICczLjAuMScsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnQUktcG93ZXJlZCBjb2RlIHJldmlldyB3aXRoIHNtYXJ0IHN1Z2dlc3Rpb25zLCBidWcgZGV0ZWN0aW9uLCBhbmQgY29kZSBxdWFsaXR5IGFuYWx5c2lzJyxcbiAgICAgICAgYXV0aG9yOiAnQ29kZUFJIExhYnMnLFxuICAgICAgICBkb3dubG9hZHM6IDMyMDAsXG4gICAgICAgIHJhdGluZzogNC45LFxuICAgICAgICB0YWdzOiBbJ2FpJywgJ2NvZGUtcmV2aWV3JywgJ3F1YWxpdHknLCAnYnVncycsICdhbmFseXNpcyddLFxuICAgICAgICBzY3JlZW5zaG90czogW10sXG4gICAgICAgIHJlYWRtZTogJyMgQUkgQ29kZSBSZXZpZXdlclxcblxcbkFJLXBvd2VyZWQgY29kZSByZXZpZXcuLi4nLFxuICAgICAgICBjaGFuZ2Vsb2c6ICcjIyAzLjAuMVxcbi0gRW5oYW5jZWQgQUkgbW9kZWxcXG4tIEJldHRlciBidWcgZGV0ZWN0aW9uJyxcbiAgICAgICAgbGljZW5zZTogJ0NvbW1lcmNpYWwnLFxuICAgICAgICByZXBvc2l0b3J5OiAnaHR0cHM6Ly9naXRodWIuY29tL2NvZGVhaS9haS1jb2RlLXJldmlld2VyJyxcbiAgICAgICAgaG9tZXBhZ2U6ICdodHRwczovL2NvZGVhaS5jb20vcGx1Z2lucy9haS1jb2RlLXJldmlld2VyJyxcbiAgICAgICAgYnVnczogJ2h0dHBzOi8vZ2l0aHViLmNvbS9jb2RlYWkvYWktY29kZS1yZXZpZXdlci9pc3N1ZXMnLFxuICAgICAgICBkZXBlbmRlbmNpZXM6IHtcbiAgICAgICAgICAnb3BlbmFpJzogJ140LjAuMCcsXG4gICAgICAgICAgJ3R5cGVzY3JpcHQnOiAnXjUuMC4wJ1xuICAgICAgICB9LFxuICAgICAgICBwZWVyRGVwZW5kZW5jaWVzOiB7fSxcbiAgICAgICAgcHVibGlzaGVkQXQ6IHdlZWtBZ28sXG4gICAgICAgIHVwZGF0ZWRBdDogbm93XG4gICAgICB9XG4gICAgXTtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0RGVmYXVsdENhcGFiaWxpdGllcyhwbHVnaW5JbmZvOiBQbHVnaW5JbmZvKTogYW55W10ge1xuICAgIGNvbnN0IGNhcGFiaWxpdGllcyA9IFtdO1xuICAgIFxuICAgIC8vIEFkZCBjYXBhYmlsaXRpZXMgYmFzZWQgb24gcGx1Z2luIHRhZ3NcbiAgICBpZiAocGx1Z2luSW5mby50YWdzLmluY2x1ZGVzKCdnaXQnKSkge1xuICAgICAgY2FwYWJpbGl0aWVzLnB1c2goe1xuICAgICAgICB0eXBlOiAnYW5hbHl6ZXInLFxuICAgICAgICBuYW1lOiAnZ2l0LWFuYWx5emVyJyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdBbmFseXplIEdpdCByZXBvc2l0b3JpZXMgYW5kIGNvbW1pdHMnXG4gICAgICB9KTtcbiAgICB9XG4gICAgXG4gICAgaWYgKHBsdWdpbkluZm8udGFncy5pbmNsdWRlcygndGVzdGluZycpKSB7XG4gICAgICBjYXBhYmlsaXRpZXMucHVzaCh7XG4gICAgICAgIHR5cGU6ICdhbmFseXplcicsXG4gICAgICAgIG5hbWU6ICd0ZXN0LWFuYWx5emVyJyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdBbmFseXplIHRlc3QgcmVzdWx0cyBhbmQgY292ZXJhZ2UnXG4gICAgICB9KTtcbiAgICB9XG4gICAgXG4gICAgaWYgKHBsdWdpbkluZm8udGFncy5pbmNsdWRlcygncGVyZm9ybWFuY2UnKSkge1xuICAgICAgY2FwYWJpbGl0aWVzLnB1c2goe1xuICAgICAgICB0eXBlOiAnYW5hbHl6ZXInLFxuICAgICAgICBuYW1lOiAncGVyZm9ybWFuY2UtYW5hbHl6ZXInLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ0FuYWx5emUgcGVyZm9ybWFuY2UgbWV0cmljcydcbiAgICAgIH0pO1xuICAgIH1cbiAgICBcbiAgICBpZiAocGx1Z2luSW5mby50YWdzLmluY2x1ZGVzKCdhaScpKSB7XG4gICAgICBjYXBhYmlsaXRpZXMucHVzaCh7XG4gICAgICAgIHR5cGU6ICdhaS1wcm92aWRlcicsXG4gICAgICAgIG5hbWU6ICdhaS1wcm92aWRlcicsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnUHJvdmlkZSBBSS1wb3dlcmVkIGluc2lnaHRzJ1xuICAgICAgfSk7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiBjYXBhYmlsaXRpZXM7XG4gIH1cblxuICBwcml2YXRlIGdlbmVyYXRlUGx1Z2luQ29kZShwbHVnaW5JbmZvOiBQbHVnaW5JbmZvKTogc3RyaW5nIHtcbiAgICBjb25zdCBjbGFzc05hbWUgPSB0aGlzLnRvUGFzY2FsQ2FzZShwbHVnaW5JbmZvLmlkKTtcbiAgICBcbiAgICByZXR1cm4gYFxuY2xhc3MgJHtjbGFzc05hbWV9IHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5tZXRhZGF0YSA9IHtcbiAgICAgIGlkOiAnJHtwbHVnaW5JbmZvLmlkfScsXG4gICAgICBuYW1lOiAnJHtwbHVnaW5JbmZvLm5hbWV9JyxcbiAgICAgIHZlcnNpb246ICcke3BsdWdpbkluZm8udmVyc2lvbn0nLFxuICAgICAgZGVzY3JpcHRpb246ICcke3BsdWdpbkluZm8uZGVzY3JpcHRpb259JyxcbiAgICAgIGF1dGhvcjogJyR7cGx1Z2luSW5mby5hdXRob3J9JyxcbiAgICAgIGxpY2Vuc2U6ICcke3BsdWdpbkluZm8ubGljZW5zZX0nLFxuICAgICAgZW5hYmxlZDogdHJ1ZSxcbiAgICAgIGNhcGFiaWxpdGllczogJHtKU09OLnN0cmluZ2lmeSh0aGlzLmdldERlZmF1bHRDYXBhYmlsaXRpZXMocGx1Z2luSW5mbyksIG51bGwsIDYpfVxuICAgIH07XG4gIH1cblxuICBhc3luYyBhY3RpdmF0ZShhcGksIGNvbnRleHQpIHtcbiAgICBjb25zb2xlLmxvZygnJHtwbHVnaW5JbmZvLm5hbWV9IHBsdWdpbiBhY3RpdmF0ZWQnKTtcbiAgICBcbiAgICAvLyBSZWdpc3RlciBwbHVnaW4gY2FwYWJpbGl0aWVzXG4gICAgaWYgKHRoaXMuY29tbWFuZHMpIHtcbiAgICAgIGZvciAoY29uc3QgY29tbWFuZCBvZiB0aGlzLmNvbW1hbmRzKSB7XG4gICAgICAgIGFwaS5yZWdpc3RlckNvbW1hbmQoY29tbWFuZCk7XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIGlmICh0aGlzLmFuYWx5emVycykge1xuICAgICAgZm9yIChjb25zdCBhbmFseXplciBvZiB0aGlzLmFuYWx5emVycykge1xuICAgICAgICBhcGkucmVnaXN0ZXJBbmFseXplcihhbmFseXplcik7XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8vIFBsdWdpbi1zcGVjaWZpYyBpbml0aWFsaXphdGlvblxuICAgIGF3YWl0IHRoaXMuaW5pdGlhbGl6ZShhcGksIGNvbnRleHQpO1xuICB9XG5cbiAgYXN5bmMgZGVhY3RpdmF0ZShhcGksIGNvbnRleHQpIHtcbiAgICBjb25zb2xlLmxvZygnJHtwbHVnaW5JbmZvLm5hbWV9IHBsdWdpbiBkZWFjdGl2YXRlZCcpO1xuICAgIFxuICAgIC8vIENsZWFudXAgcGx1Z2luIHJlc291cmNlc1xuICAgIGF3YWl0IHRoaXMuY2xlYW51cChhcGksIGNvbnRleHQpO1xuICB9XG5cbiAgYXN5bmMgaW5pdGlhbGl6ZShhcGksIGNvbnRleHQpIHtcbiAgICAvLyBQbHVnaW4tc3BlY2lmaWMgaW5pdGlhbGl6YXRpb24gbG9naWNcbiAgICBjb25zb2xlLmxvZygnSW5pdGlhbGl6aW5nICR7cGx1Z2luSW5mby5uYW1lfS4uLicpO1xuICB9XG5cbiAgYXN5bmMgY2xlYW51cChhcGksIGNvbnRleHQpIHtcbiAgICAvLyBQbHVnaW4tc3BlY2lmaWMgY2xlYW51cCBsb2dpY1xuICAgIGNvbnNvbGUubG9nKCdDbGVhbmluZyB1cCAke3BsdWdpbkluZm8ubmFtZX0uLi4nKTtcbiAgfVxuXG4gIC8vIEV4YW1wbGUgYW5hbHl6ZXIgKGlmIHBsdWdpbiBoYXMgYW5hbHlzaXMgY2FwYWJpbGl0aWVzKVxuICBnZXQgYW5hbHl6ZXJzKCkge1xuICAgIHJldHVybiBbXG4gICAgICB7XG4gICAgICAgIGlkOiAnJHtwbHVnaW5JbmZvLmlkfS1hbmFseXplcicsXG4gICAgICAgIG5hbWU6ICcke3BsdWdpbkluZm8ubmFtZX0gQW5hbHl6ZXInLFxuICAgICAgICBkZXNjcmlwdGlvbjogJyR7cGx1Z2luSW5mby5kZXNjcmlwdGlvbn0nLFxuICAgICAgICBmaWxlUGF0dGVybnM6IFsnKiovKiddLFxuICAgICAgICBcbiAgICAgICAgYXN5bmMgYW5hbHl6ZShjb250ZW50LCBmaWxlUGF0aCwgY29udGV4dCkge1xuICAgICAgICAgIC8vIEltcGxlbWVudCBhbmFseXNpcyBsb2dpYyBoZXJlXG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGlzc3VlczogW10sXG4gICAgICAgICAgICBtZXRyaWNzOiB7fSxcbiAgICAgICAgICAgIHN1Z2dlc3Rpb25zOiBbXSxcbiAgICAgICAgICAgIGNvbmZpZGVuY2U6IDAuOFxuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICBdO1xuICB9XG5cbiAgLy8gRXhhbXBsZSBjb21tYW5kcyAoaWYgcGx1Z2luIGhhcyBjb21tYW5kIGNhcGFiaWxpdGllcylcbiAgZ2V0IGNvbW1hbmRzKCkge1xuICAgIHJldHVybiBbXG4gICAgICB7XG4gICAgICAgIGlkOiAnJHtwbHVnaW5JbmZvLmlkfS1jb21tYW5kJyxcbiAgICAgICAgdGl0bGU6ICcke3BsdWdpbkluZm8ubmFtZX0gQ29tbWFuZCcsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnRXhlY3V0ZSAke3BsdWdpbkluZm8ubmFtZX0gZnVuY3Rpb25hbGl0eScsXG4gICAgICAgIGNhdGVnb3J5OiAnQUkgRGVidWcnLFxuICAgICAgICBcbiAgICAgICAgYXN5bmMgZXhlY3V0ZShjb250ZXh0LCBhcmdzKSB7XG4gICAgICAgICAgLy8gSW1wbGVtZW50IGNvbW1hbmQgbG9naWMgaGVyZVxuICAgICAgICAgIHJldHVybiAnQ29tbWFuZCBleGVjdXRlZCBzdWNjZXNzZnVsbHknO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgXTtcbiAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9ICR7Y2xhc3NOYW1lfTtcbiAgICBgLnRyaW0oKTtcbiAgfVxuXG4gIHByaXZhdGUgZ2VuZXJhdGVSZWFkbWUocGx1Z2luSW5mbzogUGx1Z2luSW5mbyk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGBcbiMgJHtwbHVnaW5JbmZvLm5hbWV9XG5cbiR7cGx1Z2luSW5mby5kZXNjcmlwdGlvbn1cblxuIyMgSW5zdGFsbGF0aW9uXG5cbkluc3RhbGwgdGhpcyBwbHVnaW4gdGhyb3VnaCB0aGUgQUkgRGVidWcgUGx1Z2luIE1hcmtldHBsYWNlOlxuXG4xLiBPcGVuIEFJIERlYnVnIGV4dGVuc2lvblxuMi4gR28gdG8gUGx1Z2luIE1hcmtldHBsYWNlXG4zLiBTZWFyY2ggZm9yIFwiJHtwbHVnaW5JbmZvLm5hbWV9XCJcbjQuIENsaWNrIEluc3RhbGxcblxuIyMgVXNhZ2VcblxuQWZ0ZXIgaW5zdGFsbGF0aW9uLCB0aGUgcGx1Z2luIHdpbGwgYmUgYXV0b21hdGljYWxseSBhY3RpdmF0ZWQgYW5kIGl0cyBmZWF0dXJlcyB3aWxsIGJlIGF2YWlsYWJsZSBpbiB0aGUgQUkgRGVidWcgZXh0ZW5zaW9uLlxuXG4jIyBGZWF0dXJlc1xuXG4tIEFkdmFuY2VkIGFuYWx5c2lzIGNhcGFiaWxpdGllc1xuLSBTbWFydCBzdWdnZXN0aW9ucyBhbmQgaW5zaWdodHNcbi0gU2VhbWxlc3MgaW50ZWdyYXRpb24gd2l0aCBBSSBEZWJ1ZyB3b3JrZmxvd1xuXG4jIyBDb25maWd1cmF0aW9uXG5cblRoZSBwbHVnaW4gY2FuIGJlIGNvbmZpZ3VyZWQgdGhyb3VnaCB0aGUgQUkgRGVidWcgc2V0dGluZ3MgcGFuZWwuXG5cbiMjIFN1cHBvcnRcblxuRm9yIGlzc3VlcyBhbmQgcXVlc3Rpb25zLCBwbGVhc2UgdmlzaXQ6ICR7cGx1Z2luSW5mby5idWdzIHx8ICdOL0EnfVxuXG4jIyBMaWNlbnNlXG5cbiR7cGx1Z2luSW5mby5saWNlbnNlfVxuICAgIGAudHJpbSgpO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRSZWFkbWUocGx1Z2luUGF0aDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICBjb25zdCByZWFkbWVQYXRoID0gcGF0aC5qb2luKHBsdWdpblBhdGgsICdSRUFETUUubWQnKTtcbiAgICBpZiAoZnMuZXhpc3RzU3luYyhyZWFkbWVQYXRoKSkge1xuICAgICAgcmV0dXJuIGZzLnJlYWRGaWxlU3luYyhyZWFkbWVQYXRoLCAndXRmOCcpO1xuICAgIH1cbiAgICByZXR1cm4gJyc7XG4gIH1cblxuICBwcml2YXRlIGdldENoYW5nZWxvZyhwbHVnaW5QYXRoOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIGNvbnN0IGNoYW5nZWxvZ1BhdGggPSBwYXRoLmpvaW4ocGx1Z2luUGF0aCwgJ0NIQU5HRUxPRy5tZCcpO1xuICAgIGlmIChmcy5leGlzdHNTeW5jKGNoYW5nZWxvZ1BhdGgpKSB7XG4gICAgICByZXR1cm4gZnMucmVhZEZpbGVTeW5jKGNoYW5nZWxvZ1BhdGgsICd1dGY4Jyk7XG4gICAgfVxuICAgIHJldHVybiAnJztcbiAgfVxuXG4gIHByaXZhdGUgdG9QYXNjYWxDYXNlKHN0cjogc3RyaW5nKTogc3RyaW5nIHtcbiAgICByZXR1cm4gc3RyXG4gICAgICAucmVwbGFjZSgvWy1fXS9nLCAnICcpXG4gICAgICAucmVwbGFjZSgvXFx3XFxTKi9nLCAodHh0KSA9PiB0eHQuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyB0eHQuc3Vic3RyKDEpLnRvTG93ZXJDYXNlKCkpXG4gICAgICAucmVwbGFjZSgvXFxzL2csICcnKTtcbiAgfVxufVxuIl0sInZlcnNpb24iOjN9