f1b802a4170e234a27a07b690fc8b927
"use strict";
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
exports.GitAnalyzerPlugin = void 0;
const vscode = __importStar(require("vscode"));
class GitAnalyzerPlugin {
    metadata = {
        id: 'builtin-git-analyzer',
        name: 'Git Analyzer',
        version: '1.0.0',
        description: 'Analyze Git repositories, commits, and provide insights for better version control',
        author: 'AI Debug Team',
        license: 'MIT',
        enabled: true,
        capabilities: [
            {
                type: 'analyzer',
                name: 'git-analyzer',
                description: 'Analyze Git repositories and commits',
                permissions: ['workspace-access:git:Analyze Git repository status and history']
            },
            {
                type: 'command',
                name: 'git-insights',
                description: 'Generate Git insights and recommendations'
            }
        ]
    };
    api;
    get analyzers() {
        return [
            {
                id: 'git-commit-analyzer',
                name: 'Git Commit Analyzer',
                description: 'Analyze Git commit messages and patterns',
                filePatterns: ['.git/**/*', '**/.git/**/*'],
                analyze: async (content, filePath, context) => {
                    const issues = [];
                    const metrics = {};
                    const suggestions = [];
                    try {
                        // Analyze commit history
                        const commitAnalysis = await this.analyzeCommitHistory(context);
                        issues.push(...commitAnalysis.issues);
                        Object.assign(metrics, commitAnalysis.metrics);
                        suggestions.push(...commitAnalysis.suggestions);
                        // Analyze branch structure
                        const branchAnalysis = await this.analyzeBranches(context);
                        issues.push(...branchAnalysis.issues);
                        Object.assign(metrics, branchAnalysis.metrics);
                        suggestions.push(...branchAnalysis.suggestions);
                        // Analyze file changes
                        const changesAnalysis = await this.analyzeChanges(context);
                        issues.push(...changesAnalysis.issues);
                        Object.assign(metrics, changesAnalysis.metrics);
                        suggestions.push(...changesAnalysis.suggestions);
                    }
                    catch (error) {
                        issues.push({
                            type: 'error',
                            message: `Git analysis failed: ${error.message}`,
                            severity: 'medium'
                        });
                    }
                    return {
                        id: 'git-analysis',
                        summary: 'Git repository analysis completed',
                        issues,
                        metrics,
                        suggestions,
                        confidence: 0.85
                    };
                }
            }
        ];
    }
    get commands() {
        return [
            {
                id: 'git-health-check',
                title: 'Git Health Check',
                description: 'Perform comprehensive Git repository health check',
                category: 'Git',
                icon: 'git-branch',
                execute: async (context, args) => {
                    const healthReport = await this.performHealthCheck(context);
                    // Show results in a new document
                    const doc = await vscode.workspace.openTextDocument({
                        content: this.formatHealthReport(healthReport),
                        language: 'markdown'
                    });
                    await vscode.window.showTextDocument(doc);
                    return healthReport;
                }
            },
            {
                id: 'git-optimize-workflow',
                title: 'Optimize Git Workflow',
                description: 'Analyze and suggest Git workflow optimizations',
                category: 'Git',
                icon: 'arrow-up',
                execute: async (context, args) => {
                    const optimizations = await this.suggestWorkflowOptimizations(context);
                    // Show optimization suggestions
                    const items = optimizations.map(opt => ({
                        label: opt.title,
                        description: opt.description,
                        detail: opt.impact
                    }));
                    const selected = await vscode.window.showQuickPick(items, {
                        placeHolder: 'Select optimization to apply',
                        canPickMany: false
                    });
                    if (selected) {
                        const optimization = optimizations.find(opt => opt.title === selected.label);
                        if (optimization) {
                            await this.applyOptimization(optimization, context);
                        }
                    }
                    return optimizations;
                }
            }
        ];
    }
    async activate(api, context) {
        this.api = api;
        // Register analyzers
        for (const analyzer of this.analyzers) {
            api.registerAnalyzer?.(analyzer);
        }
        // Register commands
        for (const command of this.commands) {
            api.registerCommand(command.id, command.execute);
        }
        // Listen for Git events
        api.on?.('git:commit', (data) => this.onGitCommit(data, context));
        api.on?.('git:branch-changed', (data) => this.onBranchChanged(data, context));
        console.log('Git Analyzer Plugin activated');
    }
    async deactivate(api, context) {
        // Cleanup
        api.off?.('git:commit');
        api.off?.('git:branch-changed');
        console.log('Git Analyzer Plugin deactivated');
    }
    async analyzeCommitHistory(context) {
        const issues = [];
        const metrics = {};
        const suggestions = [];
        // Simulate Git commit analysis
        const recentCommits = await this.getRecentCommits(context);
        // Analyze commit message quality
        let poorCommitMessages = 0;
        let longCommitMessages = 0;
        for (const commit of recentCommits) {
            if (commit.message.length < 10) {
                poorCommitMessages++;
            }
            if (commit.message.length > 72) {
                longCommitMessages++;
            }
        }
        metrics['total-commits'] = recentCommits.length;
        metrics['poor-commit-messages'] = poorCommitMessages;
        metrics['long-commit-messages'] = longCommitMessages;
        if (poorCommitMessages > 0) {
            issues.push({
                type: 'warning',
                message: `Found ${poorCommitMessages} commit(s) with poor messages`,
                severity: 'low'
            });
            suggestions.push('Use conventional commit format: type(scope): description');
        }
        if (longCommitMessages > 0) {
            issues.push({
                type: 'info',
                message: `Found ${longCommitMessages} commit(s) with long messages`,
                severity: 'low'
            });
        }
        // Analyze commit frequency
        const commitFrequency = this.analyzeCommitFrequency(recentCommits);
        metrics['commits-per-day'] = commitFrequency.daily;
        metrics['commits-per-week'] = commitFrequency.weekly;
        if (commitFrequency.daily < 0.5) {
            suggestions.push('Consider more frequent commits for better version control');
        }
        return {
            id: 'commit-analysis',
            summary: 'Commit history analysis completed',
            issues,
            metrics,
            suggestions,
            confidence: 0.9
        };
    }
    async analyzeBranches(context) {
        const issues = [];
        const metrics = {};
        const suggestions = [];
        // Simulate branch analysis
        const branches = await this.getBranches(context);
        const staleBranches = branches.filter(b => this.isStaleBranch(b));
        metrics['total-branches'] = branches.length;
        metrics['stale-branches'] = staleBranches.length;
        if (staleBranches.length > 0) {
            issues.push({
                type: 'warning',
                message: `Found ${staleBranches.length} stale branch(es)`,
                severity: 'medium'
            });
            suggestions.push('Clean up old branches to maintain a tidy repository');
        }
        if (branches.length > 20) {
            issues.push({
                type: 'info',
                message: `Repository has ${branches.length} branches`,
                severity: 'low'
            });
        }
        return {
            id: 'branch-analysis',
            summary: 'Branch analysis completed',
            issues,
            metrics,
            suggestions,
            confidence: 0.8
        };
    }
    async analyzeChanges(context) {
        const issues = [];
        const metrics = {};
        const suggestions = [];
        // Analyze uncommitted changes
        const uncommittedFiles = await this.getUncommittedFiles(context);
        metrics['uncommitted-files'] = uncommittedFiles.length;
        if (uncommittedFiles.length > 10) {
            issues.push({
                type: 'warning',
                message: `${uncommittedFiles.length} files with uncommitted changes`,
                severity: 'medium'
            });
        }
        // Analyze file sizes
        const largeFiles = uncommittedFiles.filter(f => this.isLargeFile(f));
        metrics['large-uncommitted-files'] = largeFiles.length;
        if (largeFiles.length > 0) {
            issues.push({
                type: 'warning',
                message: `${largeFiles.length} large file(s) with uncommitted changes`,
                severity: 'high'
            });
            suggestions.push('Use Git LFS for files larger than 100MB');
        }
        return {
            id: 'changes-analysis',
            summary: 'Changes analysis completed',
            issues,
            metrics,
            suggestions,
            confidence: 0.85
        };
    }
    async performHealthCheck(context) {
        const health = {
            overall: 'good',
            scores: {
                commitQuality: 0,
                branchHealth: 0,
                repositorySize: 0,
                workflowEfficiency: 0
            },
            recommendations: []
        };
        // Perform various health checks
        const commitAnalysis = await this.analyzeCommitHistory(context);
        health.scores.commitQuality = this.calculateCommitQualityScore(commitAnalysis);
        const branchAnalysis = await this.analyzeBranches(context);
        health.scores.branchHealth = this.calculateBranchHealthScore(branchAnalysis);
        // Overall score
        const overallScore = (health.scores.commitQuality +
            health.scores.branchHealth +
            health.scores.repositorySize +
            health.scores.workflowEfficiency) / 4;
        if (overallScore >= 0.8) {
            health.overall = 'excellent';
        }
        else if (overallScore >= 0.6) {
            health.overall = 'good';
        }
        else if (overallScore >= 0.4) {
            health.overall = 'fair';
        }
        else {
            health.overall = 'poor';
        }
        return health;
    }
    async suggestWorkflowOptimizations(context) {
        return [
            {
                title: 'Setup Git Hooks',
                description: 'Add pre-commit hooks for code quality checks',
                impact: 'High - prevents bad commits',
                action: 'setup-hooks'
            },
            {
                title: 'Configure Branch Protection',
                description: 'Setup branch protection rules for main branch',
                impact: 'Medium - improves code quality',
                action: 'branch-protection'
            },
            {
                title: 'Optimize .gitignore',
                description: 'Update .gitignore to exclude unnecessary files',
                impact: 'Low - reduces repository size',
                action: 'optimize-gitignore'
            }
        ];
    }
    async applyOptimization(optimization, context) {
        switch (optimization.action) {
            case 'setup-hooks':
                await this.setupGitHooks(context);
                break;
            case 'branch-protection':
                await this.setupBranchProtection(context);
                break;
            case 'optimize-gitignore':
                await this.optimizeGitignore(context);
                break;
            default:
                console.log(`Unknown optimization action: ${optimization.action}`);
        }
    }
    async getRecentCommits(context) {
        // Simulate Git log
        return [
            { hash: 'abc123', message: 'feat: add new feature', author: 'dev', date: new Date() },
            { hash: 'def456', message: 'fix bug', author: 'dev', date: new Date() },
            { hash: 'ghi789', message: 'update docs', author: 'dev', date: new Date() }
        ];
    }
    async getBranches(context) {
        // Simulate Git branch list
        return [
            { name: 'main', lastCommit: new Date(), active: true },
            { name: 'develop', lastCommit: new Date(Date.now() - 86400000), active: false },
            { name: 'feature/old', lastCommit: new Date(Date.now() - 86400000 * 30), active: false }
        ];
    }
    async getUncommittedFiles(context) {
        // Simulate Git status
        return [
            { path: 'src/main.ts', status: 'modified', size: 1024 },
            { path: 'README.md', status: 'modified', size: 2048 }
        ];
    }
    analyzeCommitFrequency(commits) {
        const now = new Date();
        const dayAgo = new Date(now.getTime() - 86400000);
        const weekAgo = new Date(now.getTime() - 86400000 * 7);
        const dailyCommits = commits.filter(c => c.date >= dayAgo).length;
        const weeklyCommits = commits.filter(c => c.date >= weekAgo).length;
        return {
            daily: dailyCommits,
            weekly: weeklyCommits
        };
    }
    isStaleBranch(branch) {
        const monthAgo = new Date(Date.now() - 86400000 * 30);
        return branch.lastCommit < monthAgo && !branch.active;
    }
    isLargeFile(file) {
        return file.size > 100 * 1024 * 1024; // 100MB
    }
    calculateCommitQualityScore(analysis) {
        const totalCommits = analysis.metrics?.['total-commits'] || 1;
        const poorCommits = analysis.metrics?.['poor-commit-messages'] || 0;
        const longCommits = analysis.metrics?.['long-commit-messages'] || 0;
        const qualityScore = 1 - (poorCommits + longCommits * 0.5) / totalCommits;
        return Math.max(0, Math.min(1, qualityScore));
    }
    calculateBranchHealthScore(analysis) {
        const totalBranches = analysis.metrics?.['total-branches'] || 1;
        const staleBranches = analysis.metrics?.['stale-branches'] || 0;
        const healthScore = 1 - (staleBranches / totalBranches);
        return Math.max(0, Math.min(1, healthScore));
    }
    formatHealthReport(health) {
        return `
# Git Repository Health Report

## Overall Health: ${health.overall.toUpperCase()}

## Scores
- **Commit Quality**: ${Math.round(health.scores.commitQuality * 100)}%
- **Branch Health**: ${Math.round(health.scores.branchHealth * 100)}%
- **Repository Size**: ${Math.round(health.scores.repositorySize * 100)}%
- **Workflow Efficiency**: ${Math.round(health.scores.workflowEfficiency * 100)}%

## Recommendations
${health.recommendations.map((rec) => `- ${rec}`).join('\n')}

---
*Generated by AI Debug Git Analyzer Plugin*
    `.trim();
    }
    async setupGitHooks(context) {
        // Implementation for setting up Git hooks
        this.api?.showNotification?.('Git hooks setup completed', 'info');
    }
    async setupBranchProtection(context) {
        // Implementation for setting up branch protection
        this.api?.showNotification?.('Branch protection configured', 'info');
    }
    async optimizeGitignore(context) {
        // Implementation for optimizing .gitignore
        this.api?.showNotification?.('.gitignore optimized', 'info');
    }
    async onGitCommit(data, context) {
        // Handle Git commit events
        console.log('Git commit detected:', data);
    }
    async onBranchChanged(data, context) {
        // Handle branch change events
        console.log('Branch changed:', data);
    }
}
exports.GitAnalyzerPlugin = GitAnalyzerPlugin;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2dyZWdkdW5uL3NyYy90ZXN0L2FpX2RlYnVnX2NvbnRleHQvdnNjb2RlL3NyYy9zZXJ2aWNlcy9wbHVnaW5zL2J1aWx0aW4vZ2l0QW5hbHl6ZXJQbHVnaW4udHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBV0EsK0NBQWlDO0FBSWpDLE1BQWEsaUJBQWlCO0lBQzVCLFFBQVEsR0FBbUI7UUFDekIsRUFBRSxFQUFFLHNCQUFzQjtRQUMxQixJQUFJLEVBQUUsY0FBYztRQUNwQixPQUFPLEVBQUUsT0FBTztRQUNoQixXQUFXLEVBQUUsb0ZBQW9GO1FBQ2pHLE1BQU0sRUFBRSxlQUFlO1FBQ3ZCLE9BQU8sRUFBRSxLQUFLO1FBQ2QsT0FBTyxFQUFFLElBQUk7UUFDYixZQUFZLEVBQUU7WUFDWjtnQkFDRSxJQUFJLEVBQUUsVUFBVTtnQkFDaEIsSUFBSSxFQUFFLGNBQWM7Z0JBQ3BCLFdBQVcsRUFBRSxzQ0FBc0M7Z0JBQ25ELFdBQVcsRUFBRSxDQUFDLGdFQUFnRSxDQUFDO2FBQ2hGO1lBQ0Q7Z0JBQ0UsSUFBSSxFQUFFLFNBQVM7Z0JBQ2YsSUFBSSxFQUFFLGNBQWM7Z0JBQ3BCLFdBQVcsRUFBRSwyQ0FBMkM7YUFDekQ7U0FDRjtLQUNGLENBQUM7SUFFTSxHQUFHLENBQWE7SUFFeEIsSUFBSSxTQUFTO1FBQ1gsT0FBTztZQUNMO2dCQUNFLEVBQUUsRUFBRSxxQkFBcUI7Z0JBQ3pCLElBQUksRUFBRSxxQkFBcUI7Z0JBQzNCLFdBQVcsRUFBRSwwQ0FBMEM7Z0JBQ3ZELFlBQVksRUFBRSxDQUFDLFdBQVcsRUFBRSxjQUFjLENBQUM7Z0JBRTNDLE9BQU8sRUFBRSxLQUFLLEVBQUUsT0FBZSxFQUFFLFFBQWdCLEVBQUUsT0FBc0IsRUFBMkIsRUFBRTtvQkFDcEcsTUFBTSxNQUFNLEdBQVksRUFBRSxDQUFDO29CQUMzQixNQUFNLE9BQU8sR0FBMkIsRUFBRSxDQUFDO29CQUMzQyxNQUFNLFdBQVcsR0FBYSxFQUFFLENBQUM7b0JBRWpDLElBQUksQ0FBQzt3QkFDSCx5QkFBeUI7d0JBQ3pCLE1BQU0sY0FBYyxHQUFHLE1BQU0sSUFBSSxDQUFDLG9CQUFvQixDQUFDLE9BQU8sQ0FBQyxDQUFDO3dCQUNoRSxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsY0FBYyxDQUFDLE1BQU0sQ0FBQyxDQUFDO3dCQUN0QyxNQUFNLENBQUMsTUFBTSxDQUFDLE9BQU8sRUFBRSxjQUFjLENBQUMsT0FBTyxDQUFDLENBQUM7d0JBQy9DLFdBQVcsQ0FBQyxJQUFJLENBQUMsR0FBRyxjQUFjLENBQUMsV0FBVyxDQUFDLENBQUM7d0JBRWhELDJCQUEyQjt3QkFDM0IsTUFBTSxjQUFjLEdBQUcsTUFBTSxJQUFJLENBQUMsZUFBZSxDQUFDLE9BQU8sQ0FBQyxDQUFDO3dCQUMzRCxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsY0FBYyxDQUFDLE1BQU0sQ0FBQyxDQUFDO3dCQUN0QyxNQUFNLENBQUMsTUFBTSxDQUFDLE9BQU8sRUFBRSxjQUFjLENBQUMsT0FBTyxDQUFDLENBQUM7d0JBQy9DLFdBQVcsQ0FBQyxJQUFJLENBQUMsR0FBRyxjQUFjLENBQUMsV0FBVyxDQUFDLENBQUM7d0JBRWhELHVCQUF1Qjt3QkFDdkIsTUFBTSxlQUFlLEdBQUcsTUFBTSxJQUFJLENBQUMsY0FBYyxDQUFDLE9BQU8sQ0FBQyxDQUFDO3dCQUMzRCxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsZUFBZSxDQUFDLE1BQU0sQ0FBQyxDQUFDO3dCQUN2QyxNQUFNLENBQUMsTUFBTSxDQUFDLE9BQU8sRUFBRSxlQUFlLENBQUMsT0FBTyxDQUFDLENBQUM7d0JBQ2hELFdBQVcsQ0FBQyxJQUFJLENBQUMsR0FBRyxlQUFlLENBQUMsV0FBVyxDQUFDLENBQUM7b0JBRW5ELENBQUM7b0JBQUMsT0FBTyxLQUFLLEVBQUUsQ0FBQzt3QkFDZixNQUFNLENBQUMsSUFBSSxDQUFDOzRCQUNWLElBQUksRUFBRSxPQUFPOzRCQUNiLE9BQU8sRUFBRSx3QkFBeUIsS0FBZSxDQUFDLE9BQU8sRUFBRTs0QkFDM0QsUUFBUSxFQUFFLFFBQVE7eUJBQ25CLENBQUMsQ0FBQztvQkFDTCxDQUFDO29CQUVELE9BQU87d0JBQ0wsRUFBRSxFQUFFLGNBQWM7d0JBQ2xCLE9BQU8sRUFBRSxtQ0FBbUM7d0JBQzVDLE1BQU07d0JBQ04sT0FBTzt3QkFDUCxXQUFXO3dCQUNYLFVBQVUsRUFBRSxJQUFJO3FCQUNqQixDQUFDO2dCQUNKLENBQUM7YUFDRjtTQUNGLENBQUM7SUFDSixDQUFDO0lBRUQsSUFBSSxRQUFRO1FBQ1YsT0FBTztZQUNMO2dCQUNFLEVBQUUsRUFBRSxrQkFBa0I7Z0JBQ3RCLEtBQUssRUFBRSxrQkFBa0I7Z0JBQ3pCLFdBQVcsRUFBRSxtREFBbUQ7Z0JBQ2hFLFFBQVEsRUFBRSxLQUFLO2dCQUNmLElBQUksRUFBRSxZQUFZO2dCQUVsQixPQUFPLEVBQUUsS0FBSyxFQUFFLE9BQXNCLEVBQUUsSUFBWSxFQUFnQixFQUFFO29CQUNwRSxNQUFNLFlBQVksR0FBRyxNQUFNLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxPQUFPLENBQUMsQ0FBQztvQkFFNUQsaUNBQWlDO29CQUNqQyxNQUFNLEdBQUcsR0FBRyxNQUFNLE1BQU0sQ0FBQyxTQUFTLENBQUMsZ0JBQWdCLENBQUM7d0JBQ2xELE9BQU8sRUFBRSxJQUFJLENBQUMsa0JBQWtCLENBQUMsWUFBWSxDQUFDO3dCQUM5QyxRQUFRLEVBQUUsVUFBVTtxQkFDckIsQ0FBQyxDQUFDO29CQUVILE1BQU0sTUFBTSxDQUFDLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxHQUFHLENBQUMsQ0FBQztvQkFFMUMsT0FBTyxZQUFZLENBQUM7Z0JBQ3RCLENBQUM7YUFDRjtZQUNEO2dCQUNFLEVBQUUsRUFBRSx1QkFBdUI7Z0JBQzNCLEtBQUssRUFBRSx1QkFBdUI7Z0JBQzlCLFdBQVcsRUFBRSxnREFBZ0Q7Z0JBQzdELFFBQVEsRUFBRSxLQUFLO2dCQUNmLElBQUksRUFBRSxVQUFVO2dCQUVoQixPQUFPLEVBQUUsS0FBSyxFQUFFLE9BQXNCLEVBQUUsSUFBWSxFQUFnQixFQUFFO29CQUNwRSxNQUFNLGFBQWEsR0FBRyxNQUFNLElBQUksQ0FBQyw0QkFBNEIsQ0FBQyxPQUFPLENBQUMsQ0FBQztvQkFFdkUsZ0NBQWdDO29CQUNoQyxNQUFNLEtBQUssR0FBRyxhQUFhLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsQ0FBQzt3QkFDdEMsS0FBSyxFQUFFLEdBQUcsQ0FBQyxLQUFLO3dCQUNoQixXQUFXLEVBQUUsR0FBRyxDQUFDLFdBQVc7d0JBQzVCLE1BQU0sRUFBRSxHQUFHLENBQUMsTUFBTTtxQkFDbkIsQ0FBQyxDQUFDLENBQUM7b0JBRUosTUFBTSxRQUFRLEdBQUcsTUFBTSxNQUFNLENBQUMsTUFBTSxDQUFDLGFBQWEsQ0FBQyxLQUFLLEVBQUU7d0JBQ3hELFdBQVcsRUFBRSw4QkFBOEI7d0JBQzNDLFdBQVcsRUFBRSxLQUFLO3FCQUNuQixDQUFDLENBQUM7b0JBRUgsSUFBSSxRQUFRLEVBQUUsQ0FBQzt3QkFDYixNQUFNLFlBQVksR0FBRyxhQUFhLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxDQUFDLEtBQUssS0FBSyxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUM7d0JBQzdFLElBQUksWUFBWSxFQUFFLENBQUM7NEJBQ2pCLE1BQU0sSUFBSSxDQUFDLGlCQUFpQixDQUFDLFlBQVksRUFBRSxPQUFPLENBQUMsQ0FBQzt3QkFDdEQsQ0FBQztvQkFDSCxDQUFDO29CQUVELE9BQU8sYUFBYSxDQUFDO2dCQUN2QixDQUFDO2FBQ0Y7U0FDRixDQUFDO0lBQ0osQ0FBQztJQUVELEtBQUssQ0FBQyxRQUFRLENBQUMsR0FBYyxFQUFFLE9BQXNCO1FBQ25ELElBQUksQ0FBQyxHQUFHLEdBQUcsR0FBRyxDQUFDO1FBRWYscUJBQXFCO1FBQ3JCLEtBQUssTUFBTSxRQUFRLElBQUksSUFBSSxDQUFDLFNBQVMsRUFBRSxDQUFDO1lBQ3RDLEdBQUcsQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQ25DLENBQUM7UUFFRCxvQkFBb0I7UUFDcEIsS0FBSyxNQUFNLE9BQU8sSUFBSSxJQUFJLENBQUMsUUFBUSxFQUFFLENBQUM7WUFDcEMsR0FBRyxDQUFDLGVBQWUsQ0FBQyxPQUFPLENBQUMsRUFBRSxFQUFFLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUNuRCxDQUFDO1FBRUQsd0JBQXdCO1FBQ3hCLEdBQUcsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxZQUFZLEVBQUUsQ0FBQyxJQUFJLEVBQUUsRUFBRSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxFQUFFLE9BQU8sQ0FBQyxDQUFDLENBQUM7UUFDbEUsR0FBRyxDQUFDLEVBQUUsRUFBRSxDQUFDLG9CQUFvQixFQUFFLENBQUMsSUFBSSxFQUFFLEVBQUUsQ0FBQyxJQUFJLENBQUMsZUFBZSxDQUFDLElBQUksRUFBRSxPQUFPLENBQUMsQ0FBQyxDQUFDO1FBRTlFLE9BQU8sQ0FBQyxHQUFHLENBQUMsK0JBQStCLENBQUMsQ0FBQztJQUMvQyxDQUFDO0lBRUQsS0FBSyxDQUFDLFVBQVUsQ0FBQyxHQUFjLEVBQUUsT0FBc0I7UUFDckQsVUFBVTtRQUNWLEdBQUcsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxZQUFZLENBQUMsQ0FBQztRQUN4QixHQUFHLENBQUMsR0FBRyxFQUFFLENBQUMsb0JBQW9CLENBQUMsQ0FBQztRQUVoQyxPQUFPLENBQUMsR0FBRyxDQUFDLGlDQUFpQyxDQUFDLENBQUM7SUFDakQsQ0FBQztJQUVPLEtBQUssQ0FBQyxvQkFBb0IsQ0FBQyxPQUFzQjtRQUN2RCxNQUFNLE1BQU0sR0FBWSxFQUFFLENBQUM7UUFDM0IsTUFBTSxPQUFPLEdBQTJCLEVBQUUsQ0FBQztRQUMzQyxNQUFNLFdBQVcsR0FBYSxFQUFFLENBQUM7UUFFakMsK0JBQStCO1FBQy9CLE1BQU0sYUFBYSxHQUFHLE1BQU0sSUFBSSxDQUFDLGdCQUFnQixDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBRTNELGlDQUFpQztRQUNqQyxJQUFJLGtCQUFrQixHQUFHLENBQUMsQ0FBQztRQUMzQixJQUFJLGtCQUFrQixHQUFHLENBQUMsQ0FBQztRQUUzQixLQUFLLE1BQU0sTUFBTSxJQUFJLGFBQWEsRUFBRSxDQUFDO1lBQ25DLElBQUksTUFBTSxDQUFDLE9BQU8sQ0FBQyxNQUFNLEdBQUcsRUFBRSxFQUFFLENBQUM7Z0JBQy9CLGtCQUFrQixFQUFFLENBQUM7WUFDdkIsQ0FBQztZQUVELElBQUksTUFBTSxDQUFDLE9BQU8sQ0FBQyxNQUFNLEdBQUcsRUFBRSxFQUFFLENBQUM7Z0JBQy9CLGtCQUFrQixFQUFFLENBQUM7WUFDdkIsQ0FBQztRQUNILENBQUM7UUFFRCxPQUFPLENBQUMsZUFBZSxDQUFDLEdBQUcsYUFBYSxDQUFDLE1BQU0sQ0FBQztRQUNoRCxPQUFPLENBQUMsc0JBQXNCLENBQUMsR0FBRyxrQkFBa0IsQ0FBQztRQUNyRCxPQUFPLENBQUMsc0JBQXNCLENBQUMsR0FBRyxrQkFBa0IsQ0FBQztRQUVyRCxJQUFJLGtCQUFrQixHQUFHLENBQUMsRUFBRSxDQUFDO1lBQzNCLE1BQU0sQ0FBQyxJQUFJLENBQUM7Z0JBQ1YsSUFBSSxFQUFFLFNBQVM7Z0JBQ2YsT0FBTyxFQUFFLFNBQVMsa0JBQWtCLCtCQUErQjtnQkFDbkUsUUFBUSxFQUFFLEtBQUs7YUFDaEIsQ0FBQyxDQUFDO1lBRUgsV0FBVyxDQUFDLElBQUksQ0FBQywwREFBMEQsQ0FBQyxDQUFDO1FBQy9FLENBQUM7UUFFRCxJQUFJLGtCQUFrQixHQUFHLENBQUMsRUFBRSxDQUFDO1lBQzNCLE1BQU0sQ0FBQyxJQUFJLENBQUM7Z0JBQ1YsSUFBSSxFQUFFLE1BQU07Z0JBQ1osT0FBTyxFQUFFLFNBQVMsa0JBQWtCLCtCQUErQjtnQkFDbkUsUUFBUSxFQUFFLEtBQUs7YUFDaEIsQ0FBQyxDQUFDO1FBQ0wsQ0FBQztRQUVELDJCQUEyQjtRQUMzQixNQUFNLGVBQWUsR0FBRyxJQUFJLENBQUMsc0JBQXNCLENBQUMsYUFBYSxDQUFDLENBQUM7UUFDbkUsT0FBTyxDQUFDLGlCQUFpQixDQUFDLEdBQUcsZUFBZSxDQUFDLEtBQUssQ0FBQztRQUNuRCxPQUFPLENBQUMsa0JBQWtCLENBQUMsR0FBRyxlQUFlLENBQUMsTUFBTSxDQUFDO1FBRXJELElBQUksZUFBZSxDQUFDLEtBQUssR0FBRyxHQUFHLEVBQUUsQ0FBQztZQUNoQyxXQUFXLENBQUMsSUFBSSxDQUFDLDJEQUEyRCxDQUFDLENBQUM7UUFDaEYsQ0FBQztRQUVELE9BQU87WUFDTCxFQUFFLEVBQUUsaUJBQWlCO1lBQ3JCLE9BQU8sRUFBRSxtQ0FBbUM7WUFDNUMsTUFBTTtZQUNOLE9BQU87WUFDUCxXQUFXO1lBQ1gsVUFBVSxFQUFFLEdBQUc7U0FDaEIsQ0FBQztJQUNKLENBQUM7SUFFTyxLQUFLLENBQUMsZUFBZSxDQUFDLE9BQXNCO1FBQ2xELE1BQU0sTUFBTSxHQUFZLEVBQUUsQ0FBQztRQUMzQixNQUFNLE9BQU8sR0FBMkIsRUFBRSxDQUFDO1FBQzNDLE1BQU0sV0FBVyxHQUFhLEVBQUUsQ0FBQztRQUVqQywyQkFBMkI7UUFDM0IsTUFBTSxRQUFRLEdBQUcsTUFBTSxJQUFJLENBQUMsV0FBVyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQ2pELE1BQU0sYUFBYSxHQUFHLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFFbEUsT0FBTyxDQUFDLGdCQUFnQixDQUFDLEdBQUcsUUFBUSxDQUFDLE1BQU0sQ0FBQztRQUM1QyxPQUFPLENBQUMsZ0JBQWdCLENBQUMsR0FBRyxhQUFhLENBQUMsTUFBTSxDQUFDO1FBRWpELElBQUksYUFBYSxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUUsQ0FBQztZQUM3QixNQUFNLENBQUMsSUFBSSxDQUFDO2dCQUNWLElBQUksRUFBRSxTQUFTO2dCQUNmLE9BQU8sRUFBRSxTQUFTLGFBQWEsQ0FBQyxNQUFNLG1CQUFtQjtnQkFDekQsUUFBUSxFQUFFLFFBQVE7YUFDbkIsQ0FBQyxDQUFDO1lBRUgsV0FBVyxDQUFDLElBQUksQ0FBQyxxREFBcUQsQ0FBQyxDQUFDO1FBQzFFLENBQUM7UUFFRCxJQUFJLFFBQVEsQ0FBQyxNQUFNLEdBQUcsRUFBRSxFQUFFLENBQUM7WUFDekIsTUFBTSxDQUFDLElBQUksQ0FBQztnQkFDVixJQUFJLEVBQUUsTUFBTTtnQkFDWixPQUFPLEVBQUUsa0JBQWtCLFFBQVEsQ0FBQyxNQUFNLFdBQVc7Z0JBQ3JELFFBQVEsRUFBRSxLQUFLO2FBQ2hCLENBQUMsQ0FBQztRQUNMLENBQUM7UUFFRCxPQUFPO1lBQ0wsRUFBRSxFQUFFLGlCQUFpQjtZQUNyQixPQUFPLEVBQUUsMkJBQTJCO1lBQ3BDLE1BQU07WUFDTixPQUFPO1lBQ1AsV0FBVztZQUNYLFVBQVUsRUFBRSxHQUFHO1NBQ2hCLENBQUM7SUFDSixDQUFDO0lBRU8sS0FBSyxDQUFDLGNBQWMsQ0FBQyxPQUFzQjtRQUNqRCxNQUFNLE1BQU0sR0FBWSxFQUFFLENBQUM7UUFDM0IsTUFBTSxPQUFPLEdBQTJCLEVBQUUsQ0FBQztRQUMzQyxNQUFNLFdBQVcsR0FBYSxFQUFFLENBQUM7UUFFakMsOEJBQThCO1FBQzlCLE1BQU0sZ0JBQWdCLEdBQUcsTUFBTSxJQUFJLENBQUMsbUJBQW1CLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDakUsT0FBTyxDQUFDLG1CQUFtQixDQUFDLEdBQUcsZ0JBQWdCLENBQUMsTUFBTSxDQUFDO1FBRXZELElBQUksZ0JBQWdCLENBQUMsTUFBTSxHQUFHLEVBQUUsRUFBRSxDQUFDO1lBQ2pDLE1BQU0sQ0FBQyxJQUFJLENBQUM7Z0JBQ1YsSUFBSSxFQUFFLFNBQVM7Z0JBQ2YsT0FBTyxFQUFFLEdBQUcsZ0JBQWdCLENBQUMsTUFBTSxpQ0FBaUM7Z0JBQ3BFLFFBQVEsRUFBRSxRQUFRO2FBQ25CLENBQUMsQ0FBQztRQUNMLENBQUM7UUFFRCxxQkFBcUI7UUFDckIsTUFBTSxVQUFVLEdBQUcsZ0JBQWdCLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ3JFLE9BQU8sQ0FBQyx5QkFBeUIsQ0FBQyxHQUFHLFVBQVUsQ0FBQyxNQUFNLENBQUM7UUFFdkQsSUFBSSxVQUFVLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRSxDQUFDO1lBQzFCLE1BQU0sQ0FBQyxJQUFJLENBQUM7Z0JBQ1YsSUFBSSxFQUFFLFNBQVM7Z0JBQ2YsT0FBTyxFQUFFLEdBQUcsVUFBVSxDQUFDLE1BQU0seUNBQXlDO2dCQUN0RSxRQUFRLEVBQUUsTUFBTTthQUNqQixDQUFDLENBQUM7WUFFSCxXQUFXLENBQUMsSUFBSSxDQUFDLHlDQUF5QyxDQUFDLENBQUM7UUFDOUQsQ0FBQztRQUVELE9BQU87WUFDTCxFQUFFLEVBQUUsa0JBQWtCO1lBQ3RCLE9BQU8sRUFBRSw0QkFBNEI7WUFDckMsTUFBTTtZQUNOLE9BQU87WUFDUCxXQUFXO1lBQ1gsVUFBVSxFQUFFLElBQUk7U0FDakIsQ0FBQztJQUNKLENBQUM7SUFFTyxLQUFLLENBQUMsa0JBQWtCLENBQUMsT0FBc0I7UUFDckQsTUFBTSxNQUFNLEdBQUc7WUFDYixPQUFPLEVBQUUsTUFBTTtZQUNmLE1BQU0sRUFBRTtnQkFDTixhQUFhLEVBQUUsQ0FBQztnQkFDaEIsWUFBWSxFQUFFLENBQUM7Z0JBQ2YsY0FBYyxFQUFFLENBQUM7Z0JBQ2pCLGtCQUFrQixFQUFFLENBQUM7YUFDdEI7WUFDRCxlQUFlLEVBQUUsRUFBYztTQUNoQyxDQUFDO1FBRUYsZ0NBQWdDO1FBQ2hDLE1BQU0sY0FBYyxHQUFHLE1BQU0sSUFBSSxDQUFDLG9CQUFvQixDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQ2hFLE1BQU0sQ0FBQyxNQUFNLENBQUMsYUFBYSxHQUFHLElBQUksQ0FBQywyQkFBMkIsQ0FBQyxjQUFjLENBQUMsQ0FBQztRQUUvRSxNQUFNLGNBQWMsR0FBRyxNQUFNLElBQUksQ0FBQyxlQUFlLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDM0QsTUFBTSxDQUFDLE1BQU0sQ0FBQyxZQUFZLEdBQUcsSUFBSSxDQUFDLDBCQUEwQixDQUFDLGNBQWMsQ0FBQyxDQUFDO1FBRTdFLGdCQUFnQjtRQUNoQixNQUFNLFlBQVksR0FBRyxDQUNuQixNQUFNLENBQUMsTUFBTSxDQUFDLGFBQWE7WUFDM0IsTUFBTSxDQUFDLE1BQU0sQ0FBQyxZQUFZO1lBQzFCLE1BQU0sQ0FBQyxNQUFNLENBQUMsY0FBYztZQUM1QixNQUFNLENBQUMsTUFBTSxDQUFDLGtCQUFrQixDQUNqQyxHQUFHLENBQUMsQ0FBQztRQUVOLElBQUksWUFBWSxJQUFJLEdBQUcsRUFBRSxDQUFDO1lBQ3hCLE1BQU0sQ0FBQyxPQUFPLEdBQUcsV0FBVyxDQUFDO1FBQy9CLENBQUM7YUFBTSxJQUFJLFlBQVksSUFBSSxHQUFHLEVBQUUsQ0FBQztZQUMvQixNQUFNLENBQUMsT0FBTyxHQUFHLE1BQU0sQ0FBQztRQUMxQixDQUFDO2FBQU0sSUFBSSxZQUFZLElBQUksR0FBRyxFQUFFLENBQUM7WUFDL0IsTUFBTSxDQUFDLE9BQU8sR0FBRyxNQUFNLENBQUM7UUFDMUIsQ0FBQzthQUFNLENBQUM7WUFDTixNQUFNLENBQUMsT0FBTyxHQUFHLE1BQU0sQ0FBQztRQUMxQixDQUFDO1FBRUQsT0FBTyxNQUFNLENBQUM7SUFDaEIsQ0FBQztJQUVPLEtBQUssQ0FBQyw0QkFBNEIsQ0FBQyxPQUFzQjtRQUMvRCxPQUFPO1lBQ0w7Z0JBQ0UsS0FBSyxFQUFFLGlCQUFpQjtnQkFDeEIsV0FBVyxFQUFFLDhDQUE4QztnQkFDM0QsTUFBTSxFQUFFLDZCQUE2QjtnQkFDckMsTUFBTSxFQUFFLGFBQWE7YUFDdEI7WUFDRDtnQkFDRSxLQUFLLEVBQUUsNkJBQTZCO2dCQUNwQyxXQUFXLEVBQUUsK0NBQStDO2dCQUM1RCxNQUFNLEVBQUUsZ0NBQWdDO2dCQUN4QyxNQUFNLEVBQUUsbUJBQW1CO2FBQzVCO1lBQ0Q7Z0JBQ0UsS0FBSyxFQUFFLHFCQUFxQjtnQkFDNUIsV0FBVyxFQUFFLGdEQUFnRDtnQkFDN0QsTUFBTSxFQUFFLCtCQUErQjtnQkFDdkMsTUFBTSxFQUFFLG9CQUFvQjthQUM3QjtTQUNGLENBQUM7SUFDSixDQUFDO0lBRU8sS0FBSyxDQUFDLGlCQUFpQixDQUFDLFlBQWlCLEVBQUUsT0FBc0I7UUFDdkUsUUFBUSxZQUFZLENBQUMsTUFBTSxFQUFFLENBQUM7WUFDNUIsS0FBSyxhQUFhO2dCQUNoQixNQUFNLElBQUksQ0FBQyxhQUFhLENBQUMsT0FBTyxDQUFDLENBQUM7Z0JBQ2xDLE1BQU07WUFDUixLQUFLLG1CQUFtQjtnQkFDdEIsTUFBTSxJQUFJLENBQUMscUJBQXFCLENBQUMsT0FBTyxDQUFDLENBQUM7Z0JBQzFDLE1BQU07WUFDUixLQUFLLG9CQUFvQjtnQkFDdkIsTUFBTSxJQUFJLENBQUMsaUJBQWlCLENBQUMsT0FBTyxDQUFDLENBQUM7Z0JBQ3RDLE1BQU07WUFDUjtnQkFDRSxPQUFPLENBQUMsR0FBRyxDQUFDLGdDQUFnQyxZQUFZLENBQUMsTUFBTSxFQUFFLENBQUMsQ0FBQztRQUN2RSxDQUFDO0lBQ0gsQ0FBQztJQUVPLEtBQUssQ0FBQyxnQkFBZ0IsQ0FBQyxPQUFzQjtRQUNuRCxtQkFBbUI7UUFDbkIsT0FBTztZQUNMLEVBQUUsSUFBSSxFQUFFLFFBQVEsRUFBRSxPQUFPLEVBQUUsdUJBQXVCLEVBQUUsTUFBTSxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUUsSUFBSSxJQUFJLEVBQUUsRUFBRTtZQUNyRixFQUFFLElBQUksRUFBRSxRQUFRLEVBQUUsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBRSxJQUFJLElBQUksRUFBRSxFQUFFO1lBQ3ZFLEVBQUUsSUFBSSxFQUFFLFFBQVEsRUFBRSxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFFLElBQUksSUFBSSxFQUFFLEVBQUU7U0FDNUUsQ0FBQztJQUNKLENBQUM7SUFFTyxLQUFLLENBQUMsV0FBVyxDQUFDLE9BQXNCO1FBQzlDLDJCQUEyQjtRQUMzQixPQUFPO1lBQ0wsRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLFVBQVUsRUFBRSxJQUFJLElBQUksRUFBRSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUU7WUFDdEQsRUFBRSxJQUFJLEVBQUUsU0FBUyxFQUFFLFVBQVUsRUFBRSxJQUFJLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFLEdBQUcsUUFBUSxDQUFDLEVBQUUsTUFBTSxFQUFFLEtBQUssRUFBRTtZQUMvRSxFQUFFLElBQUksRUFBRSxhQUFhLEVBQUUsVUFBVSxFQUFFLElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLEVBQUUsR0FBRyxRQUFRLEdBQUcsRUFBRSxDQUFDLEVBQUUsTUFBTSxFQUFFLEtBQUssRUFBRTtTQUN6RixDQUFDO0lBQ0osQ0FBQztJQUVPLEtBQUssQ0FBQyxtQkFBbUIsQ0FBQyxPQUFzQjtRQUN0RCxzQkFBc0I7UUFDdEIsT0FBTztZQUNMLEVBQUUsSUFBSSxFQUFFLGFBQWEsRUFBRSxNQUFNLEVBQUUsVUFBVSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUU7WUFDdkQsRUFBRSxJQUFJLEVBQUUsV0FBVyxFQUFFLE1BQU0sRUFBRSxVQUFVLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRTtTQUN0RCxDQUFDO0lBQ0osQ0FBQztJQUVPLHNCQUFzQixDQUFDLE9BQWM7UUFDM0MsTUFBTSxHQUFHLEdBQUcsSUFBSSxJQUFJLEVBQUUsQ0FBQztRQUN2QixNQUFNLE1BQU0sR0FBRyxJQUFJLElBQUksQ0FBQyxHQUFHLENBQUMsT0FBTyxFQUFFLEdBQUcsUUFBUSxDQUFDLENBQUM7UUFDbEQsTUFBTSxPQUFPLEdBQUcsSUFBSSxJQUFJLENBQUMsR0FBRyxDQUFDLE9BQU8sRUFBRSxHQUFHLFFBQVEsR0FBRyxDQUFDLENBQUMsQ0FBQztRQUV2RCxNQUFNLFlBQVksR0FBRyxPQUFPLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksSUFBSSxNQUFNLENBQUMsQ0FBQyxNQUFNLENBQUM7UUFDbEUsTUFBTSxhQUFhLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLElBQUksT0FBTyxDQUFDLENBQUMsTUFBTSxDQUFDO1FBRXBFLE9BQU87WUFDTCxLQUFLLEVBQUUsWUFBWTtZQUNuQixNQUFNLEVBQUUsYUFBYTtTQUN0QixDQUFDO0lBQ0osQ0FBQztJQUVPLGFBQWEsQ0FBQyxNQUFXO1FBQy9CLE1BQU0sUUFBUSxHQUFHLElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLEVBQUUsR0FBRyxRQUFRLEdBQUcsRUFBRSxDQUFDLENBQUM7UUFDdEQsT0FBTyxNQUFNLENBQUMsVUFBVSxHQUFHLFFBQVEsSUFBSSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUM7SUFDeEQsQ0FBQztJQUVPLFdBQVcsQ0FBQyxJQUFTO1FBQzNCLE9BQU8sSUFBSSxDQUFDLElBQUksR0FBRyxHQUFHLEdBQUcsSUFBSSxHQUFHLElBQUksQ0FBQyxDQUFDLFFBQVE7SUFDaEQsQ0FBQztJQUVPLDJCQUEyQixDQUFDLFFBQXdCO1FBQzFELE1BQU0sWUFBWSxHQUFHLFFBQVEsQ0FBQyxPQUFPLEVBQUUsQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDOUQsTUFBTSxXQUFXLEdBQUcsUUFBUSxDQUFDLE9BQU8sRUFBRSxDQUFDLHNCQUFzQixDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ3BFLE1BQU0sV0FBVyxHQUFHLFFBQVEsQ0FBQyxPQUFPLEVBQUUsQ0FBQyxzQkFBc0IsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUVwRSxNQUFNLFlBQVksR0FBRyxDQUFDLEdBQUcsQ0FBQyxXQUFXLEdBQUcsV0FBVyxHQUFHLEdBQUcsQ0FBQyxHQUFHLFlBQVksQ0FBQztRQUMxRSxPQUFPLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFLFlBQVksQ0FBQyxDQUFDLENBQUM7SUFDaEQsQ0FBQztJQUVPLDBCQUEwQixDQUFDLFFBQXdCO1FBQ3pELE1BQU0sYUFBYSxHQUFHLFFBQVEsQ0FBQyxPQUFPLEVBQUUsQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUNoRSxNQUFNLGFBQWEsR0FBRyxRQUFRLENBQUMsT0FBTyxFQUFFLENBQUMsZ0JBQWdCLENBQUMsSUFBSSxDQUFDLENBQUM7UUFFaEUsTUFBTSxXQUFXLEdBQUcsQ0FBQyxHQUFHLENBQUMsYUFBYSxHQUFHLGFBQWEsQ0FBQyxDQUFDO1FBQ3hELE9BQU8sSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQUUsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQUUsV0FBVyxDQUFDLENBQUMsQ0FBQztJQUMvQyxDQUFDO0lBRU8sa0JBQWtCLENBQUMsTUFBVztRQUNwQyxPQUFPOzs7cUJBR1UsTUFBTSxDQUFDLE9BQU8sQ0FBQyxXQUFXLEVBQUU7Ozt3QkFHekIsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLGFBQWEsR0FBRyxHQUFHLENBQUM7dUJBQzlDLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxZQUFZLEdBQUcsR0FBRyxDQUFDO3lCQUMxQyxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsY0FBYyxHQUFHLEdBQUcsQ0FBQzs2QkFDMUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLGtCQUFrQixHQUFHLEdBQUcsQ0FBQzs7O0VBRzdFLE1BQU0sQ0FBQyxlQUFlLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBUSxFQUFFLEVBQUUsQ0FBQyxLQUFLLEdBQUcsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQzs7OztLQUk1RCxDQUFDLElBQUksRUFBRSxDQUFDO0lBQ1gsQ0FBQztJQUVPLEtBQUssQ0FBQyxhQUFhLENBQUMsT0FBc0I7UUFDaEQsMENBQTBDO1FBQzFDLElBQUksQ0FBQyxHQUFHLEVBQUUsZ0JBQWdCLEVBQUUsQ0FBQywyQkFBMkIsRUFBRSxNQUFNLENBQUMsQ0FBQztJQUNwRSxDQUFDO0lBRU8sS0FBSyxDQUFDLHFCQUFxQixDQUFDLE9BQXNCO1FBQ3hELGtEQUFrRDtRQUNsRCxJQUFJLENBQUMsR0FBRyxFQUFFLGdCQUFnQixFQUFFLENBQUMsOEJBQThCLEVBQUUsTUFBTSxDQUFDLENBQUM7SUFDdkUsQ0FBQztJQUVPLEtBQUssQ0FBQyxpQkFBaUIsQ0FBQyxPQUFzQjtRQUNwRCwyQ0FBMkM7UUFDM0MsSUFBSSxDQUFDLEdBQUcsRUFBRSxnQkFBZ0IsRUFBRSxDQUFDLHNCQUFzQixFQUFFLE1BQU0sQ0FBQyxDQUFDO0lBQy9ELENBQUM7SUFFTyxLQUFLLENBQUMsV0FBVyxDQUFDLElBQVMsRUFBRSxPQUFzQjtRQUN6RCwyQkFBMkI7UUFDM0IsT0FBTyxDQUFDLEdBQUcsQ0FBQyxzQkFBc0IsRUFBRSxJQUFJLENBQUMsQ0FBQztJQUM1QyxDQUFDO0lBRU8sS0FBSyxDQUFDLGVBQWUsQ0FBQyxJQUFTLEVBQUUsT0FBc0I7UUFDN0QsOEJBQThCO1FBQzlCLE9BQU8sQ0FBQyxHQUFHLENBQUMsaUJBQWlCLEVBQUUsSUFBSSxDQUFDLENBQUM7SUFDdkMsQ0FBQztDQUNGO0FBbGZELDhDQWtmQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMvZ3JlZ2R1bm4vc3JjL3Rlc3QvYWlfZGVidWdfY29udGV4dC92c2NvZGUvc3JjL3NlcnZpY2VzL3BsdWdpbnMvYnVpbHRpbi9naXRBbmFseXplclBsdWdpbi50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBcbiAgUGx1Z2luLCBcbiAgUGx1Z2luTWV0YWRhdGEsIFxuICBQbHVnaW5BUEksIFxuICBQbHVnaW5Db250ZXh0LCBcbiAgUGx1Z2luQW5hbHl6ZXIsIFxuICBBbmFseXNpc1Jlc3VsdCxcbiAgSXNzdWUsXG4gIFBsdWdpbkNvbW1hbmRcbn0gZnJvbSAnLi4vLi4vLi4vdHlwZXMvcGx1Z2luJztcbmltcG9ydCB7IEdpdFN0YXR1cyB9IGZyb20gJy4uLy4uLy4uL3R5cGVzL2luZGV4JztcbmltcG9ydCAqIGFzIHZzY29kZSBmcm9tICd2c2NvZGUnO1xuaW1wb3J0ICogYXMgZnMgZnJvbSAnZnMnO1xuaW1wb3J0ICogYXMgcGF0aCBmcm9tICdwYXRoJztcblxuZXhwb3J0IGNsYXNzIEdpdEFuYWx5emVyUGx1Z2luIGltcGxlbWVudHMgUGx1Z2luIHtcbiAgbWV0YWRhdGE6IFBsdWdpbk1ldGFkYXRhID0ge1xuICAgIGlkOiAnYnVpbHRpbi1naXQtYW5hbHl6ZXInLFxuICAgIG5hbWU6ICdHaXQgQW5hbHl6ZXInLFxuICAgIHZlcnNpb246ICcxLjAuMCcsXG4gICAgZGVzY3JpcHRpb246ICdBbmFseXplIEdpdCByZXBvc2l0b3JpZXMsIGNvbW1pdHMsIGFuZCBwcm92aWRlIGluc2lnaHRzIGZvciBiZXR0ZXIgdmVyc2lvbiBjb250cm9sJyxcbiAgICBhdXRob3I6ICdBSSBEZWJ1ZyBUZWFtJyxcbiAgICBsaWNlbnNlOiAnTUlUJyxcbiAgICBlbmFibGVkOiB0cnVlLFxuICAgIGNhcGFiaWxpdGllczogW1xuICAgICAge1xuICAgICAgICB0eXBlOiAnYW5hbHl6ZXInLFxuICAgICAgICBuYW1lOiAnZ2l0LWFuYWx5emVyJyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdBbmFseXplIEdpdCByZXBvc2l0b3JpZXMgYW5kIGNvbW1pdHMnLFxuICAgICAgICBwZXJtaXNzaW9uczogWyd3b3Jrc3BhY2UtYWNjZXNzOmdpdDpBbmFseXplIEdpdCByZXBvc2l0b3J5IHN0YXR1cyBhbmQgaGlzdG9yeSddXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICB0eXBlOiAnY29tbWFuZCcsXG4gICAgICAgIG5hbWU6ICdnaXQtaW5zaWdodHMnLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ0dlbmVyYXRlIEdpdCBpbnNpZ2h0cyBhbmQgcmVjb21tZW5kYXRpb25zJ1xuICAgICAgfVxuICAgIF1cbiAgfTtcblxuICBwcml2YXRlIGFwaT86IFBsdWdpbkFQSTtcbiAgXG4gIGdldCBhbmFseXplcnMoKTogUGx1Z2luQW5hbHl6ZXJbXSB7XG4gICAgcmV0dXJuIFtcbiAgICAgIHtcbiAgICAgICAgaWQ6ICdnaXQtY29tbWl0LWFuYWx5emVyJyxcbiAgICAgICAgbmFtZTogJ0dpdCBDb21taXQgQW5hbHl6ZXInLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ0FuYWx5emUgR2l0IGNvbW1pdCBtZXNzYWdlcyBhbmQgcGF0dGVybnMnLFxuICAgICAgICBmaWxlUGF0dGVybnM6IFsnLmdpdC8qKi8qJywgJyoqLy5naXQvKiovKiddLFxuICAgICAgICBcbiAgICAgICAgYW5hbHl6ZTogYXN5bmMgKGNvbnRlbnQ6IHN0cmluZywgZmlsZVBhdGg6IHN0cmluZywgY29udGV4dDogUGx1Z2luQ29udGV4dCk6IFByb21pc2U8QW5hbHlzaXNSZXN1bHQ+ID0+IHtcbiAgICAgICAgICBjb25zdCBpc3N1ZXM6IElzc3VlW10gPSBbXTtcbiAgICAgICAgICBjb25zdCBtZXRyaWNzOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+ID0ge307XG4gICAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbnM6IHN0cmluZ1tdID0gW107XG4gICAgICAgICAgXG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIEFuYWx5emUgY29tbWl0IGhpc3RvcnlcbiAgICAgICAgICAgIGNvbnN0IGNvbW1pdEFuYWx5c2lzID0gYXdhaXQgdGhpcy5hbmFseXplQ29tbWl0SGlzdG9yeShjb250ZXh0KTtcbiAgICAgICAgICAgIGlzc3Vlcy5wdXNoKC4uLmNvbW1pdEFuYWx5c2lzLmlzc3Vlcyk7XG4gICAgICAgICAgICBPYmplY3QuYXNzaWduKG1ldHJpY3MsIGNvbW1pdEFuYWx5c2lzLm1ldHJpY3MpO1xuICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaCguLi5jb21taXRBbmFseXNpcy5zdWdnZXN0aW9ucyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEFuYWx5emUgYnJhbmNoIHN0cnVjdHVyZVxuICAgICAgICAgICAgY29uc3QgYnJhbmNoQW5hbHlzaXMgPSBhd2FpdCB0aGlzLmFuYWx5emVCcmFuY2hlcyhjb250ZXh0KTtcbiAgICAgICAgICAgIGlzc3Vlcy5wdXNoKC4uLmJyYW5jaEFuYWx5c2lzLmlzc3Vlcyk7XG4gICAgICAgICAgICBPYmplY3QuYXNzaWduKG1ldHJpY3MsIGJyYW5jaEFuYWx5c2lzLm1ldHJpY3MpO1xuICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaCguLi5icmFuY2hBbmFseXNpcy5zdWdnZXN0aW9ucyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEFuYWx5emUgZmlsZSBjaGFuZ2VzXG4gICAgICAgICAgICBjb25zdCBjaGFuZ2VzQW5hbHlzaXMgPSBhd2FpdCB0aGlzLmFuYWx5emVDaGFuZ2VzKGNvbnRleHQpO1xuICAgICAgICAgICAgaXNzdWVzLnB1c2goLi4uY2hhbmdlc0FuYWx5c2lzLmlzc3Vlcyk7XG4gICAgICAgICAgICBPYmplY3QuYXNzaWduKG1ldHJpY3MsIGNoYW5nZXNBbmFseXNpcy5tZXRyaWNzKTtcbiAgICAgICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goLi4uY2hhbmdlc0FuYWx5c2lzLnN1Z2dlc3Rpb25zKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBpc3N1ZXMucHVzaCh7XG4gICAgICAgICAgICAgIHR5cGU6ICdlcnJvcicsXG4gICAgICAgICAgICAgIG1lc3NhZ2U6IGBHaXQgYW5hbHlzaXMgZmFpbGVkOiAkeyhlcnJvciBhcyBFcnJvcikubWVzc2FnZX1gLFxuICAgICAgICAgICAgICBzZXZlcml0eTogJ21lZGl1bSdcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgaWQ6ICdnaXQtYW5hbHlzaXMnLFxuICAgICAgICAgICAgc3VtbWFyeTogJ0dpdCByZXBvc2l0b3J5IGFuYWx5c2lzIGNvbXBsZXRlZCcsXG4gICAgICAgICAgICBpc3N1ZXMsXG4gICAgICAgICAgICBtZXRyaWNzLFxuICAgICAgICAgICAgc3VnZ2VzdGlvbnMsXG4gICAgICAgICAgICBjb25maWRlbmNlOiAwLjg1XG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIF07XG4gIH1cblxuICBnZXQgY29tbWFuZHMoKTogUGx1Z2luQ29tbWFuZFtdIHtcbiAgICByZXR1cm4gW1xuICAgICAge1xuICAgICAgICBpZDogJ2dpdC1oZWFsdGgtY2hlY2snLFxuICAgICAgICB0aXRsZTogJ0dpdCBIZWFsdGggQ2hlY2snLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ1BlcmZvcm0gY29tcHJlaGVuc2l2ZSBHaXQgcmVwb3NpdG9yeSBoZWFsdGggY2hlY2snLFxuICAgICAgICBjYXRlZ29yeTogJ0dpdCcsXG4gICAgICAgIGljb246ICdnaXQtYnJhbmNoJyxcbiAgICAgICAgXG4gICAgICAgIGV4ZWN1dGU6IGFzeW5jIChjb250ZXh0OiBQbHVnaW5Db250ZXh0LCBhcmdzPzogYW55W10pOiBQcm9taXNlPGFueT4gPT4ge1xuICAgICAgICAgIGNvbnN0IGhlYWx0aFJlcG9ydCA9IGF3YWl0IHRoaXMucGVyZm9ybUhlYWx0aENoZWNrKGNvbnRleHQpO1xuICAgICAgICAgIFxuICAgICAgICAgIC8vIFNob3cgcmVzdWx0cyBpbiBhIG5ldyBkb2N1bWVudFxuICAgICAgICAgIGNvbnN0IGRvYyA9IGF3YWl0IHZzY29kZS53b3Jrc3BhY2Uub3BlblRleHREb2N1bWVudCh7XG4gICAgICAgICAgICBjb250ZW50OiB0aGlzLmZvcm1hdEhlYWx0aFJlcG9ydChoZWFsdGhSZXBvcnQpLFxuICAgICAgICAgICAgbGFuZ3VhZ2U6ICdtYXJrZG93bidcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBcbiAgICAgICAgICBhd2FpdCB2c2NvZGUud2luZG93LnNob3dUZXh0RG9jdW1lbnQoZG9jKTtcbiAgICAgICAgICBcbiAgICAgICAgICByZXR1cm4gaGVhbHRoUmVwb3J0O1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBpZDogJ2dpdC1vcHRpbWl6ZS13b3JrZmxvdycsXG4gICAgICAgIHRpdGxlOiAnT3B0aW1pemUgR2l0IFdvcmtmbG93JyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdBbmFseXplIGFuZCBzdWdnZXN0IEdpdCB3b3JrZmxvdyBvcHRpbWl6YXRpb25zJyxcbiAgICAgICAgY2F0ZWdvcnk6ICdHaXQnLFxuICAgICAgICBpY29uOiAnYXJyb3ctdXAnLFxuICAgICAgICBcbiAgICAgICAgZXhlY3V0ZTogYXN5bmMgKGNvbnRleHQ6IFBsdWdpbkNvbnRleHQsIGFyZ3M/OiBhbnlbXSk6IFByb21pc2U8YW55PiA9PiB7XG4gICAgICAgICAgY29uc3Qgb3B0aW1pemF0aW9ucyA9IGF3YWl0IHRoaXMuc3VnZ2VzdFdvcmtmbG93T3B0aW1pemF0aW9ucyhjb250ZXh0KTtcbiAgICAgICAgICBcbiAgICAgICAgICAvLyBTaG93IG9wdGltaXphdGlvbiBzdWdnZXN0aW9uc1xuICAgICAgICAgIGNvbnN0IGl0ZW1zID0gb3B0aW1pemF0aW9ucy5tYXAob3B0ID0+ICh7XG4gICAgICAgICAgICBsYWJlbDogb3B0LnRpdGxlLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246IG9wdC5kZXNjcmlwdGlvbixcbiAgICAgICAgICAgIGRldGFpbDogb3B0LmltcGFjdFxuICAgICAgICAgIH0pKTtcbiAgICAgICAgICBcbiAgICAgICAgICBjb25zdCBzZWxlY3RlZCA9IGF3YWl0IHZzY29kZS53aW5kb3cuc2hvd1F1aWNrUGljayhpdGVtcywge1xuICAgICAgICAgICAgcGxhY2VIb2xkZXI6ICdTZWxlY3Qgb3B0aW1pemF0aW9uIHRvIGFwcGx5JyxcbiAgICAgICAgICAgIGNhblBpY2tNYW55OiBmYWxzZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIFxuICAgICAgICAgIGlmIChzZWxlY3RlZCkge1xuICAgICAgICAgICAgY29uc3Qgb3B0aW1pemF0aW9uID0gb3B0aW1pemF0aW9ucy5maW5kKG9wdCA9PiBvcHQudGl0bGUgPT09IHNlbGVjdGVkLmxhYmVsKTtcbiAgICAgICAgICAgIGlmIChvcHRpbWl6YXRpb24pIHtcbiAgICAgICAgICAgICAgYXdhaXQgdGhpcy5hcHBseU9wdGltaXphdGlvbihvcHRpbWl6YXRpb24sIGNvbnRleHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBcbiAgICAgICAgICByZXR1cm4gb3B0aW1pemF0aW9ucztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIF07XG4gIH1cblxuICBhc3luYyBhY3RpdmF0ZShhcGk6IFBsdWdpbkFQSSwgY29udGV4dDogUGx1Z2luQ29udGV4dCk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRoaXMuYXBpID0gYXBpO1xuICAgIFxuICAgIC8vIFJlZ2lzdGVyIGFuYWx5emVyc1xuICAgIGZvciAoY29uc3QgYW5hbHl6ZXIgb2YgdGhpcy5hbmFseXplcnMpIHtcbiAgICAgIGFwaS5yZWdpc3RlckFuYWx5emVyPy4oYW5hbHl6ZXIpO1xuICAgIH1cbiAgICBcbiAgICAvLyBSZWdpc3RlciBjb21tYW5kc1xuICAgIGZvciAoY29uc3QgY29tbWFuZCBvZiB0aGlzLmNvbW1hbmRzKSB7XG4gICAgICBhcGkucmVnaXN0ZXJDb21tYW5kKGNvbW1hbmQuaWQsIGNvbW1hbmQuZXhlY3V0ZSk7XG4gICAgfVxuICAgIFxuICAgIC8vIExpc3RlbiBmb3IgR2l0IGV2ZW50c1xuICAgIGFwaS5vbj8uKCdnaXQ6Y29tbWl0JywgKGRhdGEpID0+IHRoaXMub25HaXRDb21taXQoZGF0YSwgY29udGV4dCkpO1xuICAgIGFwaS5vbj8uKCdnaXQ6YnJhbmNoLWNoYW5nZWQnLCAoZGF0YSkgPT4gdGhpcy5vbkJyYW5jaENoYW5nZWQoZGF0YSwgY29udGV4dCkpO1xuICAgIFxuICAgIGNvbnNvbGUubG9nKCdHaXQgQW5hbHl6ZXIgUGx1Z2luIGFjdGl2YXRlZCcpO1xuICB9XG5cbiAgYXN5bmMgZGVhY3RpdmF0ZShhcGk6IFBsdWdpbkFQSSwgY29udGV4dDogUGx1Z2luQ29udGV4dCk6IFByb21pc2U8dm9pZD4ge1xuICAgIC8vIENsZWFudXBcbiAgICBhcGkub2ZmPy4oJ2dpdDpjb21taXQnKTtcbiAgICBhcGkub2ZmPy4oJ2dpdDpicmFuY2gtY2hhbmdlZCcpO1xuICAgIFxuICAgIGNvbnNvbGUubG9nKCdHaXQgQW5hbHl6ZXIgUGx1Z2luIGRlYWN0aXZhdGVkJyk7XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGFuYWx5emVDb21taXRIaXN0b3J5KGNvbnRleHQ6IFBsdWdpbkNvbnRleHQpOiBQcm9taXNlPEFuYWx5c2lzUmVzdWx0PiB7XG4gICAgY29uc3QgaXNzdWVzOiBJc3N1ZVtdID0gW107XG4gICAgY29uc3QgbWV0cmljczogUmVjb3JkPHN0cmluZywgbnVtYmVyPiA9IHt9O1xuICAgIGNvbnN0IHN1Z2dlc3Rpb25zOiBzdHJpbmdbXSA9IFtdO1xuICAgIFxuICAgIC8vIFNpbXVsYXRlIEdpdCBjb21taXQgYW5hbHlzaXNcbiAgICBjb25zdCByZWNlbnRDb21taXRzID0gYXdhaXQgdGhpcy5nZXRSZWNlbnRDb21taXRzKGNvbnRleHQpO1xuICAgIFxuICAgIC8vIEFuYWx5emUgY29tbWl0IG1lc3NhZ2UgcXVhbGl0eVxuICAgIGxldCBwb29yQ29tbWl0TWVzc2FnZXMgPSAwO1xuICAgIGxldCBsb25nQ29tbWl0TWVzc2FnZXMgPSAwO1xuICAgIFxuICAgIGZvciAoY29uc3QgY29tbWl0IG9mIHJlY2VudENvbW1pdHMpIHtcbiAgICAgIGlmIChjb21taXQubWVzc2FnZS5sZW5ndGggPCAxMCkge1xuICAgICAgICBwb29yQ29tbWl0TWVzc2FnZXMrKztcbiAgICAgIH1cbiAgICAgIFxuICAgICAgaWYgKGNvbW1pdC5tZXNzYWdlLmxlbmd0aCA+IDcyKSB7XG4gICAgICAgIGxvbmdDb21taXRNZXNzYWdlcysrO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICBtZXRyaWNzWyd0b3RhbC1jb21taXRzJ10gPSByZWNlbnRDb21taXRzLmxlbmd0aDtcbiAgICBtZXRyaWNzWydwb29yLWNvbW1pdC1tZXNzYWdlcyddID0gcG9vckNvbW1pdE1lc3NhZ2VzO1xuICAgIG1ldHJpY3NbJ2xvbmctY29tbWl0LW1lc3NhZ2VzJ10gPSBsb25nQ29tbWl0TWVzc2FnZXM7XG4gICAgXG4gICAgaWYgKHBvb3JDb21taXRNZXNzYWdlcyA+IDApIHtcbiAgICAgIGlzc3Vlcy5wdXNoKHtcbiAgICAgICAgdHlwZTogJ3dhcm5pbmcnLFxuICAgICAgICBtZXNzYWdlOiBgRm91bmQgJHtwb29yQ29tbWl0TWVzc2FnZXN9IGNvbW1pdChzKSB3aXRoIHBvb3IgbWVzc2FnZXNgLFxuICAgICAgICBzZXZlcml0eTogJ2xvdydcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBzdWdnZXN0aW9ucy5wdXNoKCdVc2UgY29udmVudGlvbmFsIGNvbW1pdCBmb3JtYXQ6IHR5cGUoc2NvcGUpOiBkZXNjcmlwdGlvbicpO1xuICAgIH1cbiAgICBcbiAgICBpZiAobG9uZ0NvbW1pdE1lc3NhZ2VzID4gMCkge1xuICAgICAgaXNzdWVzLnB1c2goe1xuICAgICAgICB0eXBlOiAnaW5mbycsXG4gICAgICAgIG1lc3NhZ2U6IGBGb3VuZCAke2xvbmdDb21taXRNZXNzYWdlc30gY29tbWl0KHMpIHdpdGggbG9uZyBtZXNzYWdlc2AsXG4gICAgICAgIHNldmVyaXR5OiAnbG93J1xuICAgICAgfSk7XG4gICAgfVxuICAgIFxuICAgIC8vIEFuYWx5emUgY29tbWl0IGZyZXF1ZW5jeVxuICAgIGNvbnN0IGNvbW1pdEZyZXF1ZW5jeSA9IHRoaXMuYW5hbHl6ZUNvbW1pdEZyZXF1ZW5jeShyZWNlbnRDb21taXRzKTtcbiAgICBtZXRyaWNzWydjb21taXRzLXBlci1kYXknXSA9IGNvbW1pdEZyZXF1ZW5jeS5kYWlseTtcbiAgICBtZXRyaWNzWydjb21taXRzLXBlci13ZWVrJ10gPSBjb21taXRGcmVxdWVuY3kud2Vla2x5O1xuICAgIFxuICAgIGlmIChjb21taXRGcmVxdWVuY3kuZGFpbHkgPCAwLjUpIHtcbiAgICAgIHN1Z2dlc3Rpb25zLnB1c2goJ0NvbnNpZGVyIG1vcmUgZnJlcXVlbnQgY29tbWl0cyBmb3IgYmV0dGVyIHZlcnNpb24gY29udHJvbCcpO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgaWQ6ICdjb21taXQtYW5hbHlzaXMnLFxuICAgICAgc3VtbWFyeTogJ0NvbW1pdCBoaXN0b3J5IGFuYWx5c2lzIGNvbXBsZXRlZCcsXG4gICAgICBpc3N1ZXMsXG4gICAgICBtZXRyaWNzLFxuICAgICAgc3VnZ2VzdGlvbnMsXG4gICAgICBjb25maWRlbmNlOiAwLjlcbiAgICB9O1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBhbmFseXplQnJhbmNoZXMoY29udGV4dDogUGx1Z2luQ29udGV4dCk6IFByb21pc2U8QW5hbHlzaXNSZXN1bHQ+IHtcbiAgICBjb25zdCBpc3N1ZXM6IElzc3VlW10gPSBbXTtcbiAgICBjb25zdCBtZXRyaWNzOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+ID0ge307XG4gICAgY29uc3Qgc3VnZ2VzdGlvbnM6IHN0cmluZ1tdID0gW107XG4gICAgXG4gICAgLy8gU2ltdWxhdGUgYnJhbmNoIGFuYWx5c2lzXG4gICAgY29uc3QgYnJhbmNoZXMgPSBhd2FpdCB0aGlzLmdldEJyYW5jaGVzKGNvbnRleHQpO1xuICAgIGNvbnN0IHN0YWxlQnJhbmNoZXMgPSBicmFuY2hlcy5maWx0ZXIoYiA9PiB0aGlzLmlzU3RhbGVCcmFuY2goYikpO1xuICAgIFxuICAgIG1ldHJpY3NbJ3RvdGFsLWJyYW5jaGVzJ10gPSBicmFuY2hlcy5sZW5ndGg7XG4gICAgbWV0cmljc1snc3RhbGUtYnJhbmNoZXMnXSA9IHN0YWxlQnJhbmNoZXMubGVuZ3RoO1xuICAgIFxuICAgIGlmIChzdGFsZUJyYW5jaGVzLmxlbmd0aCA+IDApIHtcbiAgICAgIGlzc3Vlcy5wdXNoKHtcbiAgICAgICAgdHlwZTogJ3dhcm5pbmcnLFxuICAgICAgICBtZXNzYWdlOiBgRm91bmQgJHtzdGFsZUJyYW5jaGVzLmxlbmd0aH0gc3RhbGUgYnJhbmNoKGVzKWAsXG4gICAgICAgIHNldmVyaXR5OiAnbWVkaXVtJ1xuICAgICAgfSk7XG4gICAgICBcbiAgICAgIHN1Z2dlc3Rpb25zLnB1c2goJ0NsZWFuIHVwIG9sZCBicmFuY2hlcyB0byBtYWludGFpbiBhIHRpZHkgcmVwb3NpdG9yeScpO1xuICAgIH1cbiAgICBcbiAgICBpZiAoYnJhbmNoZXMubGVuZ3RoID4gMjApIHtcbiAgICAgIGlzc3Vlcy5wdXNoKHtcbiAgICAgICAgdHlwZTogJ2luZm8nLFxuICAgICAgICBtZXNzYWdlOiBgUmVwb3NpdG9yeSBoYXMgJHticmFuY2hlcy5sZW5ndGh9IGJyYW5jaGVzYCxcbiAgICAgICAgc2V2ZXJpdHk6ICdsb3cnXG4gICAgICB9KTtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgIGlkOiAnYnJhbmNoLWFuYWx5c2lzJyxcbiAgICAgIHN1bW1hcnk6ICdCcmFuY2ggYW5hbHlzaXMgY29tcGxldGVkJyxcbiAgICAgIGlzc3VlcyxcbiAgICAgIG1ldHJpY3MsXG4gICAgICBzdWdnZXN0aW9ucyxcbiAgICAgIGNvbmZpZGVuY2U6IDAuOFxuICAgIH07XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGFuYWx5emVDaGFuZ2VzKGNvbnRleHQ6IFBsdWdpbkNvbnRleHQpOiBQcm9taXNlPEFuYWx5c2lzUmVzdWx0PiB7XG4gICAgY29uc3QgaXNzdWVzOiBJc3N1ZVtdID0gW107XG4gICAgY29uc3QgbWV0cmljczogUmVjb3JkPHN0cmluZywgbnVtYmVyPiA9IHt9O1xuICAgIGNvbnN0IHN1Z2dlc3Rpb25zOiBzdHJpbmdbXSA9IFtdO1xuICAgIFxuICAgIC8vIEFuYWx5emUgdW5jb21taXR0ZWQgY2hhbmdlc1xuICAgIGNvbnN0IHVuY29tbWl0dGVkRmlsZXMgPSBhd2FpdCB0aGlzLmdldFVuY29tbWl0dGVkRmlsZXMoY29udGV4dCk7XG4gICAgbWV0cmljc1sndW5jb21taXR0ZWQtZmlsZXMnXSA9IHVuY29tbWl0dGVkRmlsZXMubGVuZ3RoO1xuICAgIFxuICAgIGlmICh1bmNvbW1pdHRlZEZpbGVzLmxlbmd0aCA+IDEwKSB7XG4gICAgICBpc3N1ZXMucHVzaCh7XG4gICAgICAgIHR5cGU6ICd3YXJuaW5nJyxcbiAgICAgICAgbWVzc2FnZTogYCR7dW5jb21taXR0ZWRGaWxlcy5sZW5ndGh9IGZpbGVzIHdpdGggdW5jb21taXR0ZWQgY2hhbmdlc2AsXG4gICAgICAgIHNldmVyaXR5OiAnbWVkaXVtJ1xuICAgICAgfSk7XG4gICAgfVxuICAgIFxuICAgIC8vIEFuYWx5emUgZmlsZSBzaXplc1xuICAgIGNvbnN0IGxhcmdlRmlsZXMgPSB1bmNvbW1pdHRlZEZpbGVzLmZpbHRlcihmID0+IHRoaXMuaXNMYXJnZUZpbGUoZikpO1xuICAgIG1ldHJpY3NbJ2xhcmdlLXVuY29tbWl0dGVkLWZpbGVzJ10gPSBsYXJnZUZpbGVzLmxlbmd0aDtcbiAgICBcbiAgICBpZiAobGFyZ2VGaWxlcy5sZW5ndGggPiAwKSB7XG4gICAgICBpc3N1ZXMucHVzaCh7XG4gICAgICAgIHR5cGU6ICd3YXJuaW5nJyxcbiAgICAgICAgbWVzc2FnZTogYCR7bGFyZ2VGaWxlcy5sZW5ndGh9IGxhcmdlIGZpbGUocykgd2l0aCB1bmNvbW1pdHRlZCBjaGFuZ2VzYCxcbiAgICAgICAgc2V2ZXJpdHk6ICdoaWdoJ1xuICAgICAgfSk7XG4gICAgICBcbiAgICAgIHN1Z2dlc3Rpb25zLnB1c2goJ1VzZSBHaXQgTEZTIGZvciBmaWxlcyBsYXJnZXIgdGhhbiAxMDBNQicpO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgaWQ6ICdjaGFuZ2VzLWFuYWx5c2lzJyxcbiAgICAgIHN1bW1hcnk6ICdDaGFuZ2VzIGFuYWx5c2lzIGNvbXBsZXRlZCcsXG4gICAgICBpc3N1ZXMsXG4gICAgICBtZXRyaWNzLFxuICAgICAgc3VnZ2VzdGlvbnMsXG4gICAgICBjb25maWRlbmNlOiAwLjg1XG4gICAgfTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgcGVyZm9ybUhlYWx0aENoZWNrKGNvbnRleHQ6IFBsdWdpbkNvbnRleHQpOiBQcm9taXNlPGFueT4ge1xuICAgIGNvbnN0IGhlYWx0aCA9IHtcbiAgICAgIG92ZXJhbGw6ICdnb29kJyxcbiAgICAgIHNjb3Jlczoge1xuICAgICAgICBjb21taXRRdWFsaXR5OiAwLFxuICAgICAgICBicmFuY2hIZWFsdGg6IDAsXG4gICAgICAgIHJlcG9zaXRvcnlTaXplOiAwLFxuICAgICAgICB3b3JrZmxvd0VmZmljaWVuY3k6IDBcbiAgICAgIH0sXG4gICAgICByZWNvbW1lbmRhdGlvbnM6IFtdIGFzIHN0cmluZ1tdXG4gICAgfTtcbiAgICBcbiAgICAvLyBQZXJmb3JtIHZhcmlvdXMgaGVhbHRoIGNoZWNrc1xuICAgIGNvbnN0IGNvbW1pdEFuYWx5c2lzID0gYXdhaXQgdGhpcy5hbmFseXplQ29tbWl0SGlzdG9yeShjb250ZXh0KTtcbiAgICBoZWFsdGguc2NvcmVzLmNvbW1pdFF1YWxpdHkgPSB0aGlzLmNhbGN1bGF0ZUNvbW1pdFF1YWxpdHlTY29yZShjb21taXRBbmFseXNpcyk7XG4gICAgXG4gICAgY29uc3QgYnJhbmNoQW5hbHlzaXMgPSBhd2FpdCB0aGlzLmFuYWx5emVCcmFuY2hlcyhjb250ZXh0KTtcbiAgICBoZWFsdGguc2NvcmVzLmJyYW5jaEhlYWx0aCA9IHRoaXMuY2FsY3VsYXRlQnJhbmNoSGVhbHRoU2NvcmUoYnJhbmNoQW5hbHlzaXMpO1xuICAgIFxuICAgIC8vIE92ZXJhbGwgc2NvcmVcbiAgICBjb25zdCBvdmVyYWxsU2NvcmUgPSAoXG4gICAgICBoZWFsdGguc2NvcmVzLmNvbW1pdFF1YWxpdHkgKyBcbiAgICAgIGhlYWx0aC5zY29yZXMuYnJhbmNoSGVhbHRoICsgXG4gICAgICBoZWFsdGguc2NvcmVzLnJlcG9zaXRvcnlTaXplICsgXG4gICAgICBoZWFsdGguc2NvcmVzLndvcmtmbG93RWZmaWNpZW5jeVxuICAgICkgLyA0O1xuICAgIFxuICAgIGlmIChvdmVyYWxsU2NvcmUgPj0gMC44KSB7XG4gICAgICBoZWFsdGgub3ZlcmFsbCA9ICdleGNlbGxlbnQnO1xuICAgIH0gZWxzZSBpZiAob3ZlcmFsbFNjb3JlID49IDAuNikge1xuICAgICAgaGVhbHRoLm92ZXJhbGwgPSAnZ29vZCc7XG4gICAgfSBlbHNlIGlmIChvdmVyYWxsU2NvcmUgPj0gMC40KSB7XG4gICAgICBoZWFsdGgub3ZlcmFsbCA9ICdmYWlyJztcbiAgICB9IGVsc2Uge1xuICAgICAgaGVhbHRoLm92ZXJhbGwgPSAncG9vcic7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiBoZWFsdGg7XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIHN1Z2dlc3RXb3JrZmxvd09wdGltaXphdGlvbnMoY29udGV4dDogUGx1Z2luQ29udGV4dCk6IFByb21pc2U8YW55W10+IHtcbiAgICByZXR1cm4gW1xuICAgICAge1xuICAgICAgICB0aXRsZTogJ1NldHVwIEdpdCBIb29rcycsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnQWRkIHByZS1jb21taXQgaG9va3MgZm9yIGNvZGUgcXVhbGl0eSBjaGVja3MnLFxuICAgICAgICBpbXBhY3Q6ICdIaWdoIC0gcHJldmVudHMgYmFkIGNvbW1pdHMnLFxuICAgICAgICBhY3Rpb246ICdzZXR1cC1ob29rcydcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIHRpdGxlOiAnQ29uZmlndXJlIEJyYW5jaCBQcm90ZWN0aW9uJyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdTZXR1cCBicmFuY2ggcHJvdGVjdGlvbiBydWxlcyBmb3IgbWFpbiBicmFuY2gnLFxuICAgICAgICBpbXBhY3Q6ICdNZWRpdW0gLSBpbXByb3ZlcyBjb2RlIHF1YWxpdHknLFxuICAgICAgICBhY3Rpb246ICdicmFuY2gtcHJvdGVjdGlvbidcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIHRpdGxlOiAnT3B0aW1pemUgLmdpdGlnbm9yZScsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnVXBkYXRlIC5naXRpZ25vcmUgdG8gZXhjbHVkZSB1bm5lY2Vzc2FyeSBmaWxlcycsXG4gICAgICAgIGltcGFjdDogJ0xvdyAtIHJlZHVjZXMgcmVwb3NpdG9yeSBzaXplJyxcbiAgICAgICAgYWN0aW9uOiAnb3B0aW1pemUtZ2l0aWdub3JlJ1xuICAgICAgfVxuICAgIF07XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGFwcGx5T3B0aW1pemF0aW9uKG9wdGltaXphdGlvbjogYW55LCBjb250ZXh0OiBQbHVnaW5Db250ZXh0KTogUHJvbWlzZTx2b2lkPiB7XG4gICAgc3dpdGNoIChvcHRpbWl6YXRpb24uYWN0aW9uKSB7XG4gICAgICBjYXNlICdzZXR1cC1ob29rcyc6XG4gICAgICAgIGF3YWl0IHRoaXMuc2V0dXBHaXRIb29rcyhjb250ZXh0KTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdicmFuY2gtcHJvdGVjdGlvbic6XG4gICAgICAgIGF3YWl0IHRoaXMuc2V0dXBCcmFuY2hQcm90ZWN0aW9uKGNvbnRleHQpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ29wdGltaXplLWdpdGlnbm9yZSc6XG4gICAgICAgIGF3YWl0IHRoaXMub3B0aW1pemVHaXRpZ25vcmUoY29udGV4dCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgY29uc29sZS5sb2coYFVua25vd24gb3B0aW1pemF0aW9uIGFjdGlvbjogJHtvcHRpbWl6YXRpb24uYWN0aW9ufWApO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZ2V0UmVjZW50Q29tbWl0cyhjb250ZXh0OiBQbHVnaW5Db250ZXh0KTogUHJvbWlzZTxhbnlbXT4ge1xuICAgIC8vIFNpbXVsYXRlIEdpdCBsb2dcbiAgICByZXR1cm4gW1xuICAgICAgeyBoYXNoOiAnYWJjMTIzJywgbWVzc2FnZTogJ2ZlYXQ6IGFkZCBuZXcgZmVhdHVyZScsIGF1dGhvcjogJ2RldicsIGRhdGU6IG5ldyBEYXRlKCkgfSxcbiAgICAgIHsgaGFzaDogJ2RlZjQ1NicsIG1lc3NhZ2U6ICdmaXggYnVnJywgYXV0aG9yOiAnZGV2JywgZGF0ZTogbmV3IERhdGUoKSB9LFxuICAgICAgeyBoYXNoOiAnZ2hpNzg5JywgbWVzc2FnZTogJ3VwZGF0ZSBkb2NzJywgYXV0aG9yOiAnZGV2JywgZGF0ZTogbmV3IERhdGUoKSB9XG4gICAgXTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZ2V0QnJhbmNoZXMoY29udGV4dDogUGx1Z2luQ29udGV4dCk6IFByb21pc2U8YW55W10+IHtcbiAgICAvLyBTaW11bGF0ZSBHaXQgYnJhbmNoIGxpc3RcbiAgICByZXR1cm4gW1xuICAgICAgeyBuYW1lOiAnbWFpbicsIGxhc3RDb21taXQ6IG5ldyBEYXRlKCksIGFjdGl2ZTogdHJ1ZSB9LFxuICAgICAgeyBuYW1lOiAnZGV2ZWxvcCcsIGxhc3RDb21taXQ6IG5ldyBEYXRlKERhdGUubm93KCkgLSA4NjQwMDAwMCksIGFjdGl2ZTogZmFsc2UgfSxcbiAgICAgIHsgbmFtZTogJ2ZlYXR1cmUvb2xkJywgbGFzdENvbW1pdDogbmV3IERhdGUoRGF0ZS5ub3coKSAtIDg2NDAwMDAwICogMzApLCBhY3RpdmU6IGZhbHNlIH1cbiAgICBdO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBnZXRVbmNvbW1pdHRlZEZpbGVzKGNvbnRleHQ6IFBsdWdpbkNvbnRleHQpOiBQcm9taXNlPGFueVtdPiB7XG4gICAgLy8gU2ltdWxhdGUgR2l0IHN0YXR1c1xuICAgIHJldHVybiBbXG4gICAgICB7IHBhdGg6ICdzcmMvbWFpbi50cycsIHN0YXR1czogJ21vZGlmaWVkJywgc2l6ZTogMTAyNCB9LFxuICAgICAgeyBwYXRoOiAnUkVBRE1FLm1kJywgc3RhdHVzOiAnbW9kaWZpZWQnLCBzaXplOiAyMDQ4IH1cbiAgICBdO1xuICB9XG5cbiAgcHJpdmF0ZSBhbmFseXplQ29tbWl0RnJlcXVlbmN5KGNvbW1pdHM6IGFueVtdKTogeyBkYWlseTogbnVtYmVyOyB3ZWVrbHk6IG51bWJlciB9IHtcbiAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuICAgIGNvbnN0IGRheUFnbyA9IG5ldyBEYXRlKG5vdy5nZXRUaW1lKCkgLSA4NjQwMDAwMCk7XG4gICAgY29uc3Qgd2Vla0FnbyA9IG5ldyBEYXRlKG5vdy5nZXRUaW1lKCkgLSA4NjQwMDAwMCAqIDcpO1xuICAgIFxuICAgIGNvbnN0IGRhaWx5Q29tbWl0cyA9IGNvbW1pdHMuZmlsdGVyKGMgPT4gYy5kYXRlID49IGRheUFnbykubGVuZ3RoO1xuICAgIGNvbnN0IHdlZWtseUNvbW1pdHMgPSBjb21taXRzLmZpbHRlcihjID0+IGMuZGF0ZSA+PSB3ZWVrQWdvKS5sZW5ndGg7XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgIGRhaWx5OiBkYWlseUNvbW1pdHMsXG4gICAgICB3ZWVrbHk6IHdlZWtseUNvbW1pdHNcbiAgICB9O1xuICB9XG5cbiAgcHJpdmF0ZSBpc1N0YWxlQnJhbmNoKGJyYW5jaDogYW55KTogYm9vbGVhbiB7XG4gICAgY29uc3QgbW9udGhBZ28gPSBuZXcgRGF0ZShEYXRlLm5vdygpIC0gODY0MDAwMDAgKiAzMCk7XG4gICAgcmV0dXJuIGJyYW5jaC5sYXN0Q29tbWl0IDwgbW9udGhBZ28gJiYgIWJyYW5jaC5hY3RpdmU7XG4gIH1cblxuICBwcml2YXRlIGlzTGFyZ2VGaWxlKGZpbGU6IGFueSk6IGJvb2xlYW4ge1xuICAgIHJldHVybiBmaWxlLnNpemUgPiAxMDAgKiAxMDI0ICogMTAyNDsgLy8gMTAwTUJcbiAgfVxuXG4gIHByaXZhdGUgY2FsY3VsYXRlQ29tbWl0UXVhbGl0eVNjb3JlKGFuYWx5c2lzOiBBbmFseXNpc1Jlc3VsdCk6IG51bWJlciB7XG4gICAgY29uc3QgdG90YWxDb21taXRzID0gYW5hbHlzaXMubWV0cmljcz8uWyd0b3RhbC1jb21taXRzJ10gfHwgMTtcbiAgICBjb25zdCBwb29yQ29tbWl0cyA9IGFuYWx5c2lzLm1ldHJpY3M/LlsncG9vci1jb21taXQtbWVzc2FnZXMnXSB8fCAwO1xuICAgIGNvbnN0IGxvbmdDb21taXRzID0gYW5hbHlzaXMubWV0cmljcz8uWydsb25nLWNvbW1pdC1tZXNzYWdlcyddIHx8IDA7XG4gICAgXG4gICAgY29uc3QgcXVhbGl0eVNjb3JlID0gMSAtIChwb29yQ29tbWl0cyArIGxvbmdDb21taXRzICogMC41KSAvIHRvdGFsQ29tbWl0cztcbiAgICByZXR1cm4gTWF0aC5tYXgoMCwgTWF0aC5taW4oMSwgcXVhbGl0eVNjb3JlKSk7XG4gIH1cblxuICBwcml2YXRlIGNhbGN1bGF0ZUJyYW5jaEhlYWx0aFNjb3JlKGFuYWx5c2lzOiBBbmFseXNpc1Jlc3VsdCk6IG51bWJlciB7XG4gICAgY29uc3QgdG90YWxCcmFuY2hlcyA9IGFuYWx5c2lzLm1ldHJpY3M/LlsndG90YWwtYnJhbmNoZXMnXSB8fCAxO1xuICAgIGNvbnN0IHN0YWxlQnJhbmNoZXMgPSBhbmFseXNpcy5tZXRyaWNzPy5bJ3N0YWxlLWJyYW5jaGVzJ10gfHwgMDtcbiAgICBcbiAgICBjb25zdCBoZWFsdGhTY29yZSA9IDEgLSAoc3RhbGVCcmFuY2hlcyAvIHRvdGFsQnJhbmNoZXMpO1xuICAgIHJldHVybiBNYXRoLm1heCgwLCBNYXRoLm1pbigxLCBoZWFsdGhTY29yZSkpO1xuICB9XG5cbiAgcHJpdmF0ZSBmb3JtYXRIZWFsdGhSZXBvcnQoaGVhbHRoOiBhbnkpOiBzdHJpbmcge1xuICAgIHJldHVybiBgXG4jIEdpdCBSZXBvc2l0b3J5IEhlYWx0aCBSZXBvcnRcblxuIyMgT3ZlcmFsbCBIZWFsdGg6ICR7aGVhbHRoLm92ZXJhbGwudG9VcHBlckNhc2UoKX1cblxuIyMgU2NvcmVzXG4tICoqQ29tbWl0IFF1YWxpdHkqKjogJHtNYXRoLnJvdW5kKGhlYWx0aC5zY29yZXMuY29tbWl0UXVhbGl0eSAqIDEwMCl9JVxuLSAqKkJyYW5jaCBIZWFsdGgqKjogJHtNYXRoLnJvdW5kKGhlYWx0aC5zY29yZXMuYnJhbmNoSGVhbHRoICogMTAwKX0lXG4tICoqUmVwb3NpdG9yeSBTaXplKio6ICR7TWF0aC5yb3VuZChoZWFsdGguc2NvcmVzLnJlcG9zaXRvcnlTaXplICogMTAwKX0lXG4tICoqV29ya2Zsb3cgRWZmaWNpZW5jeSoqOiAke01hdGgucm91bmQoaGVhbHRoLnNjb3Jlcy53b3JrZmxvd0VmZmljaWVuY3kgKiAxMDApfSVcblxuIyMgUmVjb21tZW5kYXRpb25zXG4ke2hlYWx0aC5yZWNvbW1lbmRhdGlvbnMubWFwKChyZWM6IGFueSkgPT4gYC0gJHtyZWN9YCkuam9pbignXFxuJyl9XG5cbi0tLVxuKkdlbmVyYXRlZCBieSBBSSBEZWJ1ZyBHaXQgQW5hbHl6ZXIgUGx1Z2luKlxuICAgIGAudHJpbSgpO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBzZXR1cEdpdEhvb2tzKGNvbnRleHQ6IFBsdWdpbkNvbnRleHQpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAvLyBJbXBsZW1lbnRhdGlvbiBmb3Igc2V0dGluZyB1cCBHaXQgaG9va3NcbiAgICB0aGlzLmFwaT8uc2hvd05vdGlmaWNhdGlvbj8uKCdHaXQgaG9va3Mgc2V0dXAgY29tcGxldGVkJywgJ2luZm8nKTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgc2V0dXBCcmFuY2hQcm90ZWN0aW9uKGNvbnRleHQ6IFBsdWdpbkNvbnRleHQpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAvLyBJbXBsZW1lbnRhdGlvbiBmb3Igc2V0dGluZyB1cCBicmFuY2ggcHJvdGVjdGlvblxuICAgIHRoaXMuYXBpPy5zaG93Tm90aWZpY2F0aW9uPy4oJ0JyYW5jaCBwcm90ZWN0aW9uIGNvbmZpZ3VyZWQnLCAnaW5mbycpO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBvcHRpbWl6ZUdpdGlnbm9yZShjb250ZXh0OiBQbHVnaW5Db250ZXh0KTogUHJvbWlzZTx2b2lkPiB7XG4gICAgLy8gSW1wbGVtZW50YXRpb24gZm9yIG9wdGltaXppbmcgLmdpdGlnbm9yZVxuICAgIHRoaXMuYXBpPy5zaG93Tm90aWZpY2F0aW9uPy4oJy5naXRpZ25vcmUgb3B0aW1pemVkJywgJ2luZm8nKTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgb25HaXRDb21taXQoZGF0YTogYW55LCBjb250ZXh0OiBQbHVnaW5Db250ZXh0KTogUHJvbWlzZTx2b2lkPiB7XG4gICAgLy8gSGFuZGxlIEdpdCBjb21taXQgZXZlbnRzXG4gICAgY29uc29sZS5sb2coJ0dpdCBjb21taXQgZGV0ZWN0ZWQ6JywgZGF0YSk7XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIG9uQnJhbmNoQ2hhbmdlZChkYXRhOiBhbnksIGNvbnRleHQ6IFBsdWdpbkNvbnRleHQpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAvLyBIYW5kbGUgYnJhbmNoIGNoYW5nZSBldmVudHNcbiAgICBjb25zb2xlLmxvZygnQnJhbmNoIGNoYW5nZWQ6JywgZGF0YSk7XG4gIH1cbn1cbiJdLCJ2ZXJzaW9uIjozfQ==