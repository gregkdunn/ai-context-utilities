6cac6e516c77ccd4f0b1e9504bedc7ff
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.InteractiveDashboardEngine = void 0;
const events_1 = require("events");
/**
 * Interactive Dashboard Engine for Phase 4.4
 *
 * Advanced dashboard creation and management system with:
 * - Dynamic widget creation and configuration
 * - Real-time data updates and visualization
 * - Interactive filtering and drill-down capabilities
 * - Custom themes and responsive layouts
 * - Export and sharing functionality
 * - Performance optimization for large datasets
 */
class InteractiveDashboardEngine extends events_1.EventEmitter {
    dashboards = new Map();
    widgets = new Map();
    themes = new Map();
    updateIntervals = new Map();
    widgetDataCache = new Map();
    permissions = new Map();
    constructor() {
        super();
        this.initializeEngine();
    }
    /**
     * Initialize the dashboard engine
     */
    initializeEngine() {
        this.setupDefaultThemes();
        this.setupDefaultWidgetTypes();
        this.emit('engineInitialized');
    }
    /**
     * Create a new dashboard
     */
    async createDashboard(config) {
        const dashboard = {
            id: config.id || this.generateDashboardId(),
            name: config.name,
            description: config.description,
            layout: config.layout || this.createDefaultLayout(),
            widgets: [],
            filters: config.filters || [],
            theme: config.theme || 'default',
            refreshInterval: config.refreshInterval || 30000,
            isRealTime: config.isRealTime || false,
            permissions: config.permissions || { read: ['*'], write: ['admin'] },
            createdAt: new Date(),
            updatedAt: new Date(),
            createdBy: config.createdBy || 'system',
            tags: config.tags || [],
            isPublic: config.isPublic || false
        };
        // Create widgets if provided
        if (config.widgets) {
            for (const widgetConfig of config.widgets) {
                const widget = await this.createWidget(widgetConfig);
                dashboard.widgets.push(widget);
            }
        }
        this.dashboards.set(dashboard.id, dashboard);
        // Set up real-time updates if enabled
        if (dashboard.isRealTime) {
            this.setupRealTimeUpdates(dashboard.id);
        }
        this.emit('dashboardCreated', dashboard);
        return dashboard;
    }
    /**
     * Update an existing dashboard
     */
    async updateDashboard(dashboardId, updates) {
        const dashboard = this.dashboards.get(dashboardId);
        if (!dashboard) {
            throw new Error(`Dashboard not found: ${dashboardId}`);
        }
        // Apply updates
        Object.assign(dashboard, updates, { updatedAt: new Date() });
        // Update real-time settings if changed
        if (updates.isRealTime !== undefined) {
            if (updates.isRealTime) {
                this.setupRealTimeUpdates(dashboardId);
            }
            else {
                this.stopRealTimeUpdates(dashboardId);
            }
        }
        this.dashboards.set(dashboardId, dashboard);
        this.emit('dashboardUpdated', dashboard);
        return dashboard;
    }
    /**
     * Delete a dashboard
     */
    deleteDashboard(dashboardId) {
        const dashboard = this.dashboards.get(dashboardId);
        if (!dashboard) {
            return false;
        }
        // Clean up widgets
        dashboard.widgets.forEach((widget) => {
            this.widgets.delete(widget.id);
            this.widgetDataCache.delete(widget.id);
        });
        // Stop real-time updates
        this.stopRealTimeUpdates(dashboardId);
        this.dashboards.delete(dashboardId);
        this.emit('dashboardDeleted', dashboardId);
        return true;
    }
    /**
     * Get a dashboard by ID
     */
    getDashboard(dashboardId) {
        return this.dashboards.get(dashboardId);
    }
    /**
     * List all dashboards
     */
    listDashboards(userId) {
        const dashboards = Array.from(this.dashboards.values());
        if (userId) {
            return dashboards.filter(d => this.hasPermission(d, userId, 'read'));
        }
        return dashboards;
    }
    /**
     * Create a new widget
     */
    async createWidget(config) {
        const widget = {
            id: config.id || this.generateWidgetId(),
            type: config.type,
            title: config.title,
            description: config.description,
            position: config.position || { x: 0, y: 0, width: 4, height: 4 },
            configuration: config.configuration || {},
            dataSource: config.dataSource,
            filters: config.filters || [],
            refreshInterval: config.refreshInterval || 30000,
            isVisible: config.isVisible !== false,
            createdAt: new Date(),
            updatedAt: new Date(),
            style: config.style || {},
            interactions: config.interactions || {}
        };
        this.widgets.set(widget.id, widget);
        // Initialize widget data
        await this.refreshWidgetData(widget.id);
        this.emit('widgetCreated', widget);
        return widget;
    }
    /**
     * Update a widget
     */
    async updateWidget(widgetId, updates) {
        const widget = this.widgets.get(widgetId);
        if (!widget) {
            throw new Error(`Widget not found: ${widgetId}`);
        }
        Object.assign(widget, updates, { updatedAt: new Date() });
        // Refresh data if configuration changed
        if (updates.configuration || updates.dataSource || updates.filters) {
            await this.refreshWidgetData(widgetId);
        }
        this.widgets.set(widgetId, widget);
        this.emit('widgetUpdated', widget);
        return widget;
    }
    /**
     * Delete a widget
     */
    deleteWidget(widgetId) {
        const widget = this.widgets.get(widgetId);
        if (!widget) {
            return false;
        }
        this.widgets.delete(widgetId);
        this.widgetDataCache.delete(widgetId);
        this.emit('widgetDeleted', widgetId);
        return true;
    }
    /**
     * Get widget data
     */
    getWidgetData(widgetId) {
        return this.widgetDataCache.get(widgetId);
    }
    /**
     * Refresh widget data
     */
    async refreshWidgetData(widgetId) {
        const widget = this.widgets.get(widgetId);
        if (!widget) {
            throw new Error(`Widget not found: ${widgetId}`);
        }
        const data = await this.fetchWidgetData(widget);
        this.widgetDataCache.set(widgetId, data);
        this.emit('widgetDataRefreshed', { widgetId, data });
        return data;
    }
    /**
     * Apply filters to a dashboard
     */
    applyFilters(dashboardId, filters) {
        const dashboard = this.dashboards.get(dashboardId);
        if (!dashboard) {
            throw new Error(`Dashboard not found: ${dashboardId}`);
        }
        dashboard.filters = filters;
        dashboard.updatedAt = new Date();
        // Refresh all widgets with new filters
        dashboard.widgets.forEach((widget) => {
            this.refreshWidgetData(widget.id);
        });
        this.emit('filtersApplied', { dashboardId, filters });
    }
    /**
     * Export dashboard
     */
    async exportDashboard(dashboardId, format = 'json') {
        const dashboard = this.dashboards.get(dashboardId);
        if (!dashboard) {
            throw new Error(`Dashboard not found: ${dashboardId}`);
        }
        const exportData = {
            dashboard,
            format,
            exportedAt: new Date(),
            data: await this.prepareExportData(dashboard, format)
        };
        this.emit('dashboardExported', exportData);
        return exportData;
    }
    /**
     * Clone a dashboard
     */
    async cloneDashboard(dashboardId, newName, userId) {
        const original = this.dashboards.get(dashboardId);
        if (!original) {
            throw new Error(`Dashboard not found: ${dashboardId}`);
        }
        const cloneConfig = {
            name: newName,
            description: `Clone of ${original.name}`,
            layout: { ...original.layout },
            widgets: original.widgets.map((w) => ({ ...w })),
            filters: [...original.filters],
            theme: original.theme,
            refreshInterval: original.refreshInterval,
            isRealTime: original.isRealTime,
            createdBy: userId || 'system',
            tags: [...(original.tags || []), 'clone']
        };
        return this.createDashboard(cloneConfig);
    }
    /**
     * Get dashboard themes
     */
    getThemes() {
        return Array.from(this.themes.values());
    }
    /**
     * Create a custom theme
     */
    createTheme(theme) {
        this.themes.set(theme.id, theme);
        this.emit('themeCreated', theme);
    }
    /**
     * Get widget types
     */
    getWidgetTypes() {
        return [
            { id: 'line-chart', name: 'Line Chart', category: 'charts' },
            { id: 'bar-chart', name: 'Bar Chart', category: 'charts' },
            { id: 'pie-chart', name: 'Pie Chart', category: 'charts' },
            { id: 'scatter-plot', name: 'Scatter Plot', category: 'charts' },
            { id: 'heatmap', name: 'Heatmap', category: 'charts' },
            { id: 'metric-card', name: 'Metric Card', category: 'metrics' },
            { id: 'gauge', name: 'Gauge', category: 'metrics' },
            { id: 'table', name: 'Table', category: 'data' },
            { id: 'list', name: 'List', category: 'data' },
            { id: 'text', name: 'Text', category: 'content' },
            { id: 'image', name: 'Image', category: 'content' },
            { id: 'iframe', name: 'iFrame', category: 'content' }
        ];
    }
    /**
     * Get dashboard analytics
     */
    getDashboardAnalytics(dashboardId) {
        const dashboard = this.dashboards.get(dashboardId);
        if (!dashboard) {
            throw new Error(`Dashboard not found: ${dashboardId}`);
        }
        return {
            views: this.getDashboardViews(dashboardId),
            interactions: this.getDashboardInteractions(dashboardId),
            performance: this.getDashboardPerformance(dashboardId),
            widgets: dashboard.widgets.map((w) => ({
                id: w.id,
                type: w.type,
                interactions: this.getWidgetInteractions(w.id),
                loadTime: this.getWidgetLoadTime(w.id)
            }))
        };
    }
    /**
     * Dispose of the dashboard engine
     */
    dispose() {
        // Stop all real-time updates
        for (const [dashboardId] of this.updateIntervals) {
            this.stopRealTimeUpdates(dashboardId);
        }
        // Clear all data
        this.dashboards.clear();
        this.widgets.clear();
        this.widgetDataCache.clear();
        this.themes.clear();
        this.permissions.clear();
        this.removeAllListeners();
    }
    // Private helper methods
    setupDefaultThemes() {
        const themes = [
            {
                id: 'default',
                name: 'Default',
                colors: {
                    primary: '#007acc',
                    secondary: '#6c757d',
                    success: '#28a745',
                    warning: '#ffc107',
                    error: '#dc3545',
                    background: '#ffffff',
                    surface: '#f8f9fa',
                    text: '#212529'
                },
                fonts: {
                    body: 'system-ui, -apple-system, sans-serif',
                    heading: 'system-ui, -apple-system, sans-serif',
                    monospace: 'Consolas, Monaco, monospace'
                },
                spacing: {
                    small: '8px',
                    medium: '16px',
                    large: '24px'
                }
            },
            {
                id: 'dark',
                name: 'Dark',
                colors: {
                    primary: '#0d7377',
                    secondary: '#6c757d',
                    success: '#20c997',
                    warning: '#ffc107',
                    error: '#dc3545',
                    background: '#1a1a1a',
                    surface: '#2d2d2d',
                    text: '#ffffff'
                },
                fonts: {
                    body: 'system-ui, -apple-system, sans-serif',
                    heading: 'system-ui, -apple-system, sans-serif',
                    monospace: 'Consolas, Monaco, monospace'
                },
                spacing: {
                    small: '8px',
                    medium: '16px',
                    large: '24px'
                }
            }
        ];
        themes.forEach(theme => this.themes.set(theme.id, theme));
    }
    setupDefaultWidgetTypes() {
        // Widget types are defined in getWidgetTypes() method
        this.emit('widgetTypesInitialized');
    }
    createDefaultLayout() {
        return {
            type: 'grid',
            columns: 12,
            rows: 'auto',
            gap: '16px',
            padding: '16px'
        };
    }
    setupRealTimeUpdates(dashboardId) {
        const dashboard = this.dashboards.get(dashboardId);
        if (!dashboard) {
            return;
        }
        // Stop existing interval if any
        this.stopRealTimeUpdates(dashboardId);
        // Start new interval
        const interval = setInterval(() => {
            this.updateDashboardData(dashboardId);
        }, dashboard.refreshInterval);
        this.updateIntervals.set(dashboardId, interval);
    }
    stopRealTimeUpdates(dashboardId) {
        const interval = this.updateIntervals.get(dashboardId);
        if (interval) {
            clearInterval(interval);
            this.updateIntervals.delete(dashboardId);
        }
    }
    async updateDashboardData(dashboardId) {
        const dashboard = this.dashboards.get(dashboardId);
        if (!dashboard) {
            return;
        }
        const updates = [];
        for (const widget of dashboard.widgets) {
            try {
                const data = await this.refreshWidgetData(widget.id);
                updates.push({
                    widgetId: widget.id,
                    data,
                    timestamp: new Date()
                });
            }
            catch (error) {
                console.error(`Error updating widget ${widget.id}:`, error);
            }
        }
        this.emit('dashboardDataUpdated', { dashboardId, updates });
    }
    async fetchWidgetData(widget) {
        // Simulate data fetching based on widget type and configuration
        const data = {
            id: widget.id,
            type: widget.type,
            data: await this.generateMockData(widget),
            metadata: {
                lastUpdated: new Date(),
                dataPoints: 0,
                source: widget.dataSource?.type || 'mock',
                filters: widget.filters
            }
        };
        return data;
    }
    async generateMockData(widget) {
        // Generate mock data based on widget type
        switch (widget.type) {
            case 'line-chart':
                return this.generateLineChartData();
            case 'bar-chart':
                return this.generateBarChartData();
            case 'pie-chart':
                return this.generatePieChartData();
            case 'metric-card':
                return this.generateMetricData();
            case 'table':
                return this.generateTableData();
            case 'gauge':
                return this.generateGaugeData();
            default:
                return {};
        }
    }
    generateLineChartData() {
        const data = [];
        const now = new Date();
        for (let i = 23; i >= 0; i--) {
            const timestamp = new Date(now.getTime() - i * 60 * 60 * 1000);
            data.push({
                x: timestamp.toISOString(),
                y: Math.floor(Math.random() * 100) + 50
            });
        }
        return {
            datasets: [{
                    label: 'Sample Data',
                    data,
                    borderColor: '#007acc',
                    backgroundColor: 'rgba(0, 122, 204, 0.1)'
                }]
        };
    }
    generateBarChartData() {
        return {
            labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
            datasets: [{
                    label: 'Sample Data',
                    data: Array.from({ length: 6 }, () => Math.floor(Math.random() * 100)),
                    backgroundColor: '#007acc'
                }]
        };
    }
    generatePieChartData() {
        return {
            labels: ['Category A', 'Category B', 'Category C', 'Category D'],
            datasets: [{
                    data: [30, 25, 25, 20],
                    backgroundColor: ['#007acc', '#28a745', '#ffc107', '#dc3545']
                }]
        };
    }
    generateMetricData() {
        return {
            value: Math.floor(Math.random() * 1000) + 100,
            change: (Math.random() - 0.5) * 20,
            unit: 'count',
            trend: Math.random() > 0.5 ? 'up' : 'down'
        };
    }
    generateTableData() {
        const columns = ['ID', 'Name', 'Status', 'Value'];
        const rows = [];
        for (let i = 0; i < 10; i++) {
            rows.push([
                i + 1,
                `Item ${i + 1}`,
                Math.random() > 0.5 ? 'Active' : 'Inactive',
                Math.floor(Math.random() * 100)
            ]);
        }
        return { columns, rows };
    }
    generateGaugeData() {
        return {
            value: Math.floor(Math.random() * 100),
            min: 0,
            max: 100,
            thresholds: [
                { value: 30, color: '#28a745' },
                { value: 70, color: '#ffc107' },
                { value: 90, color: '#dc3545' }
            ]
        };
    }
    hasPermission(dashboard, userId, action) {
        if (dashboard.isPublic && action === 'read') {
            return true;
        }
        const permissions = dashboard.permissions?.[action];
        return permissions ? (permissions.includes('*') || permissions.includes(userId)) : false;
    }
    async prepareExportData(dashboard, format) {
        switch (format) {
            case 'json':
                return {
                    dashboard,
                    widgets: dashboard.widgets.map((w) => ({
                        ...w,
                        data: this.widgetDataCache.get(w.id)
                    }))
                };
            case 'pdf':
                return { content: 'PDF export not implemented' };
            case 'png':
                return { content: 'PNG export not implemented' };
            case 'svg':
                return { content: 'SVG export not implemented' };
            default:
                throw new Error(`Unsupported export format: ${format}`);
        }
    }
    getDashboardViews(dashboardId) {
        // Mock implementation
        return Math.floor(Math.random() * 1000) + 10;
    }
    getDashboardInteractions(dashboardId) {
        // Mock implementation
        return Math.floor(Math.random() * 100) + 5;
    }
    getDashboardPerformance(dashboardId) {
        return {
            loadTime: Math.random() * 2000 + 500,
            renderTime: Math.random() * 500 + 100,
            dataFetchTime: Math.random() * 1000 + 200
        };
    }
    getWidgetInteractions(widgetId) {
        // Mock implementation
        return Math.floor(Math.random() * 50) + 1;
    }
    getWidgetLoadTime(widgetId) {
        // Mock implementation
        return Math.random() * 1000 + 100;
    }
    generateDashboardId() {
        return `dashboard_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
    }
    generateWidgetId() {
        return `widget_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
    }
}
exports.InteractiveDashboardEngine = InteractiveDashboardEngine;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2dyZWdkdW5uL3NyYy90ZXN0L2FpX2RlYnVnX2NvbnRleHQvdnNjb2RlL3NyYy9zZXJ2aWNlcy9hbmFseXRpY3MvZW5naW5lcy9pbnRlcmFjdGl2ZURhc2hib2FyZEVuZ2luZS50cyIsIm1hcHBpbmdzIjoiOzs7QUFBQSxtQ0FBc0M7QUFpQnRDOzs7Ozs7Ozs7O0dBVUc7QUFDSCxNQUFhLDBCQUEyQixTQUFRLHFCQUFZO0lBQ2xELFVBQVUsR0FBMkIsSUFBSSxHQUFHLEVBQUUsQ0FBQztJQUMvQyxPQUFPLEdBQWlDLElBQUksR0FBRyxFQUFFLENBQUM7SUFDbEQsTUFBTSxHQUFnQyxJQUFJLEdBQUcsRUFBRSxDQUFDO0lBQ2hELGVBQWUsR0FBZ0MsSUFBSSxHQUFHLEVBQUUsQ0FBQztJQUN6RCxlQUFlLEdBQTRCLElBQUksR0FBRyxFQUFFLENBQUM7SUFDckQsV0FBVyxHQUFxQyxJQUFJLEdBQUcsRUFBRSxDQUFDO0lBRWxFO1FBQ0UsS0FBSyxFQUFFLENBQUM7UUFDUixJQUFJLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQztJQUMxQixDQUFDO0lBRUQ7O09BRUc7SUFDSyxnQkFBZ0I7UUFDdEIsSUFBSSxDQUFDLGtCQUFrQixFQUFFLENBQUM7UUFDMUIsSUFBSSxDQUFDLHVCQUF1QixFQUFFLENBQUM7UUFDL0IsSUFBSSxDQUFDLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDO0lBQ2pDLENBQUM7SUFFRDs7T0FFRztJQUNJLEtBQUssQ0FBQyxlQUFlLENBQUMsTUFBdUI7UUFDbEQsTUFBTSxTQUFTLEdBQWM7WUFDM0IsRUFBRSxFQUFFLE1BQU0sQ0FBQyxFQUFFLElBQUksSUFBSSxDQUFDLG1CQUFtQixFQUFFO1lBQzNDLElBQUksRUFBRSxNQUFNLENBQUMsSUFBSTtZQUNqQixXQUFXLEVBQUUsTUFBTSxDQUFDLFdBQVc7WUFDL0IsTUFBTSxFQUFFLE1BQU0sQ0FBQyxNQUFNLElBQUksSUFBSSxDQUFDLG1CQUFtQixFQUFFO1lBQ25ELE9BQU8sRUFBRSxFQUFFO1lBQ1gsT0FB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QUcsRUFBRSxJQUFJLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQyxRQUFRLENBQUMsRUFBRSxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDO0lBQzlFLENBQUM7SUFFTyxnQkFBZ0I7UUFDdEIsT0FBTyxVQUFVLElBQUksQ0FBQyxHQUFHLEVBQUUsSUFBSSxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQztJQUMzRSxDQUFDO0NBQ0Y7QUFucUJELGdFQW1xQkMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL2dyZWdkdW5uL3NyYy90ZXN0L2FpX2RlYnVnX2NvbnRleHQvdnNjb2RlL3NyYy9zZXJ2aWNlcy9hbmFseXRpY3MvZW5naW5lcy9pbnRlcmFjdGl2ZURhc2hib2FyZEVuZ2luZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBFdmVudEVtaXR0ZXIgfSBmcm9tICdldmVudHMnO1xuaW1wb3J0IHsgXG4gIERhc2hib2FyZCwgXG4gIERhc2hib2FyZENvbmZpZywgXG4gIERhc2hib2FyZFdpZGdldCwgXG4gIFdpZGdldENvbmZpZywgXG4gIENoYXJ0Q29uZmlndXJhdGlvbiwgXG4gIERhc2hib2FyZEZpbHRlciwgXG4gIERhc2hib2FyZExheW91dCxcbiAgV2lkZ2V0RGF0YSxcbiAgRGFzaGJvYXJkVGhlbWUsXG4gIFJlYWxUaW1lVXBkYXRlLFxuICBEYXNoYm9hcmRFeHBvcnQsXG4gIFdpZGdldFR5cGUsXG4gIERhc2hib2FyZFBlcm1pc3Npb25cbn0gZnJvbSAnLi4vLi4vLi4vdHlwZXMnO1xuXG4vKipcbiAqIEludGVyYWN0aXZlIERhc2hib2FyZCBFbmdpbmUgZm9yIFBoYXNlIDQuNFxuICogXG4gKiBBZHZhbmNlZCBkYXNoYm9hcmQgY3JlYXRpb24gYW5kIG1hbmFnZW1lbnQgc3lzdGVtIHdpdGg6XG4gKiAtIER5bmFtaWMgd2lkZ2V0IGNyZWF0aW9uIGFuZCBjb25maWd1cmF0aW9uXG4gKiAtIFJlYWwtdGltZSBkYXRhIHVwZGF0ZXMgYW5kIHZpc3VhbGl6YXRpb25cbiAqIC0gSW50ZXJhY3RpdmUgZmlsdGVyaW5nIGFuZCBkcmlsbC1kb3duIGNhcGFiaWxpdGllc1xuICogLSBDdXN0b20gdGhlbWVzIGFuZCByZXNwb25zaXZlIGxheW91dHNcbiAqIC0gRXhwb3J0IGFuZCBzaGFyaW5nIGZ1bmN0aW9uYWxpdHlcbiAqIC0gUGVyZm9ybWFuY2Ugb3B0aW1pemF0aW9uIGZvciBsYXJnZSBkYXRhc2V0c1xuICovXG5leHBvcnQgY2xhc3MgSW50ZXJhY3RpdmVEYXNoYm9hcmRFbmdpbmUgZXh0ZW5kcyBFdmVudEVtaXR0ZXIge1xuICBwcml2YXRlIGRhc2hib2FyZHM6IE1hcDxzdHJpbmcsIERhc2hib2FyZD4gPSBuZXcgTWFwKCk7XG4gIHByaXZhdGUgd2lkZ2V0czogTWFwPHN0cmluZywgRGFzaGJvYXJkV2lkZ2V0PiA9IG5ldyBNYXAoKTtcbiAgcHJpdmF0ZSB0aGVtZXM6IE1hcDxzdHJpbmcsIERhc2hib2FyZFRoZW1lPiA9IG5ldyBNYXAoKTtcbiAgcHJpdmF0ZSB1cGRhdGVJbnRlcnZhbHM6IE1hcDxzdHJpbmcsIE5vZGVKUy5UaW1lb3V0PiA9IG5ldyBNYXAoKTtcbiAgcHJpdmF0ZSB3aWRnZXREYXRhQ2FjaGU6IE1hcDxzdHJpbmcsIFdpZGdldERhdGE+ID0gbmV3IE1hcCgpO1xuICBwcml2YXRlIHBlcm1pc3Npb25zOiBNYXA8c3RyaW5nLCBEYXNoYm9hcmRQZXJtaXNzaW9uPiA9IG5ldyBNYXAoKTtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMuaW5pdGlhbGl6ZUVuZ2luZSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIEluaXRpYWxpemUgdGhlIGRhc2hib2FyZCBlbmdpbmVcbiAgICovXG4gIHByaXZhdGUgaW5pdGlhbGl6ZUVuZ2luZSgpOiB2b2lkIHtcbiAgICB0aGlzLnNldHVwRGVmYXVsdFRoZW1lcygpO1xuICAgIHRoaXMuc2V0dXBEZWZhdWx0V2lkZ2V0VHlwZXMoKTtcbiAgICB0aGlzLmVtaXQoJ2VuZ2luZUluaXRpYWxpemVkJyk7XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlIGEgbmV3IGRhc2hib2FyZFxuICAgKi9cbiAgcHVibGljIGFzeW5jIGNyZWF0ZURhc2hib2FyZChjb25maWc6IERhc2hib2FyZENvbmZpZyk6IFByb21pc2U8RGFzaGJvYXJkPiB7XG4gICAgY29uc3QgZGFzaGJvYXJkOiBEYXNoYm9hcmQgPSB7XG4gICAgICBpZDogY29uZmlnLmlkIHx8IHRoaXMuZ2VuZXJhdGVEYXNoYm9hcmRJZCgpLFxuICAgICAgbmFtZTogY29uZmlnLm5hbWUsXG4gICAgICBkZXNjcmlwdGlvbjogY29uZmlnLmRlc2NyaXB0aW9uLFxuICAgICAgbGF5b3V0OiBjb25maWcubGF5b3V0IHx8IHRoaXMuY3JlYXRlRGVmYXVsdExheW91dCgpLFxuICAgICAgd2lkZ2V0czogW10sXG4gICAgICBmaWx0ZXJzOiBjb25maWcuZmlsdGVycyB8fCBbXSxcbiAgICAgIHRoZW1lOiBjb25maWcudGhlbWUgfHwgJ2RlZmF1bHQnLFxuICAgICAgcmVmcmVzaEludGVydmFsOiBjb25maWcucmVmcmVzaEludGVydmFsIHx8IDMwMDAwLFxuICAgICAgaXNSZWFsVGltZTogY29uZmlnLmlzUmVhbFRpbWUgfHwgZmFsc2UsXG4gICAgICBwZXJtaXNzaW9uczogY29uZmlnLnBlcm1pc3Npb25zIHx8IHsgcmVhZDogWycqJ10sIHdyaXRlOiBbJ2FkbWluJ10gfSxcbiAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKSxcbiAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKSxcbiAgICAgIGNyZWF0ZWRCeTogY29uZmlnLmNyZWF0ZWRCeSB8fCAnc3lzdGVtJyxcbiAgICAgIHRhZ3M6IGNvbmZpZy50YWdzIHx8IFtdLFxuICAgICAgaXNQdWJsaWM6IGNvbmZpZy5pc1B1YmxpYyB8fCBmYWxzZVxuICAgIH07XG5cbiAgICAvLyBDcmVhdGUgd2lkZ2V0cyBpZiBwcm92aWRlZFxuICAgIGlmIChjb25maWcud2lkZ2V0cykge1xuICAgICAgZm9yIChjb25zdCB3aWRnZXRDb25maWcgb2YgY29uZmlnLndpZGdldHMpIHtcbiAgICAgICAgY29uc3Qgd2lkZ2V0ID0gYXdhaXQgdGhpcy5jcmVhdGVXaWRnZXQod2lkZ2V0Q29uZmlnKTtcbiAgICAgICAgZGFzaGJvYXJkLndpZGdldHMucHVzaCh3aWRnZXQpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuZGFzaGJvYXJkcy5zZXQoZGFzaGJvYXJkLmlkLCBkYXNoYm9hcmQpO1xuICAgIFxuICAgIC8vIFNldCB1cCByZWFsLXRpbWUgdXBkYXRlcyBpZiBlbmFibGVkXG4gICAgaWYgKGRhc2hib2FyZC5pc1JlYWxUaW1lKSB7XG4gICAgICB0aGlzLnNldHVwUmVhbFRpbWVVcGRhdGVzKGRhc2hib2FyZC5pZCk7XG4gICAgfVxuXG4gICAgdGhpcy5lbWl0KCdkYXNoYm9hcmRDcmVhdGVkJywgZGFzaGJvYXJkKTtcbiAgICByZXR1cm4gZGFzaGJvYXJkO1xuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZSBhbiBleGlzdGluZyBkYXNoYm9hcmRcbiAgICovXG4gIHB1YmxpYyBhc3luYyB1cGRhdGVEYXNoYm9hcmQoXG4gICAgZGFzaGJvYXJkSWQ6IHN0cmluZywgXG4gICAgdXBkYXRlczogUGFydGlhbDxEYXNoYm9hcmRDb25maWc+XG4gICk6IFByb21pc2U8RGFzaGJvYXJkPiB7XG4gICAgY29uc3QgZGFzaGJvYXJkID0gdGhpcy5kYXNoYm9hcmRzLmdldChkYXNoYm9hcmRJZCk7XG4gICAgaWYgKCFkYXNoYm9hcmQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgRGFzaGJvYXJkIG5vdCBmb3VuZDogJHtkYXNoYm9hcmRJZH1gKTtcbiAgICB9XG5cbiAgICAvLyBBcHBseSB1cGRhdGVzXG4gICAgT2JqZWN0LmFzc2lnbihkYXNoYm9hcmQsIHVwZGF0ZXMsIHsgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpIH0pO1xuXG4gICAgLy8gVXBkYXRlIHJlYWwtdGltZSBzZXR0aW5ncyBpZiBjaGFuZ2VkXG4gICAgaWYgKHVwZGF0ZXMuaXNSZWFsVGltZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBpZiAodXBkYXRlcy5pc1JlYWxUaW1lKSB7XG4gICAgICAgIHRoaXMuc2V0dXBSZWFsVGltZVVwZGF0ZXMoZGFzaGJvYXJkSWQpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5zdG9wUmVhbFRpbWVVcGRhdGVzKGRhc2hib2FyZElkKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLmRhc2hib2FyZHMuc2V0KGRhc2hib2FyZElkLCBkYXNoYm9hcmQpO1xuICAgIHRoaXMuZW1pdCgnZGFzaGJvYXJkVXBkYXRlZCcsIGRhc2hib2FyZCk7XG4gICAgcmV0dXJuIGRhc2hib2FyZDtcbiAgfVxuXG4gIC8qKlxuICAgKiBEZWxldGUgYSBkYXNoYm9hcmRcbiAgICovXG4gIHB1YmxpYyBkZWxldGVEYXNoYm9hcmQoZGFzaGJvYXJkSWQ6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IGRhc2hib2FyZCA9IHRoaXMuZGFzaGJvYXJkcy5nZXQoZGFzaGJvYXJkSWQpO1xuICAgIGlmICghZGFzaGJvYXJkKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgLy8gQ2xlYW4gdXAgd2lkZ2V0c1xuICAgIGRhc2hib2FyZC53aWRnZXRzLmZvckVhY2goKHdpZGdldDogYW55KSA9PiB7XG4gICAgICB0aGlzLndpZGdldHMuZGVsZXRlKHdpZGdldC5pZCk7XG4gICAgICB0aGlzLndpZGdldERhdGFDYWNoZS5kZWxldGUod2lkZ2V0LmlkKTtcbiAgICB9KTtcblxuICAgIC8vIFN0b3AgcmVhbC10aW1lIHVwZGF0ZXNcbiAgICB0aGlzLnN0b3BSZWFsVGltZVVwZGF0ZXMoZGFzaGJvYXJkSWQpO1xuXG4gICAgdGhpcy5kYXNoYm9hcmRzLmRlbGV0ZShkYXNoYm9hcmRJZCk7XG4gICAgdGhpcy5lbWl0KCdkYXNoYm9hcmREZWxldGVkJywgZGFzaGJvYXJkSWQpO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBhIGRhc2hib2FyZCBieSBJRFxuICAgKi9cbiAgcHVibGljIGdldERhc2hib2FyZChkYXNoYm9hcmRJZDogc3RyaW5nKTogRGFzaGJvYXJkIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5kYXNoYm9hcmRzLmdldChkYXNoYm9hcmRJZCk7XG4gIH1cblxuICAvKipcbiAgICogTGlzdCBhbGwgZGFzaGJvYXJkc1xuICAgKi9cbiAgcHVibGljIGxpc3REYXNoYm9hcmRzKHVzZXJJZD86IHN0cmluZyk6IERhc2hib2FyZFtdIHtcbiAgICBjb25zdCBkYXNoYm9hcmRzID0gQXJyYXkuZnJvbSh0aGlzLmRhc2hib2FyZHMudmFsdWVzKCkpO1xuICAgIFxuICAgIGlmICh1c2VySWQpIHtcbiAgICAgIHJldHVybiBkYXNoYm9hcmRzLmZpbHRlcihkID0+IHRoaXMuaGFzUGVybWlzc2lvbihkLCB1c2VySWQsICdyZWFkJykpO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4gZGFzaGJvYXJkcztcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGUgYSBuZXcgd2lkZ2V0XG4gICAqL1xuICBwdWJsaWMgYXN5bmMgY3JlYXRlV2lkZ2V0KGNvbmZpZzogV2lkZ2V0Q29uZmlnKTogUHJvbWlzZTxEYXNoYm9hcmRXaWRnZXQ+IHtcbiAgICBjb25zdCB3aWRnZXQ6IERhc2hib2FyZFdpZGdldCA9IHtcbiAgICAgIGlkOiBjb25maWcuaWQgfHwgdGhpcy5nZW5lcmF0ZVdpZGdldElkKCksXG4gICAgICB0eXBlOiBjb25maWcudHlwZSxcbiAgICAgIHRpdGxlOiBjb25maWcudGl0bGUsXG4gICAgICBkZXNjcmlwdGlvbjogY29uZmlnLmRlc2NyaXB0aW9uLFxuICAgICAgcG9zaXRpb246IGNvbmZpZy5wb3NpdGlvbiB8fCB7IHg6IDAsIHk6IDAsIHdpZHRoOiA0LCBoZWlnaHQ6IDQgfSxcbiAgICAgIGNvbmZpZ3VyYXRpb246IGNvbmZpZy5jb25maWd1cmF0aW9uIHx8IHt9LFxuICAgICAgZGF0YVNvdXJjZTogY29uZmlnLmRhdGFTb3VyY2UsXG4gICAgICBmaWx0ZXJzOiBjb25maWcuZmlsdGVycyB8fCBbXSxcbiAgICAgIHJlZnJlc2hJbnRlcnZhbDogY29uZmlnLnJlZnJlc2hJbnRlcnZhbCB8fCAzMDAwMCxcbiAgICAgIGlzVmlzaWJsZTogY29uZmlnLmlzVmlzaWJsZSAhPT0gZmFsc2UsXG4gICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgICBzdHlsZTogY29uZmlnLnN0eWxlIHx8IHt9LFxuICAgICAgaW50ZXJhY3Rpb25zOiBjb25maWcuaW50ZXJhY3Rpb25zIHx8IHt9XG4gICAgfTtcblxuICAgIHRoaXMud2lkZ2V0cy5zZXQod2lkZ2V0LmlkLCB3aWRnZXQpO1xuICAgIFxuICAgIC8vIEluaXRpYWxpemUgd2lkZ2V0IGRhdGFcbiAgICBhd2FpdCB0aGlzLnJlZnJlc2hXaWRnZXREYXRhKHdpZGdldC5pZCk7XG4gICAgXG4gICAgdGhpcy5lbWl0KCd3aWRnZXRDcmVhdGVkJywgd2lkZ2V0KTtcbiAgICByZXR1cm4gd2lkZ2V0O1xuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZSBhIHdpZGdldFxuICAgKi9cbiAgcHVibGljIGFzeW5jIHVwZGF0ZVdpZGdldChcbiAgICB3aWRnZXRJZDogc3RyaW5nLCBcbiAgICB1cGRhdGVzOiBQYXJ0aWFsPFdpZGdldENvbmZpZz5cbiAgKTogUHJvbWlzZTxEYXNoYm9hcmRXaWRnZXQ+IHtcbiAgICBjb25zdCB3aWRnZXQgPSB0aGlzLndpZGdldHMuZ2V0KHdpZGdldElkKTtcbiAgICBpZiAoIXdpZGdldCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBXaWRnZXQgbm90IGZvdW5kOiAke3dpZGdldElkfWApO1xuICAgIH1cblxuICAgIE9iamVjdC5hc3NpZ24od2lkZ2V0LCB1cGRhdGVzLCB7IHVwZGF0ZWRBdDogbmV3IERhdGUoKSB9KTtcbiAgICBcbiAgICAvLyBSZWZyZXNoIGRhdGEgaWYgY29uZmlndXJhdGlvbiBjaGFuZ2VkXG4gICAgaWYgKHVwZGF0ZXMuY29uZmlndXJhdGlvbiB8fCB1cGRhdGVzLmRhdGFTb3VyY2UgfHwgdXBkYXRlcy5maWx0ZXJzKSB7XG4gICAgICBhd2FpdCB0aGlzLnJlZnJlc2hXaWRnZXREYXRhKHdpZGdldElkKTtcbiAgICB9XG5cbiAgICB0aGlzLndpZGdldHMuc2V0KHdpZGdldElkLCB3aWRnZXQpO1xuICAgIHRoaXMuZW1pdCgnd2lkZ2V0VXBkYXRlZCcsIHdpZGdldCk7XG4gICAgcmV0dXJuIHdpZGdldDtcbiAgfVxuXG4gIC8qKlxuICAgKiBEZWxldGUgYSB3aWRnZXRcbiAgICovXG4gIHB1YmxpYyBkZWxldGVXaWRnZXQod2lkZ2V0SWQ6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IHdpZGdldCA9IHRoaXMud2lkZ2V0cy5nZXQod2lkZ2V0SWQpO1xuICAgIGlmICghd2lkZ2V0KSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgdGhpcy53aWRnZXRzLmRlbGV0ZSh3aWRnZXRJZCk7XG4gICAgdGhpcy53aWRnZXREYXRhQ2FjaGUuZGVsZXRlKHdpZGdldElkKTtcbiAgICB0aGlzLmVtaXQoJ3dpZGdldERlbGV0ZWQnLCB3aWRnZXRJZCk7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICAvKipcbiAgICogR2V0IHdpZGdldCBkYXRhXG4gICAqL1xuICBwdWJsaWMgZ2V0V2lkZ2V0RGF0YSh3aWRnZXRJZDogc3RyaW5nKTogV2lkZ2V0RGF0YSB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMud2lkZ2V0RGF0YUNhY2hlLmdldCh3aWRnZXRJZCk7XG4gIH1cblxuICAvKipcbiAgICogUmVmcmVzaCB3aWRnZXQgZGF0YVxuICAgKi9cbiAgcHVibGljIGFzeW5jIHJlZnJlc2hXaWRnZXREYXRhKHdpZGdldElkOiBzdHJpbmcpOiBQcm9taXNlPFdpZGdldERhdGE+IHtcbiAgICBjb25zdCB3aWRnZXQgPSB0aGlzLndpZGdldHMuZ2V0KHdpZGdldElkKTtcbiAgICBpZiAoIXdpZGdldCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBXaWRnZXQgbm90IGZvdW5kOiAke3dpZGdldElkfWApO1xuICAgIH1cblxuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCB0aGlzLmZldGNoV2lkZ2V0RGF0YSh3aWRnZXQpO1xuICAgIHRoaXMud2lkZ2V0RGF0YUNhY2hlLnNldCh3aWRnZXRJZCwgZGF0YSk7XG4gICAgXG4gICAgdGhpcy5lbWl0KCd3aWRnZXREYXRhUmVmcmVzaGVkJywgeyB3aWRnZXRJZCwgZGF0YSB9KTtcbiAgICByZXR1cm4gZGF0YTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBcHBseSBmaWx0ZXJzIHRvIGEgZGFzaGJvYXJkXG4gICAqL1xuICBwdWJsaWMgYXBwbHlGaWx0ZXJzKGRhc2hib2FyZElkOiBzdHJpbmcsIGZpbHRlcnM6IERhc2hib2FyZEZpbHRlcltdKTogdm9pZCB7XG4gICAgY29uc3QgZGFzaGJvYXJkID0gdGhpcy5kYXNoYm9hcmRzLmdldChkYXNoYm9hcmRJZCk7XG4gICAgaWYgKCFkYXNoYm9hcmQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgRGFzaGJvYXJkIG5vdCBmb3VuZDogJHtkYXNoYm9hcmRJZH1gKTtcbiAgICB9XG5cbiAgICBkYXNoYm9hcmQuZmlsdGVycyA9IGZpbHRlcnM7XG4gICAgZGFzaGJvYXJkLnVwZGF0ZWRBdCA9IG5ldyBEYXRlKCk7XG5cbiAgICAvLyBSZWZyZXNoIGFsbCB3aWRnZXRzIHdpdGggbmV3IGZpbHRlcnNcbiAgICBkYXNoYm9hcmQud2lkZ2V0cy5mb3JFYWNoKCh3aWRnZXQ6IGFueSkgPT4ge1xuICAgICAgdGhpcy5yZWZyZXNoV2lkZ2V0RGF0YSh3aWRnZXQuaWQpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5lbWl0KCdmaWx0ZXJzQXBwbGllZCcsIHsgZGFzaGJvYXJkSWQsIGZpbHRlcnMgfSk7XG4gIH1cblxuICAvKipcbiAgICogRXhwb3J0IGRhc2hib2FyZFxuICAgKi9cbiAgcHVibGljIGFzeW5jIGV4cG9ydERhc2hib2FyZChcbiAgICBkYXNoYm9hcmRJZDogc3RyaW5nLCBcbiAgICBmb3JtYXQ6ICdqc29uJyB8ICdwZGYnIHwgJ3BuZycgfCAnc3ZnJyA9ICdqc29uJ1xuICApOiBQcm9taXNlPERhc2hib2FyZEV4cG9ydD4ge1xuICAgIGNvbnN0IGRhc2hib2FyZCA9IHRoaXMuZGFzaGJvYXJkcy5nZXQoZGFzaGJvYXJkSWQpO1xuICAgIGlmICghZGFzaGJvYXJkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYERhc2hib2FyZCBub3QgZm91bmQ6ICR7ZGFzaGJvYXJkSWR9YCk7XG4gICAgfVxuXG4gICAgY29uc3QgZXhwb3J0RGF0YTogRGFzaGJvYXJkRXhwb3J0ID0ge1xuICAgICAgZGFzaGJvYXJkLFxuICAgICAgZm9ybWF0LFxuICAgICAgZXhwb3J0ZWRBdDogbmV3IERhdGUoKSxcbiAgICAgIGRhdGE6IGF3YWl0IHRoaXMucHJlcGFyZUV4cG9ydERhdGEoZGFzaGJvYXJkLCBmb3JtYXQpXG4gICAgfTtcblxuICAgIHRoaXMuZW1pdCgnZGFzaGJvYXJkRXhwb3J0ZWQnLCBleHBvcnREYXRhKTtcbiAgICByZXR1cm4gZXhwb3J0RGF0YTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDbG9uZSBhIGRhc2hib2FyZFxuICAgKi9cbiAgcHVibGljIGFzeW5jIGNsb25lRGFzaGJvYXJkKFxuICAgIGRhc2hib2FyZElkOiBzdHJpbmcsIFxuICAgIG5ld05hbWU6IHN0cmluZywgXG4gICAgdXNlcklkPzogc3RyaW5nXG4gICk6IFByb21pc2U8RGFzaGJvYXJkPiB7XG4gICAgY29uc3Qgb3JpZ2luYWwgPSB0aGlzLmRhc2hib2FyZHMuZ2V0KGRhc2hib2FyZElkKTtcbiAgICBpZiAoIW9yaWdpbmFsKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYERhc2hib2FyZCBub3QgZm91bmQ6ICR7ZGFzaGJvYXJkSWR9YCk7XG4gICAgfVxuXG4gICAgY29uc3QgY2xvbmVDb25maWc6IERhc2hib2FyZENvbmZpZyA9IHtcbiAgICAgIG5hbWU6IG5ld05hbWUsXG4gICAgICBkZXNjcmlwdGlvbjogYENsb25lIG9mICR7b3JpZ2luYWwubmFtZX1gLFxuICAgICAgbGF5b3V0OiB7IC4uLm9yaWdpbmFsLmxheW91dCB9LFxuICAgICAgd2lkZ2V0czogb3JpZ2luYWwud2lkZ2V0cy5tYXAoKHc6IGFueSkgPT4gKHsgLi4udyB9KSksXG4gICAgICBmaWx0ZXJzOiBbLi4ub3JpZ2luYWwuZmlsdGVyc10sXG4gICAgICB0aGVtZTogb3JpZ2luYWwudGhlbWUsXG4gICAgICByZWZyZXNoSW50ZXJ2YWw6IG9yaWdpbmFsLnJlZnJlc2hJbnRlcnZhbCxcbiAgICAgIGlzUmVhbFRpbWU6IG9yaWdpbmFsLmlzUmVhbFRpbWUsXG4gICAgICBjcmVhdGVkQnk6IHVzZXJJZCB8fCAnc3lzdGVtJyxcbiAgICAgIHRhZ3M6IFsuLi4ob3JpZ2luYWwudGFncyB8fCBbXSksICdjbG9uZSddXG4gICAgfTtcblxuICAgIHJldHVybiB0aGlzLmNyZWF0ZURhc2hib2FyZChjbG9uZUNvbmZpZyk7XG4gIH1cblxuICAvKipcbiAgICogR2V0IGRhc2hib2FyZCB0aGVtZXNcbiAgICovXG4gIHB1YmxpYyBnZXRUaGVtZXMoKTogRGFzaGJvYXJkVGhlbWVbXSB7XG4gICAgcmV0dXJuIEFycmF5LmZyb20odGhpcy50aGVtZXMudmFsdWVzKCkpO1xuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZSBhIGN1c3RvbSB0aGVtZVxuICAgKi9cbiAgcHVibGljIGNyZWF0ZVRoZW1lKHRoZW1lOiBEYXNoYm9hcmRUaGVtZSk6IHZvaWQge1xuICAgIHRoaXMudGhlbWVzLnNldCh0aGVtZS5pZCwgdGhlbWUpO1xuICAgIHRoaXMuZW1pdCgndGhlbWVDcmVhdGVkJywgdGhlbWUpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCB3aWRnZXQgdHlwZXNcbiAgICovXG4gIHB1YmxpYyBnZXRXaWRnZXRUeXBlcygpOiBXaWRnZXRUeXBlW10ge1xuICAgIHJldHVybiBbXG4gICAgICB7IGlkOiAnbGluZS1jaGFydCcsIG5hbWU6ICdMaW5lIENoYXJ0JywgY2F0ZWdvcnk6ICdjaGFydHMnIH0sXG4gICAgICB7IGlkOiAnYmFyLWNoYXJ0JywgbmFtZTogJ0JhciBDaGFydCcsIGNhdGVnb3J5OiAnY2hhcnRzJyB9LFxuICAgICAgeyBpZDogJ3BpZS1jaGFydCcsIG5hbWU6ICdQaWUgQ2hhcnQnLCBjYXRlZ29yeTogJ2NoYXJ0cycgfSxcbiAgICAgIHsgaWQ6ICdzY2F0dGVyLXBsb3QnLCBuYW1lOiAnU2NhdHRlciBQbG90JywgY2F0ZWdvcnk6ICdjaGFydHMnIH0sXG4gICAgICB7IGlkOiAnaGVhdG1hcCcsIG5hbWU6ICdIZWF0bWFwJywgY2F0ZWdvcnk6ICdjaGFydHMnIH0sXG4gICAgICB7IGlkOiAnbWV0cmljLWNhcmQnLCBuYW1lOiAnTWV0cmljIENhcmQnLCBjYXRlZ29yeTogJ21ldHJpY3MnIH0sXG4gICAgICB7IGlkOiAnZ2F1Z2UnLCBuYW1lOiAnR2F1Z2UnLCBjYXRlZ29yeTogJ21ldHJpY3MnIH0sXG4gICAgICB7IGlkOiAndGFibGUnLCBuYW1lOiAnVGFibGUnLCBjYXRlZ29yeTogJ2RhdGEnIH0sXG4gICAgICB7IGlkOiAnbGlzdCcsIG5hbWU6ICdMaXN0JywgY2F0ZWdvcnk6ICdkYXRhJyB9LFxuICAgICAgeyBpZDogJ3RleHQnLCBuYW1lOiAnVGV4dCcsIGNhdGVnb3J5OiAnY29udGVudCcgfSxcbiAgICAgIHsgaWQ6ICdpbWFnZScsIG5hbWU6ICdJbWFnZScsIGNhdGVnb3J5OiAnY29udGVudCcgfSxcbiAgICAgIHsgaWQ6ICdpZnJhbWUnLCBuYW1lOiAnaUZyYW1lJywgY2F0ZWdvcnk6ICdjb250ZW50JyB9XG4gICAgXTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgZGFzaGJvYXJkIGFuYWx5dGljc1xuICAgKi9cbiAgcHVibGljIGdldERhc2hib2FyZEFuYWx5dGljcyhkYXNoYm9hcmRJZDogc3RyaW5nKTogYW55IHtcbiAgICBjb25zdCBkYXNoYm9hcmQgPSB0aGlzLmRhc2hib2FyZHMuZ2V0KGRhc2hib2FyZElkKTtcbiAgICBpZiAoIWRhc2hib2FyZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBEYXNoYm9hcmQgbm90IGZvdW5kOiAke2Rhc2hib2FyZElkfWApO1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICB2aWV3czogdGhpcy5nZXREYXNoYm9hcmRWaWV3cyhkYXNoYm9hcmRJZCksXG4gICAgICBpbnRlcmFjdGlvbnM6IHRoaXMuZ2V0RGFzaGJvYXJkSW50ZXJhY3Rpb25zKGRhc2hib2FyZElkKSxcbiAgICAgIHBlcmZvcm1hbmNlOiB0aGlzLmdldERhc2hib2FyZFBlcmZvcm1hbmNlKGRhc2hib2FyZElkKSxcbiAgICAgIHdpZGdldHM6IGRhc2hib2FyZC53aWRnZXRzLm1hcCgodzogYW55KSA9PiAoe1xuICAgICAgICBpZDogdy5pZCxcbiAgICAgICAgdHlwZTogdy50eXBlLFxuICAgICAgICBpbnRlcmFjdGlvbnM6IHRoaXMuZ2V0V2lkZ2V0SW50ZXJhY3Rpb25zKHcuaWQpLFxuICAgICAgICBsb2FkVGltZTogdGhpcy5nZXRXaWRnZXRMb2FkVGltZSh3LmlkKVxuICAgICAgfSkpXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBEaXNwb3NlIG9mIHRoZSBkYXNoYm9hcmQgZW5naW5lXG4gICAqL1xuICBwdWJsaWMgZGlzcG9zZSgpOiB2b2lkIHtcbiAgICAvLyBTdG9wIGFsbCByZWFsLXRpbWUgdXBkYXRlc1xuICAgIGZvciAoY29uc3QgW2Rhc2hib2FyZElkXSBvZiB0aGlzLnVwZGF0ZUludGVydmFscykge1xuICAgICAgdGhpcy5zdG9wUmVhbFRpbWVVcGRhdGVzKGRhc2hib2FyZElkKTtcbiAgICB9XG5cbiAgICAvLyBDbGVhciBhbGwgZGF0YVxuICAgIHRoaXMuZGFzaGJvYXJkcy5jbGVhcigpO1xuICAgIHRoaXMud2lkZ2V0cy5jbGVhcigpO1xuICAgIHRoaXMud2lkZ2V0RGF0YUNhY2hlLmNsZWFyKCk7XG4gICAgdGhpcy50aGVtZXMuY2xlYXIoKTtcbiAgICB0aGlzLnBlcm1pc3Npb25zLmNsZWFyKCk7XG5cbiAgICB0aGlzLnJlbW92ZUFsbExpc3RlbmVycygpO1xuICB9XG5cbiAgLy8gUHJpdmF0ZSBoZWxwZXIgbWV0aG9kc1xuXG4gIHByaXZhdGUgc2V0dXBEZWZhdWx0VGhlbWVzKCk6IHZvaWQge1xuICAgIGNvbnN0IHRoZW1lczogRGFzaGJvYXJkVGhlbWVbXSA9IFtcbiAgICAgIHtcbiAgICAgICAgaWQ6ICdkZWZhdWx0JyxcbiAgICAgICAgbmFtZTogJ0RlZmF1bHQnLFxuICAgICAgICBjb2xvcnM6IHtcbiAgICAgICAgICBwcmltYXJ5OiAnIzAwN2FjYycsXG4gICAgICAgICAgc2Vjb25kYXJ5OiAnIzZjNzU3ZCcsXG4gICAgICAgICAgc3VjY2VzczogJyMyOGE3NDUnLFxuICAgICAgICAgIHdhcm5pbmc6ICcjZmZjMTA3JyxcbiAgICAgICAgICBlcnJvcjogJyNkYzM1NDUnLFxuICAgICAgICAgIGJhY2tncm91bmQ6ICcjZmZmZmZmJyxcbiAgICAgICAgICBzdXJmYWNlOiAnI2Y4ZjlmYScsXG4gICAgICAgICAgdGV4dDogJyMyMTI1MjknXG4gICAgICAgIH0sXG4gICAgICAgIGZvbnRzOiB7XG4gICAgICAgICAgYm9keTogJ3N5c3RlbS11aSwgLWFwcGxlLXN5c3RlbSwgc2Fucy1zZXJpZicsXG4gICAgICAgICAgaGVhZGluZzogJ3N5c3RlbS11aSwgLWFwcGxlLXN5c3RlbSwgc2Fucy1zZXJpZicsXG4gICAgICAgICAgbW9ub3NwYWNlOiAnQ29uc29sYXMsIE1vbmFjbywgbW9ub3NwYWNlJ1xuICAgICAgICB9LFxuICAgICAgICBzcGFjaW5nOiB7XG4gICAgICAgICAgc21hbGw6ICc4cHgnLFxuICAgICAgICAgIG1lZGl1bTogJzE2cHgnLFxuICAgICAgICAgIGxhcmdlOiAnMjRweCdcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgaWQ6ICdkYXJrJyxcbiAgICAgICAgbmFtZTogJ0RhcmsnLFxuICAgICAgICBjb2xvcnM6IHtcbiAgICAgICAgICBwcmltYXJ5OiAnIzBkNzM3NycsXG4gICAgICAgICAgc2Vjb25kYXJ5OiAnIzZjNzU3ZCcsXG4gICAgICAgICAgc3VjY2VzczogJyMyMGM5OTcnLFxuICAgICAgICAgIHdhcm5pbmc6ICcjZmZjMTA3JyxcbiAgICAgICAgICBlcnJvcjogJyNkYzM1NDUnLFxuICAgICAgICAgIGJhY2tncm91bmQ6ICcjMWExYTFhJyxcbiAgICAgICAgICBzdXJmYWNlOiAnIzJkMmQyZCcsXG4gICAgICAgICAgdGV4dDogJyNmZmZmZmYnXG4gICAgICAgIH0sXG4gICAgICAgIGZvbnRzOiB7XG4gICAgICAgICAgYm9keTogJ3N5c3RlbS11aSwgLWFwcGxlLXN5c3RlbSwgc2Fucy1zZXJpZicsXG4gICAgICAgICAgaGVhZGluZzogJ3N5c3RlbS11aSwgLWFwcGxlLXN5c3RlbSwgc2Fucy1zZXJpZicsXG4gICAgICAgICAgbW9ub3NwYWNlOiAnQ29uc29sYXMsIE1vbmFjbywgbW9ub3NwYWNlJ1xuICAgICAgICB9LFxuICAgICAgICBzcGFjaW5nOiB7XG4gICAgICAgICAgc21hbGw6ICc4cHgnLFxuICAgICAgICAgIG1lZGl1bTogJzE2cHgnLFxuICAgICAgICAgIGxhcmdlOiAnMjRweCdcbiAgICAgICAgfVxuICAgICAgfVxuICAgIF07XG5cbiAgICB0aGVtZXMuZm9yRWFjaCh0aGVtZSA9PiB0aGlzLnRoZW1lcy5zZXQodGhlbWUuaWQsIHRoZW1lKSk7XG4gIH1cblxuICBwcml2YXRlIHNldHVwRGVmYXVsdFdpZGdldFR5cGVzKCk6IHZvaWQge1xuICAgIC8vIFdpZGdldCB0eXBlcyBhcmUgZGVmaW5lZCBpbiBnZXRXaWRnZXRUeXBlcygpIG1ldGhvZFxuICAgIHRoaXMuZW1pdCgnd2lkZ2V0VHlwZXNJbml0aWFsaXplZCcpO1xuICB9XG5cbiAgcHJpdmF0ZSBjcmVhdGVEZWZhdWx0TGF5b3V0KCk6IERhc2hib2FyZExheW91dCB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6ICdncmlkJyxcbiAgICAgIGNvbHVtbnM6IDEyLFxuICAgICAgcm93czogJ2F1dG8nLFxuICAgICAgZ2FwOiAnMTZweCcsXG4gICAgICBwYWRkaW5nOiAnMTZweCdcbiAgICB9O1xuICB9XG5cbiAgcHJpdmF0ZSBzZXR1cFJlYWxUaW1lVXBkYXRlcyhkYXNoYm9hcmRJZDogc3RyaW5nKTogdm9pZCB7XG4gICAgY29uc3QgZGFzaGJvYXJkID0gdGhpcy5kYXNoYm9hcmRzLmdldChkYXNoYm9hcmRJZCk7XG4gICAgaWYgKCFkYXNoYm9hcmQpIHtyZXR1cm47fVxuXG4gICAgLy8gU3RvcCBleGlzdGluZyBpbnRlcnZhbCBpZiBhbnlcbiAgICB0aGlzLnN0b3BSZWFsVGltZVVwZGF0ZXMoZGFzaGJvYXJkSWQpO1xuXG4gICAgLy8gU3RhcnQgbmV3IGludGVydmFsXG4gICAgY29uc3QgaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICB0aGlzLnVwZGF0ZURhc2hib2FyZERhdGEoZGFzaGJvYXJkSWQpO1xuICAgIH0sIGRhc2hib2FyZC5yZWZyZXNoSW50ZXJ2YWwpO1xuXG4gICAgdGhpcy51cGRhdGVJbnRlcnZhbHMuc2V0KGRhc2hib2FyZElkLCBpbnRlcnZhbCk7XG4gIH1cblxuICBwcml2YXRlIHN0b3BSZWFsVGltZVVwZGF0ZXMoZGFzaGJvYXJkSWQ6IHN0cmluZyk6IHZvaWQge1xuICAgIGNvbnN0IGludGVydmFsID0gdGhpcy51cGRhdGVJbnRlcnZhbHMuZ2V0KGRhc2hib2FyZElkKTtcbiAgICBpZiAoaW50ZXJ2YWwpIHtcbiAgICAgIGNsZWFySW50ZXJ2YWwoaW50ZXJ2YWwpO1xuICAgICAgdGhpcy51cGRhdGVJbnRlcnZhbHMuZGVsZXRlKGRhc2hib2FyZElkKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIHVwZGF0ZURhc2hib2FyZERhdGEoZGFzaGJvYXJkSWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGRhc2hib2FyZCA9IHRoaXMuZGFzaGJvYXJkcy5nZXQoZGFzaGJvYXJkSWQpO1xuICAgIGlmICghZGFzaGJvYXJkKSB7cmV0dXJuO31cblxuICAgIGNvbnN0IHVwZGF0ZXM6IFJlYWxUaW1lVXBkYXRlW10gPSBbXTtcblxuICAgIGZvciAoY29uc3Qgd2lkZ2V0IG9mIGRhc2hib2FyZC53aWRnZXRzKSB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgdGhpcy5yZWZyZXNoV2lkZ2V0RGF0YSh3aWRnZXQuaWQpO1xuICAgICAgICB1cGRhdGVzLnB1c2goe1xuICAgICAgICAgIHdpZGdldElkOiB3aWRnZXQuaWQsXG4gICAgICAgICAgZGF0YSxcbiAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKClcbiAgICAgICAgfSk7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKGBFcnJvciB1cGRhdGluZyB3aWRnZXQgJHt3aWRnZXQuaWR9OmAsIGVycm9yKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLmVtaXQoJ2Rhc2hib2FyZERhdGFVcGRhdGVkJywgeyBkYXNoYm9hcmRJZCwgdXBkYXRlcyB9KTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZmV0Y2hXaWRnZXREYXRhKHdpZGdldDogRGFzaGJvYXJkV2lkZ2V0KTogUHJvbWlzZTxXaWRnZXREYXRhPiB7XG4gICAgLy8gU2ltdWxhdGUgZGF0YSBmZXRjaGluZyBiYXNlZCBvbiB3aWRnZXQgdHlwZSBhbmQgY29uZmlndXJhdGlvblxuICAgIGNvbnN0IGRhdGE6IFdpZGdldERhdGEgPSB7XG4gICAgICBpZDogd2lkZ2V0LmlkLFxuICAgICAgdHlwZTogd2lkZ2V0LnR5cGUsXG4gICAgICBkYXRhOiBhd2FpdCB0aGlzLmdlbmVyYXRlTW9ja0RhdGEod2lkZ2V0KSxcbiAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgIGxhc3RVcGRhdGVkOiBuZXcgRGF0ZSgpLFxuICAgICAgICBkYXRhUG9pbnRzOiAwLFxuICAgICAgICBzb3VyY2U6IHdpZGdldC5kYXRhU291cmNlPy50eXBlIHx8ICdtb2NrJyxcbiAgICAgICAgZmlsdGVyczogd2lkZ2V0LmZpbHRlcnNcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgcmV0dXJuIGRhdGE7XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGdlbmVyYXRlTW9ja0RhdGEod2lkZ2V0OiBEYXNoYm9hcmRXaWRnZXQpOiBQcm9taXNlPGFueT4ge1xuICAgIC8vIEdlbmVyYXRlIG1vY2sgZGF0YSBiYXNlZCBvbiB3aWRnZXQgdHlwZVxuICAgIHN3aXRjaCAod2lkZ2V0LnR5cGUpIHtcbiAgICAgIGNhc2UgJ2xpbmUtY2hhcnQnOlxuICAgICAgICByZXR1cm4gdGhpcy5nZW5lcmF0ZUxpbmVDaGFydERhdGEoKTtcbiAgICAgIGNhc2UgJ2Jhci1jaGFydCc6XG4gICAgICAgIHJldHVybiB0aGlzLmdlbmVyYXRlQmFyQ2hhcnREYXRhKCk7XG4gICAgICBjYXNlICdwaWUtY2hhcnQnOlxuICAgICAgICByZXR1cm4gdGhpcy5nZW5lcmF0ZVBpZUNoYXJ0RGF0YSgpO1xuICAgICAgY2FzZSAnbWV0cmljLWNhcmQnOlxuICAgICAgICByZXR1cm4gdGhpcy5nZW5lcmF0ZU1ldHJpY0RhdGEoKTtcbiAgICAgIGNhc2UgJ3RhYmxlJzpcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2VuZXJhdGVUYWJsZURhdGEoKTtcbiAgICAgIGNhc2UgJ2dhdWdlJzpcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2VuZXJhdGVHYXVnZURhdGEoKTtcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiB7fTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGdlbmVyYXRlTGluZUNoYXJ0RGF0YSgpOiBhbnkge1xuICAgIGNvbnN0IGRhdGEgPSBbXTtcbiAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuICAgIFxuICAgIGZvciAobGV0IGkgPSAyMzsgaSA+PSAwOyBpLS0pIHtcbiAgICAgIGNvbnN0IHRpbWVzdGFtcCA9IG5ldyBEYXRlKG5vdy5nZXRUaW1lKCkgLSBpICogNjAgKiA2MCAqIDEwMDApO1xuICAgICAgZGF0YS5wdXNoKHtcbiAgICAgICAgeDogdGltZXN0YW1wLnRvSVNPU3RyaW5nKCksXG4gICAgICAgIHk6IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMCkgKyA1MFxuICAgICAgfSk7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiB7XG4gICAgICBkYXRhc2V0czogW3tcbiAgICAgICAgbGFiZWw6ICdTYW1wbGUgRGF0YScsXG4gICAgICAgIGRhdGEsXG4gICAgICAgIGJvcmRlckNvbG9yOiAnIzAwN2FjYycsXG4gICAgICAgIGJhY2tncm91bmRDb2xvcjogJ3JnYmEoMCwgMTIyLCAyMDQsIDAuMSknXG4gICAgICB9XVxuICAgIH07XG4gIH1cblxuICBwcml2YXRlIGdlbmVyYXRlQmFyQ2hhcnREYXRhKCk6IGFueSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGxhYmVsczogWydKYW4nLCAnRmViJywgJ01hcicsICdBcHInLCAnTWF5JywgJ0p1biddLFxuICAgICAgZGF0YXNldHM6IFt7XG4gICAgICAgIGxhYmVsOiAnU2FtcGxlIERhdGEnLFxuICAgICAgICBkYXRhOiBBcnJheS5mcm9tKHsgbGVuZ3RoOiA2IH0sICgpID0+IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMCkpLFxuICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6ICcjMDA3YWNjJ1xuICAgICAgfV1cbiAgICB9O1xuICB9XG5cbiAgcHJpdmF0ZSBnZW5lcmF0ZVBpZUNoYXJ0RGF0YSgpOiBhbnkge1xuICAgIHJldHVybiB7XG4gICAgICBsYWJlbHM6IFsnQ2F0ZWdvcnkgQScsICdDYXRlZ29yeSBCJywgJ0NhdGVnb3J5IEMnLCAnQ2F0ZWdvcnkgRCddLFxuICAgICAgZGF0YXNldHM6IFt7XG4gICAgICAgIGRhdGE6IFszMCwgMjUsIDI1LCAyMF0sXG4gICAgICAgIGJhY2tncm91bmRDb2xvcjogWycjMDA3YWNjJywgJyMyOGE3NDUnLCAnI2ZmYzEwNycsICcjZGMzNTQ1J11cbiAgICAgIH1dXG4gICAgfTtcbiAgfVxuXG4gIHByaXZhdGUgZ2VuZXJhdGVNZXRyaWNEYXRhKCk6IGFueSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHZhbHVlOiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDAwKSArIDEwMCxcbiAgICAgIGNoYW5nZTogKE1hdGgucmFuZG9tKCkgLSAwLjUpICogMjAsXG4gICAgICB1bml0OiAnY291bnQnLFxuICAgICAgdHJlbmQ6IE1hdGgucmFuZG9tKCkgPiAwLjUgPyAndXAnIDogJ2Rvd24nXG4gICAgfTtcbiAgfVxuXG4gIHByaXZhdGUgZ2VuZXJhdGVUYWJsZURhdGEoKTogYW55IHtcbiAgICBjb25zdCBjb2x1bW5zID0gWydJRCcsICdOYW1lJywgJ1N0YXR1cycsICdWYWx1ZSddO1xuICAgIGNvbnN0IHJvd3MgPSBbXTtcbiAgICBcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDEwOyBpKyspIHtcbiAgICAgIHJvd3MucHVzaChbXG4gICAgICAgIGkgKyAxLFxuICAgICAgICBgSXRlbSAke2kgKyAxfWAsXG4gICAgICAgIE1hdGgucmFuZG9tKCkgPiAwLjUgPyAnQWN0aXZlJyA6ICdJbmFjdGl2ZScsXG4gICAgICAgIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMClcbiAgICAgIF0pO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4geyBjb2x1bW5zLCByb3dzIH07XG4gIH1cblxuICBwcml2YXRlIGdlbmVyYXRlR2F1Z2VEYXRhKCk6IGFueSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHZhbHVlOiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDApLFxuICAgICAgbWluOiAwLFxuICAgICAgbWF4OiAxMDAsXG4gICAgICB0aHJlc2hvbGRzOiBbXG4gICAgICAgIHsgdmFsdWU6IDMwLCBjb2xvcjogJyMyOGE3NDUnIH0sXG4gICAgICAgIHsgdmFsdWU6IDcwLCBjb2xvcjogJyNmZmMxMDcnIH0sXG4gICAgICAgIHsgdmFsdWU6IDkwLCBjb2xvcjogJyNkYzM1NDUnIH1cbiAgICAgIF1cbiAgICB9O1xuICB9XG5cbiAgcHJpdmF0ZSBoYXNQZXJtaXNzaW9uKGRhc2hib2FyZDogRGFzaGJvYXJkLCB1c2VySWQ6IHN0cmluZywgYWN0aW9uOiAncmVhZCcgfCAnd3JpdGUnKTogYm9vbGVhbiB7XG4gICAgaWYgKGRhc2hib2FyZC5pc1B1YmxpYyAmJiBhY3Rpb24gPT09ICdyZWFkJykge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIFxuICAgIGNvbnN0IHBlcm1pc3Npb25zID0gZGFzaGJvYXJkLnBlcm1pc3Npb25zPy5bYWN0aW9uXTtcbiAgICByZXR1cm4gcGVybWlzc2lvbnMgPyAocGVybWlzc2lvbnMuaW5jbHVkZXMoJyonKSB8fCBwZXJtaXNzaW9ucy5pbmNsdWRlcyh1c2VySWQpKSA6IGZhbHNlO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBwcmVwYXJlRXhwb3J0RGF0YShkYXNoYm9hcmQ6IERhc2hib2FyZCwgZm9ybWF0OiBzdHJpbmcpOiBQcm9taXNlPGFueT4ge1xuICAgIHN3aXRjaCAoZm9ybWF0KSB7XG4gICAgICBjYXNlICdqc29uJzpcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBkYXNoYm9hcmQsXG4gICAgICAgICAgd2lkZ2V0czogZGFzaGJvYXJkLndpZGdldHMubWFwKCh3OiBhbnkpID0+ICh7XG4gICAgICAgICAgICAuLi53LFxuICAgICAgICAgICAgZGF0YTogdGhpcy53aWRnZXREYXRhQ2FjaGUuZ2V0KHcuaWQpXG4gICAgICAgICAgfSkpXG4gICAgICAgIH07XG4gICAgICBjYXNlICdwZGYnOlxuICAgICAgICByZXR1cm4geyBjb250ZW50OiAnUERGIGV4cG9ydCBub3QgaW1wbGVtZW50ZWQnIH07XG4gICAgICBjYXNlICdwbmcnOlxuICAgICAgICByZXR1cm4geyBjb250ZW50OiAnUE5HIGV4cG9ydCBub3QgaW1wbGVtZW50ZWQnIH07XG4gICAgICBjYXNlICdzdmcnOlxuICAgICAgICByZXR1cm4geyBjb250ZW50OiAnU1ZHIGV4cG9ydCBub3QgaW1wbGVtZW50ZWQnIH07XG4gICAgICBkZWZhdWx0OlxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuc3VwcG9ydGVkIGV4cG9ydCBmb3JtYXQ6ICR7Zm9ybWF0fWApO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZ2V0RGFzaGJvYXJkVmlld3MoZGFzaGJvYXJkSWQ6IHN0cmluZyk6IG51bWJlciB7XG4gICAgLy8gTW9jayBpbXBsZW1lbnRhdGlvblxuICAgIHJldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDAwKSArIDEwO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXREYXNoYm9hcmRJbnRlcmFjdGlvbnMoZGFzaGJvYXJkSWQ6IHN0cmluZyk6IG51bWJlciB7XG4gICAgLy8gTW9jayBpbXBsZW1lbnRhdGlvblxuICAgIHJldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDApICsgNTtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0RGFzaGJvYXJkUGVyZm9ybWFuY2UoZGFzaGJvYXJkSWQ6IHN0cmluZyk6IGFueSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGxvYWRUaW1lOiBNYXRoLnJhbmRvbSgpICogMjAwMCArIDUwMCxcbiAgICAgIHJlbmRlclRpbWU6IE1hdGgucmFuZG9tKCkgKiA1MDAgKyAxMDAsXG4gICAgICBkYXRhRmV0Y2hUaW1lOiBNYXRoLnJhbmRvbSgpICogMTAwMCArIDIwMFxuICAgIH07XG4gIH1cblxuICBwcml2YXRlIGdldFdpZGdldEludGVyYWN0aW9ucyh3aWRnZXRJZDogc3RyaW5nKTogbnVtYmVyIHtcbiAgICAvLyBNb2NrIGltcGxlbWVudGF0aW9uXG4gICAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDUwKSArIDE7XG4gIH1cblxuICBwcml2YXRlIGdldFdpZGdldExvYWRUaW1lKHdpZGdldElkOiBzdHJpbmcpOiBudW1iZXIge1xuICAgIC8vIE1vY2sgaW1wbGVtZW50YXRpb25cbiAgICByZXR1cm4gTWF0aC5yYW5kb20oKSAqIDEwMDAgKyAxMDA7XG4gIH1cblxuICBwcml2YXRlIGdlbmVyYXRlRGFzaGJvYXJkSWQoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gYGRhc2hib2FyZF8ke0RhdGUubm93KCl9XyR7TWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDkpfWA7XG4gIH1cblxuICBwcml2YXRlIGdlbmVyYXRlV2lkZ2V0SWQoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gYHdpZGdldF8ke0RhdGUubm93KCl9XyR7TWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDkpfWA7XG4gIH1cbn1cbiJdLCJ2ZXJzaW9uIjozfQ==